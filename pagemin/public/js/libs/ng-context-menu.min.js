;
angular
.module('ng-context-menu',[])
.factory('ContextMenuService',function(){
return{
menuElement:null
};
})
.directive('contextMenu',['$window','$parse','ContextMenuService',function($window,$parse,ContextMenuService){
return{
restrict:'A',
link:function($scope,element,attrs){
var opened=false,
openTarget,
disabled=$scope.$eval(attrs.contextMenuDisabled),
win=angular.element($window),
fn=$parse(attrs.contextMenu);
element.bind('contextmenu',function(event){
if(!disabled){
if(ContextMenuService.menuElement!==null){
close(ContextMenuService.menuElement);
}
ContextMenuService.menuElement=angular.element(document.getElementById(attrs.target));
openTarget=event.target;
event.preventDefault();
event.stopPropagation();
$scope.$apply(function(){
fn($scope,{$event:event});
});
}
});
}
};
}]);
;
