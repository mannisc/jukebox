;
var notSupportedBrowsers=[];
var displayPoweredBy=true;
var noticeLang='professional';
var noticeLangCustom=null;
var supportedBrowsers=[];
var BrowserDetection={
init:function(){
if(notSupportedBrowsers==null||notSupportedBrowsers.length<1){
notSupportedBrowsers=this.defaultNotSupportedBrowsers;
}
this.detectBrowser();
this.detectOS();
if(this.browser==''||this.browser=='Unknown'||this.os==''||
this.os=='Unknown'||this.browserVersion==''||this.browserVersion==0)
{
return;
}
var oldBrowser=false;
for(var i=0;i<notSupportedBrowsers.length;i++){
if(notSupportedBrowsers[i].os=='Any'||notSupportedBrowsers[i].os==this.os){
if(notSupportedBrowsers[i].browser=='Any'||notSupportedBrowsers[i].browser==this.browser){
if(notSupportedBrowsers[i].version=="Any"||this.browserVersion<=parseFloat(notSupportedBrowsers[i].version)){
oldBrowser=true;
break;
}
}
}
}
if(oldBrowser){
this.displayNotice();
}
},
getEl:function(id){return window.document.getElementById(id)},
getElSize:function(id){
var el=this.getEl(id);
if(el==null){return null}
return{'width':parseInt(el.offsetWidth),'height':parseInt(el.offsetHeight)};
},
getWindowSize:function(){
if(typeof window.innerWidth!='undefined'){
return{'width':parseInt(window.innerWidth),'height':parseInt(window.innerHeight)};
}else{
if(window.document.documentElement.clientWidth!=0){
return{'width':parseInt(window.document.documentElement.clientWidth),'height':parseInt(window.document.documentElement.clientHeight)};
}else{
return{'width':parseInt(window.document.body.clientWidth),'height':parseInt(window.document.body.clientHeight)};
}
}
},
positionNotice:function(){
var noticeSize=this.getElSize('browser-detection');
var windowSize=this.getWindowSize();
var noticeEl=this.getEl('browser-detection');
if(noticeEl==null||noticeSize==null||windowSize==null||!windowSize.width||!windowSize.height){return}
noticeEl.style.left=(windowSize.width-noticeSize.width)/2+"px";
var offset=(this.browser=="MSIE"&&this.browserVersion<7)?(window.document.documentElement.scrollTop!=0?window.document.documentElement.scrollTop:window.document.body.scrollTop):0;
noticeEl.style.top=(windowSize.height-noticeSize.height-20+offset)+"px";
this.noticeHeight=noticeSize.height;
},
displayNotice:function(){
if(this.readCookie('bdnotice')==1){
return;
}
this.writeNoticeCode();
this.positionNotice();
var el=this;
window.onresize=function(){el.positionNotice()};
if(this.browser=="MSIE"&&this.browserVersion<7){
window.onscroll=function(){el.positionNotice()};
}
this.getEl('browser-detection-close').onclick=function(){el.remindMe(false)};
this.getEl('browser-detection-remind-later').onclick=function(){el.remindMe(false)};
this.getEl('browser-detection-never-remind').onclick=function(){el.remindMe(true)};
},
remindMe:function(never){
this.writeCookie('bdnotice',1,never==true?365:7);
this.getEl('browser-detection').style.display='none';
this.getEl('black_overlay').style.display='none';
},
writeCookie:function(name,value,days){
var expiration="";
if(parseInt(days)>0){
var date=new Date();
date.setTime(date.getTime()+parseInt(days)*24*60*60*1000);
expiration='; expires='+date.toGMTString();
}
document.cookie=name+'='+value+expiration+'; path=/';
},
readCookie:function(name){
if(!document.cookie){return''}
var searchName=name+'=';
var data=document.cookie.split(';');
for(var i=0;i<data.length;i++){
while(data[i].charAt(0)==' '){
data[i]=data[i].substring(1,data[i].length);
}
if(data[i].indexOf(searchName)==0){
return data[i].substring(searchName.length,data[i].length);
}
}
return'';
},
writeNoticeCode:function(){
var title='';
var notice='';
var selectBrowser='';
var remindMeLater='';
var neverRemindAgain='';
var browsersList=null;
var code='<div id="black_overlay"></div><div id="browser-detection"><a href="javascript:;" id="browser-detection-close">Close</a>';
if(noticeLang=='custom'&&noticeLangCustom!=null){
title=noticeLangCustom.title;
notice=noticeLangCustom.notice;
selectBrowser=noticeLangCustom.selectBrowser;
remindMeLater=noticeLangCustom.remindMeLater;
neverRemindAgain=noticeLangCustom.neverRemindAgain;
}else{
var noticeTextObj=null;
eval('noticeTextObj = this.noticeText.'+noticeLang+';');
if(!noticeTextObj){
noticeTextObj=this.noticeText.professional;
}
title=noticeTextObj.title;
notice=noticeTextObj.notice;
selectBrowser=noticeTextObj.selectBrowser;
remindMeLater=noticeTextObj.remindMeLater;
neverRemindAgain=noticeTextObj.neverRemindAgain;
}
notice=notice.replace("\n",'</p><p class="bd-notice">');
notice=notice.replace("{browser_name}",(this.browser+" "+this.browserVersion));
code+='<p class="bd-title">'+title+'</p><p class="bd-notice">'+notice+'</p><p class="bd-notice"><b>'+selectBrowser+'</b></p>';
if(supportedBrowsers.length>0){
browsersList=supportedBrowsers;
}else{
browsersList=this.supportedBrowsers;
}
code+='<ul class="bd-browsers-list">';
for(var i=0;i<browsersList.length;i++){
code+='<li class="'+browsersList[i].cssClass+'"><a href="'+browsersList[i].downloadUrl+'" target="_blank">'+browsersList[i].name+'</a></li>';
}
code+='</ul>';
if(displayPoweredBy){
code+='<div class="bd-poweredby">Powered by <a href="http://www.devslide.com/labs/browser-detection" target="_blank">DevSlide Labs</a></div>';
}
code+='<ul class="bd-skip-buttons">';
code+='<li><button id="browser-detection-remind-later" type="button" class="ui-btn ui-input-btn ui-corner-all ui-shadow">'+remindMeLater+'</button></li>';
code+='<li><button id="browser-detection-never-remind" type="button" class="ui-btn ui-input-btn ui-corner-all ui-shadow">'+neverRemindAgain+'</button></li>';
code+='</ul>';
code+='</div>';
$(code).appendTo("body")
},
detectBrowser:function(){
this.browser='';
this.browserVersion=0;
if(/Opera[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
this.browser='Opera';
}else if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){
this.browser='MSIE';
}else if(/Navigator[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
this.browser='Netscape';
}else if(/Chrome[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
this.browser='Chrome';
}else if(/Safari[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
this.browser='Safari';
/Version[\/\s](\d+\.\d+)/.test(navigator.userAgent);
this.browserVersion=new Number(RegExp.$1);
}else if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
this.browser='Firefox';
}
if(this.browser==''){
this.browser='Unknown';
}else if(this.browserVersion==0){
this.browserVersion=parseFloat(new Number(RegExp.$1));
}
},
detectOS:function(){
for(var i=0;i<this.operatingSystems.length;i++){
if(this.operatingSystems[i].searchString.indexOf(this.operatingSystems[i].subStr)!=-1){
this.os=this.operatingSystems[i].name;
return;
}
}
this.os="Unknown";
},
noticeHeight:0,
browser:'',
os:'',
browserVersion:'',
supportedBrowsers:[
{'cssClass':'chrome','name':'Google Chrome','downloadUrl':'http://www.google.com/chrome/'},
{'cssClass':'firefox','name':'Mozilla Firefox','downloadUrl':'http://www.getfirefox.com/'},
{'cssClass':'opera','name':'Opera','downloadUrl':'http://www.opera.com/'},
{'cssClass':'safari','name':'Apple Safari','downloadUrl':'http://www.apple.com/safari/'},
{'cssClass':'msie','name':'Internet Explorer','downloadUrl':'http://www.getie.com/'}
],
operatingSystems:[
{'searchString':navigator.platform,'name':'Windows','subStr':'Win'},
{'searchString':navigator.platform,'name':'Mac','subStr':'Mac'},
{'searchString':navigator.platform,'name':'Linux','subStr':'Linux'},
{'searchString':navigator.userAgent,'name':'iPhone','subStr':'iPhone/iPod'}
],
defaultNotSupportedBrowsers:[{'os':'Any','browser':'MSIE','version':6}],
noticeText:{
'professional':{"title":"Outdated Browser Detected","notice":"Our website has detected that you are using an outdated browser. Using your current browser will prevent you from accessing features on our website. An upgrade is not required, but is strongly recommend to improve your browsing experience on our website.","selectBrowser":"Use the links below to download a new browser or upgrade your existing browser.","remindMeLater":"Remind me later","neverRemindAgain":"No, don't remind me again"},
'informal':{"title":"Whoaa!","notice":"It appears you're using an outdated browser which prevents access to some of the features on our website. You really should <b>upgrade or install a new browser</b>!","selectBrowser":"Visit the official sites for popular browsers below:","remindMeLater":"Not now, but maybe later","neverRemindAgain":"No, don't remind me again"},
'technical':{"title":"Old Browser Alert! <span class='bd-highlight'>DEFCON 5</span>","notice":"Come on! If you are hitting our site, then you must at least be partially tech savvy. So, why the older browser? We're not asking you to brush off your old Fibonacci Heap and share it with the class. Just upgrade!\nI know, I know. You don't like to be told what to do. But, we're only asking you to upgrade so you can access all the latest, greatest features on our site. It's quick and easy. But, if you still want to skip it, that's cool. We will still welcome you &mdash; and your creepy old browser. :P","selectBrowser":"Visit the official sites for popular browsers below:","remindMeLater":"Remind me later","neverRemindAgain":"No, don't remind me. I like my Commodore 64!"},
'goofy':{"title":"Are You Serious?","notice":"Are you really using <b>{browser_name}</b> as your browser?\nYou're surfing the web on a dinosaur (a dangerous one too &mdash; like a Tyrannosaurus or Pterodactyl or something scary like that). <b>Get with it and upgrade now!</b> If you do, we promise you will enjoy our site a whole lot more. :)","selectBrowser":"Visit the official sites for popular browsers below:","remindMeLater":"Maybe Later","neverRemindAgain":"No, don't remind me again"},
'mean':{"title":"Umm, Your Browser Sucks!","notice":"Get a new one here.","selectBrowser":"Official sites for popular browsers:","remindMeLater":"Remind me later, a'hole","neverRemindAgain":"F' off! My browser rocks!"}
}
};
window.onload=function(){
BrowserDetection.init();
};
;

;
;(function(){
var CORDOVA_JS_BUILD_LABEL='3.0.0-0-ge670de9';
var require,
define;
(function(){
var modules={},
requireStack=[],
inProgressModules={},
SEPERATOR=".";
function build(module){
var factory=module.factory,
localRequire=function(id){
var resultantId=id;
if(id.charAt(0)==="."){
resultantId=module.id.slice(0,module.id.lastIndexOf(SEPERATOR))+SEPERATOR+id.slice(2);
}
return require(resultantId);
};
module.exports={};
delete module.factory;
factory(localRequire,module.exports,module);
return module.exports;
}
require=function(id){
if(!modules[id]){
throw"module "+id+" not found";
}else if(id in inProgressModules){
var cycle=requireStack.slice(inProgressModules[id]).join('->')+'->'+id;
throw"Cycle in require graph: "+cycle;
}
if(modules[id].factory){
try{
inProgressModules[id]=requireStack.length;
requireStack.push(id);
return build(modules[id]);
}finally{
delete inProgressModules[id];
requireStack.pop();
}
}
return modules[id].exports;
};
define=function(id,factory){
if(modules[id]){
throw"module "+id+" already defined";
}
modules[id]={
id:id,
factory:factory
};
};
define.remove=function(id){
delete modules[id];
};
define.moduleMap=modules;
})();
if(typeof module==="object"&&typeof require==="function"){
module.exports.require=require;
module.exports.define=define;
}
define("cordova",function(require,exports,module){
var channel=require('cordova/channel');

document.addEventListener('DOMContentLoaded',function(){
channel.onDOMContentLoaded.fire();
},false);
if(document.readyState=='complete'||document.readyState=='interactive'){
channel.onDOMContentLoaded.fire();
}

var m_document_addEventListener=document.addEventListener;
var m_document_removeEventListener=document.removeEventListener;
var m_window_addEventListener=window.addEventListener;
var m_window_removeEventListener=window.removeEventListener;

var documentEventHandlers={},
windowEventHandlers={};
document.addEventListener=function(evt,handler,capture){
var e=evt.toLowerCase();
if(typeof documentEventHandlers[e]!='undefined'){
documentEventHandlers[e].subscribe(handler);
}else{
m_document_addEventListener.call(document,evt,handler,capture);
}
};
window.addEventListener=function(evt,handler,capture){
var e=evt.toLowerCase();
if(typeof windowEventHandlers[e]!='undefined'){
windowEventHandlers[e].subscribe(handler);
}else{
m_window_addEventListener.call(window,evt,handler,capture);
}
};
document.removeEventListener=function(evt,handler,capture){
var e=evt.toLowerCase();
if(typeof documentEventHandlers[e]!="undefined"){
documentEventHandlers[e].unsubscribe(handler);
}else{
m_document_removeEventListener.call(document,evt,handler,capture);
}
};
window.removeEventListener=function(evt,handler,capture){
var e=evt.toLowerCase();
if(typeof windowEventHandlers[e]!="undefined"){
windowEventHandlers[e].unsubscribe(handler);
}else{
m_window_removeEventListener.call(window,evt,handler,capture);
}
};
function createEvent(type,data){
var event=document.createEvent('Events');
event.initEvent(type,false,false);
if(data){
for(var i in data){
if(data.hasOwnProperty(i)){
event[i]=data[i];
}
}
}
return event;
}
if(typeof window.console==="undefined"){
window.console={
log:function(){}
};
}
if(typeof window.console.warn==="undefined"){
window.console.warn=function(msg){
this.log("warn: "+msg);
}
}
var cordova={
define:define,
require:require,

addWindowEventHandler:function(event){
return(windowEventHandlers[event]=channel.create(event));
},
addStickyDocumentEventHandler:function(event){
return(documentEventHandlers[event]=channel.createSticky(event));
},
addDocumentEventHandler:function(event){
return(documentEventHandlers[event]=channel.create(event));
},
removeWindowEventHandler:function(event){
delete windowEventHandlers[event];
},
removeDocumentEventHandler:function(event){
delete documentEventHandlers[event];
},

getOriginalHandlers:function(){
return{'document':{'addEventListener':m_document_addEventListener,'removeEventListener':m_document_removeEventListener},
'window':{'addEventListener':m_window_addEventListener,'removeEventListener':m_window_removeEventListener}};
},

fireDocumentEvent:function(type,data,bNoDetach){
var evt=createEvent(type,data);
if(typeof documentEventHandlers[type]!='undefined'){
if(bNoDetach){
documentEventHandlers[type].fire(evt);
}
else{
setTimeout(function(){
if(type=='deviceready'){
document.dispatchEvent(evt);
}
documentEventHandlers[type].fire(evt);
},0);
}
}else{
document.dispatchEvent(evt);
}
},
fireWindowEvent:function(type,data){
var evt=createEvent(type,data);
if(typeof windowEventHandlers[type]!='undefined'){
setTimeout(function(){
windowEventHandlers[type].fire(evt);
},0);
}else{
window.dispatchEvent(evt);
}
},

callbackId:Math.floor(Math.random()*2000000000),
callbacks:{},
callbackStatus:{
NO_RESULT:0,
OK:1,
CLASS_NOT_FOUND_EXCEPTION:2,
ILLEGAL_ACCESS_EXCEPTION:3,
INSTANTIATION_EXCEPTION:4,
MALFORMED_URL_EXCEPTION:5,
IO_EXCEPTION:6,
INVALID_ACTION:7,
JSON_EXCEPTION:8,
ERROR:9
},

callbackSuccess:function(callbackId,args){
try{
cordova.callbackFromNative(callbackId,true,args.status,[args.message],args.keepCallback);
}catch(e){
console.log("Error in error callback: "+callbackId+" = "+e);
}
},

callbackError:function(callbackId,args){
try{
cordova.callbackFromNative(callbackId,false,args.status,[args.message],args.keepCallback);
}catch(e){
console.log("Error in error callback: "+callbackId+" = "+e);
}
},

callbackFromNative:function(callbackId,success,status,args,keepCallback){
var callback=cordova.callbacks[callbackId];
if(callback){
if(success&&status==cordova.callbackStatus.OK){
callback.success&&callback.success.apply(null,args);
}else if(!success){
callback.fail&&callback.fail.apply(null,args);
}
if(!keepCallback){
delete cordova.callbacks[callbackId];
}
}
},
addConstructor:function(func){
channel.onCordovaReady.subscribe(function(){
try{
func();
}catch(e){
console.log("Failed to run constructor: "+e);
}
});
}
};
channel.onPause=cordova.addDocumentEventHandler('pause');
channel.onResume=cordova.addDocumentEventHandler('resume');
channel.onDeviceReady=cordova.addStickyDocumentEventHandler('deviceready');
module.exports=cordova;
});
define("cordova/argscheck",function(require,exports,module){
var exec=require('cordova/exec');
var utils=require('cordova/utils');
var moduleExports=module.exports;
var typeMap={
'A':'Array',
'D':'Date',
'N':'Number',
'S':'String',
'F':'Function',
'O':'Object'
};
function extractParamName(callee,argIndex){
return(/.*?\((.*?)\)/).exec(callee)[1].split(', ')[argIndex];
}
function checkArgs(spec,functionName,args,opt_callee){
if(!moduleExports.enableChecks){
return;
}
var errMsg=null;
var typeName;
for(var i=0;i<spec.length;++i){
var c=spec.charAt(i),
cUpper=c.toUpperCase(),
arg=args[i];
if(c=='*'){
continue;
}
typeName=utils.typeName(arg);
if((arg===null||arg===undefined)&&c==cUpper){
continue;
}
if(typeName!=typeMap[cUpper]){
errMsg='Expected '+typeMap[cUpper];
break;
}
}
if(errMsg){
errMsg+=', but got '+typeName+'.';
errMsg='Wrong type for parameter "'+extractParamName(opt_callee||args.callee,i)+'" of '+functionName+': '+errMsg;
if(typeof jasmine=='undefined'){
console.error(errMsg);
}
throw TypeError(errMsg);
}
}
function getValue(value,defaultValue){
return value===undefined?defaultValue:value;
}
moduleExports.checkArgs=checkArgs;
moduleExports.getValue=getValue;
moduleExports.enableChecks=true;
});
define("cordova/base64",function(require,exports,module){
var base64=exports;
base64.fromArrayBuffer=function(arrayBuffer){
var array=new Uint8Array(arrayBuffer);
return uint8ToBase64(array);
};

var b64_6bit="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
var b64_12bit;
var b64_12bitTable=function(){
b64_12bit=[];
for(var i=0;i<64;i++){
for(var j=0;j<64;j++){
b64_12bit[i*64+j]=b64_6bit[i]+b64_6bit[j];
}
}
b64_12bitTable=function(){return b64_12bit};
return b64_12bit;
}
function uint8ToBase64(rawData){
var numBytes=rawData.byteLength;
var output="";
var segment;
var table=b64_12bitTable();
for(var i=0;i<numBytes-2;i+=3){
segment=(rawData[i]<<16)+(rawData[i+1]<<8)+rawData[i+2];
output+=table[segment>>12];
output+=table[segment&0xfff];
}
if(numBytes-i==2){
segment=(rawData[i]<<16)+(rawData[i+1]<<8);
output+=table[segment>>12];
output+=b64_6bit[(segment&0xfff)>>6];
output+='=';
}else if(numBytes-i==1){
segment=(rawData[i]<<16);
output+=table[segment>>12];
output+='==';
}
return output;
}
});
define("cordova/builder",function(require,exports,module){
var utils=require('cordova/utils');
function each(objects,func,context){
for(var prop in objects){
if(objects.hasOwnProperty(prop)){
func.apply(context,[objects[prop],prop]);
}
}
}
function clobber(obj,key,value){
exports.replaceHookForTesting(obj,key);
obj[key]=value;
if(obj[key]!==value){
utils.defineGetter(obj,key,function(){
return value;
});
}
}
function assignOrWrapInDeprecateGetter(obj,key,value,message){
if(message){
utils.defineGetter(obj,key,function(){
console.log(message);
delete obj[key];
clobber(obj,key,value);
return value;
});
}else{
clobber(obj,key,value);
}
}
function include(parent,objects,clobber,merge){
each(objects,function(obj,key){
try{
var result=obj.path?require(obj.path):{};
if(clobber){
if(typeof parent[key]==='undefined'){
assignOrWrapInDeprecateGetter(parent,key,result,obj.deprecated);
}else if(typeof obj.path!=='undefined'){
if(merge){
recursiveMerge(parent[key],result);
}else{
assignOrWrapInDeprecateGetter(parent,key,result,obj.deprecated);
}
}
result=parent[key];
}else{
if(typeof parent[key]=='undefined'){
assignOrWrapInDeprecateGetter(parent,key,result,obj.deprecated);
}else{
result=parent[key];
}
}
if(obj.children){
include(result,obj.children,clobber,merge);
}
}catch(e){
utils.alert('Exception building cordova JS globals: '+e+' for key "'+key+'"');
}
});
}

function recursiveMerge(target,src){
for(var prop in src){
if(src.hasOwnProperty(prop)){
if(target.prototype&&target.prototype.constructor===target){
clobber(target.prototype,prop,src[prop]);
}else{
if(typeof src[prop]==='object'&&typeof target[prop]==='object'){
recursiveMerge(target[prop],src[prop]);
}else{
clobber(target,prop,src[prop]);
}
}
}
}
}
exports.buildIntoButDoNotClobber=function(objects,target){
include(target,objects,false,false);
};
exports.buildIntoAndClobber=function(objects,target){
include(target,objects,true,false);
};
exports.buildIntoAndMerge=function(objects,target){
include(target,objects,true,true);
};
exports.recursiveMerge=recursiveMerge;
exports.assignOrWrapInDeprecateGetter=assignOrWrapInDeprecateGetter;
exports.replaceHookForTesting=function(){};
});
define("cordova/channel",function(require,exports,module){
var utils=require('cordova/utils'),
nextGuid=1;


var Channel=function(type,sticky){
this.type=type;
this.handlers={};
this.state=sticky?1:0;
this.fireArgs=null;
this.numHandlers=0;
this.onHasSubscribersChange=null;
},
channel={

join:function(h,c){
var len=c.length,
i=len,
f=function(){
if(!(--i))h();
};
for(var j=0;j<len;j++){
if(c[j].state===0){
throw Error('Can only use join with sticky channels.');
}
c[j].subscribe(f);
}
if(!len)h();
},
create:function(type){
return channel[type]=new Channel(type,false);
},
createSticky:function(type){
return channel[type]=new Channel(type,true);
},

deviceReadyChannelsArray:[],
deviceReadyChannelsMap:{},

waitForInitialization:function(feature){
if(feature){
var c=channel[feature]||this.createSticky(feature);
this.deviceReadyChannelsMap[feature]=c;
this.deviceReadyChannelsArray.push(c);
}
},

initializationComplete:function(feature){
var c=this.deviceReadyChannelsMap[feature];
if(c){
c.fire();
}
}
};
function forceFunction(f){
if(typeof f!='function')throw"Function required as first argument!";
}

Channel.prototype.subscribe=function(f,c){
forceFunction(f);
if(this.state==2){
f.apply(c||this,this.fireArgs);
return;
}
var func=f,
guid=f.observer_guid;
if(typeof c=="object"){func=utils.close(c,f)}
if(!guid){
guid=''+nextGuid++;
}
func.observer_guid=guid;
f.observer_guid=guid;
if(!this.handlers[guid]){
this.handlers[guid]=func;
this.numHandlers++;
if(this.numHandlers==1){
this.onHasSubscribersChange&&this.onHasSubscribersChange();
}
}
};

Channel.prototype.unsubscribe=function(f){
forceFunction(f);
var guid=f.observer_guid,
handler=this.handlers[guid];
if(handler){
delete this.handlers[guid];
this.numHandlers--;
if(this.numHandlers===0){
this.onHasSubscribersChange&&this.onHasSubscribersChange();
}
}
};

Channel.prototype.fire=function(e){
var fail=false,
fireArgs=Array.prototype.slice.call(arguments);
if(this.state==1){
this.state=2;
this.fireArgs=fireArgs;
}
if(this.numHandlers){
var toCall=[];
for(var item in this.handlers){
toCall.push(this.handlers[item]);
}
for(var i=0;i<toCall.length;++i){
toCall[i].apply(this,fireArgs);
}
if(this.state==2&&this.numHandlers){
this.numHandlers=0;
this.handlers={};
this.onHasSubscribersChange&&this.onHasSubscribersChange();
}
}
};
channel.createSticky('onDOMContentLoaded');
channel.createSticky('onNativeReady');
channel.createSticky('onCordovaReady');
channel.createSticky('onPluginsReady');
channel.createSticky('onDeviceReady');
channel.create('onResume');
channel.create('onPause');
channel.createSticky('onDestroy');
channel.waitForInitialization('onCordovaReady');
channel.waitForInitialization('onDOMContentLoaded');
module.exports=channel;
});
define("cordova/commandProxy",function(require,exports,module){
var CommandProxyMap={};
module.exports={
add:function(id,proxyObj){
console.log("adding proxy for "+id);
CommandProxyMap[id]=proxyObj;
return proxyObj;
},
remove:function(id){
var proxy=CommandProxyMap[id];
delete CommandProxyMap[id];
CommandProxyMap[id]=null;
return proxy;
},
get:function(service,action){
return(CommandProxyMap[service]?CommandProxyMap[service][action]:null);
}
};
});
define("cordova/exec",function(require,exports,module){

var cordova=require('cordova'),
nativeApiProvider=require('cordova/plugin/android/nativeapiprovider'),
utils=require('cordova/utils'),
base64=require('cordova/base64'),
jsToNativeModes={
PROMPT:0,
JS_OBJECT:1,
LOCATION_CHANGE:2
},
nativeToJsModes={
POLLING:0,
LOAD_URL:1,
ONLINE_EVENT:2,
PRIVATE_API:3
},
jsToNativeBridgeMode,nativeToJsBridgeMode=nativeToJsModes.ONLINE_EVENT,
pollEnabled=false,
messagesFromNative=[];
function androidExec(success,fail,service,action,args){
if(jsToNativeBridgeMode===undefined){
androidExec.setJsToNativeBridgeMode(jsToNativeModes.JS_OBJECT);
}
for(var i=0;i<args.length;i++){
if(utils.typeName(args[i])=='ArrayBuffer'){
args[i]=base64.fromArrayBuffer(args[i]);
}
}
var callbackId=service+cordova.callbackId++,
argsJson=JSON.stringify(args);
if(success||fail){
cordova.callbacks[callbackId]={success:success,fail:fail};
}
if(jsToNativeBridgeMode==jsToNativeModes.LOCATION_CHANGE){
window.location='http://cdv_exec/'+service+'#'+action+'#'+callbackId+'#'+argsJson;
}else{
var messages=nativeApiProvider.get().exec(service,action,callbackId,argsJson);
if(jsToNativeBridgeMode==jsToNativeModes.JS_OBJECT&&messages==="@Null arguments."){
androidExec.setJsToNativeBridgeMode(jsToNativeModes.PROMPT);
androidExec(success,fail,service,action,args);
androidExec.setJsToNativeBridgeMode(jsToNativeModes.JS_OBJECT);
return;
}else{
androidExec.processMessages(messages);
}
}
}
function pollOnce(){
var msg=nativeApiProvider.get().retrieveJsMessages();
androidExec.processMessages(msg);
}
function pollingTimerFunc(){
if(pollEnabled){
pollOnce();
setTimeout(pollingTimerFunc,50);
}
}
function hookOnlineApis(){
function proxyEvent(e){
cordova.fireWindowEvent(e.type);
}
window.addEventListener('online',pollOnce,false);
window.addEventListener('offline',pollOnce,false);
cordova.addWindowEventHandler('online');
cordova.addWindowEventHandler('offline');
document.addEventListener('online',proxyEvent,false);
document.addEventListener('offline',proxyEvent,false);
}
hookOnlineApis();
androidExec.jsToNativeModes=jsToNativeModes;
androidExec.nativeToJsModes=nativeToJsModes;
androidExec.setJsToNativeBridgeMode=function(mode){
if(mode==jsToNativeModes.JS_OBJECT&&!window._cordovaNative){
console.log('Falling back on PROMPT mode since _cordovaNative is missing. Expected for Android 3.2 and lower only.');
mode=jsToNativeModes.PROMPT;
}
nativeApiProvider.setPreferPrompt(mode==jsToNativeModes.PROMPT);
jsToNativeBridgeMode=mode;
};
androidExec.setNativeToJsBridgeMode=function(mode){
if(mode==nativeToJsBridgeMode){
return;
}
if(nativeToJsBridgeMode==nativeToJsModes.POLLING){
pollEnabled=false;
}
nativeToJsBridgeMode=mode;
nativeApiProvider.get().setNativeToJsBridgeMode(mode);
if(mode==nativeToJsModes.POLLING){
pollEnabled=true;
setTimeout(pollingTimerFunc,1);
}
};
function processMessage(message){
try{
var firstChar=message.charAt(0);
if(firstChar=='J'){
eval(message.slice(1));
}else if(firstChar=='S'||firstChar=='F'){
var success=firstChar=='S';
var keepCallback=message.charAt(1)=='1';
var spaceIdx=message.indexOf(' ',2);
var status=+message.slice(2,spaceIdx);
var nextSpaceIdx=message.indexOf(' ',spaceIdx+1);
var callbackId=message.slice(spaceIdx+1,nextSpaceIdx);
var payloadKind=message.charAt(nextSpaceIdx+1);
var payload;
if(payloadKind=='s'){
payload=message.slice(nextSpaceIdx+2);
}else if(payloadKind=='t'){
payload=true;
}else if(payloadKind=='f'){
payload=false;
}else if(payloadKind=='N'){
payload=null;
}else if(payloadKind=='n'){
payload=+message.slice(nextSpaceIdx+2);
}else if(payloadKind=='A'){
var data=message.slice(nextSpaceIdx+2);
var bytes=window.atob(data);
var arraybuffer=new Uint8Array(bytes.length);
for(var i=0;i<bytes.length;i++){
arraybuffer[i]=bytes.charCodeAt(i);
}
payload=arraybuffer.buffer;
}else if(payloadKind=='S'){
payload=window.atob(message.slice(nextSpaceIdx+2));
}else{
payload=JSON.parse(message.slice(nextSpaceIdx+1));
}
cordova.callbackFromNative(callbackId,success,status,[payload],keepCallback);
}else{
console.log("processMessage failed: invalid message:"+message);
}
}catch(e){
console.log("processMessage failed: Message: "+message);
console.log("processMessage failed: Error: "+e);
console.log("processMessage failed: Stack: "+e.stack);
}
}
androidExec.processMessages=function(messages){
if(messages){
messagesFromNative.push(messages);
if(messagesFromNative.length>1){
return;
}
while(messagesFromNative.length){
messages=messagesFromNative[0];
if(messages=='*'){
messagesFromNative.shift();
window.setTimeout(pollOnce,0);
return;
}
var spaceIdx=messages.indexOf(' ');
var msgLen=+messages.slice(0,spaceIdx);
var message=messages.substr(spaceIdx+1,msgLen);
messages=messages.slice(spaceIdx+msgLen+1);
processMessage(message);
if(messages){
messagesFromNative[0]=messages;
}else{
messagesFromNative.shift();
}
}
}
};
module.exports=androidExec;
});
define("cordova/modulemapper",function(require,exports,module){
var builder=require('cordova/builder'),
moduleMap=define.moduleMap,
symbolList,
deprecationMap;
exports.reset=function(){
symbolList=[];
deprecationMap={};
};
function addEntry(strategy,moduleName,symbolPath,opt_deprecationMessage){
if(!(moduleName in moduleMap)){
throw new Error('Module '+moduleName+' does not exist.');
}
symbolList.push(strategy,moduleName,symbolPath);
if(opt_deprecationMessage){
deprecationMap[symbolPath]=opt_deprecationMessage;
}
}
exports.clobbers=function(moduleName,symbolPath,opt_deprecationMessage){
addEntry('c',moduleName,symbolPath,opt_deprecationMessage);
};
exports.merges=function(moduleName,symbolPath,opt_deprecationMessage){
addEntry('m',moduleName,symbolPath,opt_deprecationMessage);
};
exports.defaults=function(moduleName,symbolPath,opt_deprecationMessage){
addEntry('d',moduleName,symbolPath,opt_deprecationMessage);
};
exports.runs=function(moduleName){
addEntry('r',moduleName,null);
};
function prepareNamespace(symbolPath,context){
if(!symbolPath){
return context;
}
var parts=symbolPath.split('.');
var cur=context;
for(var i=0,part;part=parts[i];++i){
cur=cur[part]=cur[part]||{};
}
return cur;
}
exports.mapModules=function(context){
var origSymbols={};
context.CDV_origSymbols=origSymbols;
for(var i=0,len=symbolList.length;i<len;i+=3){
var strategy=symbolList[i];
var moduleName=symbolList[i+1];
var module=require(moduleName);
if(strategy=='r'){
continue;
}
var symbolPath=symbolList[i+2];
var lastDot=symbolPath.lastIndexOf('.');
var namespace=symbolPath.substr(0,lastDot);
var lastName=symbolPath.substr(lastDot+1);
var deprecationMsg=symbolPath in deprecationMap?'Access made to deprecated symbol: '+symbolPath+'. '+deprecationMsg:null;
var parentObj=prepareNamespace(namespace,context);
var target=parentObj[lastName];
if(strategy=='m'&&target){
builder.recursiveMerge(target,module);
}else if((strategy=='d'&&!target)||(strategy!='d')){
if(!(symbolPath in origSymbols)){
origSymbols[symbolPath]=target;
}
builder.assignOrWrapInDeprecateGetter(parentObj,lastName,module,deprecationMsg);
}
}
};
exports.getOriginalSymbol=function(context,symbolPath){
var origSymbols=context.CDV_origSymbols;
if(origSymbols&&(symbolPath in origSymbols)){
return origSymbols[symbolPath];
}
var parts=symbolPath.split('.');
var obj=context;
for(var i=0;i<parts.length;++i){
obj=obj&&obj[parts[i]];
}
return obj;
};
exports.loadMatchingModules=function(matchingRegExp){
for(var k in moduleMap){
if(matchingRegExp.exec(k)){
require(k);
}
}
};
exports.reset();
});
define("cordova/platform",function(require,exports,module){
module.exports={
id:"android",
initialize:function(){
var channel=require("cordova/channel"),
cordova=require('cordova'),
exec=require('cordova/exec'),
modulemapper=require('cordova/modulemapper');
modulemapper.loadMatchingModules(/cordova.*\/symbols$/);
modulemapper.clobbers('cordova/plugin/android/app','navigator.app');
modulemapper.mapModules(window);
var backButtonChannel=cordova.addDocumentEventHandler('backbutton');
backButtonChannel.onHasSubscribersChange=function(){
exec(null,null,"App","overrideBackbutton",[this.numHandlers==1]);
};
cordova.addDocumentEventHandler('menubutton');
cordova.addDocumentEventHandler('searchbutton');
channel.join(function(){
exec(null,null,"App","show",[]);
},[channel.onCordovaReady]);
}
};
});
define("cordova/plugin/android/app",function(require,exports,module){
var exec=require('cordova/exec');
module.exports={

clearCache:function(){
exec(null,null,"App","clearCache",[]);
},

loadUrl:function(url,props){
exec(null,null,"App","loadUrl",[url,props]);
},

cancelLoadUrl:function(){
exec(null,null,"App","cancelLoadUrl",[]);
},

clearHistory:function(){
exec(null,null,"App","clearHistory",[]);
},

backHistory:function(){
exec(null,null,"App","backHistory",[]);
},

overrideBackbutton:function(override){
exec(null,null,"App","overrideBackbutton",[override]);
},

exitApp:function(){
return exec(null,null,"App","exitApp",[]);
}
};
});
define("cordova/plugin/android/nativeapiprovider",function(require,exports,module){

var nativeApi=this._cordovaNative||require('cordova/plugin/android/promptbasednativeapi');
var currentApi=nativeApi;
module.exports={
get:function(){return currentApi},
setPreferPrompt:function(value){
currentApi=value?require('cordova/plugin/android/promptbasednativeapi'):nativeApi;
},
set:function(value){
currentApi=value;
}
};
});
define("cordova/plugin/android/promptbasednativeapi",function(require,exports,module){

module.exports={
exec:function(service,action,callbackId,argsJson){
return prompt(argsJson,'gap:'+JSON.stringify([service,action,callbackId]));
},
setNativeToJsBridgeMode:function(value){
prompt(value,'gap_bridge_mode:');
},
retrieveJsMessages:function(){
return prompt('','gap_poll:');
}
};
});
define("cordova/plugin/android/storage",function(require,exports,module){
var utils=require('cordova/utils'),
exec=require('cordova/exec'),
channel=require('cordova/channel');
var queryQueue={};

var DroidDB_Rows=function(){
this.resultSet=[];this.length=0};

DroidDB_Rows.prototype.item=function(row){
return this.resultSet[row];
};

var DroidDB_Result=function(){
this.rows=new DroidDB_Rows();
};

function completeQuery(id,data){
var query=queryQueue[id];
if(query){
try{
delete queryQueue[id];
var tx=query.tx;
if(tx&&tx.queryList[id]){
var r=new DroidDB_Result();
r.rows.resultSet=data;
r.rows.length=data.length;
try{
if(typeof query.successCallback==='function'){
query.successCallback(query.tx,r);
}
}catch(ex){
console.log("executeSql error calling user success callback: "+ex);
}
tx.queryComplete(id);
}
}catch(e){
console.log("executeSql error: "+e);
}
}
}

function failQuery(reason,id){
var query=queryQueue[id];
if(query){
try{
delete queryQueue[id];
var tx=query.tx;
if(tx&&tx.queryList[id]){
tx.queryList={};
try{
if(typeof query.errorCallback==='function'){
query.errorCallback(query.tx,reason);
}
}catch(ex){
console.log("executeSql error calling user error callback: "+ex);
}
tx.queryFailed(id,reason);
}
}catch(e){
console.log("executeSql error: "+e);
}
}
}

var DroidDB_Query=function(tx){
this.id=utils.createUUID();
queryQueue[this.id]=this;
this.resultSet=[];
this.tx=tx;
this.tx.queryList[this.id]=this;
this.successCallback=null;
this.errorCallback=null;
};

var DroidDB_Tx=function(){
this.id=utils.createUUID();
this.successCallback=null;
this.errorCallback=null;
this.queryList={};
};

DroidDB_Tx.prototype.queryComplete=function(id){
delete this.queryList[id];
if(this.successCallback){
var count=0;
var i;
for(i in this.queryList){
if(this.queryList.hasOwnProperty(i)){
count++;
}
}
if(count===0){
try{
this.successCallback();
}catch(e){
console.log("Transaction error calling user success callback: "+e);
}
}
}
};

DroidDB_Tx.prototype.queryFailed=function(id,reason){
this.queryList={};
if(this.errorCallback){
try{
this.errorCallback(reason);
}catch(e){
console.log("Transaction error calling user error callback: "+e);
}
}
};

DroidDB_Tx.prototype.executeSql=function(sql,params,successCallback,errorCallback){
if(typeof params==='undefined'){
params=[];
}
var query=new DroidDB_Query(this);
queryQueue[query.id]=query;
query.successCallback=successCallback;
query.errorCallback=errorCallback;
exec(null,null,"Storage","executeSql",[sql,params,query.id]);
};
var DatabaseShell=function(){
};

DatabaseShell.prototype.transaction=function(process,errorCallback,successCallback){
var tx=new DroidDB_Tx();
tx.successCallback=successCallback;
tx.errorCallback=errorCallback;
try{
process(tx);
}catch(e){
console.log("Transaction error: "+e);
if(tx.errorCallback){
try{
tx.errorCallback(e);
}catch(ex){
console.log("Transaction error calling user error callback: "+e);
}
}
}
};

var DroidDB_openDatabase=function(name,version,display_name,size){
exec(null,null,"Storage","openDatabase",[name,version,display_name,size]);
var db=new DatabaseShell();
return db;
};
module.exports={
openDatabase:DroidDB_openDatabase,
failQuery:failQuery,
completeQuery:completeQuery
};
});
define("cordova/plugin/android/storage/openDatabase",function(require,exports,module){
var modulemapper=require('cordova/modulemapper'),
storage=require('cordova/plugin/android/storage');
var originalOpenDatabase=modulemapper.getOriginalSymbol(window,'openDatabase');
module.exports=function(name,version,desc,size){
if(!originalOpenDatabase){
return storage.openDatabase.apply(this,arguments);
}
try{
return originalOpenDatabase(name,version,desc,size);
}catch(ex){
if(ex.code!==18){
throw ex;
}
}
return storage.openDatabase(name,version,desc,size);
};
});
define("cordova/plugin/android/storage/symbols",function(require,exports,module){
var modulemapper=require('cordova/modulemapper');
modulemapper.clobbers('cordova/plugin/android/storage/openDatabase','openDatabase');
});
define("cordova/plugin/echo",function(require,exports,module){
var exec=require('cordova/exec'),
utils=require('cordova/utils');

module.exports=function(successCallback,errorCallback,message,forceAsync){
var action='echo';
var messageIsMultipart=(utils.typeName(message)=="Array");
var args=messageIsMultipart?message:[message];
if(utils.typeName(message)=='ArrayBuffer'){
if(forceAsync){
console.warn('Cannot echo ArrayBuffer with forced async, falling back to sync.');
}
action+='ArrayBuffer';
}else if(messageIsMultipart){
if(forceAsync){
console.warn('Cannot echo MultiPart Array with forced async, falling back to sync.');
}
action+='MultiPart';
}else if(forceAsync){
action+='Async';
}
exec(successCallback,errorCallback,"Echo",action,args);
};
});
define("cordova/pluginloader",function(require,exports,module){
var channel=require('cordova/channel');
var modulemapper=require('cordova/modulemapper');
function injectScript(url,onload,onerror){
var script=document.createElement("script");
script.onload=onload;
script.onerror=onerror||onload;
script.src=url;
document.head.appendChild(script);
}
function onScriptLoadingComplete(moduleList){
for(var i=0,module;module=moduleList[i];i++){
if(module){
try{
if(module.clobbers&&module.clobbers.length){
for(var j=0;j<module.clobbers.length;j++){
modulemapper.clobbers(module.id,module.clobbers[j]);
}
}
if(module.merges&&module.merges.length){
for(var k=0;k<module.merges.length;k++){
modulemapper.merges(module.id,module.merges[k]);
}
}
if(module.runs&&!(module.clobbers&&module.clobbers.length)&&!(module.merges&&module.merges.length)){
modulemapper.runs(module.id);
}
}
catch(err){
}
}
}
finishPluginLoading();
}
function finishPluginLoading(){
channel.onPluginsReady.fire();
}
function handlePluginsObject(path,moduleList){
var scriptCounter=moduleList.length;
if(!scriptCounter){
finishPluginLoading();
return;
}
function scriptLoadedCallback(){
if(!--scriptCounter){
onScriptLoadingComplete(moduleList);
}
}
for(var i=0;i<moduleList.length;i++){
injectScript(path+moduleList[i].file,scriptLoadedCallback);
}
}
function injectPluginScript(pathPrefix){
injectScript(pathPrefix+'cordova_plugins.js',function(){
try{
var moduleList=require("cordova/plugin_list");
handlePluginsObject(pathPrefix,moduleList);
}catch(e){
finishPluginLoading();
}
},finishPluginLoading)}
function findCordovaPath(){
var path=null;
var scripts=document.getElementsByTagName('script');
var term='cordova.js';
for(var n=scripts.length-1;n>-1;n--){
var src=scripts[n].src;
if(src.indexOf(term)==(src.length-term.length)){
path=src.substring(0,src.length-term.length);
break;
}
}
return path;
}
exports.load=function(){
var pathPrefix=findCordovaPath();
if(pathPrefix===null){
console.log('Could not find cordova.js script tag. Plugin loading may fail.');
pathPrefix='';
}
injectPluginScript(pathPrefix);
};
});
define("cordova/symbols",function(require,exports,module){
var modulemapper=require('cordova/modulemapper');
modulemapper.merges('cordova','cordova');
modulemapper.clobbers('cordova/exec','cordova.exec');
modulemapper.clobbers('cordova/exec','Cordova.exec');
});
define("cordova/utils",function(require,exports,module){
var utils=exports;

utils.defineGetterSetter=function(obj,key,getFunc,opt_setFunc){
if(Object.defineProperty){
var desc={
get:getFunc,
configurable:true
};
if(opt_setFunc){
desc.set=opt_setFunc;
}
Object.defineProperty(obj,key,desc);
}else{
obj.__defineGetter__(key,getFunc);
if(opt_setFunc){
obj.__defineSetter__(key,opt_setFunc);
}
}
};

utils.defineGetter=utils.defineGetterSetter;
utils.arrayIndexOf=function(a,item){
if(a.indexOf){
return a.indexOf(item);
}
var len=a.length;
for(var i=0;i<len;++i){
if(a[i]==item){
return i;
}
}
return-1;
};

utils.arrayRemove=function(a,item){
var index=utils.arrayIndexOf(a,item);
if(index!=-1){
a.splice(index,1);
}
return index!=-1;
};
utils.typeName=function(val){
return Object.prototype.toString.call(val).slice(8,-1);
};

utils.isArray=function(a){
return utils.typeName(a)=='Array';
};

utils.isDate=function(d){
return utils.typeName(d)=='Date';
};

utils.clone=function(obj){
if(!obj||typeof obj=='function'||utils.isDate(obj)||typeof obj!='object'){
return obj;
}
var retVal,i;
if(utils.isArray(obj)){
retVal=[];
for(i=0;i<obj.length;++i){
retVal.push(utils.clone(obj[i]));
}
return retVal;
}
retVal={};
for(i in obj){
if(!(i in retVal)||retVal[i]!=obj[i]){
retVal[i]=utils.clone(obj[i]);
}
}
return retVal;
};

utils.close=function(context,func,params){
if(typeof params=='undefined'){
return function(){
return func.apply(context,arguments);
};
}else{
return function(){
return func.apply(context,params);
};
}
};

utils.createUUID=function(){
return UUIDcreatePart(4)+'-'+
UUIDcreatePart(2)+'-'+
UUIDcreatePart(2)+'-'+
UUIDcreatePart(2)+'-'+
UUIDcreatePart(6);
};

utils.extend=(function(){
var F=function(){};
return function(Child,Parent){
F.prototype=Parent.prototype;
Child.prototype=new F();
Child.__super__=Parent.prototype;
Child.prototype.constructor=Child;
};
}());

utils.alert=function(msg){
if(window.alert){
window.alert(msg);
}else if(console&&console.log){
console.log(msg);
}
};
function UUIDcreatePart(length){
var uuidpart="";
for(var i=0;i<length;i++){
var uuidchar=parseInt((Math.random()*256),10).toString(16);
if(uuidchar.length==1){
uuidchar="0"+uuidchar;
}
uuidpart+=uuidchar;
}
return uuidpart;
}
});
window.cordova=require('cordova');
(function(context){
if(context._cordovaJsLoaded){
throw new Error('cordova.js included multiple times.');
}
context._cordovaJsLoaded=true;
var channel=require('cordova/channel');
var pluginloader=require('cordova/pluginloader');
var platformInitChannelsArray=[channel.onNativeReady,channel.onPluginsReady];
function logUnfiredChannels(arr){
for(var i=0;i<arr.length;++i){
if(arr[i].state!=2){
console.log('Channel not fired: '+arr[i].type);
}
}
}
window.setTimeout(function(){
if(channel.onDeviceReady.state!=2){
console.log('deviceready has not fired after 5 seconds.');
logUnfiredChannels(platformInitChannelsArray);
logUnfiredChannels(channel.deviceReadyChannelsArray);
}
},5000);
function replaceNavigator(origNavigator){
var CordovaNavigator=function(){};
CordovaNavigator.prototype=origNavigator;
var newNavigator=new CordovaNavigator();
if(CordovaNavigator.bind){
for(var key in origNavigator){
if(typeof origNavigator[key]=='function'){
newNavigator[key]=origNavigator[key].bind(origNavigator);
}
}
}
return newNavigator;
}
if(context.navigator){
context.navigator=replaceNavigator(context.navigator);
}
if(window._nativeReady){
channel.onNativeReady.fire();
}

channel.join(function(){
require('cordova/platform').initialize();
channel.onCordovaReady.fire();
channel.join(function(){
require('cordova').fireDocumentEvent('deviceready');
},channel.deviceReadyChannelsArray);
},platformInitChannelsArray);
if(typeof XMLHttpRequest!='undefined'){
pluginloader.load();
}
}(window));
require('cordova/exec')(null,null,'PluginManager','startup',[]);
require('cordova/channel').onNativeReady.fire();
})();
;

;
var accountController=function(){
};
accountController.loginToken="";
accountController.loggedIn=false;
accountController.userName="";
accountController.userEmail="";
accountController.defaultPassword="*♥*♥*";
accountController.requestid=1;
accountController.showRegisterPopup=false;
accountController.getCookie=function(cname){
var name=cname+"=";
var ca=document.cookie.split(';');
for(var i=0;i<ca.length;i++){
var c=ca[i].trim();
if(c.indexOf(name)==0)return c.substring(name.length,c.length);
}
return"";
}
accountController.setCookie=function(cname,cvalue,exdays){
var d=new Date();
d.setTime(d.getTime()+(exdays*24*60*60*1000));
var expires="expires="+d.toGMTString();
document.cookie=cname+"="+cvalue+"; "+expires;
}
accountController.init=function(){
setTimeout(function(){
$("#popupLogin input").on("input",function(){
accountController.resetSignInData();
})
$("#popupRegister input").on("input",function(){
accountController.resetRegisterData();
})
$('#popupLogin input').keyup(function(e){
if(e.keyCode==13){
accountController.signIn();
}
});
$('#popupLogin input').keyup(function(e){
if(e.keyCode==13){
accountController.register();
}
});
},500)
$("#popupLogin").popup({
beforeposition:function(event,ui){
accountController.resetSignInData();
},
afteropen:function(event,ui){
$('#signinusername').focus();
},
afterclose:function(){
$("#signinpw").val("");
}
});
$("#popupRegister").popup({
beforeposition:function(event,ui){
accountController.resetRegisterData();
},
afteropen:function(event,ui){
$('#registerusername').focus();
},
afterclose:function(){
$("#registerpw").val("");
$("#registerpwc").val("");
}
});
setTimeout(accountController.singInAuto,1000);
}
accountController.toggleSignInRegister=function(){
accountController.showRegisterPopup=!accountController.showRegisterPopup;
if(accountController.showRegisterPopup){
$('#signintitle').html('Please Register');
$('#signinButton').html('Register');
$('#registerlink').html('Sign in');
$('#useremail').show();
$('#pwconfirm').show();
}else{
$('#signintitle').html('Sign in');
$('#signinButton').html('Sign in');
$('#registerlink').html('Register');
$('#useremail').hide();
$('#pwconfirm').hide();
}
;
$('#signinusername').focus();
}
accountController.logout=function(){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var logout=function(){
var token=rsaController.rsa.encrypt(accountController.loginToken);
$.ajax({
timeout:30000,
url:preferences.serverURL+"?logout="+token+"&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
accountController.logout();
})){
accountController.loggedIn=false;
playlistController.playlists=[playlistController.currentQueue];
uiController.showPlaylists();
$scope.safeApply();
$('#popupAccount').popup('close');

accountController.requestid=1;
console.log("FB?????"+facebookHandler.loggedIn)
if(facebookHandler.loggedIn){
facebookHandler.logout();
}
}
},
complete:function(){
accountController.setCookie("fbLogin",Base64.encode(""),0);
accountController.setCookie("loginToken",Base64.encode(""),0);
accountController.setCookie("userName",Base64.encode(""),0);
}
})
}
logout()
}
}

accountController.loadStoredData=function(){
$.mobile.loading("show");
var playlistsReady=function(playlistdata){
console.dir("PLAYLISTS:");
console.dir(playlistdata);
if(playlistdata){
var playlists=[];

if(playlistdata.items&&playlistdata.items.length>0){
console.dir("Copy received (stored) data to playlists-Array;!!!!!!!!!!!!!!!");
console.log("!!!!!!!!!!!!")
console.log(JSON.stringify(playlistController.playlists))
var changeCurrentQueue=(playlistController.currentQueue.tracks.length==0);
var currentQueueSaved=false;
for(var j=0;j<playlistdata.items.length;j++){
if(playlistdata.items[j].gid==0){
currentQueueSaved=true;
}
if(playlistdata.items[j].gid==0&&!changeCurrentQueue){
playlistdata.items.splice(j,1);
j=j-1;
}else{
playlists[j]={
name:playlistdata.items[j].name,
gid:playlistdata.items[j].gid,
tracks:playlistdata.items[j].data,
isPlaylist:true,
id:playlistdata.items[j].gid
}
console.dir("playlists["+j+"]: ");
console.dir(playlists[j]);
console.dir("-----------------");
}
}
if(!currentQueueSaved)
changeCurrentQueue=false;
if(playlists){
var tmpCounter=0;
for(var j=0;j<playlists.length;j++){
if(playlists[j].gid==playlistController.currentQueue.gid){
tmpCounter++;
if(tmpCounter>1){
playlists.splice(j,1);
j--;
}
}
}
if(playlistController.playlists.length>0){
for(var i=0;i<playlistController.playlists.length;i++){
playlistController.playlists[i].new=true;
if(playlistController.playlists[i].gid==playlistController.currentQueue.gid&&changeCurrentQueue){
playlistController.playlists.splice(i,1);
i=i-1;
}
else{
for(var j=0;j<playlists.length;j++){
console.log(i+" - "+j+"     "+playlistController.playlists.length+" :  "+playlists[j].gid+" == "+playlistController.playlists[i].gid)
if(playlists[j].gid==playlistController.playlists[i].gid){
playlistController.playlists.splice(i,1);
i=i-1;
break;
}
else if(playlists[j].name==playlistController.playlists[i].name){
var countSame=1;
var oldName=playlistController.playlists[i].name;
do{
var foundSame=false;
playlistController.playlists[i].name=oldName+" #"+(countSame+1);
for(var k=0;k<playlists.length;k++){
if(playlists[k].name==playlistController.playlists[i].name){
foundSame=true;
break;
}
}
countSame++;
}while(foundSame)
}
}
}
}
}
console.log("!!!!!!!!!!!")
console.log(JSON.stringify(playlistController.playlists))
playlistController.playlists=playlistController.playlists.concat(playlists);
console.log("......")
console.log(JSON.stringify(playlistController.playlists))
if(playlistController.playlists.length>0){
for(var i=0;i<playlistController.playlists.length;i++){
if(changeCurrentQueue&&playlistController.playlists[i].gid==0){
playlistController.currentQueue=playlistController.playlists[i];
playlistController.playlists[i].isCurrentQueue=true;
}
if(playlistController.playlists[i].new||(playlistController.playlists[i].gid==playlistController.currentQueue.gid&&changeCurrentQueue)){
delete playlistController.playlists[i].new;
accountController.savePlaylist(playlistController.playlists[i].gid,playlistController.playlists[i].name,playlistController.playlists[i].tracks);
}
}
accountController.savePlaylistsPosition();
playbackController.updatePlayingSongIndex();
}

console.dir("User playlists: ");
console.dir(playlistController.playlists);
$scope.safeApply();
$("#playlistview").listview('refresh');
$("#playlistInner .songlist").addClass("avoidhiding");
uiController.showPlaylists();
setTimeout(function(){
playlistController.makePlayListSortable();
setTimeout(function(){
uiController.playListScroll.refresh();
},150)
setTimeout(function(){
uiController.playListScroll.refresh();
},1000)
},0)
setTimeout(function(){
if($(":focus").length==0)
$('#searchinput').focus();
},500)
setTimeout(function(){
$.mobile.loading("hide");
},1000);
}else{
$scope.safeApply();
$.mobile.loading("hide");
}
}else{
$scope.safeApply();
$.mobile.loading("hide");
}
}else{
$scope.safeApply();
$.mobile.loading("hide");
}
}
accountController.loadPlaylists(playlistsReady)
}

accountController.singInAuto=function(){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var fbLogin=accountController.getCookie("fbLogin");
var socialAutoLogin=(fbLogin&&Base64.decode(fbLogin)=="true");
if(!socialAutoLogin){
var loginTokenBase64=accountController.getCookie("loginToken");
var userNameBase64=accountController.getCookie("userName");
var emailBase64=accountController.getCookie("userEmail");
if(loginTokenBase64!=""&&userNameBase64!=""){
var token=rsaController.rsa.encrypt(Base64.decode(loginTokenBase64));
$.ajax({
timeout:30000,
url:preferences.serverURL+"?loginToken="+token+"&auth="+authController.ip_token,
success:function(data){
$.mobile.loading("hide");
if(authController.ensureAuthenticated(data,function(){
accountController.singInAuto();
})){
if(data=="ok"){
mediaController.showChooseVersionHint=false;
$.mobile.loading("show");
accountController.loggedIn=true;
accountController.loginToken=Base64.decode(loginTokenBase64);
accountController.setUserData(Base64.decode(userNameBase64),Base64.decode(emailBase64));
accountController.requestid=1;
setTimeout(function(){
$("#popupLogin").popup("close");
$("#popupRegister").popup("close");
$(".ui-popup-screen.in").click();
setTimeout(function(){
$(".ui-popup-screen.in:visible").click();
setTimeout(function(){
$(".ui-popup-screen.in:visible").click();
},500);
},500);
},500);
accountController.loadStoredData();
}else{
accountController.setCookie("loginToken",Base64.encode(accountController.loginToken),1);
accountController.setCookie("userName",Base64.encode(accountController.userName),1);
accountController.setCookie("userEmail",Base64.encode(accountController.userEmail),1);
}
}
},
error:function(){
$.mobile.loading("hide");
}
})
}
}
}
else{
setTimeout(accountController.singInAuto,1000);
}
}

accountController.openEditAccountPopup=function(){
$.mobile.loading("show");
$("#popupAccount").popup("close");
setTimeout(function(){
$.mobile.loading("hide");
accountController.resetEditAccountData();
$("#editusername").val(accountController.userName);
$("#editemail").val(accountController.userEmail);
$("#editpw").val(accountController.defaultPassword);
$("#editpwc").val(accountController.defaultPassword);
$("#popupEditAccount").popup("open",{transition:'pop'});
},900);
}

accountController.saveAccount=function(){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var send=function(nameEncrypted,oldNameEncrypted,emailEncrypted,pwEncrypted){
var data="?editaccount="+oldNameEncrypted+"&name="+nameEncrypted+"&email="+emailEncrypted+"&auth="+authController.ip_token;
if(pwEncrypted){
data=data+"&pw="+pwEncrypted
}
$.ajax({
timeout:30000,
url:preferences.serverURL+data,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
send(nameEncrypted,emailEncrypted,pwEncrypted);
})){
if(data=="userexists"){
$("#editusername").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#editusernamealreadyexists").show();
}
else{
if(data!=""){
if(data=="ok"){
accountController.userName=newusername;
accountController.userEmail=newemail;
$scope.safeApply();
$("#popupEditAccount").popup("close");
}
}
else{
$("#editusername").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#editpw").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#editpwc").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#editemail").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
}
}
},
error:function(){
uiController.toast("Sorry, it is not possible to edit your account at the moment",1500);
},complete:function(){
$.mobile.loading("hide");
}
})
}
var username=$("#editusername").val();
var oldusername=accountController.userName;
var email=$("#editemail").val();
var pw=$("#editpw").val();
if($.trim(pw)==accountController.defaultPassword){
pw=false;
}
if(accountController.validateEditAccountData()){
$.mobile.loading("show");
if(pw)
var pwEncrypted=rsaController.rsa.encrypt(pw);
else
pwEncrypted=false;
var newusername=username;
var newemail=email;
send(rsaController.rsa.encrypt(username),rsaController.rsa.encrypt(oldusername),rsaController.rsa.encrypt(email),pwEncrypted);
}
}
}

accountController.resetEditAccountData=function(){
$("#editusername").css("background-color","").css("color","");
$("#editemail").css("background-color","").css("color","");
$("#editpw").css("background-color","").css("color","");
$("#editpwc").css("background-color","").css("color","");
$("#editusernamealreadyexists").hide();
}

accountController.validateEditAccountData=function(){
var failed=false;
var username=$("#editusername").val();
var email=$("#editemail").val();
var pw=$("#editpw").val();
var pwc=$("#editpwc").val();
if(pw.length<1||pw.length>64){
failed=true;
$("#editpw").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#editpwc").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
if(pw!=pwc){
failed=true;
$("#editpwc").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
if(!accountController.validateEmail(email)||email.length<=5){
failed=true;
$("#editemail").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
if(username.length<1){
failed=true;
$("#editusername").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
return!failed;
}

accountController.setUserData=function(userName,userEmail){
accountController.userName=userName;
accountController.userEmail=userEmail;
}

accountController.singInBase=function(name,pw,nameEncrypted,emailEncrypted,pwEncrypted,useridEncrypted,externalAccountIdentifier){
$.ajax({
timeout:30000,
url:preferences.serverURL+"?login="+nameEncrypted+"&email="+emailEncrypted+"&pw="+pwEncrypted+"&userid="+useridEncrypted+"&auth="+authController.ip_token+"&extacc="+externalAccountIdentifier,
success:function(data){
console.dir("LOGIN DATA:")
console.dir(data)
if(data.match&&data.match("error:")){
$("#signinpw").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#signinusername").css("background-color","rgb(111, 0, 0)").css("color","#fff");
setTimeout(function(){
$.mobile.loading("hide");
},800);
}
else
{
if(data){
var usertoken=data.token;
accountController.userEmail=data.email;
if(authController.ensureAuthenticated(usertoken,function(){
accountController.singInBase(name,pw,nameEncrypted,emailEncrypted,pwEncrypted,useridEncrypted,externalAccountIdentifier);
})){
if(usertoken!=""&&usertoken){
if(externalAccountIdentifier==1){
accountController.setCookie("fbLogin",Base64.encode("true"),1);
facebookHandler.loggedIn=true;
}
console.log("LOGIN!!!!! "+externalAccountIdentifier+"   "+accountController.loggedIn)
if(pw!=""&&pw.length<100){
var md5pw=MD5($.trim(pw));
}
else{
var md5pw="";
}
if(!accountController.loggedIn){
accountController.loggedIn=true;
accountController.loginToken=MD5(usertoken+md5pw);
accountController.userName=name;
accountController.setCookie("loginToken",Base64.encode(accountController.loginToken),1);
accountController.setCookie("userName",Base64.encode(accountController.userName),1);
accountController.setCookie("userEmail",Base64.encode(accountController.userEmail),1);
accountController.loadStoredData();
}
accountController.requestid=1;
$("#popupLogin").popup("close");
$("#popupRegister").popup("close");
$(".ui-popup-screen.in").click();
setTimeout(function(){
$("#signinpw").val("");
$("#signinusername").val("");
var btn=$('#header .ui-btn.animated').removeClass("animated");
setTimeout(function(){
btn.addClass("animated");
},500)
},500)
}
else{
$("#signinpw").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#signinusername").css("background-color","rgb(111, 0, 0)").css("color","#fff");
setTimeout(function(){
$.mobile.loading("hide");
},800);
}
}
}
}
},
error:function(a,b,c){
console.dir(a)
console.dir(b)
console.dir(c)
uiController.toast("Sorry, it is not possible to login at the moment.",1500);
if(facebookHandler.loggedIn){
facebookHandler.logout();
}
setTimeout(function(){
$.mobile.loading("hide");
},800);
}
})
}
accountController.signIn=function(){
accountController.resetSignInData();
if(authController.ip_token!="auth"&&authController.ip_token!=""){
$.mobile.loading("show");
var username=$("#signinusername").val();
if(accountController.validateEmail(username)){
var email=username;
username="";
}else
email="";
var pw=$("#signinpw").val();
if(accountController.validateSignInData())
accountController.singInBase(username,pw,rsaController.rsa.encrypt(username),rsaController.rsa.encrypt(email),rsaController.rsa.encrypt(pw),null,0);
}
}

accountController.socialSignIn=function(username,email,userid,externalAccountIdentifier,access_token){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
$.mobile.loading("show");
accountController.singInBase(username,access_token,rsaController.rsa.encrypt(username),rsaController.rsa.encrypt(email),rsaController.rsa.encryptUnlimited(access_token),rsaController.rsa.encrypt(userid),externalAccountIdentifier);
}else{
$.mobile.loading("hide");
if(externalAccountIdentifier==1){
facebookHandler.logout();
}
}
}
accountController.resetSignInData=function(){
$("#signinusername").css("background-color","").css("color","");
$("#signinpw").css("background-color","").css("color","");
}
accountController.validateSignInData=function(){
var failed=false;
var username=$("#signinusername").val();
var pw=$("#signinpw").val();
if(pw.length<1){
failed=true;
$("#signinpw").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
if(username.length<1){
failed=true;
$("#signinusername").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
return!failed;
}
accountController.debugData=function(data){
console.dir("DATA:");
console.dir(data);
}
accountController.register=function(){
accountController.resetRegisterData();
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var send=function(name,pw,nameEncrypted,emailEncrypted,pwEncrypted){
$.ajax({
timeout:30000,
url:preferences.serverURL+"?register="+nameEncrypted+"&email="+emailEncrypted+"&pw="+pwEncrypted+"&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
send(name,pw,nameEncrypted,emailEncrypted,pwEncrypted);
})){
if(data=="error: 2"){
$("#registerusername").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#registerusernamealreadyexists").show();
$.mobile.loading("hide");
}
else{
if(data.match&&data.match("error:"))
{
data="";
}
if(data!=""){
accountController.loggedIn=true;
var md5pw=MD5($.trim(pw));
accountController.loginToken=MD5(data+md5pw);
accountController.setUserData(name,email);
accountController.setCookie("loginToken",Base64.encode(accountController.loginToken),1);
accountController.setCookie("userName",Base64.encode(accountController.userName),1);
accountController.setCookie("userEmail",Base64.encode(email),1);
for(var i=0;i<playlistController.playlists.length;i++){
accountController.savePlaylist(playlistController.playlists[i].gid,playlistController.playlists[i].name,playlistController.playlists[i].tracks);
}
accountController.savePlaylistsPosition();
accountController.requestid=1;
$("#popupRegister").popup("close");
$(".ui-popup-screen.in").click();
$scope.safeApply();setTimeout(function(){
$("#registerpw").val("");
$("#registerpwc").val("");
$("#registeruser").val("");
$("#registerusername").val("");
var btn=$('#header .ui-btn.animated').removeClass("animated");
setTimeout(function(){
btn.addClass("animated");
},500)
},500)
}
else{
$("#registerpw").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#registerpwc").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#registeruser").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#registerusername").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
}
}
},
error:function(){
uiController.toast("Sorry, it is not possible to register at the moment.",1500);
},complete:function(){
$.mobile.loading("hide");
}
})
}
var username=$("#registerusername").val();
var email=$("#registeruser").val();
var pw=$("#registerpw").val();
if(accountController.validateRegisterData()){
$.mobile.loading("show");
send(username,pw,rsaController.rsa.encrypt(username),rsaController.rsa.encrypt(email),rsaController.rsa.encrypt(pw));
}
}
}
accountController.validateEmail=function(email){
var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
return re.test(email);
}
accountController.resetRegisterData=function(){
$("#registerpw").css("background-color","").css("color","");
$("#registerpwc").css("background-color","").css("color","");
$("#registeruser").css("background-color","").css("color","");
$("#registerusername").css("background-color","").css("color","");
$("#registerusernamealreadyexists").hide();
}
accountController.validateRegisterData=function(){
var failed=false;
var username=$("#registerusername").val();
var email=$("#registeruser").val();
var pw=$("#registerpw").val();
var pwc=$("#registerpwc").val();
if(pw.length<1||pw.length>64||$.trim(pw)==accountController.defaultPassword){
failed=true;
$("#registerpw").css("background-color","rgb(111, 0, 0)").css("color","#fff");
$("#registerpwc").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
if(pw!=pwc){
failed=true;
$("#registerpwc").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
if(!accountController.validateEmail(email)||email.length<=5){
failed=true;
$("#registeruser").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
if(username.length<1){
failed=true;
$("#registerusername").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}
return!failed;
}

accountController.deletePlaylist=function(gid){
if(accountController.loggedIn){
if(gid){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
accountController.requestid=accountController.requestid+1;
var nonce=accountController.requestid;
var savetoken=rsaController.rsa.encrypt(accountController.loginToken+nonce);
var send=function(savetoken){
var postData={deleteplaylist:savetoken,auth:authController.ip_token,gid:gid,n:nonce};
$.ajax({
type:"POST",
data:postData,
timeout:30000,
url:preferences.serverURL,
success:function(data){
authController.ensureAuthenticated(data,function(){
send(savetoken);
})
}
})
}
send(savetoken);
}
}
}
}

accountController.savePlaylistsPosition=function(){
if(accountController.loggedIn){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
accountController.requestid=accountController.requestid+1;
var nonce=accountController.requestid;
var savetoken=rsaController.rsa.encrypt(accountController.loginToken+nonce);
var postData={updateplaylistpositions:savetoken,auth:authController.ip_token,n:nonce};
var j=0;
for(var i=0;i<playlistController.playlists.length;i++){
if(playlistController.playlists[i].gid!=playlistController.similarSongs.gid){
postData["gid"+(j+1)]=playlistController.playlists[i].gid
j++;
}
}
var send=function(){
$.ajax({
type:"POST",
data:postData,
timeout:30000,
url:preferences.serverURL,
success:function(data){
authController.ensureAuthenticated(data,function(){
send();
})
}
})
}
send();
}
}
}

accountController.savePlaylist=function(gid,name,tracks){
if(accountController.loggedIn){
if(gid&&gid!=playlistController.similarSongs.gid){
var playlistdata=JSON.stringify(tracks)
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var savename=escape(name);
var savedata=escape(playlistdata);
accountController.requestid=accountController.requestid+1;
var nonce=accountController.requestid;
var savetoken=rsaController.rsa.encrypt(accountController.loginToken+nonce);
var send=function(savename,savedata,savetoken){
var postData={updateplaylist:savetoken,auth:authController.ip_token,gid:gid,n:nonce};
if(savename!=undefined&&savename!=null&&savename!=false)
postData.name=savename;
if(savedata!=undefined&&savedata!=null&&savedata!=false)
postData.tracks=savedata;
$.ajax({
type:"POST",
data:postData,
timeout:30000,
url:preferences.serverURL,
success:function(data){
authController.ensureAuthenticated(data,function(){
send(savename,savedata,savetoken);
})
}
})
}
send(savename,savedata,savetoken);
}
}
}
}
accountController.loadPlaylist=function(name,callbackSuccess){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
if(accountController.loggedIn){
var savename=encodeURIComponent(name);
accountController.requestid=accountController.requestid+1;
var nonce=accountController.requestid;
var savetoken=rsaController.rsa.encrypt(accountController.loginToken+nonce);
var send=function(savename,savetoken){
name=encodeURIComponent(name);
$.ajax({
timeout:30000,
url:preferences.serverURL+"?getdata="+savetoken+"&n="+nonce+"&type=playlist&name="+savename+"&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
send(savename,savetoken);
})){
if(callbackSuccess)
callbackSuccess(data);
}
},
error:function(xhr,ajaxOptions,thrownError){
if(callbackSuccess)
callbackSuccess(xhr.responseText);
}
})
}
send(savename,savetoken);
}
}
}

accountController.loadPlaylists=function(callbackSuccess){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
if(accountController.loggedIn){
accountController.requestid=accountController.requestid+1;
var nonce=accountController.requestid;
var savetoken=rsaController.rsa.encrypt(accountController.loginToken+nonce);
var send=function(savetoken){
$.ajax({
timeout:30000,
url:preferences.serverURL+"?getdatalist="+savetoken+"&n="+nonce+"&type=playlist&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
send(savetoken)
})){
if(callbackSuccess)
callbackSuccess(data);
}
},
error:function(xhr,ajaxOptions,thrownError){

console.log("------------------------")
console.dir(ajaxOptions)
console.dir(thrownError)
console.dir(xhr)
console.dir("xhr.responseText");
console.dir(xhr.responseText);
if(callbackSuccess)
callbackSuccess(xhr.responseText);
}
})
}
send(savetoken);
}
}
}
accountController.saveUserData=function(type,name,userdata){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
if(accountController.loggedIn){
var savename=encodeURIComponent(name);
var savetype=encodeURIComponent(type);
var savedata=encodeURIComponent(userdata);
accountController.requestid=accountController.requestid+1;
var nonce=accountController.requestid;
var savetoken=rsaController.rsa.encrypt(accountController.loginToken+nonce);
var send=function(savename,savetype,savedata,savetoken){
$.ajax({
type:"POST",
data:{auth:authController.ip_token,storage:savetoken,gid:gid,pos:pos,n:nonce,type:savetype,name:savename,data:savedata},
timeout:30000,
url:preferences.serverURL,success:function(data){
authController.ensureAuthenticated(data,function(){
send(savename,savetype,savedata,savetoken);
})
}
})
}
send(savename,savetype,savedata,savetoken);
}
}
}
accountController.loadUserData=function(type,name,callbackSuccess){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
if(accountController.loggedIn){
var savename=encodeURIComponent(name);
var savetype=encodeURIComponent(type);
accountController.requestid=accountController.requestid+1;
var nonce=accountController.requestid;
var savetoken=rsaController.rsa.encrypt(accountController.loginToken+nonce);
var send=function(savename,savetype,savedata,savetoken){
$.ajax({
timeout:30000,
url:preferences.serverURL+"?getdata="+savetoken+"&n="+nonce+"&type="+savetype+"&name="+savename+"&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
send(savename,savetype,savedata,savetoken);
})){
if(callbackSuccess)
callbackSuccess(data);
}
},
error:function(xhr,ajaxOptions,thrownError){
console.dir(JSON.parse(xhr.responseText));
}
})
}
send(savename,savetype,savedata,savetoken);
}
}
}
accountController.loadUserDataItems=function(type,callbackSuccess){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
if(accountController.loggedIn){
var savename=encodeURIComponent(name);
var savetype=encodeURIComponent(type);
accountController.requestid=accountController.requestid+1;
var nonce=accountController.requestid;
var savetoken=rsaController.rsa.encrypt(accountController.loginToken+nonce);
var send=function(savename,savetype,savedata,savetoken){
$.ajax({
timeout:30000,
url:preferences.serverURL+"?getdatalist="+savetoken+"&n="+nonce+"&type="+savetype+"&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
send(savename,savetype,savedata,savetoken);
})){
if(callbackSuccess)
callbackSuccess(data);
}
},
error:function(xhr,ajaxOptions,thrownError){
console.dir(JSON.parse(xhr.responseText));
}
})
}
send(savename,savetype,savedata,savetoken);
}
}
}

;

;
var authController=function(){
};
authController.init=function(){
authController.getToken();
}
authController.ip_token="auth";
authController.clientip="";
authController.extractToken=function(token){
if(token=="init"){
authController.getToken();
}
else if(token=="wait"){
setTimeout(function(){
authController.getToken();
},10000);
}
else if(token=="down"){
uiController.toast("Sorry, the Songbase.fm server is not available at the moment!",1500);
}
else if(token!=""){
mediaController.ip_token="auth";
try{
eval(Base64.decode(token));
authController.clientip=mediaController.ipaddress;
if(authController.clientip==""){
mediaController.ip_token="";
}
if(mediaController.ip_token==""){
uiController.toast("Sorry, the Songbase.fm server is not available at the moment!",1500);
}
authController.ip_token=mediaController.ip_token;
}catch(e){
uiController.toast("Sorry, the Songbase.fm server is not available at the moment!",1500);
}
}
}
authController.getToken=function(){
$.ajax({
url:preferences.serverURL+"init.js?nocache="+Date.now(),
success:function(data){
console.dir("TOKEN:");
console.dir(data);
if(data.auth&&data.auth=="true"){
authController.extractToken(data.token);
}
else{
uiController.toast("Sorry, the Songbase.fm server is not available at the moment!",1500);
setTimeout(function(){
authController.getToken();
},15000);
}
},
error:function(xhr,ajaxOptions,thrownError){
uiController.toast("Sorry, the Songbase.fm server is not available at the moment!",1500);
setTimeout(function(){
authController.getToken();
},30000);
}
})
}

authController.ensureAuthenticated=function(data,ajaxFunction){
if(data){
if(data.auth){
if(data.auth=="true"){
authController.extractToken(data.token);
if(ajaxFunction)
ajaxFunction()
return false;
}
else
return false;
}
else
return true;
}
return true;
}
var rsaController=function(){
};
rsaController.n="a0bb4bfeb95482f621562fa9f946528febc4a23f4aabbc029b4459ca68972ec2ca9e1341ab3282fc7bacabfc0fc48aeb18fe5c964563fdd0116afdd6cb24255158fbf48b2447864303cc18ee0a65b0ee6e660d8ad021d010bb27bccdb19140ee80d0b2a3883d62ca2943a64a02665a1c23e5c786081f6fdfe01b43aee80d917d";
rsaController.e="3";
rsaController.rsa=new RSAKey();
rsaController.rsa.setPublic(rsaController.n,rsaController.e);
rsaController.rsa.encryptUnlimited=function(text){
var maxLength=110;
var rsaTextComplete=""
for(var i=0;i<Math.ceil(text.length/maxLength);i++){
var actText=text.slice(i*maxLength,(i+1)*maxLength)
var rsaText=rsaController.rsa.encrypt(actText)
rsaTextComplete=rsaTextComplete+rsaText;
}
return rsaTextComplete;
}

;

;
var dailymotionPlayer=function(){
};
dailymotionPlayer.player=null;
dailymotionPlayer.active=0;
dailymotionPlayer.dailymotion=0;
dailymotionPlayer.dailymotionVideoID="";
dailymotionPlayer.bufferedTime=0;
dailymotionPlayer.duration=0;
dailymotionPlayer.currentTime=0;
dailymotionPlayer.apiready=false;
window.dmAsyncInit=function()
{
}

function getDailyMotionId(url){
var m=url.match(/^.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/);
if(m!==null){
if(m[4]!==undefined){
return m[4];
}
return m[2];
}
return null;
}

dailymotionPlayer.init=function(){
};

dailymotionPlayer.setProgressPercentage=function(percentage){
videoController.setProgressPercentage(percentage)
}
dailymotionPlayer.eventListener=function(){};
dailymotionPlayer.eventListener.apiready=function(e)
{
if(dailymotionPlayer.player){
if(e.target.src.search(dailymotionPlayer.dailymotionVideoID)>-1){
$(".mejs-time-buffering").hide();
$("#dailymotionembedplayer").show();
$("#dailymotionplayer").show();
dailymotionPlayer.apiready=true;
dailymotionPlayer.firstplay=true;
if(dailymotionPlayer.startplay){
dailymotionPlayer.play()
}
else if(dailymotionPlayer.startpause){
videoController.playingSong();
dailymotionPlayer.firstplay=false;
}
dailymotionPlayer.startpause=false;
dailymotionPlayer.startplay=false;
}
}
}
dailymotionPlayer.eventListener.error=function(e)
{
if(dailymotionPlayer.player){
dailymotionPlayer.error();
}
}
dailymotionPlayer.eventListener.play=function(e)
{
if(dailymotionPlayer.player&&dailymotionPlayer.firstplay){
videoController.playingSong();
dailymotionPlayer.firstplay=false;
}
}
dailymotionPlayer.eventListener.canplaythrough=function(e)
{

}
dailymotionPlayer.eventListener.durationchange=function(e)
{
if(dailymotionPlayer.player){
dailymotionPlayer.duration=e.target.duration;
videoController.setMaxTime(dailymotionPlayer.duration);
}
}
dailymotionPlayer.eventListener.timeupdate=function(e)
{
if(dailymotionPlayer.player){
dailymotionPlayer.currentTime=e.target.currentTime;
videoController.setProgressTime(dailymotionPlayer.currentTime);
}
}
dailymotionPlayer.eventListener.progress=function(e)
{
if(dailymotionPlayer.player){
if(e.target.src.search(dailymotionPlayer.dailymotionVideoID)>-1){
dailymotionPlayer.bufferedTime=e.target.bufferedTime;
if(dailymotionPlayer.duration>0){
videoController.setBufferedPercentage(dailymotionPlayer.bufferedTime/dailymotionPlayer.duration);
}
}
}
}
dailymotionPlayer.eventListener.ended=function(e)
{
if(dailymotionPlayer.player){
if(e.target.src.search(dailymotionPlayer.dailymotionVideoID)>-1){
dailymotionPlayer.mediaEnded();
videoController.endedSong();
}
}
}

dailymotionPlayer.load=function(url){
console.dir("LOAD: "+url);
dailymotionPlayer.active=1;
dailymotionPlayer.bufferedTime=0;
dailymotionPlayer.duration=0;
dailymotionPlayer.currentTime=0;
dailymotionPlayer.apiready=false;
var videoid=getDailyMotionId(url);
console.dir("VideoID: "+videoid);
if(videoid){
$("#dailymotionplayer").addClass("iframeVideo").appendTo("#backgroundVideo");
dailymotionPlayer.dailymotionVideoID=videoid;
var PARAMS={background:'ABE866',autoplay:0,chromeless:1,
foreground:'000000',related:0,quality:720,
html:1,highlight:'857580',
info:1,network:'dsl',autoplay:0};
dailymotionPlayer.player=DM.player("dailymotionplayer",{video:videoid,width:"100%",height:"100%",params:PARAMS});
console.dir(dailymotionPlayer.player);
dailymotionPlayer.player.addEventListener("error",dailymotionPlayer.eventListener.error);
dailymotionPlayer.player.addEventListener("apiready",dailymotionPlayer.eventListener.apiready);
dailymotionPlayer.player.addEventListener("canplaythrough",dailymotionPlayer.eventListener.canplaythrough);
dailymotionPlayer.player.addEventListener("durationchange",dailymotionPlayer.eventListener.durationchange);
dailymotionPlayer.player.addEventListener("timeupdate",dailymotionPlayer.eventListener.timeupdate);
dailymotionPlayer.player.addEventListener("progress",dailymotionPlayer.eventListener.progress);
dailymotionPlayer.player.addEventListener("ended",dailymotionPlayer.eventListener.ended);
dailymotionPlayer.player.addEventListener("play",dailymotionPlayer.eventListener.play);
}
};

dailymotionPlayer.unload=function(){
console.dir("UNLOAD! ");
dailymotionPlayer.dailymotionVideoID="null";
dailymotionPlayer.stop();
dailymotionPlayer.active=0;
$("#dailymotionplayer").hide();
if(dailymotionPlayer.player){
dailymotionPlayer.player.removeEventListener("apiready",dailymotionPlayer.eventListener.apiready);
dailymotionPlayer.player.removeEventListener("canplaythrough",dailymotionPlayer.eventListener.canplaythrough);
dailymotionPlayer.player.removeEventListener("durationchange",dailymotionPlayer.eventListener.durationchange);
dailymotionPlayer.player.removeEventListener("timeupdate",dailymotionPlayer.eventListener.timeupdate);
dailymotionPlayer.player.removeEventListener("progress",dailymotionPlayer.eventListener.progress);
dailymotionPlayer.player.removeEventListener("ended",dailymotionPlayer.eventListener.ended);
dailymotionPlayer.player.removeEventListener("error",dailymotionPlayer.eventListener.error);
dailymotionPlayer.player.removeEventListener("play",dailymotionPlayer.eventListener.play);
}
dailymotionPlayer.apiready=false;
delete dailymotionPlayer.player;
dailymotionPlayer.player=null;
$("#dailymotionplayer").remove();
$("#dailymotionembedplayer").append('<div id="dailymotionplayer" ></div>');
};
dailymotionPlayer.setVolume=function(volume){
if(dailymotionPlayer.player&&dailymotionPlayer.apiready){
dailymotionPlayer.player.setVolume(volume);
}
}
dailymotionPlayer.play=function(){
if(dailymotionPlayer.player){
if(dailymotionPlayer.apiready){
dailymotionPlayer.player.play();
dailymotionPlayer.setVolume(videoController.volume);
}
else{
dailymotionPlayer.startplay=true;
dailymotionPlayer.startpause=false;
}
console.dir("PLAY: "+dailymotionPlayer.dailymotionVideoID);
}
}
dailymotionPlayer.pause=function(){
if(dailymotionPlayer.player){
if(dailymotionPlayer.apiready)
dailymotionPlayer.player.pause();
else{
dailymotionPlayer.startplay=false;
dailymotionPlayer.startpause=true;
}
console.dir("PAUSE: "+dailymotionPlayer.dailymotionVideoID);
}
}
dailymotionPlayer.stop=function(){
if(dailymotionPlayer.player&&dailymotionPlayer.apiready){
dailymotionPlayer.player.pause();
dailymotionPlayer.player.seek(0);
}
}
dailymotionPlayer.setProgressPercentage=function(percentage){
if(dailymotionPlayer.player&&dailymotionPlayer.apiready){
dailymotionPlayer.player.seek(percentage*dailymotionPlayer.duration);
}
}
dailymotionPlayer.mediaEnded=function(){
videoController.endedSong();
mediaController.mediaEnded();
}
dailymotionPlayer.error=function(){
if(dailymotionPlayer.active==1){
mediaController.PlayingSongError();
}
}

;

;
var Base64={
_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
encode:function(input){
if(!input)
return input;
var output="";
var chr1,chr2,chr3,enc1,enc2,enc3,enc4;
var i=0;
input=Base64._utf8_encode(input);
while(i<input.length){
chr1=input.charCodeAt(i++);
chr2=input.charCodeAt(i++);
chr3=input.charCodeAt(i++);
enc1=chr1>>2;
enc2=((chr1&3)<<4)|(chr2>>4);
enc3=((chr2&15)<<2)|(chr3>>6);
enc4=chr3&63;
if(isNaN(chr2)){
enc3=enc4=64;
}else if(isNaN(chr3)){
enc4=64;
}
output=output+
this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+
this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4);
}
return output;
},
decode:function(input){
if(!input)
return input;
var output="";
var chr1,chr2,chr3;
var enc1,enc2,enc3,enc4;
var i=0;
input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");
while(i<input.length){
enc1=this._keyStr.indexOf(input.charAt(i++));
enc2=this._keyStr.indexOf(input.charAt(i++));
enc3=this._keyStr.indexOf(input.charAt(i++));
enc4=this._keyStr.indexOf(input.charAt(i++));
chr1=(enc1<<2)|(enc2>>4);
chr2=((enc2&15)<<4)|(enc3>>2);
chr3=((enc3&3)<<6)|enc4;
output=output+String.fromCharCode(chr1);
if(enc3!=64){
output=output+String.fromCharCode(chr2);
}
if(enc4!=64){
output=output+String.fromCharCode(chr3);
}
}
output=Base64._utf8_decode(output);
return output;
},
_utf8_encode:function(string){
if(!string)
return string;
string=string.replace(/\r\n/g,"\n");
var utftext="";
for(var n=0;n<string.length;n++){
var c=string.charCodeAt(n);
if(c<128){
utftext+=String.fromCharCode(c);
}
else if((c>127)&&(c<2048)){
utftext+=String.fromCharCode((c>>6)|192);
utftext+=String.fromCharCode((c&63)|128);
}
else{
utftext+=String.fromCharCode((c>>12)|224);
utftext+=String.fromCharCode(((c>>6)&63)|128);
utftext+=String.fromCharCode((c&63)|128);
}
}
return utftext;
},
_utf8_decode:function(utftext){
if(!utftext)
return utftext;
var string="";
var i=0;
var c=c1=c2=0;
while(i<utftext.length){
c=utftext.charCodeAt(i);
if(c<128){
string+=String.fromCharCode(c);
i++;
}
else if((c>191)&&(c<224)){
c2=utftext.charCodeAt(i+1);
string+=String.fromCharCode(((c&31)<<6)|(c2&63));
i+=2;
}
else{
c2=utftext.charCodeAt(i+1);
c3=utftext.charCodeAt(i+2);
string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));
i+=3;
}
}
return string;
}
}
var MD5=function(string){
if(!string)
return string;
function RotateLeft(lValue,iShiftBits){
return(lValue<<iShiftBits)|(lValue>>>(32-iShiftBits));
}
function AddUnsigned(lX,lY){
var lX4,lY4,lX8,lY8,lResult;
lX8=(lX&0x80000000);
lY8=(lY&0x80000000);
lX4=(lX&0x40000000);
lY4=(lY&0x40000000);
lResult=(lX&0x3FFFFFFF)+(lY&0x3FFFFFFF);
if(lX4&lY4){
return(lResult^0x80000000^lX8^lY8);
}
if(lX4|lY4){
if(lResult&0x40000000){
return(lResult^0xC0000000^lX8^lY8);
}else{
return(lResult^0x40000000^lX8^lY8);
}
}else{
return(lResult^lX8^lY8);
}
}
function F(x,y,z){return(x&y)|((~x)&z)}
function G(x,y,z){return(x&z)|(y&(~z))}
function H(x,y,z){return(x^y^z)}
function I(x,y,z){return(y^(x|(~z)))}
function FF(a,b,c,d,x,s,ac){
a=AddUnsigned(a,AddUnsigned(AddUnsigned(F(b,c,d),x),ac));
return AddUnsigned(RotateLeft(a,s),b);
};
function GG(a,b,c,d,x,s,ac){
a=AddUnsigned(a,AddUnsigned(AddUnsigned(G(b,c,d),x),ac));
return AddUnsigned(RotateLeft(a,s),b);
};
function HH(a,b,c,d,x,s,ac){
a=AddUnsigned(a,AddUnsigned(AddUnsigned(H(b,c,d),x),ac));
return AddUnsigned(RotateLeft(a,s),b);
};
function II(a,b,c,d,x,s,ac){
a=AddUnsigned(a,AddUnsigned(AddUnsigned(I(b,c,d),x),ac));
return AddUnsigned(RotateLeft(a,s),b);
};
function ConvertToWordArray(string){
var lWordCount;
var lMessageLength=string.length;
var lNumberOfWords_temp1=lMessageLength+8;
var lNumberOfWords_temp2=(lNumberOfWords_temp1-(lNumberOfWords_temp1%64))/64;
var lNumberOfWords=(lNumberOfWords_temp2+1)*16;
var lWordArray=Array(lNumberOfWords-1);
var lBytePosition=0;
var lByteCount=0;
while(lByteCount<lMessageLength){
lWordCount=(lByteCount-(lByteCount%4))/4;
lBytePosition=(lByteCount%4)*8;
lWordArray[lWordCount]=(lWordArray[lWordCount]|(string.charCodeAt(lByteCount)<<lBytePosition));
lByteCount++;
}
lWordCount=(lByteCount-(lByteCount%4))/4;
lBytePosition=(lByteCount%4)*8;
lWordArray[lWordCount]=lWordArray[lWordCount]|(0x80<<lBytePosition);
lWordArray[lNumberOfWords-2]=lMessageLength<<3;
lWordArray[lNumberOfWords-1]=lMessageLength>>>29;
return lWordArray;
};
function WordToHex(lValue){
var WordToHexValue="",WordToHexValue_temp="",lByte,lCount;
for(lCount=0;lCount<=3;lCount++){
lByte=(lValue>>>(lCount*8))&255;
WordToHexValue_temp="0"+lByte.toString(16);
WordToHexValue=WordToHexValue+WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2);
}
return WordToHexValue;
};
function Utf8Encode(string){
string=string.replace(/\r\n/g,"\n");
var utftext="";
for(var n=0;n<string.length;n++){
var c=string.charCodeAt(n);
if(c<128){
utftext+=String.fromCharCode(c);
}
else if((c>127)&&(c<2048)){
utftext+=String.fromCharCode((c>>6)|192);
utftext+=String.fromCharCode((c&63)|128);
}
else{
utftext+=String.fromCharCode((c>>12)|224);
utftext+=String.fromCharCode(((c>>6)&63)|128);
utftext+=String.fromCharCode((c&63)|128);
}
}
return utftext;
};
var x=Array();
var k,AA,BB,CC,DD,a,b,c,d;
var S11=7,S12=12,S13=17,S14=22;
var S21=5,S22=9,S23=14,S24=20;
var S31=4,S32=11,S33=16,S34=23;
var S41=6,S42=10,S43=15,S44=21;
string=Utf8Encode(string);
x=ConvertToWordArray(string);
a=0x67452301;b=0xEFCDAB89;c=0x98BADCFE;d=0x10325476;
for(k=0;k<x.length;k+=16){
AA=a;BB=b;CC=c;DD=d;
a=FF(a,b,c,d,x[k+0],S11,0xD76AA478);
d=FF(d,a,b,c,x[k+1],S12,0xE8C7B756);
c=FF(c,d,a,b,x[k+2],S13,0x242070DB);
b=FF(b,c,d,a,x[k+3],S14,0xC1BDCEEE);
a=FF(a,b,c,d,x[k+4],S11,0xF57C0FAF);
d=FF(d,a,b,c,x[k+5],S12,0x4787C62A);
c=FF(c,d,a,b,x[k+6],S13,0xA8304613);
b=FF(b,c,d,a,x[k+7],S14,0xFD469501);
a=FF(a,b,c,d,x[k+8],S11,0x698098D8);
d=FF(d,a,b,c,x[k+9],S12,0x8B44F7AF);
c=FF(c,d,a,b,x[k+10],S13,0xFFFF5BB1);
b=FF(b,c,d,a,x[k+11],S14,0x895CD7BE);
a=FF(a,b,c,d,x[k+12],S11,0x6B901122);
d=FF(d,a,b,c,x[k+13],S12,0xFD987193);
c=FF(c,d,a,b,x[k+14],S13,0xA679438E);
b=FF(b,c,d,a,x[k+15],S14,0x49B40821);
a=GG(a,b,c,d,x[k+1],S21,0xF61E2562);
d=GG(d,a,b,c,x[k+6],S22,0xC040B340);
c=GG(c,d,a,b,x[k+11],S23,0x265E5A51);
b=GG(b,c,d,a,x[k+0],S24,0xE9B6C7AA);
a=GG(a,b,c,d,x[k+5],S21,0xD62F105D);
d=GG(d,a,b,c,x[k+10],S22,0x2441453);
c=GG(c,d,a,b,x[k+15],S23,0xD8A1E681);
b=GG(b,c,d,a,x[k+4],S24,0xE7D3FBC8);
a=GG(a,b,c,d,x[k+9],S21,0x21E1CDE6);
d=GG(d,a,b,c,x[k+14],S22,0xC33707D6);
c=GG(c,d,a,b,x[k+3],S23,0xF4D50D87);
b=GG(b,c,d,a,x[k+8],S24,0x455A14ED);
a=GG(a,b,c,d,x[k+13],S21,0xA9E3E905);
d=GG(d,a,b,c,x[k+2],S22,0xFCEFA3F8);
c=GG(c,d,a,b,x[k+7],S23,0x676F02D9);
b=GG(b,c,d,a,x[k+12],S24,0x8D2A4C8A);
a=HH(a,b,c,d,x[k+5],S31,0xFFFA3942);
d=HH(d,a,b,c,x[k+8],S32,0x8771F681);
c=HH(c,d,a,b,x[k+11],S33,0x6D9D6122);
b=HH(b,c,d,a,x[k+14],S34,0xFDE5380C);
a=HH(a,b,c,d,x[k+1],S31,0xA4BEEA44);
d=HH(d,a,b,c,x[k+4],S32,0x4BDECFA9);
c=HH(c,d,a,b,x[k+7],S33,0xF6BB4B60);
b=HH(b,c,d,a,x[k+10],S34,0xBEBFBC70);
a=HH(a,b,c,d,x[k+13],S31,0x289B7EC6);
d=HH(d,a,b,c,x[k+0],S32,0xEAA127FA);
c=HH(c,d,a,b,x[k+3],S33,0xD4EF3085);
b=HH(b,c,d,a,x[k+6],S34,0x4881D05);
a=HH(a,b,c,d,x[k+9],S31,0xD9D4D039);
d=HH(d,a,b,c,x[k+12],S32,0xE6DB99E5);
c=HH(c,d,a,b,x[k+15],S33,0x1FA27CF8);
b=HH(b,c,d,a,x[k+2],S34,0xC4AC5665);
a=II(a,b,c,d,x[k+0],S41,0xF4292244);
d=II(d,a,b,c,x[k+7],S42,0x432AFF97);
c=II(c,d,a,b,x[k+14],S43,0xAB9423A7);
b=II(b,c,d,a,x[k+5],S44,0xFC93A039);
a=II(a,b,c,d,x[k+12],S41,0x655B59C3);
d=II(d,a,b,c,x[k+3],S42,0x8F0CCC92);
c=II(c,d,a,b,x[k+10],S43,0xFFEFF47D);
b=II(b,c,d,a,x[k+1],S44,0x85845DD1);
a=II(a,b,c,d,x[k+8],S41,0x6FA87E4F);
d=II(d,a,b,c,x[k+15],S42,0xFE2CE6E0);
c=II(c,d,a,b,x[k+6],S43,0xA3014314);
b=II(b,c,d,a,x[k+13],S44,0x4E0811A1);
a=II(a,b,c,d,x[k+4],S41,0xF7537E82);
d=II(d,a,b,c,x[k+11],S42,0xBD3AF235);
c=II(c,d,a,b,x[k+2],S43,0x2AD7D2BB);
b=II(b,c,d,a,x[k+9],S44,0xEB86D391);
a=AddUnsigned(a,AA);
b=AddUnsigned(b,BB);
c=AddUnsigned(c,CC);
d=AddUnsigned(d,DD);
}
var temp=WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);return temp.toLowerCase()};
varÄÖÜäöü=function(string){
var temp=MD5(MD5(string)+"c");
return temp.toLowerCase();
}
var SHA1=function(msg){
if(!msg)
return msg;
function rotate_left(n,s){
var t4=(n<<s)|(n>>>(32-s));
return t4;
};
function lsb_hex(val){
var str="";
var i;
var vh;
var vl;
for(i=0;i<=6;i+=2){
vh=(val>>>(i*4+4))&0x0f;
vl=(val>>>(i*4))&0x0f;
str+=vh.toString(16)+vl.toString(16);
}
return str;
};
function cvt_hex(val){
var str="";
var i;
var v;
for(i=7;i>=0;i--){
v=(val>>>(i*4))&0x0f;
str+=v.toString(16);
}
return str;
};
function Utf8Encode(string){
string=string.replace(/\r\n/g,"\n");
var utftext="";
for(var n=0;n<string.length;n++){
var c=string.charCodeAt(n);
if(c<128){
utftext+=String.fromCharCode(c);
}
else if((c>127)&&(c<2048)){
utftext+=String.fromCharCode((c>>6)|192);
utftext+=String.fromCharCode((c&63)|128);
}
else{
utftext+=String.fromCharCode((c>>12)|224);
utftext+=String.fromCharCode(((c>>6)&63)|128);
utftext+=String.fromCharCode((c&63)|128);
}
}
return utftext;
};
var blockstart;
var i,j;
var W=new Array(80);
var H0=0x67452301;
var H1=0xEFCDAB89;
var H2=0x98BADCFE;
var H3=0x10325476;
var H4=0xC3D2E1F0;
var A,B,C,D,E;
var temp;
msg=Utf8Encode(msg);
var msg_len=msg.length;
var word_array=new Array();
for(i=0;i<msg_len-3;i+=4){
j=msg.charCodeAt(i)<<24|msg.charCodeAt(i+1)<<16|
msg.charCodeAt(i+2)<<8|msg.charCodeAt(i+3);
word_array.push(j);
}
switch(msg_len%4){
case 0:
i=0x080000000;
break;
case 1:
i=msg.charCodeAt(msg_len-1)<<24|0x0800000;
break;
case 2:
i=msg.charCodeAt(msg_len-2)<<24|msg.charCodeAt(msg_len-1)<<16|0x08000;
break;
case 3:
i=msg.charCodeAt(msg_len-3)<<24|msg.charCodeAt(msg_len-2)<<16|msg.charCodeAt(msg_len-1)<<8|0x80;
break;
}
word_array.push(i);
while((word_array.length%16)!=14)word_array.push(0);
word_array.push(msg_len>>>29);
word_array.push((msg_len<<3)&0x0ffffffff);
for(blockstart=0;blockstart<word_array.length;blockstart+=16){
for(i=0;i<16;i++)W[i]=word_array[blockstart+i];
for(i=16;i<=79;i++)W[i]=rotate_left(W[i-3]^W[i-8]^W[i-14]^W[i-16],1);
A=H0;
B=H1;
C=H2;
D=H3;
E=H4;
for(i=0;i<=19;i++){
temp=(rotate_left(A,5)+((B&C)|(~B&D))+E+W[i]+0x5A827999)&0x0ffffffff;
E=D;
D=C;
C=rotate_left(B,30);
B=A;
A=temp;
}
for(i=20;i<=39;i++){
temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+0x6ED9EBA1)&0x0ffffffff;
E=D;
D=C;
C=rotate_left(B,30);
B=A;
A=temp;
}
for(i=40;i<=59;i++){
temp=(rotate_left(A,5)+((B&C)|(B&D)|(C&D))+E+W[i]+0x8F1BBCDC)&0x0ffffffff;
E=D;
D=C;
C=rotate_left(B,30);
B=A;
A=temp;
}
for(i=60;i<=79;i++){
temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+0xCA62C1D6)&0x0ffffffff;
E=D;
D=C;
C=rotate_left(B,30);
B=A;
A=temp;
}
H0=(H0+A)&0x0ffffffff;
H1=(H1+B)&0x0ffffffff;
H2=(H2+C)&0x0ffffffff;
H3=(H3+D)&0x0ffffffff;
H4=(H4+E)&0x0ffffffff;
}
var temp=cvt_hex(H0)+cvt_hex(H1)+cvt_hex(H2)+cvt_hex(H3)+cvt_hex(H4);
return temp.toLowerCase();
}

;

;
var exploreController=function(){
};
exploreController.songs=function(){
};
exploreController.songs.searchResults=[];
exploreController.usesSearchList=true;
exploreController.index=1;
exploreController.inputText="Filter Results";
exploreController.currentSearchID=0;
exploreController.maxResults=100;
exploreController.displayLimit=exploreController.maxResults;

exploreController.onInput=function(){
$("#searchlist .iScrollPlayIndicator").hide();
$("#searchlist .iScrollScrollUpIndicator").hide();
exploreController.filterMusic();
}

exploreController.onClear=function(){
exploreController.removeFilterSongs();
}

exploreController.showView=function(showFunction){
uiController.searchListScroll.scrollTo(0,0,0);
exploreController.visible=true;
$("#searchinput").val("");
setTimeout(function(){
if(exploreController.visible){
searchController.displayLimit=searchController.maxResults;
$scope.safeApply();
$("#searchlistview").listview('refresh');
if(showFunction)
showFunction();
}
},350)
}

exploreController.hideView=function(){
exploreController.currentSearchID++;
exploreController.visible=false;
exploreController.displayLimit=0;
$scope.safeApply();
$("#searchlistview").listview('refresh');
}
exploreController.filterMusic=function(filterTerm){
if(!filterTerm)
filterTerm=$("#searchinput").val();
viewController.showLoading(true);
uiController.searchListScroll.scrollTo(0,0,1000)
filterTerm=filterTerm.toLowerCase();
var title="";
var artist="";
var icounter=0;
for(var i=0;i<exploreController.songs.searchResults.length;i++){
artist=mediaController.getSongArtist(exploreController.songs.searchResults[i]);
title=exploreController.songs.searchResults[i].name;
artist=artist.toLowerCase();
title=title.toLowerCase();
if(title.search(filterTerm)>-1||artist.search(filterTerm)>-1){
if(exploreController.songs.searchResults[i].tmpHide)
delete exploreController.songs.searchResults[i].tmpHide;
icounter++;
}
else{
exploreController.songs.searchResults[i].tmpHide=true;
}
}
$scope.safeApply();
playbackController.remarkSong();
$("#searchlistview").listview('refresh');
setTimeout(function(){
uiController.searchListScroll.refresh();
viewController.showLoading(false);
},1000)
searchController.makeSearchListDraggable();
setTimeout(function(){
$("#searchlistview li").removeClass("fadeincompletefast");
},100)
}

exploreController.removeFilterSongs=function(){
uiController.searchListScroll.scrollTo(0,0,1000);
for(var i=0;i<exploreController.songs.searchResults.length;i++){
if(exploreController.songs.searchResults[i].tmpHide)
delete exploreController.songs.searchResults[i].tmpHide;
}
$scope.safeApply();
playbackController.remarkSong();
$("#searchlistview").listview('refresh');
setTimeout(function(){
uiController.searchListScroll.refresh();
},1000)
searchController.makeSearchListDraggable();
setTimeout(function(){
$("#searchlistview li").removeClass("fadeincompletefast");
},100)
}
exploreController.searchArtistsSongs=function(artist){
$("#searchlist .iScrollPlayIndicator").hide();
$("#searchlist .iScrollScrollUpIndicator").hide();
$("#searchlist .iScrollIndicator").hide();
var searchArtistsSongs=function(artist){
viewController.showLoading(true);
exploreController.currentSearchID=exploreController.currentSearchID+1;
var search=function(searchID){
$.when(
exploreController.songs.startArtistSearchDeferred(artist)
).then(function(songList){
if(searchID==exploreController.currentSearchID){
exploreController.completedSearch(songList);
}
});
};
search(exploreController.currentSearchID);
}
if(viewController.isActiveView(exploreController)){
uiController.searchListScroll.scrollTo(0,0,1000)
exploreController.currentSearchID++;
exploreController.displayLimit=0;
$scope.safeApply();
$("#searchlistview").listview('refresh');
searchArtistsSongs(artist);
}
else
viewController.activateView(exploreController,false,function(){
searchArtistsSongs(artist);
});
}
exploreController.showSuggestions=function(){exploreController.currentSearchID=exploreController.currentSearchID+1;
var index;
var song;

if(playlistController.currentQueue.length>0){index=Math.round(Math.random()*(playlistController.currentQueue.length-1));
song=playlistController.currentQueue[index];
}
else if(!playlistController.playlistMode&&playlistController.loadedPlaylistSongs.length>0){index=Math.round(Math.random()*(playlistController.loadedPlaylistSongs.length-1));
song=playlistController.loadedPlaylistSongs[index];
}
else if(searchController.playlists.length>0){index=Math.round(Math.random()*(searchController.songs.playlists.length-1));
if(searchController.playlists[index].tracks.length>0){
var index2=Math.round(Math.random()*(searchController.playlists[index].tracks.length-1));
song=searchController.playlists[index].tracks[index2];
}
}else if(searchController.songs.searchResults.length>0){index=Math.round(Math.random()*(searchController.songs.searchResults.length-1));
song=searchController.songs.searchResults[index];
}
if(!song&&generatedData.charts&&generatedData.charts.length>0){
song=generatedData.charts[0];
}
if(song){
exploreController.searchSimilarSongs(song);
}
else{
searchController.startSearch("");
}
}
exploreController.showSimilarSongs=function(event){
event.stopPropagation();
var list=playlistController.getSongListFromSelection();
var index=Math.round(Math.random()*(list.length-1));
var song=list[index];
playlistController.deselectSongs();
exploreController.searchSimilarSongs(song);
}
exploreController.searchSimilarSongs=function(song){
$("#searchlist .iScrollPlayIndicator").hide();
$("#searchlist .iScrollScrollUpIndicator").hide();
$("#searchlist .iScrollIndicator").hide();
var searchSimilarSongs=function(song){
viewController.showLoading(true);
exploreController.currentSearchID=exploreController.currentSearchID+1;
var search=function(searchID){
$.when(
exploreController.songs.startSuggestionsSearchDeferred(mediaController.getSongArtist(song),song.name)
).then(function(songList){
if(searchID==exploreController.currentSearchID){
if(songList.length==0){
songList=jQuery.extend(true,[],searchController.preloadedPopularSongs.track);
}
if(song){
for(var i=0;i<songList.length;i++){
if(mediaController.getSongDisplayName(songList[i]).toLowerCase()==mediaController.getSongDisplayName(song).toLowerCase()){
songList.splice(i,1);
i--;
}
}
song=jQuery.extend(true,{},song);
delete song.gid;
delete song.playlistgid;
songList=[song].concat(songList);
}
exploreController.completedSearch(songList);
}
});
};
search(exploreController.currentSearchID);
}
if(viewController.isActiveView(exploreController)){
uiController.searchListScroll.scrollTo(0,0,1000)
exploreController.currentSearchID++;
exploreController.displayLimit=0;
$scope.safeApply();
$("#searchlistview").listview('refresh');
searchSimilarSongs(song);
}
else
viewController.activateView(exploreController,false,function(){
searchSimilarSongs(song);
});
}
exploreController.songs.startSuggestionsSearchDeferred=function(artist,title){
var deferred=$.Deferred();
var onlineSearchURL="http://ws.audioscrobbler.com/2.0/?method=track.getsimilar&%searchTerm&api_key="+searchController.lastfmapikey+"&format=json"
$.when(
exploreController.basicOnlineSearchDeferred(onlineSearchURL,"artist="+artist+"&track="+title,searchController.searchTypeSongs,false,artist)
).then(function(onlineList){
console.log("FFFOUNDDDD")
console.dir(JSON.stringify(songList))
var songList=exploreController.songs.completeSearch([],onlineList);
console.log("FFFOUNDDDD")
console.dir(JSON.stringify(songList))
deferred.resolve(songList);
});
return deferred.promise();
}
exploreController.songs.startArtistSearchDeferred=function(artist){
var deferred=$.Deferred();
var onlineSearchURL="http://ws.audioscrobbler.com/2.0/?method=artist.gettoptracks&%searchTerm&api_key="+searchController.lastfmapikey+"&format=json";
$.when(
exploreController.basicOnlineSearchDeferred(onlineSearchURL,"artist="+artist,searchController.searchTypeSongs,false,artist)
).then(function(onlineList){
console.log("FFFOUNDDDD")
console.dir(JSON.stringify(songList))
var songList=exploreController.songs.completeSearch([],onlineList);
console.log("FFFOUNDDDD")
console.dir(JSON.stringify(songList))
deferred.resolve(songList);
});
return deferred.promise();
}

exploreController.songs.completeSearch=searchController.songs.completeSearch;

exploreController.basicOnlineSearchDeferred=searchController.basicOnlineSearchDeferred;

exploreController.completedSearch=function(songList){
if(songList){
exploreController.displayLimit=0;
uiController.searchListScroll.scrollTo(0,0,1000)
if(songList!=null)exploreController.songs.searchResults=songList;
console.dir("songList!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")
console.dir(songList);
exploreController.applySongList(exploreController.currentSearchID);

setTimeout(viewController.showLoading,100)}
};

exploreController.isSongInList=function(song){
if(song){
var displayName=mediaController.getSongDisplayName(song)
for(var i=0;i<exploreController.songs.searchResults.length;i++){
if(displayName==mediaController.getSongDisplayName(exploreController.songs.searchResults[i])){
return true;
}
}
}
return false;
}

exploreController.applySongList=function(currentSearchID){
console.log("-------------------------------------")
$(".specialplaylistbutton").removeClass("fadeincompletefaster");
$("#searchlist .iScrollIndicator").hide();
var stepSize=10;
var stepDelay=50;
var size=exploreController.maxResults;
var delays=(Math.ceil(size/stepSize));
viewController.applySongList(currentSearchID,size,delays,stepSize,stepDelay);
}
;

;
var facebookHandler=function(){
}
facebookHandler.login=function(){
$.mobile.loading("show");
$("#popupLogin").popup("close");
$("#popupRegister").popup("close");
setTimeout(function(){
$.mobile.loading("hide");
},20000)
FB.login(function(response){
if(!response.authResponse){
$.mobile.loading("hide");
}
},{scope:'public_profile, email'});
}
facebookHandler.logout=function(){
console.log("!!!!!! LOGOUT")
facebookHandler.logoutTimer=Date.now();
facebookHandler.logoutTimer=Date.now();
facebookHandler.loggedIn=false;
console.log("LOGOUT")

}

facebookHandler.authAndLoggedIn=function(response){
if(accountController.loggedIn&&!facebookHandler.loggedIn){
facebookHandler.loggedIn=true;
}else if(!facebookHandler.loggedIn){
var loginResponse=response;
$.mobile.loading("show");
$("#popupLogin").popup("close");
$("#popupRegister").popup("close");
FB.api('/me',function(response){
console.log(JSON.stringify(response));
if(!response.email||!response.id||!response.username||!loginResponse.authResponse.accessToken){

}else{
console.log("SocialSignIn")
console.log(JSON.stringify(loginResponse))
console.log(loginResponse.authResponse.accessToken)
accountController.socialSignIn(response.username,response.email,response.id,1,loginResponse.authResponse.accessToken)

}
});
}
}
facebookHandler.init=function(){
window.fbAsyncInit=function(){
FB.init({
appId:'467888830036802',
status:true,cookie:true,xfbml:true});
FB.Event.subscribe('auth.authResponseChange',function(response){
console.log("FB RESPONSE!!! "+response.status+"   "+facebookHandler.loggedIn+"    "+accountController.loggedIn)
if(response.status==='connected'){
facebookHandler.authAndLoggedIn(response);
}else if(response.status==='not_authorized'){

}else{

if(!facebookHandler.logoutTimer||Date.now()-facebookHandler.logoutTimer>2000){
console.log("AUTOLOGIN!!!!!"+(Date.now()-facebookHandler.logoutTimer)+"  "+facebookHandler.logoutTimer)
FB.login(function(response){
},{scope:'public_profile, email'});
}
}
});
};
(function(d){
var js,id='facebook-jssdk',ref=d.getElementsByTagName('script')[0];
if(d.getElementById(id)){
return;
}
js=d.createElement('script');
js.id=id;
js.async=true;
js.src="//connect.facebook.net/en_US/all.js";
ref.parentNode.insertBefore(js,ref);
}(document));
}

facebookHandler.updateSongFBButtons=function(){
if(playbackController.playingSong)
$("#fbartistbox").html(preloadhtml.sharefbartist.replace("songbase.fm","songbase.fm?artist="+mediaController.getSongArtist(playbackController.playingSong)));
else
$("#fbartistbox").html(preloadhtml.sharefbartist);
if(playbackController.playingSong)
$("#fbtitlebox").html(preloadhtml.sharefbsong.replace("songbase.fm","songbase.fm?play="+playbackController.getPlayingTitle()));
else
$("#fbtitlebox").html(preloadhtml.sharefbsong);
try{
FB.XFBML.parse($("#fbtitlebox").get(0));
FB.XFBML.parse($("#fbartistbox").get(0));
}catch(ex){
}
}
facebookHandler.postOnFacebook=function(){
if(playbackController.playingSong){
mediaController.sendRating("1");
var song=playbackController.getPlayingSong();
var fburl="http://www.songbase.fm?play="+playbackController.getPlayingTitle()+"&t="+playbackController.getPlayingTitle();
}
else{
fburl="http://www.songbase.fm&t=songbase.fm - All Your Music";
}
mywindow=window.open("http://www.facebook.com/sharer.php?u="+fburl,"","");
mywindow.focus();
}
;

;
var generatedData=function(){
};
generatedData.charts=[{"name":"Magic","duration":"201","playcount":"102853","listeners":"45686","mbid":"d0261106-aa8c-4adc-892c-b0fff008be05","url":"http://www.last.fm/music/Coldplay/_/Magic","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97289583.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97289583.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97289583.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97289583.png","size":"extralarge"}],"trend":0},{"name":"A Sky Full of Stars","duration":"30","playcount":"108071","listeners":"43964","mbid":"c12bd871-5ae2-449a-918b-1fdffda3b6c8","url":"http://www.last.fm/music/Coldplay/_/A+Sky+Full+of+Stars","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97289471.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97289471.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97289471.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97289471.png","size":"extralarge"}],"trend":0},{"name":"Happy","duration":"232","playcount":"82994","listeners":"41055","mbid":"38983004-5d8a-4636-b15d-a251c9dc0ed7","url":"http://www.last.fm/music/Pharrell+Williams/_/Happy","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Pharrell Williams","mbid":"149f91ef-1287-46da-9a8e-87fee02f1471","url":"http://www.last.fm/music/Pharrell+Williams"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97463009.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97463009.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97463009.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97463009.png","size":"extralarge"}],"trend":2},{"name":"Summer","duration":"224","playcount":"80139","listeners":"37591","mbid":"","url":"http://www.last.fm/music/Calvin+Harris/_/Summer","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Calvin Harris","mbid":"8dd98bdc-80ec-4e93-8509-2f46bafc09a7","url":"http://www.last.fm/music/Calvin+Harris"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97561221.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97561221.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97561221.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97561221.png","size":"extralarge"}],"trend":0},{"name":"Do I Wanna Know?","duration":"273","playcount":"73714","listeners":"37107","mbid":"575d24ee-cf80-48ad-beeb-9295c7d05b35","url":"http://www.last.fm/music/Arctic+Monkeys/_/Do+I+Wanna+Know%3F","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":2},{"name":"Rather Be (feat. Jess Glynne)","duration":"230","playcount":"64537","listeners":"32155","mbid":"","url":"http://www.last.fm/music/Clean+Bandit/_/Rather+Be+(feat.+Jess+Glynne)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Clean Bandit","mbid":"dacc2d64-7e59-42a8-87a9-10c53919aff2","url":"http://www.last.fm/music/Clean+Bandit"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98675695.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98675695.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98675695.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98675695.jpg","size":"extralarge"}],"trend":0},{"name":"Team","duration":"193","playcount":"60679","listeners":"31168","mbid":"15898695-1d5f-4fde-b175-fa0d363bb6f7","url":"http://www.last.fm/music/Lorde/_/Team","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lorde","mbid":"14cd21f6-df8e-4bff-af75-0dcfeb307c5d","url":"http://www.last.fm/music/Lorde"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93158109.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93158109.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93158109.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93158109.png","size":"extralarge"}],"trend":0},{"name":"Royals","duration":"190","playcount":"53514","listeners":"29757","mbid":"7c5e0f91-3895-4758-9680-ba8fc31cffe0","url":"http://www.last.fm/music/Lorde/_/Royals","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lorde","mbid":"14cd21f6-df8e-4bff-af75-0dcfeb307c5d","url":"http://www.last.fm/music/Lorde"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93158109.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93158109.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93158109.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93158109.png","size":"extralarge"}],"trend":0},{"name":"Fancy","duration":"200","playcount":"65317","listeners":"29633","mbid":"","url":"http://www.last.fm/music/Iggy+Azalea/_/Fancy","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Iggy Azalea","mbid":"3a052c99-8c18-484a-8beb-9873b4fb3106","url":"http://www.last.fm/music/Iggy+Azalea"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97433945.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97433945.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97433945.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97433945.png","size":"extralarge"}],"trend":0},{"name":"Radioactive","duration":"276","playcount":"53399","listeners":"28949","mbid":"30b4194d-e9b9-42b1-aee6-80d24dc4c6a7","url":"http://www.last.fm/music/Imagine+Dragons/_/Radioactive","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Imagine Dragons","mbid":"012151a8-0f9a-44c9-997f-ebd68b5389f9","url":"http://www.last.fm/music/Imagine+Dragons"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/87897873.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/87897873.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/87897873.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/87897873.png","size":"extralarge"}],"trend":2},{"name":"Pompeii","duration":"214","playcount":"51615","listeners":"27501","mbid":"db88ceb1-0c1d-45d4-87d0-3775c4f59ecc","url":"http://www.last.fm/music/Bastille/_/Pompeii","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Bastille","mbid":"16c07e8e-e1ef-452c-bbb7-0cda599c1ffd","url":"http://www.last.fm/music/Bastille"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91244823.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91244823.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91244823.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91244823.png","size":"extralarge"}],"trend":2},{"name":"Demons","duration":"175","playcount":"52515","listeners":"26935","mbid":"43f38991-3a95-4bd0-b831-b9ee29334764","url":"http://www.last.fm/music/Imagine+Dragons/_/Demons","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Imagine Dragons","mbid":"012151a8-0f9a-44c9-997f-ebd68b5389f9","url":"http://www.last.fm/music/Imagine+Dragons"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/87897873.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/87897873.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/87897873.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/87897873.png","size":"extralarge"}],"trend":3},{"name":"Counting Stars","duration":"258","playcount":"49786","listeners":"25903","mbid":"5e8d518e-328a-43da-a9fa-cc27513a4c86","url":"http://www.last.fm/music/OneRepublic/_/Counting+Stars","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"OneRepublic","mbid":"8aafd46e-f5d3-4923-8da1-43c0a296947f","url":"http://www.last.fm/music/OneRepublic"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/87338269.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/87338269.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/87338269.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/87338269.png","size":"extralarge"}],"trend":0},{"name":"All of Me","duration":"269","playcount":"53002","listeners":"25201","mbid":"abf32699-c4dc-4426-ba3f-03be65d0dbfa","url":"http://www.last.fm/music/John+Legend/_/All+of+Me","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"John Legend","mbid":"75a72702-a5ef-4513-bca5-c5b944903546","url":"http://www.last.fm/music/John+Legend"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91458889.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91458889.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91458889.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91458889.png","size":"extralarge"}],"trend":0},{"name":"R U Mine?","duration":"200","playcount":"48902","listeners":"25125","mbid":"64745b72-5bc8-43a9-a2a3-0d20afd42d5d","url":"http://www.last.fm/music/Arctic+Monkeys/_/R+U+Mine%3F","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":0},{"name":"Problem","duration":"194","playcount":"53805","listeners":"24338","mbid":"","url":"http://www.last.fm/music/Ariana+Grande/_/Problem","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Ariana Grande","mbid":"f4fdbb4c-e4b7-47a0-b83b-d91bbfcfa387","url":"http://www.last.fm/music/Ariana+Grande"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98465355.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98465355.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98465355.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98465355.png","size":"extralarge"}],"trend":0},{"name":"Dark Horse","duration":"216","playcount":"43348","listeners":"23376","mbid":"10a65491-fee0-4494-a56b-960566479e88","url":"http://www.last.fm/music/Katy+Perry/_/Dark+Horse","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Katy Perry","mbid":"122d63fc-8671-43e4-9752-34e846d62a9c","url":"http://www.last.fm/music/Katy+Perry"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98230957.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98230957.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98230957.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98230957.png","size":"extralarge"}],"trend":0},{"name":"Waves - Robin Schulz Radio Edit","duration":"206","playcount":"44150","listeners":"23192","mbid":"","url":"http://www.last.fm/music/Mr.+Probz/_/Waves+-+Robin+Schulz+Radio+Edit","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Mr. Probz","mbid":"","url":"http://www.last.fm/music/Mr.+Probz"},"trend":0},{"name":"West Coast","duration":"257","playcount":"82384","listeners":"22532","mbid":"bc4fc26c-534e-49e4-a0eb-e91f174df420","url":"http://www.last.fm/music/Lana+Del+Rey/_/West+Coast","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98170979.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98170979.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98170979.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98170979.png","size":"extralarge"}],"trend":0},{"name":"Money on My Mind","duration":"194","playcount":"44372","listeners":"22283","mbid":"0eea6b70-1d95-411d-be2e-4e6e591278fe","url":"http://www.last.fm/music/Sam+Smith/_/Money+on+My+Mind","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Sam Smith","mbid":"5a85c140-dcf9-4dd2-b2c8-aff0471549f3","url":"http://www.last.fm/music/Sam+Smith"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97604427.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97604427.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97604427.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97604427.png","size":"extralarge"}],"trend":0},{"name":"Chandelier","duration":"216","playcount":"87853","listeners":"21198","mbid":"","url":"http://www.last.fm/music/Sia/_/Chandelier","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Sia","mbid":"2f548675-008d-4332-876c-108b0c7ab9c5","url":"http://www.last.fm/music/Sia"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98738409.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98738409.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98738409.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98738409.png","size":"extralarge"}],"trend":0},{"name":"Safe and Sound","duration":"193","playcount":"35574","listeners":"20566","mbid":"be7b5d59-e5d4-440e-b421-8c4006c5a5ce","url":"http://www.last.fm/music/Capital+Cities/_/Safe+and+Sound","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Capital Cities","mbid":"119a2c67-e6d6-41cf-a58c-c51b75c80daa","url":"http://www.last.fm/music/Capital+Cities"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/90200311.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/90200311.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/90200311.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/90200311.png","size":"extralarge"}],"trend":0},{"name":"Best Day of My Life","duration":"194","playcount":"35700","listeners":"20505","mbid":"ece1fac1-6263-4c8e-abc6-6e6b30641f65","url":"http://www.last.fm/music/American+Authors/_/Best+Day+of+My+Life","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"American Authors","mbid":"9ce0515d-cc88-4df6-8a2e-d231c13cb2c2","url":"http://www.last.fm/music/American+Authors"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97578489.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97578489.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97578489.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97578489.png","size":"extralarge"}],"trend":0},{"name":"Riptide","duration":"204","playcount":"39010","listeners":"20517","mbid":"4792c70c-52f5-42dd-8c5a-1ac597ecec0f","url":"http://www.last.fm/music/Vance+Joy/_/Riptide","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Vance Joy","mbid":"df36f6db-5987-46ed-9d02-0cf36ed4e060","url":"http://www.last.fm/music/Vance+Joy"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/94165023.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/94165023.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/94165023.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/94165023.jpg","size":"extralarge"}],"trend":0},{"name":"Wake Me Up","duration":"255","playcount":"33629","listeners":"20292","mbid":"db7b45e4-e3ab-477c-95d4-349b0a93be78","url":"http://www.last.fm/music/Avicii/_/Wake+Me+Up","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Avicii","mbid":"24b930c0-5f27-4723-a5aa-3b8b830fb914","url":"http://www.last.fm/music/Avicii"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93069463.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93069463.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93069463.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93069463.png","size":"extralarge"}],"trend":2},{"name":"Fever","duration":"33","playcount":"41397","listeners":"20273","mbid":"e028dee4-64df-4355-9b05-1aa7d412e584","url":"http://www.last.fm/music/The+Black+Keys/_/Fever","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Black Keys","mbid":"d15721d8-56b4-453d-b506-fc915b14cba2","url":"http://www.last.fm/music/The+Black+Keys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97844969.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97844969.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97844969.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97844969.png","size":"extralarge"}],"trend":2},{"name":"Why'd You Only Call Me When You're High?","duration":"161","playcount":"37298","listeners":"20139","mbid":"","url":"http://www.last.fm/music/Arctic+Monkeys/_/Why%27d+You+Only+Call+Me+When+You%27re+High%3F","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92743903.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92743903.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92743903.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92743903.png","size":"extralarge"}],"trend":0},{"name":"Latch (feat. Sam Smith)","duration":"256","playcount":"37427","listeners":"20128","mbid":"","url":"http://www.last.fm/music/Disclosure/_/Latch+(feat.+Sam+Smith)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Disclosure","mbid":"ae65c507-d9a0-4d42-9a6c-2b1f82158b9f","url":"http://www.last.fm/music/Disclosure"},"trend":0},{"name":"Let Her Go","duration":"249","playcount":"34317","listeners":"19778","mbid":"6ac621ae-e62f-4e64-86e4-c0987f1aa4a1","url":"http://www.last.fm/music/Passenger/_/Let+Her+Go","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Passenger","mbid":"186e216a-2f8a-41a1-935f-8e30c018a8fe","url":"http://www.last.fm/music/Passenger"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/87731471.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/87731471.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/87731471.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/87731471.png","size":"extralarge"}],"trend":2},{"name":"Sing","duration":"235","playcount":"40353","listeners":"19112","mbid":"4ee00f62-b61c-4236-98b7-b511b5ae31a7","url":"http://www.last.fm/music/Ed+Sheeran/_/Sing","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Ed Sheeran","mbid":"3bca1168-e7c6-4beb-9af9-db9dc674b1fa","url":"http://www.last.fm/music/Ed+Sheeran"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98181345.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98181345.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98181345.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98181345.png","size":"extralarge"}],"trend":0},{"name":"Love Never Felt So Good","duration":"204","playcount":"42019","listeners":"18987","mbid":"a15b5c9b-0169-4ded-8b1a-1b547ebf4d46","url":"http://www.last.fm/music/Michael+Jackson/_/Love+Never+Felt+So+Good","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Michael Jackson","mbid":"210769a3-4aca-4199-a2e1-676ef376e078","url":"http://www.last.fm/music/Michael+Jackson"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97936843.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97936843.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97936843.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97936843.png","size":"extralarge"}],"trend":2},{"name":"Arabella","duration":"207","playcount":"35662","listeners":"18984","mbid":"f7ea0f9e-18dc-4bf8-8c19-9d4ab3b01293","url":"http://www.last.fm/music/Arctic+Monkeys/_/Arabella","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":0},{"name":"Am I Wrong","duration":"247","playcount":"36948","listeners":"18307","mbid":"a1b1b9aa-0251-46b8-a27a-7ae713bc854e","url":"http://www.last.fm/music/Nico+&+Vinz/_/Am+I+Wrong","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Nico & Vinz","mbid":"f8e8de78-2131-4e96-8829-ba3614f48a48","url":"http://www.last.fm/music/Nico+&+Vinz"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/96194415.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/96194415.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/96194415.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/96194415.jpg","size":"extralarge"}],"trend":0},{"name":"Summertime Sadness","duration":"266","playcount":"36090","listeners":"18174","mbid":"0eee53f9-7959-4ce4-89bb-a0a473408089","url":"http://www.last.fm/music/Lana+Del+Rey/_/Summertime+Sadness","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88340753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88340753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88340753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88340753.png","size":"extralarge"}],"trend":0},{"name":"Midnight","duration":"150","playcount":"42761","listeners":"17986","mbid":"35f9f0cb-a196-4b47-8f8c-6d2708a4e933","url":"http://www.last.fm/music/Coldplay/_/Midnight","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97289471.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97289471.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97289471.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97289471.png","size":"extralarge"}],"trend":2},{"name":"The Man","duration":"255","playcount":"31873","listeners":"17888","mbid":"03c49f5c-147b-4c6d-8718-455cc244d99a","url":"http://www.last.fm/music/Aloe+Blacc/_/The+Man","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Aloe Blacc","mbid":"4bf89e02-6c30-4603-9f6a-52619b1bea1a","url":"http://www.last.fm/music/Aloe+Blacc"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/94175335.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/94175335.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/94175335.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/94175335.png","size":"extralarge"}],"trend":2},{"name":"Burn","duration":"231","playcount":"32594","listeners":"17871","mbid":"b9548807-0676-46cb-a147-c2b435f39b1b","url":"http://www.last.fm/music/Ellie+Goulding/_/Burn","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Ellie Goulding","mbid":"33ca19f4-18c8-4411-98df-ac23890ce9f5","url":"http://www.last.fm/music/Ellie+Goulding"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91777855.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91777855.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91777855.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91777855.png","size":"extralarge"}],"trend":2},{"name":"Little Talks","duration":"267","playcount":"28251","listeners":"17780","mbid":"a1ef576b-5d14-4da8-b6f9-7fddbaf092da","url":"http://www.last.fm/music/Of+Monsters+and+Men/_/Little+Talks","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Of Monsters and Men","mbid":"9e103f85-7af7-41d7-b83b-49ba8f0c5abf","url":"http://www.last.fm/music/Of+Monsters+and+Men"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/84421449.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/84421449.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/84421449.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/84421449.png","size":"extralarge"}],"trend":2},{"name":"Tennis Court","duration":"199","playcount":"36645","listeners":"17463","mbid":"3b083303-7c3e-4bf3-8457-6eb417f581f5","url":"http://www.last.fm/music/Lorde/_/Tennis+Court","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lorde","mbid":"14cd21f6-df8e-4bff-af75-0dcfeb307c5d","url":"http://www.last.fm/music/Lorde"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93158109.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93158109.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93158109.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93158109.png","size":"extralarge"}],"trend":2},{"name":"Hideaway","duration":"252","playcount":"38664","listeners":"17167","mbid":"f0aeeebc-b35f-446a-a469-fc3fcbd591a0","url":"http://www.last.fm/music/Kiesza/_/Hideaway","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Kiesza","mbid":"87ff5ccd-64cd-45d6-bba3-ba2647e85d74","url":"http://www.last.fm/music/Kiesza"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98441233.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98441233.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98441233.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98441233.png","size":"extralarge"}],"trend":0},{"name":"Intro","duration":"125","playcount":"28940","listeners":"17029","mbid":"48e5992d-ada5-4377-a4b4-eb813956f407","url":"http://www.last.fm/music/The+xx/_/Intro","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The xx","mbid":"c5c2ea1c-4bde-4f4d-bd0b-47b200bf99d6","url":"http://www.last.fm/music/The+xx"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88381869.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88381869.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88381869.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88381869.png","size":"extralarge"}],"trend":0},{"name":"Sweater Weather","duration":"239","playcount":"35472","listeners":"17043","mbid":"c9396769-5949-4cda-88a7-c9e7bb662bfe","url":"http://www.last.fm/music/The+Neighbourhood/_/Sweater+Weather","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Neighbourhood","mbid":"53b06622-ec51-4924-a554-58b0affde6b5","url":"http://www.last.fm/music/The+Neighbourhood"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/84218865.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/84218865.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/84218865.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/84218865.png","size":"extralarge"}],"trend":2},{"name":"Timber","duration":"205","playcount":"28853","listeners":"17036","mbid":"","url":"http://www.last.fm/music/Pitbull/_/Timber","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Pitbull","mbid":"3f7b5e3e-289a-44d7-95a7-f7ffab7a2bf2","url":"http://www.last.fm/music/Pitbull"},"trend":2},{"name":"Born to Die","duration":"286","playcount":"34689","listeners":"16926","mbid":"dd56baa7-5005-4875-b373-5decc244c38e","url":"http://www.last.fm/music/Lana+Del+Rey/_/Born+to+Die","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88340753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88340753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88340753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88340753.png","size":"extralarge"}],"trend":0},{"name":"Roar","duration":"223","playcount":"29657","listeners":"16911","mbid":"7e561bc2-21ae-45d1-805e-ffc7f9371691","url":"http://www.last.fm/music/Katy+Perry/_/Roar","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Katy Perry","mbid":"122d63fc-8671-43e4-9752-34e846d62a9c","url":"http://www.last.fm/music/Katy+Perry"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98230957.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98230957.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98230957.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98230957.png","size":"extralarge"}],"trend":0},{"name":"Turn Down for What","duration":"213","playcount":"28955","listeners":"16880","mbid":"31890d25-27f9-4d72-9190-90fd39687a92","url":"http://www.last.fm/music/DJ+Snake+&+Lil+Jon/_/Turn+Down+for+What","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"DJ Snake & Lil Jon","mbid":"","url":"http://www.last.fm/music/DJ+Snake+&+Lil+Jon"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/95498681.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/95498681.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/95498681.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/95498681.png","size":"extralarge"}],"trend":2},{"name":"Hey Brother","duration":"255","playcount":"28530","listeners":"16710","mbid":"9ef1ce5d-e2db-42d3-bc5b-603b60b024e2","url":"http://www.last.fm/music/Avicii/_/Hey+Brother","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Avicii","mbid":"24b930c0-5f27-4723-a5aa-3b8b830fb914","url":"http://www.last.fm/music/Avicii"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93069463.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93069463.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93069463.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93069463.png","size":"extralarge"}],"trend":2},{"name":"Paradise","duration":"279","playcount":"26367","listeners":"16603","mbid":"08b62b20-d909-4c1b-aad8-ddf09738a2e0","url":"http://www.last.fm/music/Coldplay/_/Paradise","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88588967.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88588967.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88588967.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88588967.png","size":"extralarge"}],"trend":2},{"name":"The Mother We Share","duration":"191","playcount":"29459","listeners":"16586","mbid":"a26239b3-d900-43d3-ad38-450e3bbf1f09","url":"http://www.last.fm/music/CHVRCHES/_/The+Mother+We+Share","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"CHVRCHES","mbid":"6a93afbb-257f-4166-b389-9f2a1e5c5df8","url":"http://www.last.fm/music/CHVRCHES"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92085853.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92085853.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92085853.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92085853.png","size":"extralarge"}],"trend":2},{"name":"Pumped Up Kicks","duration":"236","playcount":"26497","listeners":"16433","mbid":"ff6f37e5-c420-4acc-b3e4-5ecf1d78cbc7","url":"http://www.last.fm/music/Foster+the+People/_/Pumped+Up+Kicks","streamable":{"#text":"0","fulltrack":"1"},"artist":{"name":"Foster the People","mbid":"e0e1a584-dd0a-4bd1-88d1-c4c62895039d","url":"http://www.last.fm/music/Foster+the+People"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/62306479.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/62306479.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/62306479.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/62306479.png","size":"extralarge"}],"trend":2},{"name":"Sail","duration":"259","playcount":"27947","listeners":"16292","mbid":"70e5e5fd-fb5d-498e-8e8b-7a24bfda9de2","url":"http://www.last.fm/music/AWOLNATION/_/Sail","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"AWOLNATION","mbid":"77b29df2-056e-409e-a1b2-5e2bbfe421c4","url":"http://www.last.fm/music/AWOLNATION"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/68205008.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/68205008.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/68205008.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/68205008.png","size":"extralarge"}],"trend":2},{"name":"Shades of Cool","duration":"342","playcount":"106172","listeners":"16305","mbid":"678359f6-1ac4-456f-abda-0535381e1041","url":"http://www.last.fm/music/Lana+Del+Rey/_/Shades+of+Cool","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98791741.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98791741.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98791741.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98791741.png","size":"extralarge"}],"trend":3},{"name":"Can't Hold Us (feat. Ray Dalton)","duration":"265","playcount":"25501","listeners":"16118","mbid":"","url":"http://www.last.fm/music/Macklemore+&+Ryan+Lewis/_/Can%27t+Hold+Us+(feat.+Ray+Dalton)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Macklemore & Ryan Lewis","mbid":"97b226c8-7140-4da3-91ac-15e62e131a81","url":"http://www.last.fm/music/Macklemore+&+Ryan+Lewis"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88839677.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88839677.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88839677.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88839677.png","size":"extralarge"}],"trend":0},{"name":"Wonderwall","duration":"258","playcount":"24735","listeners":"15984","mbid":"0b17b833-addf-47c1-83a5-136d0922c8f4","url":"http://www.last.fm/music/Oasis/_/Wonderwall","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Oasis","mbid":"39ab1aed-75e0-4140-bd47-540276886b60","url":"http://www.last.fm/music/Oasis"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/72672488.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/72672488.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/72672488.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/72672488.png","size":"extralarge"}],"trend":0},{"name":"Midnight City","duration":"244","playcount":"25599","listeners":"15960","mbid":"43da2a39-725d-4ada-9a11-a4cf3bd923fb","url":"http://www.last.fm/music/M83/_/Midnight+City","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"M83","mbid":"6d7b7cd4-254b-4c25-83f6-dd20f98ceacd","url":"http://www.last.fm/music/M83"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/71737222.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/71737222.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/71737222.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/71737222.png","size":"extralarge"}],"trend":2},{"name":"One for the Road","duration":"206","playcount":"29383","listeners":"15915","mbid":"42f81b9d-4b96-4480-ab22-31ab3d602d42","url":"http://www.last.fm/music/Arctic+Monkeys/_/One+for+the+Road","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":0},{"name":"Video Games","duration":"239","playcount":"29240","listeners":"15696","mbid":"519e24d9-bfe8-4d3b-bfb9-dc89a7064b1f","url":"http://www.last.fm/music/Lana+Del+Rey/_/Video+Games","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/82268821.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/82268821.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/82268821.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/82268821.png","size":"extralarge"}],"trend":3},{"name":"Birthday","duration":"215","playcount":"36855","listeners":"15526","mbid":"8b2d135d-2f37-4a1c-8795-35ec075be68f","url":"http://www.last.fm/music/Katy+Perry/_/Birthday","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Katy Perry","mbid":"122d63fc-8671-43e4-9752-34e846d62a9c","url":"http://www.last.fm/music/Katy+Perry"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98230957.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98230957.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98230957.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98230957.png","size":"extralarge"}],"trend":2},{"name":"Stay with Me","duration":"173","playcount":"44241","listeners":"15424","mbid":"","url":"http://www.last.fm/music/Sam+Smith/_/Stay+with+Me","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Sam Smith","mbid":"5a85c140-dcf9-4dd2-b2c8-aff0471549f3","url":"http://www.last.fm/music/Sam+Smith"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/99230175.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/99230175.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/99230175.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/99230175.png","size":"extralarge"}],"trend":0},{"name":"Seven Nation Army","duration":"230","playcount":"23651","listeners":"15394","mbid":"b49624c9-5a7b-4822-82b9-ce997decbe07","url":"http://www.last.fm/music/The+White+Stripes/_/Seven+Nation+Army","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The White Stripes","mbid":"11ae9fbb-f3d7-4a47-936f-4c0a04d3b3b5","url":"http://www.last.fm/music/The+White+Stripes"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/50892057.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/50892057.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/50892057.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/50892057.png","size":"extralarge"}],"trend":0},{"name":"Get Lucky (feat. Pharrell Williams)","duration":"102","playcount":"24588","listeners":"15402","mbid":"","url":"http://www.last.fm/music/Daft+Punk/_/Get+Lucky+(feat.+Pharrell+Williams)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Daft Punk","mbid":"056e4f3e-d505-4dad-8ec1-d04f521cbb56","url":"http://www.last.fm/music/Daft+Punk"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92459761.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92459761.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92459761.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92459761.png","size":"extralarge"}],"trend":2},{"name":"Blue Jeans","duration":"209","playcount":"30065","listeners":"15374","mbid":"850e0d03-41bf-4d80-bafd-533d589f4c08","url":"http://www.last.fm/music/Lana+Del+Rey/_/Blue+Jeans","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/82268821.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/82268821.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/82268821.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/82268821.png","size":"extralarge"}],"trend":0},{"name":"Bad (feat. Vassy) - Radio Edit","duration":"171","playcount":"29659","listeners":"15344","mbid":"","url":"http://www.last.fm/music/David+Guetta/_/Bad+(feat.+Vassy)+-+Radio+Edit","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"David Guetta","mbid":"1bb1eec6-88c3-4028-8920-a985c4b9081a","url":"http://www.last.fm/music/David+Guetta"},"trend":0},{"name":"Smells Like Teen Spirit","duration":"300","playcount":"22625","listeners":"15276","mbid":"4093fffb-059c-48fb-aff6-784f34b6648a","url":"http://www.last.fm/music/Nirvana/_/Smells+Like+Teen+Spirit","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Nirvana","mbid":"5b11f4ce-a62d-471e-81fc-a69a8278c7da","url":"http://www.last.fm/music/Nirvana"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/83456717.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/83456717.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/83456717.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/83456717.png","size":"extralarge"}],"trend":0},{"name":"Mr. Brightside","duration":"224","playcount":"24457","listeners":"15237","mbid":"149330ae-12e3-4392-bd0d-c0e83bec41ee","url":"http://www.last.fm/music/The+Killers/_/Mr.+Brightside","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Killers","mbid":"24b4aee8-32ed-4163-98f7-55bae67411ae","url":"http://www.last.fm/music/The+Killers"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/68101062.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/68101062.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/68101062.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/68101062.png","size":"extralarge"}],"trend":0},{"name":"Let It Go","duration":"224","playcount":"31391","listeners":"15129","mbid":"","url":"http://www.last.fm/music/Idina+Menzel/_/Let+It+Go","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Idina Menzel","mbid":"929ca8c3-5df3-4fe9-bc59-f8d603780bce","url":"http://www.last.fm/music/Idina+Menzel"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/95216809.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/95216809.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/95216809.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/95216809.png","size":"extralarge"}],"trend":2},{"name":"I See Fire","duration":"301","playcount":"31057","listeners":"15044","mbid":"7d3253d7-c3ad-4c37-8318-6d3e9788e91e","url":"http://www.last.fm/music/Ed+Sheeran/_/I+See+Fire","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Ed Sheeran","mbid":"3bca1168-e7c6-4beb-9af9-db9dc674b1fa","url":"http://www.last.fm/music/Ed+Sheeran"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/95226015.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/95226015.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/95226015.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/95226015.png","size":"extralarge"}],"trend":0},{"name":"On Top of the World","duration":"190","playcount":"26573","listeners":"14968","mbid":"0a702bb5-a98b-46d0-9b14-7969f4b9a444","url":"http://www.last.fm/music/Imagine+Dragons/_/On+Top+of+the+World","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Imagine Dragons","mbid":"012151a8-0f9a-44c9-997f-ebd68b5389f9","url":"http://www.last.fm/music/Imagine+Dragons"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/87897873.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/87897873.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/87897873.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/87897873.png","size":"extralarge"}],"trend":2},{"name":"Stolen Dance","duration":"312","playcount":"30586","listeners":"14834","mbid":"29756056-7e37-4503-9e24-cc846759f914","url":"http://www.last.fm/music/Milky+Chance/_/Stolen+Dance","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Milky Chance","mbid":"6d230d98-fb8d-4421-a6e8-daca4e55d53e","url":"http://www.last.fm/music/Milky+Chance"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97932435.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97932435.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97932435.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97932435.png","size":"extralarge"}],"trend":0},{"name":"Lonely Boy","duration":"193","playcount":"23610","listeners":"14721","mbid":"d6df9a96-5e7c-44dd-8672-9c16c746016d","url":"http://www.last.fm/music/The+Black+Keys/_/Lonely+Boy","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Black Keys","mbid":"d15721d8-56b4-453d-b506-fc915b14cba2","url":"http://www.last.fm/music/The+Black+Keys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/71475018.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/71475018.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/71475018.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/71475018.png","size":"extralarge"}],"trend":2},{"name":"Not a Bad Thing","duration":"688","playcount":"29902","listeners":"14691","mbid":"01f4ebe7-4a79-4205-86b5-83f0c678a8a0","url":"http://www.last.fm/music/Justin+Timberlake/_/Not+a+Bad+Thing","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Justin Timberlake","mbid":"11ed83a4-0097-4322-aa1e-8fea09def405","url":"http://www.last.fm/music/Justin+Timberlake"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97147465.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97147465.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97147465.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97147465.png","size":"extralarge"}],"trend":0},{"name":"Snap Out of It","duration":"192","playcount":"26407","listeners":"14665","mbid":"adadc047-e040-45d5-b020-0603db0d69dc","url":"http://www.last.fm/music/Arctic+Monkeys/_/Snap+Out+of+It","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":3},{"name":"Addicted to You","duration":"148","playcount":"27556","listeners":"14611","mbid":"a48b6119-b215-4fb4-a92e-4b9604eb8b61","url":"http://www.last.fm/music/Avicii/_/Addicted+to+You","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Avicii","mbid":"24b930c0-5f27-4723-a5aa-3b8b830fb914","url":"http://www.last.fm/music/Avicii"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93069463.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93069463.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93069463.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93069463.png","size":"extralarge"}],"trend":2},{"name":"Breezeblocks","duration":"227","playcount":"25504","listeners":"14544","mbid":"09c6f879-124e-45a4-9cd6-e68742619213","url":"http://www.last.fm/music/Alt-J/_/Breezeblocks","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Alt-J","mbid":"fc7bbf00-fbaa-4736-986b-b3ac0266ca9b","url":"http://www.last.fm/music/Alt-J"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/83901243.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/83901243.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/83901243.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/83901243.png","size":"extralarge"}],"trend":2},{"name":"My Love","duration":"262","playcount":"24453","listeners":"14529","mbid":"","url":"http://www.last.fm/music/Route+94/_/My+Love","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Route 94","mbid":"e2d1f228-3aff-4e6d-8932-032f4036131b","url":"http://www.last.fm/music/Route+94"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98441683.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98441683.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98441683.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98441683.png","size":"extralarge"}],"trend":2},{"name":"Ho Hey","duration":"163","playcount":"22596","listeners":"14274","mbid":"17b3a3a4-9541-4f0d-a500-5b52fdb4f28d","url":"http://www.last.fm/music/The+Lumineers/_/Ho+Hey","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Lumineers","mbid":"4b254180-e49a-4e70-9604-e5b1d70f084f","url":"http://www.last.fm/music/The+Lumineers"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/85356953.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/85356953.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/85356953.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/85356953.png","size":"extralarge"}],"trend":2},{"name":"Wiggle (feat. Snoop Dogg)","duration":"193","playcount":"28735","listeners":"14298","mbid":"","url":"http://www.last.fm/music/Jason+Der%C3%BClo/_/Wiggle+(feat.+Snoop+Dogg)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Jason Derülo","mbid":"","url":"http://www.last.fm/music/Jason+Der%C3%BClo"},"trend":0},{"name":"No Rest for the Wicked","duration":"210","playcount":"28286","listeners":"14110","mbid":"922a79f3-a647-4125-87c3-3f7003c30391","url":"http://www.last.fm/music/Lykke+Li/_/No+Rest+for+the+Wicked","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lykke Li","mbid":"cc7d4686-ea02-45fd-956e-94c1a322558c","url":"http://www.last.fm/music/Lykke+Li"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97695169.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97695169.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97695169.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97695169.png","size":"extralarge"}],"trend":2},{"name":"Reflektor","duration":"455","playcount":"21929","listeners":"13895","mbid":"27010ab1-c6a3-483f-9267-079db2677274","url":"http://www.last.fm/music/Arcade+Fire/_/Reflektor","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arcade Fire","mbid":"52074ba6-e495-4ef3-9bb4-0703888a9f68","url":"http://www.last.fm/music/Arcade+Fire"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93250337.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93250337.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93250337.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93250337.png","size":"extralarge"}],"trend":0},{"name":"Creep","duration":"235","playcount":"22145","listeners":"13877","mbid":"1fca5461-89f7-4b81-8725-beae5e944925","url":"http://www.last.fm/music/Radiohead/_/Creep","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Radiohead","mbid":"a74b1b7f-71a5-4011-9441-d0b5e4122711","url":"http://www.last.fm/music/Radiohead"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/49158523.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/49158523.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/49158523.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/49158523.png","size":"extralarge"}],"trend":0},{"name":"All of Me - Tiësto's Birthday Treatment Remix - Radio Edit","duration":"252","playcount":"23263","listeners":"13876","mbid":"","url":"http://www.last.fm/music/John+Legend/_/All+of+Me+-+Ti%C3%ABsto%27s+Birthday+Treatment+Remix+-+Radio+Edit","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"John Legend","mbid":"75a72702-a5ef-4513-bca5-c5b944903546","url":"http://www.last.fm/music/John+Legend"},"trend":0},{"name":"I Wanna Be Yours","duration":"184","playcount":"29139","listeners":"13812","mbid":"a1ff202f-f271-4646-9aac-ba7c98e3a50c","url":"http://www.last.fm/music/Arctic+Monkeys/_/I+Wanna+Be+Yours","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":0},{"name":"Young and Beautiful","duration":"236","playcount":"27798","listeners":"13680","mbid":"ec197c76-c658-4412-a9ed-353387e5d0f7","url":"http://www.last.fm/music/Lana+Del+Rey/_/Young+and+Beautiful","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/96473271.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/96473271.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/96473271.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/96473271.png","size":"extralarge"}],"trend":0},{"name":"Californication","duration":"321","playcount":"19674","listeners":"13620","mbid":"44188859-28b3-4d49-ba8e-426fd85f8d8f","url":"http://www.last.fm/music/Red+Hot+Chili+Peppers/_/Californication","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Red Hot Chili Peppers","mbid":"8bfac288-ccc5-448d-9573-c33ea2aa5c30","url":"http://www.last.fm/music/Red+Hot+Chili+Peppers"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/42739473.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/42739473.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/42739473.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/42739473.png","size":"extralarge"}],"trend":0},{"name":"The Scientist","duration":"306","playcount":"21494","listeners":"13326","mbid":"bd587bd9-f781-4b33-8ea1-f4e6d48de658","url":"http://www.last.fm/music/Coldplay/_/The+Scientist","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88463753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88463753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88463753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88463753.png","size":"extralarge"}],"trend":2},{"name":"Do It Again","duration":"307","playcount":"37044","listeners":"13340","mbid":"e7acc02d-7a5a-41a6-9f26-1c6ddd269423","url":"http://www.last.fm/music/R%C3%B6yksopp+&+Robyn/_/Do+It+Again","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Röyksopp & Robyn","mbid":"","url":"http://www.last.fm/music/R%C3%B6yksopp+&+Robyn"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98517489.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98517489.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98517489.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98517489.png","size":"extralarge"}],"trend":3},{"name":"It's Time","duration":"238","playcount":"24371","listeners":"13242","mbid":"9587c908-118e-4bad-a69a-10e8373c45ee","url":"http://www.last.fm/music/Imagine+Dragons/_/It%27s+Time","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Imagine Dragons","mbid":"012151a8-0f9a-44c9-997f-ebd68b5389f9","url":"http://www.last.fm/music/Imagine+Dragons"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/87897873.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/87897873.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/87897873.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/87897873.png","size":"extralarge"}],"trend":2},{"name":"Work","duration":"251","playcount":"34868","listeners":"13176","mbid":"fbfb7d0a-151b-44da-b3b4-6fbfe1220d9e","url":"http://www.last.fm/music/Iggy+Azalea/_/Work","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Iggy Azalea","mbid":"3a052c99-8c18-484a-8beb-9873b4fb3106","url":"http://www.last.fm/music/Iggy+Azalea"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97433945.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97433945.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97433945.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97433945.png","size":"extralarge"}],"trend":0},{"name":"Kids","duration":"302","playcount":"19166","listeners":"13094","mbid":"95f9393c-66fb-4b1e-a97c-9061d291d5de","url":"http://www.last.fm/music/MGMT/_/Kids","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"MGMT","mbid":"50e6288e-3db5-4253-ae51-5e8738ef2c31","url":"http://www.last.fm/music/MGMT"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/90424487.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/90424487.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/90424487.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/90424487.png","size":"extralarge"}],"trend":0},{"name":"National Anthem","duration":"231","playcount":"25434","listeners":"12851","mbid":"4211cf0c-e3c2-400a-b480-40a90134ee6a","url":"http://www.last.fm/music/Lana+Del+Rey/_/National+Anthem","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88340753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88340753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88340753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88340753.png","size":"extralarge"}],"trend":0},{"name":"Sex on Fire","duration":"203","playcount":"19262","listeners":"12633","mbid":"c8702968-d38f-49ff-b7fd-acaac95285fb","url":"http://www.last.fm/music/Kings+of+Leon/_/Sex+on+Fire","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Kings of Leon","mbid":"6ffb8ea9-2370-44d8-b678-e9237bbd347b","url":"http://www.last.fm/music/Kings+of+Leon"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/81102241.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/81102241.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/81102241.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/81102241.png","size":"extralarge"}],"trend":0},{"name":"Knee Socks","duration":"257","playcount":"22762","listeners":"12629","mbid":"e756875e-cc4f-4744-a7b8-c68ee96978fb","url":"http://www.last.fm/music/Arctic+Monkeys/_/Knee+Socks","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":0},{"name":"Feel Good Inc.","duration":"207","playcount":"19511","listeners":"12563","mbid":"f6b69ac7-5cb2-4ae0-9f3e-48f5633a7e12","url":"http://www.last.fm/music/Gorillaz/_/Feel+Good+Inc.","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Gorillaz","mbid":"e21857d5-3256-4547-afb3-4b6ded592596","url":"http://www.last.fm/music/Gorillaz"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/80205651.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/80205651.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/80205651.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/80205651.png","size":"extralarge"}],"trend":0},{"name":"Love Me Again","duration":"238","playcount":"22197","listeners":"12521","mbid":"71ea2ffb-fed6-4d57-a3e1-1c863ec1bf0f","url":"http://www.last.fm/music/John+Newman/_/Love+Me+Again","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"John Newman","mbid":"589ef702-7f3a-4a1c-8f2c-4727005cfc0e","url":"http://www.last.fm/music/John+Newman"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92990641.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92990641.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92990641.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92990641.png","size":"extralarge"}],"trend":2},{"name":"Viva la Vida","duration":"240","playcount":"20094","listeners":"12434","mbid":"6eb6e977-3fa9-4b9b-b56a-00b6e0e47616","url":"http://www.last.fm/music/Coldplay/_/Viva+la+Vida","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88588929.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88588929.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88588929.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88588929.png","size":"extralarge"}],"trend":2},{"name":"No. 1 Party Anthem","duration":"243","playcount":"21634","listeners":"12367","mbid":"52ba3e3d-157f-400a-a603-6fb00ba3968c","url":"http://www.last.fm/music/Arctic+Monkeys/_/No.+1+Party+Anthem","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":0},{"name":"Instant Crush (feat. Julian Casablancas)","duration":"337","playcount":"20573","listeners":"12357","mbid":"","url":"http://www.last.fm/music/Daft+Punk/_/Instant+Crush+(feat.+Julian+Casablancas)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Daft Punk","mbid":"056e4f3e-d505-4dad-8ec1-d04f521cbb56","url":"http://www.last.fm/music/Daft+Punk"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92459761.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92459761.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92459761.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92459761.png","size":"extralarge"}],"trend":0},{"name":"Where Is My Mind?","duration":"227","playcount":"19492","listeners":"12328","mbid":"8b2384d6-b398-4a43-ad7e-72ec300f2f45","url":"http://www.last.fm/music/Pixies/_/Where+Is+My+Mind%3F","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Pixies","mbid":"b6b2bb8d-54a9-491f-9607-7b546023b433","url":"http://www.last.fm/music/Pixies"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/82423469.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/82423469.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/82423469.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/82423469.png","size":"extralarge"}],"trend":0},{"name":"Always in My Head","duration":"294","playcount":"35830","listeners":"12307","mbid":"5c278fd7-fc78-43f2-b74a-e428ae811ade","url":"http://www.last.fm/music/Coldplay/_/Always+in+My+Head","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97289471.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97289471.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97289471.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97289471.png","size":"extralarge"}],"trend":2},{"name":"Crystalised","duration":"202","playcount":"19673","listeners":"12277","mbid":"c3562dfa-25a1-4058-bf25-655d67bd00e3","url":"http://www.last.fm/music/The+xx/_/Crystalised","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The xx","mbid":"c5c2ea1c-4bde-4f4d-bd0b-47b200bf99d6","url":"http://www.last.fm/music/The+xx"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88381869.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88381869.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88381869.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88381869.png","size":"extralarge"}],"trend":0},{"name":"Ink","duration":"30","playcount":"38467","listeners":"12268","mbid":"ffcc1b43-a189-4125-93b5-e91270ec32cf","url":"http://www.last.fm/music/Coldplay/_/Ink","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97289471.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97289471.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97289471.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97289471.png","size":"extralarge"}],"trend":2},{"name":"My Number","duration":"213","playcount":"19113","listeners":"12247","mbid":"ded51003-df0e-47e0-9bda-6985627bcb88","url":"http://www.last.fm/music/Foals/_/My+Number","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Foals","mbid":"6a65d878-fcd0-42cf-aff9-ca1d636a8bcc","url":"http://www.last.fm/music/Foals"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/86656233.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/86656233.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/86656233.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/86656233.png","size":"extralarge"}],"trend":2},{"name":"Wrecking Ball","duration":"221","playcount":"21812","listeners":"12111","mbid":"4c217d10-029a-487b-86a7-5413f05e1950","url":"http://www.last.fm/music/Miley+Cyrus/_/Wrecking+Ball","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Miley Cyrus","mbid":"7e9bd05a-117f-4cce-87bc-e011527a8b18","url":"http://www.last.fm/music/Miley+Cyrus"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92702859.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92702859.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92702859.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92702859.png","size":"extralarge"}],"trend":2},{"name":"Fluorescent Adolescent","duration":"174","playcount":"20270","listeners":"12101","mbid":"9aab89a3-2b63-4e30-bab9-7994bedaf6b3","url":"http://www.last.fm/music/Arctic+Monkeys/_/Fluorescent+Adolescent","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/33692189.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/33692189.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/33692189.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/33692189.png","size":"extralarge"}],"trend":0},{"name":"Electric Feel","duration":"229","playcount":"17523","listeners":"12102","mbid":"0b19c35d-c8f6-409b-a492-e5da9a7f94c7","url":"http://www.last.fm/music/MGMT/_/Electric+Feel","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"MGMT","mbid":"50e6288e-3db5-4253-ae51-5e8738ef2c31","url":"http://www.last.fm/music/MGMT"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/90424487.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/90424487.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/90424487.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/90424487.png","size":"extralarge"}],"trend":0},{"name":"Skinny Love","duration":"237","playcount":"18877","listeners":"12032","mbid":"e1ed517e-bc4e-4dce-b007-e8ecccede8f3","url":"http://www.last.fm/music/Bon+Iver/_/Skinny+Love","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Bon Iver","mbid":"437a0e49-c6ae-42f6-a6c1-84f25ed366bc","url":"http://www.last.fm/music/Bon+Iver"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93278287.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93278287.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93278287.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93278287.png","size":"extralarge"}],"trend":0},{"name":"Fix You","duration":"295","playcount":"19141","listeners":"11958","mbid":"858618a8-2a0a-408d-8422-c2f0d70ba30f","url":"http://www.last.fm/music/Coldplay/_/Fix+You","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88463793.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88463793.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88463793.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88463793.png","size":"extralarge"}],"trend":2},{"name":"Glory and Gore","duration":"211","playcount":"23457","listeners":"11873","mbid":"a886ee67-ae0e-4dca-8766-11475c131524","url":"http://www.last.fm/music/Lorde/_/Glory+and+Gore","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lorde","mbid":"14cd21f6-df8e-4bff-af75-0dcfeb307c5d","url":"http://www.last.fm/music/Lorde"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93158109.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93158109.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93158109.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93158109.png","size":"extralarge"}],"trend":2},{"name":"Take Me Out","duration":"288","playcount":"17443","listeners":"11843","mbid":"2f5f5cad-f018-4cbf-8254-21d90e05ae1b","url":"http://www.last.fm/music/Franz+Ferdinand/_/Take+Me+Out","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Franz Ferdinand","mbid":"aa7a2827-f74b-473c-bd79-03d065835cf7","url":"http://www.last.fm/music/Franz+Ferdinand"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/51497369.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/51497369.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/51497369.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/51497369.png","size":"extralarge"}],"trend":0},{"name":"Coming of Age","duration":"280","playcount":"19389","listeners":"11849","mbid":"fd15284f-208b-40b7-8c1c-91588b67a14b","url":"http://www.last.fm/music/Foster+the+People/_/Coming+of+Age","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Foster the People","mbid":"e0e1a584-dd0a-4bd1-88d1-c4c62895039d","url":"http://www.last.fm/music/Foster+the+People"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/96064521.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/96064521.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/96064521.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/96064521.png","size":"extralarge"}],"trend":0},{"name":"Get Lucky (Radio Edit) [feat. Pharrell Williams]","duration":"248","playcount":"16899","listeners":"11842","mbid":"","url":"http://www.last.fm/music/Daft+Punk/_/Get+Lucky+(Radio+Edit)+%5Bfeat.+Pharrell+Williams%5D","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Daft Punk","mbid":"056e4f3e-d505-4dad-8ec1-d04f521cbb56","url":"http://www.last.fm/music/Daft+Punk"},"trend":0},{"name":"What You Know","duration":"191","playcount":"19120","listeners":"11834","mbid":"079f085f-a37f-4d23-99cc-1138d22bc6ce","url":"http://www.last.fm/music/Two+Door+Cinema+Club/_/What+You+Know","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Two Door Cinema Club","mbid":"6f1de078-6684-4792-820d-2ffad64c15ed","url":"http://www.last.fm/music/Two+Door+Cinema+Club"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91992741.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91992741.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91992741.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91992741.png","size":"extralarge"}],"trend":0},{"name":"Come as You Are","duration":"219","playcount":"17294","listeners":"11783","mbid":"053ba773-c458-4972-99fa-edfca8fb7fb3","url":"http://www.last.fm/music/Nirvana/_/Come+as+You+Are","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Nirvana","mbid":"5b11f4ce-a62d-471e-81fc-a69a8278c7da","url":"http://www.last.fm/music/Nirvana"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/83456717.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/83456717.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/83456717.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/83456717.png","size":"extralarge"}],"trend":0},{"name":"Can't Remember to Forget You","duration":"207","playcount":"20010","listeners":"11766","mbid":"","url":"http://www.last.fm/music/Shakira/_/Can%27t+Remember+to+Forget+You","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Shakira","mbid":"726cb350-d775-4e07-b006-898555f24b0d","url":"http://www.last.fm/music/Shakira"},"trend":2},{"name":"Ain't It Fun","duration":"202","playcount":"25366","listeners":"11728","mbid":"","url":"http://www.last.fm/music/Paramore/_/Ain%27t+It+Fun","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Paramore","mbid":"44cf61b8-5197-448a-b82b-cef6ee89fac5","url":"http://www.last.fm/music/Paramore"},"trend":0},{"name":"Of the Night","duration":"214","playcount":"21097","listeners":"11701","mbid":"95dbce57-56ee-457b-be66-c2998a804a3a","url":"http://www.last.fm/music/Bastille/_/Of+the+Night","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Bastille","mbid":"16c07e8e-e1ef-452c-bbb7-0cda599c1ffd","url":"http://www.last.fm/music/Bastille"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/94542125.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/94542125.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/94542125.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/94542125.png","size":"extralarge"}],"trend":2},{"name":"I Want It All","duration":"184","playcount":"19932","listeners":"11663","mbid":"86c8c108-a134-467e-ab0f-4f867c2acfac","url":"http://www.last.fm/music/Arctic+Monkeys/_/I+Want+It+All","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":0},{"name":"The Wire","duration":"245","playcount":"19517","listeners":"11653","mbid":"87675a11-6b2a-4034-9bdc-15fc32ef3470","url":"http://www.last.fm/music/HAIM/_/The+Wire","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"HAIM","mbid":"6da01dec-d03c-492f-8f22-3969ea340888","url":"http://www.last.fm/music/HAIM"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92568911.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92568911.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92568911.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92568911.png","size":"extralarge"}],"trend":2},{"name":"In the End","duration":"215","playcount":"19191","listeners":"11560","mbid":"4d2f896d-e16e-4df1-99f5-72db4d1c266c","url":"http://www.last.fm/music/Linkin+Park/_/In+the+End","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Linkin Park","mbid":"f59c5520-5f46-4d2c-b2c4-822eabf53419","url":"http://www.last.fm/music/Linkin+Park"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/63334151.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/63334151.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/63334151.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/63334151.png","size":"extralarge"}],"trend":0},{"name":"Somebody That I Used to Know","duration":"242","playcount":"18747","listeners":"11447","mbid":"f24dd049-a90a-476f-9919-2820ce1c51a5","url":"http://www.last.fm/music/Gotye/_/Somebody+That+I+Used+to+Know","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Gotye","mbid":"6f6fd596-76e0-4b82-aa37-f558ac2d337b","url":"http://www.last.fm/music/Gotye"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/68234032.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/68234032.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/68234032.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/68234032.png","size":"extralarge"}],"trend":0},{"name":"True Love","duration":"239","playcount":"32786","listeners":"11453","mbid":"b4cb134b-9811-49d6-9c69-450f0d6f02ae","url":"http://www.last.fm/music/Coldplay/_/True+Love","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97289471.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97289471.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97289471.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97289471.png","size":"extralarge"}],"trend":2},{"name":"Changes - Original Mix","duration":"345","playcount":"18431","listeners":"11433","mbid":"","url":"http://www.last.fm/music/Faul+&+Wad+Ad+vs.+Pnau/_/Changes+-+Original+Mix","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Faul & Wad Ad vs. Pnau","mbid":"","url":"http://www.last.fm/music/Faul+&+Wad+Ad+vs.+Pnau"},"trend":2},{"name":"We Exist","duration":"344","playcount":"21165","listeners":"11398","mbid":"","url":"http://www.last.fm/music/Arcade+Fire/_/We+Exist","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arcade Fire","mbid":"52074ba6-e495-4ef3-9bb4-0703888a9f68","url":"http://www.last.fm/music/Arcade+Fire"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93250337.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93250337.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93250337.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93250337.png","size":"extralarge"}],"trend":2},{"name":"Dark Paradise","duration":"243","playcount":"22025","listeners":"11365","mbid":"9e3d84e8-9475-4911-ba9c-15c583f9951b","url":"http://www.last.fm/music/Lana+Del+Rey/_/Dark+Paradise","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88340753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88340753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88340753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88340753.png","size":"extralarge"}],"trend":0},{"name":"#SELFIE","duration":"184","playcount":"19968","listeners":"11371","mbid":"ee7b4261-80c2-478f-acee-61b533505584","url":"http://www.last.fm/music/The+Chainsmokers/_/%23SELFIE","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Chainsmokers","mbid":"91a81925-92f9-4fc9-b897-93cf01226282","url":"http://www.last.fm/music/The+Chainsmokers"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98577807.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98577807.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98577807.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98577807.jpg","size":"extralarge"}],"trend":3},{"name":"Yellow","duration":"268","playcount":"17541","listeners":"11317","mbid":"cc72ece1-c7d2-46b7-b9b8-2f274c6d8c0a","url":"http://www.last.fm/music/Coldplay/_/Yellow","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88463661.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88463661.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88463661.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88463661.png","size":"extralarge"}],"trend":2},{"name":"I Got U","duration":"286","playcount":"20203","listeners":"11321","mbid":"","url":"http://www.last.fm/music/Duke+Dumont/_/I+Got+U","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Duke Dumont","mbid":"188437a9-7c29-4b9a-9507-b5a95ab5829a","url":"http://www.last.fm/music/Duke+Dumont"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/95175089.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/95175089.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/95175089.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/95175089.png","size":"extralarge"}],"trend":2},{"name":"Fireside","duration":"181","playcount":"20253","listeners":"11303","mbid":"c4966fc1-b06e-46ba-a070-9c6cec0d9053","url":"http://www.last.fm/music/Arctic+Monkeys/_/Fireside","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":0},{"name":"Tighten Up","duration":"211","playcount":"17842","listeners":"11234","mbid":"bf01cab7-e8de-40de-b79d-966aebc83ec5","url":"http://www.last.fm/music/The+Black+Keys/_/Tighten+Up","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Black Keys","mbid":"d15721d8-56b4-453d-b506-fc915b14cba2","url":"http://www.last.fm/music/The+Black+Keys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/89603041.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/89603041.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/89603041.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/89603041.png","size":"extralarge"}],"trend":2},{"name":"La La La","duration":"222","playcount":"18987","listeners":"11242","mbid":"8bd8872e-3ef9-444a-b2e7-893f10e67e07","url":"http://www.last.fm/music/Naughty+Boy/_/La+La+La","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Naughty Boy","mbid":"1e4460c9-4d4a-4eb7-b2a6-3718e6e1020b","url":"http://www.last.fm/music/Naughty+Boy"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/87916583.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/87916583.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/87916583.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/87916583.png","size":"extralarge"}],"trend":0},{"name":"Song 2","duration":"120","playcount":"16205","listeners":"11230","mbid":"73e2370f-e501-4038-859f-c7c88f5116cc","url":"http://www.last.fm/music/Blur/_/Song+2","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Blur","mbid":"ba853904-ae25-4ebb-89d6-c44cfbd71bd2","url":"http://www.last.fm/music/Blur"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/85634517.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/85634517.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/85634517.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/85634517.png","size":"extralarge"}],"trend":0},{"name":"Chocolate","duration":"225","playcount":"20895","listeners":"11191","mbid":"13c0efea-da70-4ea0-a1a2-978e126995be","url":"http://www.last.fm/music/The+1975/_/Chocolate","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The 1975","mbid":"5b6ebfe0-f72b-4902-bba9-74c8af0f1af0","url":"http://www.last.fm/music/The+1975"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92910831.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92910831.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92910831.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92910831.png","size":"extralarge"}],"trend":0},{"name":"Karma Police","duration":"261","playcount":"17136","listeners":"11173","mbid":"7a5aff92-a14b-4155-8ede-7f961e06814f","url":"http://www.last.fm/music/Radiohead/_/Karma+Police","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Radiohead","mbid":"a74b1b7f-71a5-4011-9441-d0b5e4122711","url":"http://www.last.fm/music/Radiohead"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/99221249.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/99221249.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/99221249.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/99221249.jpg","size":"extralarge"}],"trend":0},{"name":"I Bet You Look Good on the Dancefloor","duration":"175","playcount":"17881","listeners":"11129","mbid":"3b855869-b82b-4b98-91d8-d5e1e0704cc7","url":"http://www.last.fm/music/Arctic+Monkeys/_/I+Bet+You+Look+Good+on+the+Dancefloor","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/32760011.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/32760011.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/32760011.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/32760011.png","size":"extralarge"}],"trend":0},{"name":"Angels","duration":"171","playcount":"19150","listeners":"11104","mbid":"5a091f6c-3eb0-4989-9615-3fce957a72d7","url":"http://www.last.fm/music/The+xx/_/Angels","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The xx","mbid":"c5c2ea1c-4bde-4f4d-bd0b-47b200bf99d6","url":"http://www.last.fm/music/The+xx"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88381961.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88381961.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88381961.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88381961.png","size":"extralarge"}],"trend":0},{"name":"Things We Lost in the Fire","duration":"241","playcount":"21750","listeners":"11058","mbid":"5004a0cf-94df-4e8b-9065-b645f4ea7390","url":"http://www.last.fm/music/Bastille/_/Things+We+Lost+in+the+Fire","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Bastille","mbid":"16c07e8e-e1ef-452c-bbb7-0cda599c1ffd","url":"http://www.last.fm/music/Bastille"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91244823.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91244823.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91244823.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91244823.png","size":"extralarge"}],"trend":0},{"name":"Stay High - Habits Remix","duration":"258","playcount":"20366","listeners":"11028","mbid":"","url":"http://www.last.fm/music/Tove+Lo/_/Stay+High+-+Habits+Remix","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Tove Lo","mbid":"56756959-1e78-429c-b897-e1d056cb0225","url":"http://www.last.fm/music/Tove+Lo"},"trend":0},{"name":"Hold On, We're Going Home","duration":"226","playcount":"16901","listeners":"11016","mbid":"01c976c5-c1e0-4e47-a563-4ce9bd58eb87","url":"http://www.last.fm/music/Drake/_/Hold+On,+We%27re+Going+Home","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Drake","mbid":"7cf5af7a-afa0-4dca-9473-a13508c64e9d","url":"http://www.last.fm/music/Drake"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98230967.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98230967.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98230967.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98230967.png","size":"extralarge"}],"trend":2},{"name":"Home","duration":"306","playcount":"17095","listeners":"10980","mbid":"58ce768b-aa90-47d0-a925-44ed834002eb","url":"http://www.last.fm/music/Edward+Sharpe+&+The+Magnetic+Zeros/_/Home","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Edward Sharpe & The Magnetic Zeros","mbid":"4659a37c-7954-4643-bd83-146aa13ce3e6","url":"http://www.last.fm/music/Edward+Sharpe+&+The+Magnetic+Zeros"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/51705263.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/51705263.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/51705263.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/51705263.png","size":"extralarge"}],"trend":0},{"name":"Blurred Lines","duration":"263","playcount":"16453","listeners":"10977","mbid":"e81efca9-59ec-4325-8638-3fd7f7fcf9fa","url":"http://www.last.fm/music/Robin+Thicke/_/Blurred+Lines","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Robin Thicke","mbid":"c4b5272d-b23a-4ef6-a5d9-ebd717eca81c","url":"http://www.last.fm/music/Robin+Thicke"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/90553053.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/90553053.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/90553053.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/90553053.png","size":"extralarge"}],"trend":2},{"name":"Time to Pretend","duration":"262","playcount":"15907","listeners":"10982","mbid":"02e1b034-057d-4e48-9109-a5295f741d29","url":"http://www.last.fm/music/MGMT/_/Time+to+Pretend","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"MGMT","mbid":"50e6288e-3db5-4253-ae51-5e8738ef2c31","url":"http://www.last.fm/music/MGMT"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/90424487.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/90424487.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/90424487.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/90424487.png","size":"extralarge"}],"trend":0},{"name":"Under the Bridge","duration":"264","playcount":"15632","listeners":"10956","mbid":"64e2d1e3-c721-4ef3-b1f3-706bd0e505a6","url":"http://www.last.fm/music/Red+Hot+Chili+Peppers/_/Under+the+Bridge","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Red Hot Chili Peppers","mbid":"8bfac288-ccc5-448d-9573-c33ea2aa5c30","url":"http://www.last.fm/music/Red+Hot+Chili+Peppers"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/67744128.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/67744128.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/67744128.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/67744128.png","size":"extralarge"}],"trend":0},{"name":"Buzzcut Season","duration":"247","playcount":"22845","listeners":"10926","mbid":"bcaec4d1-fdac-496c-a44d-76d62bf15e4b","url":"http://www.last.fm/music/Lorde/_/Buzzcut+Season","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lorde","mbid":"14cd21f6-df8e-4bff-af75-0dcfeb307c5d","url":"http://www.last.fm/music/Lorde"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93158109.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93158109.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93158109.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93158109.png","size":"extralarge"}],"trend":2},{"name":"400 Lux","duration":"234","playcount":"20712","listeners":"10868","mbid":"07ffb4a6-d57c-4585-a1df-7b7ebadd02f5","url":"http://www.last.fm/music/Lorde/_/400+Lux","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lorde","mbid":"14cd21f6-df8e-4bff-af75-0dcfeb307c5d","url":"http://www.last.fm/music/Lorde"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93158109.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93158109.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93158109.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93158109.png","size":"extralarge"}],"trend":2},{"name":"Budapest","duration":"202","playcount":"19643","listeners":"10865","mbid":"b0a58203-f55a-423e-9055-4a9220d258df","url":"http://www.last.fm/music/George+Ezra/_/Budapest","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"George Ezra","mbid":"2c5e2a98-d9ea-46b5-9618-d9bb4863a920","url":"http://www.last.fm/music/George+Ezra"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/95403731.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/95403731.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/95403731.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/95403731.png","size":"extralarge"}],"trend":0},{"name":"Red Lights","duration":"264","playcount":"18758","listeners":"10819","mbid":"c1fb50f3-422a-41d2-ae93-85b88f5bbc32","url":"http://www.last.fm/music/Ti%C3%ABsto/_/Red+Lights","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Tiësto","mbid":"163a0256-f137-4b6f-8922-77941cbb9532","url":"http://www.last.fm/music/Ti%C3%ABsto"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97390117.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97390117.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97390117.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97390117.png","size":"extralarge"}],"trend":2},{"name":"Another's Arms","duration":"","playcount":"31509","listeners":"10815","mbid":"","url":"http://www.last.fm/music/Coldplay/_/Another%27s+Arms","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"trend":2},{"name":"Classic","duration":"175","playcount":"20004","listeners":"10793","mbid":"6399c732-2c8f-4c69-ad6a-ee99cf313b2d","url":"http://www.last.fm/music/MKTO/_/Classic","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"MKTO","mbid":"aa25521e-3848-4ff7-ab09-545cc95b8a36","url":"http://www.last.fm/music/MKTO"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/90760893.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/90760893.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/90760893.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/90760893.png","size":"extralarge"}],"trend":0},{"name":"Off to the Races","duration":"300","playcount":"20481","listeners":"10750","mbid":"9dd2278c-4d63-4607-9c0f-4a75033f35c1","url":"http://www.last.fm/music/Lana+Del+Rey/_/Off+to+the+Races","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88340753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88340753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88340753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88340753.png","size":"extralarge"}],"trend":0},{"name":"Everlong","duration":"249","playcount":"16036","listeners":"10733","mbid":"faf3057d-6ee5-4859-8c5f-a016e2cafca4","url":"http://www.last.fm/music/Foo+Fighters/_/Everlong","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Foo Fighters","mbid":"67f66c07-6e61-4026-ade5-7e782fad3a5d","url":"http://www.last.fm/music/Foo+Fighters"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/69591230.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/69591230.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/69591230.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/69591230.png","size":"extralarge"}],"trend":0},{"name":"Dirty Paws","duration":"272","playcount":"17583","listeners":"10658","mbid":"f4b2219f-81f4-4ed8-bf6c-baf39db901ab","url":"http://www.last.fm/music/Of+Monsters+and+Men/_/Dirty+Paws","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Of Monsters and Men","mbid":"9e103f85-7af7-41d7-b83b-49ba8f0c5abf","url":"http://www.last.fm/music/Of+Monsters+and+Men"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/84421449.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/84421449.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/84421449.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/84421449.png","size":"extralarge"}],"trend":0},{"name":"Numb","duration":"186","playcount":"17476","listeners":"10654","mbid":"3b946820-d8eb-44d0-8dc9-8d6588077697","url":"http://www.last.fm/music/Linkin+Park/_/Numb","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Linkin Park","mbid":"f59c5520-5f46-4d2c-b2c4-822eabf53419","url":"http://www.last.fm/music/Linkin+Park"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/52490659.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/52490659.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/52490659.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/52490659.png","size":"extralarge"}],"trend":0},{"name":"She Looks So Perfect","duration":"203","playcount":"24807","listeners":"10652","mbid":"e34f81c9-de1d-4845-98da-8dfc91276692","url":"http://www.last.fm/music/5+Seconds+of+Summer/_/She+Looks+So+Perfect","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"5 Seconds of Summer","mbid":"830e5c4e-6b7d-431d-86ab-00c751281dc5","url":"http://www.last.fm/music/5+Seconds+of+Summer"},"image":[{"#text":"http://cdn.last.fm/flatness/catalogue/noimage/2/default_album_medium.png","size":"small"},{"#text":"http://cdn.last.fm/flatness/catalogue/noimage/2/default_album_medium.png","size":"medium"},{"#text":"http://cdn.last.fm/flatness/catalogue/noimage/2/default_album_medium.png","size":"large"},{"#text":"http://cdn.last.fm/flatness/catalogue/noimage/2/default_album_medium.png","size":"extralarge"}],"trend":2},{"name":"Young Blood","duration":"247","playcount":"16569","listeners":"10647","mbid":"137d85b3-ddd7-4811-9c03-94dd63eac593","url":"http://www.last.fm/music/The+Naked+and+Famous/_/Young+Blood","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Naked and Famous","mbid":"216a7b44-3846-494c-93f5-f2d4d9b95b36","url":"http://www.last.fm/music/The+Naked+and+Famous"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/51383895.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/51383895.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/51383895.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/51383895.png","size":"extralarge"}],"trend":2},{"name":"Islands","duration":"160","playcount":"16667","listeners":"10622","mbid":"be80834d-9fe0-40a8-a947-5388ea045989","url":"http://www.last.fm/music/The+xx/_/Islands","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The xx","mbid":"c5c2ea1c-4bde-4f4d-bd0b-47b200bf99d6","url":"http://www.last.fm/music/The+xx"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88381869.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88381869.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88381869.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88381869.png","size":"extralarge"}],"trend":0},{"name":"Sweet Disposition","duration":"230","playcount":"15911","listeners":"10599","mbid":"68226d28-1e2e-493d-b943-450c18b8b91a","url":"http://www.last.fm/music/The+Temper+Trap/_/Sweet+Disposition","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Temper Trap","mbid":"bb6eaced-69dd-4636-829f-9f987acc4fc3","url":"http://www.last.fm/music/The+Temper+Trap"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/43091673.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/43091673.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/43091673.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/43091673.png","size":"extralarge"}],"trend":0},{"name":"Mad Sounds","duration":"199","playcount":"17335","listeners":"10559","mbid":"eaa22014-18b8-4de2-8383-f69ee50c6a2f","url":"http://www.last.fm/music/Arctic+Monkeys/_/Mad+Sounds","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92744747.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92744747.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92744747.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92744747.png","size":"extralarge"}],"trend":0},{"name":"Chop Suey!","duration":"209","playcount":"16292","listeners":"10540","mbid":"e5ff92b7-cb82-4ca8-91a9-e595ff6517c5","url":"http://www.last.fm/music/System+of+a+Down/_/Chop+Suey!","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"System of a Down","mbid":"cc0b7089-c08d-4c10-b6b0-873582c17fd6","url":"http://www.last.fm/music/System+of+a+Down"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/81673107.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/81673107.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/81673107.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/81673107.png","size":"extralarge"}],"trend":0},{"name":"Red Eyes","duration":"299","playcount":"17565","listeners":"10504","mbid":"16530cb5-26d0-44a1-b7b4-a4fda7df8688","url":"http://www.last.fm/music/The+War+on+Drugs/_/Red+Eyes","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The War on Drugs","mbid":"87b9b3b8-ab93-426c-a200-4012d667a626","url":"http://www.last.fm/music/The+War+on+Drugs"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97376541.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97376541.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97376541.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97376541.png","size":"extralarge"}],"trend":2},{"name":"Somebody Told Me","duration":"198","playcount":"16234","listeners":"10493","mbid":"8e350594-c241-4d0d-8a4d-2b8d55e166f9","url":"http://www.last.fm/music/The+Killers/_/Somebody+Told+Me","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Killers","mbid":"24b4aee8-32ed-4163-98f7-55bae67411ae","url":"http://www.last.fm/music/The+Killers"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/68101062.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/68101062.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/68101062.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/68101062.png","size":"extralarge"}],"trend":0},{"name":"Say Something","duration":"231","playcount":"18513","listeners":"10405","mbid":"f7733afa-153e-4c5d-a481-9d7d0088e8ba","url":"http://www.last.fm/music/A+Great+Big+World/_/Say+Something","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"A Great Big World","mbid":"6958e806-1e14-4844-a0a7-07a27756aa0f","url":"http://www.last.fm/music/A+Great+Big+World"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/95754165.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/95754165.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/95754165.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/95754165.png","size":"extralarge"}],"trend":2},{"name":"Ride","duration":"289","playcount":"20943","listeners":"10350","mbid":"00f481e6-9e98-4cbf-ac05-6c885175018b","url":"http://www.last.fm/music/Lana+Del+Rey/_/Ride","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/82268821.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/82268821.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/82268821.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/82268821.png","size":"extralarge"}],"trend":0},{"name":"Mirrors","duration":"484","playcount":"17714","listeners":"10345","mbid":"024474c3-8c36-41b8-9524-6acd967895cd","url":"http://www.last.fm/music/Justin+Timberlake/_/Mirrors","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Justin Timberlake","mbid":"11ed83a4-0097-4322-aa1e-8fea09def405","url":"http://www.last.fm/music/Justin+Timberlake"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/87945843.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/87945843.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/87945843.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/87945843.png","size":"extralarge"}],"trend":2},{"name":"Drunk in Love","duration":"200","playcount":"16519","listeners":"10284","mbid":"","url":"http://www.last.fm/music/Beyonc%C3%A9/_/Drunk+in+Love","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Beyoncé","mbid":"183105b5-3e68-4748-9086-2c1c11bf7a3d","url":"http://www.last.fm/music/Beyonc%C3%A9"},"trend":2},{"name":"Scar Tissue","duration":"217","playcount":"15106","listeners":"10260","mbid":"0a640d3e-caa0-4e55-b63f-135a933f3852","url":"http://www.last.fm/music/Red+Hot+Chili+Peppers/_/Scar+Tissue","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Red Hot Chili Peppers","mbid":"8bfac288-ccc5-448d-9573-c33ea2aa5c30","url":"http://www.last.fm/music/Red+Hot+Chili+Peppers"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/42739473.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/42739473.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/42739473.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/42739473.png","size":"extralarge"}],"trend":2},{"name":"Clocks","duration":"307","playcount":"15116","listeners":"10187","mbid":"3c4ae40f-b53b-46d7-a041-b39f57d600e3","url":"http://www.last.fm/music/Coldplay/_/Clocks","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88463753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88463753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88463753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88463753.png","size":"extralarge"}],"trend":2},{"name":"Dog Days Are Over","duration":"253","playcount":"15867","listeners":"10163","mbid":"772ea437-45b3-4868-b3c0-b80526ef0fa3","url":"http://www.last.fm/music/Florence+%252B+the+Machine/_/Dog+Days+Are+Over","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Florence + the Machine","mbid":"227b39fc-23f6-40f5-b8a1-75100d5baad4","url":"http://www.last.fm/music/Florence+%252B+the+Machine"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/58219263.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/58219263.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/58219263.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/58219263.png","size":"extralarge"}],"trend":0},{"name":"Partition","duration":"90","playcount":"22732","listeners":"10174","mbid":"c54734b9-984f-48d3-be19-dd91620e4553","url":"http://www.last.fm/music/Beyonc%C3%A9/_/Partition","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Beyoncé","mbid":"183105b5-3e68-4748-9086-2c1c11bf7a3d","url":"http://www.last.fm/music/Beyonc%C3%A9"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98570479.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98570479.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98570479.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98570479.png","size":"extralarge"}],"trend":2},{"name":"Applause","duration":"212","playcount":"20632","listeners":"10112","mbid":"01851061-0ba5-4b9b-9a50-ff98621e8e33","url":"http://www.last.fm/music/Lady+Gaga/_/Applause","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lady Gaga","mbid":"650e7db6-b795-4eb5-a702-5ea2fc46c848","url":"http://www.last.fm/music/Lady+Gaga"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93681345.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93681345.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93681345.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93681345.png","size":"extralarge"}],"trend":0},{"name":"Recover","duration":"224","playcount":"17117","listeners":"10057","mbid":"33a2b38a-0544-4644-9cbc-4e76cc02e2ec","url":"http://www.last.fm/music/CHVRCHES/_/Recover","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"CHVRCHES","mbid":"6a93afbb-257f-4166-b389-9f2a1e5c5df8","url":"http://www.last.fm/music/CHVRCHES"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92085853.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92085853.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92085853.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92085853.png","size":"extralarge"}],"trend":0},{"name":"Oceans","duration":"219","playcount":"26134","listeners":"10026","mbid":"4f11e0e7-185e-4103-9416-a45953bf0f8d","url":"http://www.last.fm/music/Coldplay/_/Oceans","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97289471.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97289471.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97289471.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97289471.png","size":"extralarge"}],"trend":2},{"name":"Shake It Out","duration":"278","playcount":"15203","listeners":"10007","mbid":"dea77e5e-0aac-426c-b241-90b690f2f1e5","url":"http://www.last.fm/music/Florence+%252B+the+Machine/_/Shake+It+Out","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Florence + the Machine","mbid":"227b39fc-23f6-40f5-b8a1-75100d5baad4","url":"http://www.last.fm/music/Florence+%252B+the+Machine"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/68930602.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/68930602.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/68930602.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/68930602.png","size":"extralarge"}],"trend":0},{"name":"Enter Sandman","duration":"331","playcount":"15132","listeners":"10004","mbid":"0d3dc069-4de2-4c87-a775-89d16b960043","url":"http://www.last.fm/music/Metallica/_/Enter+Sandman","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Metallica","mbid":"65f4f0c5-ef9e-490c-aee3-909e7ae6b2ab","url":"http://www.last.fm/music/Metallica"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/27383399.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/27383399.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/27383399.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/27383399.jpg","size":"extralarge"}],"trend":0},{"name":"Unbelievers","duration":"215","playcount":"14956","listeners":"9996","mbid":"5b4530ed-4a5f-4b61-aa67-801cb5303f4e","url":"http://www.last.fm/music/Vampire+Weekend/_/Unbelievers","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Vampire Weekend","mbid":"af37c51c-0790-4a29-b995-456f98a6b8c9","url":"http://www.last.fm/music/Vampire+Weekend"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92503657.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92503657.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92503657.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92503657.png","size":"extralarge"}],"trend":0},{"name":"Feels Like We Only Go Backwards","duration":"193","playcount":"18388","listeners":"9992","mbid":"840ee495-12ef-45cf-b8a0-d447f548de60","url":"http://www.last.fm/music/Tame+Impala/_/Feels+Like+We+Only+Go+Backwards","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Tame Impala","mbid":"63aa26c3-d59b-4da4-84ac-716b54f1ef4d","url":"http://www.last.fm/music/Tame+Impala"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/81756565.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/81756565.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/81756565.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/81756565.png","size":"extralarge"}],"trend":2},{"name":"Taking Chances","duration":"232","playcount":"18467","listeners":"9982","mbid":"65d3eb05-b6d6-4380-9005-6920b326983c","url":"http://www.last.fm/music/Sharon+Van+Etten/_/Taking+Chances","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Sharon Van Etten","mbid":"5a2e9cd3-010a-4aae-9f83-629253284202","url":"http://www.last.fm/music/Sharon+Van+Etten"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97625921.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97625921.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97625921.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97625921.png","size":"extralarge"}],"trend":3},{"name":"I Never Learn","duration":"650","playcount":"20793","listeners":"9961","mbid":"dc560042-7986-4fd7-b162-a6cc6f5d630d","url":"http://www.last.fm/music/Lykke+Li/_/I+Never+Learn","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lykke Li","mbid":"cc7d4686-ea02-45fd-956e-94c1a322558c","url":"http://www.last.fm/music/Lykke+Li"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97695169.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97695169.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97695169.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97695169.png","size":"extralarge"}],"trend":2},{"name":"Stairway to Heaven","duration":"480","playcount":"15373","listeners":"9910","mbid":"ccbf4fcc-85d0-4fe1-9e41-04561e5e0549","url":"http://www.last.fm/music/Led+Zeppelin/_/Stairway+to+Heaven","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Led Zeppelin","mbid":"678d88b2-87b0-403b-b63d-5da7465aecc3","url":"http://www.last.fm/music/Led+Zeppelin"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/78946605.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/78946605.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/78946605.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/78946605.png","size":"extralarge"}],"trend":2},{"name":"Walking on a Dream","duration":"196","playcount":"14088","listeners":"9898","mbid":"006e7c3b-e360-4ff9-abae-62df60370890","url":"http://www.last.fm/music/Empire+of+the+Sun/_/Walking+on+a+Dream","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Empire of the Sun","mbid":"ac7e838c-3d95-47c2-92a9-81767ad7c217","url":"http://www.last.fm/music/Empire+of+the+Sun"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/77717248.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/77717248.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/77717248.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/77717248.png","size":"extralarge"}],"trend":0},{"name":"Lose Yourself to Dance (feat. Pharrell Williams)","duration":"353","playcount":"15724","listeners":"9892","mbid":"","url":"http://www.last.fm/music/Daft+Punk/_/Lose+Yourself+to+Dance+(feat.+Pharrell+Williams)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Daft Punk","mbid":"056e4f3e-d505-4dad-8ec1-d04f521cbb56","url":"http://www.last.fm/music/Daft+Punk"},"trend":2},{"name":"Otherside","duration":"255","playcount":"14346","listeners":"9867","mbid":"91cd4e60-514a-464c-95dd-47d553b02e87","url":"http://www.last.fm/music/Red+Hot+Chili+Peppers/_/Otherside","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Red Hot Chili Peppers","mbid":"8bfac288-ccc5-448d-9573-c33ea2aa5c30","url":"http://www.last.fm/music/Red+Hot+Chili+Peppers"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/42739473.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/42739473.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/42739473.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/42739473.png","size":"extralarge"}],"trend":0},{"name":"I Will Never Let You Down","duration":"203","playcount":"28195","listeners":"9877","mbid":"9d062ad8-a99b-4ac1-8e16-1ab1e7d69a20","url":"http://www.last.fm/music/Rita+Ora/_/I+Will+Never+Let+You+Down","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Rita Ora","mbid":"c9dd033c-0270-463c-b3ec-f4b7712486fe","url":"http://www.last.fm/music/Rita+Ora"},"trend":0},{"name":"Madness","duration":"279","playcount":"15322","listeners":"9852","mbid":"826b8640-29b5-47aa-bc44-bb7b1e66eff1","url":"http://www.last.fm/music/Muse/_/Madness","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Muse","mbid":"1695c115-bf3f-4014-9966-2b0c50179193","url":"http://www.last.fm/music/Muse"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/80945949.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/80945949.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/80945949.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/80945949.png","size":"extralarge"}],"trend":0},{"name":"Afterlife","duration":"353","playcount":"16731","listeners":"9849","mbid":"","url":"http://www.last.fm/music/Arcade+Fire/_/Afterlife","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arcade Fire","mbid":"52074ba6-e495-4ef3-9bb4-0703888a9f68","url":"http://www.last.fm/music/Arcade+Fire"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93250337.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93250337.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93250337.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93250337.png","size":"extralarge"}],"trend":0},{"name":"Locked Out of Heaven","duration":"234","playcount":"15958","listeners":"9842","mbid":"a8501ac3-10e0-48ee-8e23-a954f1f8b273","url":"http://www.last.fm/music/Bruno+Mars/_/Locked+Out+of+Heaven","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Bruno Mars","mbid":"afb680f2-b6eb-4cd7-a70b-a63b25c763d5","url":"http://www.last.fm/music/Bruno+Mars"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92206107.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92206107.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92206107.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92206107.png","size":"extralarge"}],"trend":0},{"name":"Gunshot","duration":"196","playcount":"20111","listeners":"9838","mbid":"d247b9af-45e9-4813-9293-2b1a5a47dfef","url":"http://www.last.fm/music/Lykke+Li/_/Gunshot","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lykke Li","mbid":"cc7d4686-ea02-45fd-956e-94c1a322558c","url":"http://www.last.fm/music/Lykke+Li"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97695169.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97695169.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97695169.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97695169.png","size":"extralarge"}],"trend":2},{"name":"XO","duration":"216","playcount":"20180","listeners":"9830","mbid":"d0d9670a-b485-49d6-bf54-e7ed45a7642c","url":"http://www.last.fm/music/Beyonc%C3%A9/_/XO","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Beyoncé","mbid":"183105b5-3e68-4748-9086-2c1c11bf7a3d","url":"http://www.last.fm/music/Beyonc%C3%A9"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98570479.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98570479.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98570479.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98570479.png","size":"extralarge"}],"trend":0},{"name":"Rolling in the Deep","duration":"228","playcount":"14570","listeners":"9774","mbid":"092a88bc-af0b-4ddd-a3a1-17ad37abfccb","url":"http://www.last.fm/music/Adele/_/Rolling+in+the+Deep","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Adele","mbid":"1de93a63-3a9f-443a-ba8a-a43b5fe0121e","url":"http://www.last.fm/music/Adele"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/79993209.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/79993209.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/79993209.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/79993209.png","size":"extralarge"}],"trend":0},{"name":"Ribs","duration":"259","playcount":"19578","listeners":"9772","mbid":"393bab53-fedf-41fb-a2b9-5527eacec849","url":"http://www.last.fm/music/Lorde/_/Ribs","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lorde","mbid":"14cd21f6-df8e-4bff-af75-0dcfeb307c5d","url":"http://www.last.fm/music/Lorde"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93158109.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93158109.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93158109.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93158109.png","size":"extralarge"}],"trend":2},{"name":"Fancy (feat. Charli XCX)","duration":"169","playcount":"46536","listeners":"9758","mbid":"","url":"http://www.last.fm/music/Iggy+Azalea/_/Fancy+(feat.+Charli+XCX)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Iggy Azalea","mbid":"3a052c99-8c18-484a-8beb-9873b4fb3106","url":"http://www.last.fm/music/Iggy+Azalea"},"trend":0},{"name":"Losing My Religion","duration":"268","playcount":"14467","listeners":"9736","mbid":"2cfb096c-91ae-4a84-bf90-a818950f846d","url":"http://www.last.fm/music/R.E.M./_/Losing+My+Religion","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"R.E.M.","mbid":"ea4dfa26-f633-4da6-a52a-f49ea4897b58","url":"http://www.last.fm/music/R.E.M."},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/96506699.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/96506699.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/96506699.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/96506699.png","size":"extralarge"}],"trend":2},{"name":"Black Skinhead","duration":"188","playcount":"15943","listeners":"9729","mbid":"731ddb5c-6e2e-4cae-badd-52b61b252ce4","url":"http://www.last.fm/music/Kanye+West/_/Black+Skinhead","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Kanye West","mbid":"164f0d73-1234-4e2c-8743-d77bf2191051","url":"http://www.last.fm/music/Kanye+West"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/96481285.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/96481285.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/96481285.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/96481285.png","size":"extralarge"}],"trend":0},{"name":"Afraid of Nothing","duration":"247","playcount":"17652","listeners":"9618","mbid":"57058425-019a-4df9-a9aa-bbc5fb649df2","url":"http://www.last.fm/music/Sharon+Van+Etten/_/Afraid+of+Nothing","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Sharon Van Etten","mbid":"5a2e9cd3-010a-4aae-9f83-629253284202","url":"http://www.last.fm/music/Sharon+Van+Etten"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97625921.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97625921.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97625921.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97625921.png","size":"extralarge"}],"trend":3},{"name":"Reptilia","duration":"219","playcount":"14538","listeners":"9576","mbid":"","url":"http://www.last.fm/music/The+Strokes/_/Reptilia","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Strokes","mbid":"f181961b-20f7-459e-89de-920ef03c7ed0","url":"http://www.last.fm/music/The+Strokes"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/37849317.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/37849317.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/37849317.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/37849317.png","size":"extralarge"}],"trend":0},{"name":"Teardrop","duration":"332","playcount":"13974","listeners":"9536","mbid":"03b2cbfb-8765-4b93-8ede-0c3b0a07296a","url":"http://www.last.fm/music/Massive+Attack/_/Teardrop","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Massive Attack","mbid":"10adbe5e-a2c0-4bf3-8249-2b4cbf6e6ca8","url":"http://www.last.fm/music/Massive+Attack"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/38150483.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/38150483.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/38150483.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/38150483.png","size":"extralarge"}],"trend":0},{"name":"The Monster","duration":"250","playcount":"16033","listeners":"9525","mbid":"","url":"http://www.last.fm/music/Eminem/_/The+Monster","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Eminem","mbid":"b95ce3ff-3d05-4e87-9e01-c97b66af13d4","url":"http://www.last.fm/music/Eminem"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98147285.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98147285.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98147285.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98147285.jpg","size":"extralarge"}],"trend":2},{"name":"Radio","duration":"215","playcount":"18291","listeners":"9504","mbid":"d03d47bf-0005-4445-af16-887db5980014","url":"http://www.last.fm/music/Lana+Del+Rey/_/Radio","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88340753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88340753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88340753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88340753.png","size":"extralarge"}],"trend":0},{"name":"Jealous (I Ain't With It)","duration":"228","playcount":"18563","listeners":"9509","mbid":"","url":"http://www.last.fm/music/Chromeo/_/Jealous+(I+Ain%27t+With+It)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Chromeo","mbid":"13f2e9fe-be3c-498d-a22d-b4ed5f0ffefc","url":"http://www.last.fm/music/Chromeo"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97973907.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97973907.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97973907.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97973907.png","size":"extralarge"}],"trend":2},{"name":"O","duration":"275","playcount":"26773","listeners":"9504","mbid":"4733b01f-0caf-43a2-aa41-3ef2e3992432","url":"http://www.last.fm/music/Coldplay/_/O","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Coldplay","mbid":"cc197bad-dc9c-440d-a5b5-d52ba2e14234","url":"http://www.last.fm/music/Coldplay"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97289471.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97289471.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97289471.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97289471.png","size":"extralarge"}],"trend":2},{"name":"Youth","duration":"249","playcount":"16761","listeners":"9481","mbid":"5dc34c95-63a5-4273-9e2b-74b2a6561eb7","url":"http://www.last.fm/music/Daughter/_/Youth","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Daughter","mbid":"1a02ce2f-2330-4ea9-b639-a7c6bebdf378","url":"http://www.last.fm/music/Daughter"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92986323.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92986323.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92986323.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92986323.png","size":"extralarge"}],"trend":3},{"name":"Diet Mountain Dew","duration":"223","playcount":"17466","listeners":"9475","mbid":"13a13f72-3637-4b8e-9204-940ebddcd264","url":"http://www.last.fm/music/Lana+Del+Rey/_/Diet+Mountain+Dew","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88340753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88340753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88340753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88340753.png","size":"extralarge"}],"trend":0},{"name":"Do It Again","duration":"307","playcount":"18891","listeners":"9464","mbid":"","url":"http://www.last.fm/music/R%C3%B6yksopp/_/Do+It+Again","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Röyksopp","mbid":"1c70a3fc-fa3c-4be1-8b55-c3192db8a884","url":"http://www.last.fm/music/R%C3%B6yksopp"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98250641.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98250641.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98250641.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98250641.jpg","size":"extralarge"}],"trend":2},{"name":"The A Team","duration":"260","playcount":"15523","listeners":"9343","mbid":"3c7eba4f-6fc0-4439-a703-cb299b07f63a","url":"http://www.last.fm/music/Ed+Sheeran/_/The+A+Team","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Ed Sheeran","mbid":"3bca1168-e7c6-4beb-9af9-db9dc674b1fa","url":"http://www.last.fm/music/Ed+Sheeran"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88259807.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88259807.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88259807.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88259807.png","size":"extralarge"}],"trend":0},{"name":"Marilyn Monroe","duration":"351","playcount":"17326","listeners":"9340","mbid":"13563054-a53b-424b-8050-bf4b7b489e7e","url":"http://www.last.fm/music/Pharrell+Williams/_/Marilyn+Monroe","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Pharrell Williams","mbid":"149f91ef-1287-46da-9a8e-87fee02f1471","url":"http://www.last.fm/music/Pharrell+Williams"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97009161.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97009161.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97009161.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97009161.png","size":"extralarge"}],"trend":0},{"name":"1901","duration":"193","playcount":"13556","listeners":"9273","mbid":"b3581bfd-64dd-48c2-ace6-8873823b4b39","url":"http://www.last.fm/music/Phoenix/_/1901","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Phoenix","mbid":"02f4c1ff-65e0-4412-8e8b-6239b0faecb5","url":"http://www.last.fm/music/Phoenix"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/53574933.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/53574933.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/53574933.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/53574933.png","size":"extralarge"}],"trend":0},{"name":"Hard Out Here","duration":"262","playcount":"19327","listeners":"9275","mbid":"b229f5a9-593e-4392-95db-a8d24e11796b","url":"http://www.last.fm/music/Lily+Allen/_/Hard+Out+Here","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lily Allen","mbid":"365e73ae-808c-4b0f-a313-74f302cb6911","url":"http://www.last.fm/music/Lily+Allen"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/94682661.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/94682661.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/94682661.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/94682661.png","size":"extralarge"}],"trend":2},{"name":"Falling","duration":"257","playcount":"15941","listeners":"9256","mbid":"a7abdede-5010-452c-a130-766d71a15f6e","url":"http://www.last.fm/music/HAIM/_/Falling","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"HAIM","mbid":"6da01dec-d03c-492f-8f22-3969ea340888","url":"http://www.last.fm/music/HAIM"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92568911.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92568911.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92568911.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92568911.png","size":"extralarge"}],"trend":2},{"name":"Monument","duration":"598","playcount":"24577","listeners":"9220","mbid":"0bf8fe0e-40c8-4cc5-805e-59e16d57c6c5","url":"http://www.last.fm/music/R%C3%B6yksopp+&+Robyn/_/Monument","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Röyksopp & Robyn","mbid":"","url":"http://www.last.fm/music/R%C3%B6yksopp+&+Robyn"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98517489.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98517489.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98517489.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98517489.png","size":"extralarge"}],"trend":3},{"name":"G.U.Y.","duration":"233","playcount":"24198","listeners":"9212","mbid":"575d4e21-9d41-43e3-a001-1df583de26fa","url":"http://www.last.fm/music/Lady+Gaga/_/G.U.Y.","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lady Gaga","mbid":"650e7db6-b795-4eb5-a702-5ea2fc46c848","url":"http://www.last.fm/music/Lady+Gaga"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93681345.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93681345.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93681345.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93681345.png","size":"extralarge"}],"trend":2},{"name":"Use Somebody","duration":"231","playcount":"13904","listeners":"9185","mbid":"c92c41c8-8792-4acb-a744-c97d900b3e1c","url":"http://www.last.fm/music/Kings+of+Leon/_/Use+Somebody","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Kings of Leon","mbid":"6ffb8ea9-2370-44d8-b678-e9237bbd347b","url":"http://www.last.fm/music/Kings+of+Leon"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/81102241.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/81102241.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/81102241.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/81102241.png","size":"extralarge"}],"trend":0},{"name":"I Will Wait","duration":"277","playcount":"14089","listeners":"9160","mbid":"2150fd47-7367-419e-8865-03baaccbcdad","url":"http://www.last.fm/music/Mumford+&+Sons/_/I+Will+Wait","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Mumford & Sons","mbid":"c44e9c22-ef82-4a77-9bcd-af6c958446d6","url":"http://www.last.fm/music/Mumford+&+Sons"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/81291929.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/81291929.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/81291929.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/81291929.png","size":"extralarge"}],"trend":2},{"name":"The Pretender","duration":"268","playcount":"13753","listeners":"9142","mbid":"68046840-4171-4e11-b23c-d58135197e13","url":"http://www.last.fm/music/Foo+Fighters/_/The+Pretender","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Foo Fighters","mbid":"67f66c07-6e61-4026-ade5-7e782fad3a5d","url":"http://www.last.fm/music/Foo+Fighters"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/83693587.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/83693587.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/83693587.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/83693587.png","size":"extralarge"}],"trend":0},{"name":"Clint Eastwood","duration":"339","playcount":"13590","listeners":"9130","mbid":"25809ba7-d61a-44c7-8f5f-ebe86068bdb5","url":"http://www.last.fm/music/Gorillaz/_/Clint+Eastwood","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Gorillaz","mbid":"e21857d5-3256-4547-afb3-4b6ded592596","url":"http://www.last.fm/music/Gorillaz"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/24507751.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/24507751.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/24507751.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/24507751.png","size":"extralarge"}],"trend":0},{"name":"No Surprises","duration":"229","playcount":"13923","listeners":"9132","mbid":"6bb29353-ba61-4c5a-85ff-f33693808dc3","url":"http://www.last.fm/music/Radiohead/_/No+Surprises","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Radiohead","mbid":"a74b1b7f-71a5-4011-9441-d0b5e4122711","url":"http://www.last.fm/music/Radiohead"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/99221249.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/99221249.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/99221249.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/99221249.jpg","size":"extralarge"}],"trend":0},{"name":"Wasted","duration":"188","playcount":"16272","listeners":"9129","mbid":"","url":"http://www.last.fm/music/Ti%C3%ABsto/_/Wasted","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Tiësto","mbid":"163a0256-f137-4b6f-8922-77941cbb9532","url":"http://www.last.fm/music/Ti%C3%ABsto"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98431879.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98431879.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98431879.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98431879.png","size":"extralarge"}],"trend":0},{"name":"Don't Stop Believin'","duration":"250","playcount":"12970","listeners":"9070","mbid":"7a6403fb-c546-450e-ac72-490dc195b742","url":"http://www.last.fm/music/Journey/_/Don%27t+Stop+Believin%27","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Journey","mbid":"a26ff336-32ef-4adc-a800-3581c9a517a9","url":"http://www.last.fm/music/Journey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/5915773.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/5915773.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/5915773.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/5915773.jpg","size":"extralarge"}],"trend":0},{"name":"Do What U Want","duration":"217","playcount":"18066","listeners":"9082","mbid":"84690131-b024-4358-90ea-27383890d00d","url":"http://www.last.fm/music/Lady+Gaga/_/Do+What+U+Want","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lady Gaga","mbid":"650e7db6-b795-4eb5-a702-5ea2fc46c848","url":"http://www.last.fm/music/Lady+Gaga"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98135107.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98135107.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98135107.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98135107.jpg","size":"extralarge"}],"trend":2},{"name":"Problem (feat. Iggy Azalea)","duration":"55","playcount":"53694","listeners":"9086","mbid":"","url":"http://www.last.fm/music/Ariana+Grande/_/Problem+(feat.+Iggy+Azalea)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Ariana Grande","mbid":"f4fdbb4c-e4b7-47a0-b83b-d91bbfcfa387","url":"http://www.last.fm/music/Ariana+Grande"},"trend":0},{"name":"Gold on the Ceiling","duration":"224","playcount":"14277","listeners":"9063","mbid":"eb3357e8-3e1e-45b3-ad4f-5cf9e0e99190","url":"http://www.last.fm/music/The+Black+Keys/_/Gold+on+the+Ceiling","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Black Keys","mbid":"d15721d8-56b4-453d-b506-fc915b14cba2","url":"http://www.last.fm/music/The+Black+Keys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/71475018.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/71475018.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/71475018.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/71475018.png","size":"extralarge"}],"trend":2},{"name":"A-Punk","duration":"137","playcount":"13261","listeners":"9049","mbid":"3a2a9ca7-93e7-47d0-b9f1-6119da81a8b7","url":"http://www.last.fm/music/Vampire+Weekend/_/A-Punk","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Vampire Weekend","mbid":"af37c51c-0790-4a29-b995-456f98a6b8c9","url":"http://www.last.fm/music/Vampire+Weekend"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/69597994.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/69597994.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/69597994.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/69597994.png","size":"extralarge"}],"trend":2},{"name":"Last Nite","duration":"193","playcount":"12788","listeners":"8978","mbid":"3a3042ee-0083-4164-be82-77271d4a405f","url":"http://www.last.fm/music/The+Strokes/_/Last+Nite","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Strokes","mbid":"f181961b-20f7-459e-89de-920ef03c7ed0","url":"http://www.last.fm/music/The+Strokes"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/72672492.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/72672492.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/72672492.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/72672492.png","size":"extralarge"}],"trend":0},{"name":"Tessellate","duration":"183","playcount":"14660","listeners":"8977","mbid":"c03d0c17-b702-4cd9-82b4-7361008f0933","url":"http://www.last.fm/music/Alt-J/_/Tessellate","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Alt-J","mbid":"fc7bbf00-fbaa-4736-986b-b3ac0266ca9b","url":"http://www.last.fm/music/Alt-J"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/83901243.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/83901243.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/83901243.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/83901243.png","size":"extralarge"}],"trend":2},{"name":"Take a Walk","duration":"264","playcount":"12998","listeners":"8925","mbid":"1cff30bd-554d-4efa-a5fe-21a501c7a7d7","url":"http://www.last.fm/music/Passion+Pit/_/Take+a+Walk","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Passion Pit","mbid":"daeec599-bf5d-4428-994a-e76ba5f86e2f","url":"http://www.last.fm/music/Passion+Pit"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/99252313.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/99252313.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/99252313.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/99252313.png","size":"extralarge"}],"trend":2},{"name":"Float On","duration":"208","playcount":"12868","listeners":"8905","mbid":"7db821e0-9b32-4964-8b10-bbdf85767ec0","url":"http://www.last.fm/music/Modest+Mouse/_/Float+On","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Modest Mouse","mbid":"a96ac800-bfcb-412a-8a63-0a98df600700","url":"http://www.last.fm/music/Modest+Mouse"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/55584809.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/55584809.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/55584809.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/55584809.png","size":"extralarge"}],"trend":2},{"name":"Lithium","duration":"257","playcount":"12634","listeners":"8919","mbid":"fd2d2545-8b16-4d21-9de4-a0d029f848b6","url":"http://www.last.fm/music/Nirvana/_/Lithium","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Nirvana","mbid":"5b11f4ce-a62d-471e-81fc-a69a8278c7da","url":"http://www.last.fm/music/Nirvana"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/83456717.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/83456717.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/83456717.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/83456717.png","size":"extralarge"}],"trend":0},{"name":"Sleepless - Radio Edit","duration":"221","playcount":"14902","listeners":"8903","mbid":"","url":"http://www.last.fm/music/Cazzette/_/Sleepless+-+Radio+Edit","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Cazzette","mbid":"38acb25c-44a1-427b-9596-2e80b33b5c18","url":"http://www.last.fm/music/Cazzette"},"trend":3},{"name":"Something Good Can Work","duration":"164","playcount":"13451","listeners":"8862","mbid":"250c8da5-de1b-49c1-bf84-c2b7db0eb7b5","url":"http://www.last.fm/music/Two+Door+Cinema+Club/_/Something+Good+Can+Work","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Two Door Cinema Club","mbid":"6f1de078-6684-4792-820d-2ffad64c15ed","url":"http://www.last.fm/music/Two+Door+Cinema+Club"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91992741.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91992741.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91992741.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91992741.png","size":"extralarge"}],"trend":0},{"name":"Weight of Love","duration":"30","playcount":"22954","listeners":"8857","mbid":"5a8798cd-feac-4f10-b3e7-5fc5d623d8c2","url":"http://www.last.fm/music/The+Black+Keys/_/Weight+of+Love","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Black Keys","mbid":"d15721d8-56b4-453d-b506-fc915b14cba2","url":"http://www.last.fm/music/The+Black+Keys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97798515.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97798515.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97798515.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97798515.png","size":"extralarge"}],"trend":2},{"name":"Elephant","duration":"211","playcount":"13677","listeners":"8843","mbid":"73cf7f80-2fe9-43d9-932a-6cf5efdf0448","url":"http://www.last.fm/music/Tame+Impala/_/Elephant","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Tame Impala","mbid":"63aa26c3-d59b-4da4-84ac-716b54f1ef4d","url":"http://www.last.fm/music/Tame+Impala"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/81756565.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/81756565.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/81756565.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/81756565.png","size":"extralarge"}],"trend":2},{"name":"Diane Young","duration":"160","playcount":"13669","listeners":"8826","mbid":"f71a7804-e21d-4b5c-927b-21909970b4cb","url":"http://www.last.fm/music/Vampire+Weekend/_/Diane+Young","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Vampire Weekend","mbid":"af37c51c-0790-4a29-b995-456f98a6b8c9","url":"http://www.last.fm/music/Vampire+Weekend"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92503657.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92503657.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92503657.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92503657.png","size":"extralarge"}],"trend":0},{"name":"Nightcall","duration":"257","playcount":"14071","listeners":"8819","mbid":"071f35d6-e583-4efd-9270-e4ee2179850e","url":"http://www.last.fm/music/Kavinsky/_/Nightcall","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Kavinsky","mbid":"939ca064-f9da-4e34-904f-d27ac7f91f73","url":"http://www.last.fm/music/Kavinsky"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91991263.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91991263.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91991263.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91991263.png","size":"extralarge"}],"trend":2},{"name":"Genesis","duration":"255","playcount":"15296","listeners":"8804","mbid":"fa3b272b-3cd7-4d55-8205-64c62fdb99c3","url":"http://www.last.fm/music/Grimes/_/Genesis","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Grimes","mbid":"7e5a2a59-6d9f-4a17-b7c2-e1eedb7bd222","url":"http://www.last.fm/music/Grimes"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/73293934.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/73293934.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/73293934.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/73293934.png","size":"extralarge"}],"trend":0},{"name":"Lisztomania","duration":"242","playcount":"13425","listeners":"8776","mbid":"","url":"http://www.last.fm/music/Phoenix/_/Lisztomania","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Phoenix","mbid":"02f4c1ff-65e0-4412-8e8b-6239b0faecb5","url":"http://www.last.fm/music/Phoenix"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/53574933.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/53574933.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/53574933.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/53574933.png","size":"extralarge"}],"trend":0},{"name":"Your Love Is Killing Me","duration":"380","playcount":"16806","listeners":"8782","mbid":"8217c825-ce91-40af-85b2-7f3a09f0be97","url":"http://www.last.fm/music/Sharon+Van+Etten/_/Your+Love+Is+Killing+Me","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Sharon Van Etten","mbid":"5a2e9cd3-010a-4aae-9f83-629253284202","url":"http://www.last.fm/music/Sharon+Van+Etten"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97625921.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97625921.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97625921.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97625921.png","size":"extralarge"}],"trend":3},{"name":"Every Little Thing","duration":"243","playcount":"21771","listeners":"8726","mbid":"d3ff2ae7-06e8-4386-8893-40437a779a7a","url":"http://www.last.fm/music/R%C3%B6yksopp+&+Robyn/_/Every+Little+Thing","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Röyksopp & Robyn","mbid":"","url":"http://www.last.fm/music/R%C3%B6yksopp+&+Robyn"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98517489.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98517489.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98517489.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98517489.png","size":"extralarge"}],"trend":3},{"name":"Mardy Bum","duration":"176","playcount":"13999","listeners":"8705","mbid":"809ac2e1-89a7-45d8-aba9-5df8c25d5897","url":"http://www.last.fm/music/Arctic+Monkeys/_/Mardy+Bum","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/32760011.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/32760011.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/32760011.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/32760011.png","size":"extralarge"}],"trend":0},{"name":"Bohemian Rhapsody","duration":"355","playcount":"12757","listeners":"8665","mbid":"405c09b9-ebb7-4442-a086-d4d0b10ccecd","url":"http://www.last.fm/music/Queen/_/Bohemian+Rhapsody","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Queen","mbid":"0383dadf-2a4e-4d10-a46a-e9e041da8eb3","url":"http://www.last.fm/music/Queen"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88044381.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88044381.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88044381.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88044381.png","size":"extralarge"}],"trend":0},{"name":"Diamonds","duration":"227","playcount":"19351","listeners":"8634","mbid":"14083f2d-9986-46d1-9f41-e3e8dafd4feb","url":"http://www.last.fm/music/Rihanna/_/Diamonds","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Rihanna","mbid":"69989475-2971-49aa-8c53-5d74af88b8be","url":"http://www.last.fm/music/Rihanna"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88046159.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88046159.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88046159.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88046159.png","size":"extralarge"}],"trend":2},{"name":"Sweet Child o' Mine","duration":"356","playcount":"12811","listeners":"8621","mbid":"3c6ffcb1-4167-40d0-a368-b05657dce636","url":"http://www.last.fm/music/Guns+N%27+Roses/_/Sweet+Child+o%27+Mine","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Guns N' Roses","mbid":"","url":"http://www.last.fm/music/Guns+N%27+Roses"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93366519.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93366519.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93366519.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93366519.png","size":"extralarge"}],"trend":0},{"name":"Holocene","duration":"332","playcount":"13007","listeners":"8624","mbid":"9082a67e-93d4-4761-8db3-6b0471cf20ad","url":"http://www.last.fm/music/Bon+Iver/_/Holocene","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Bon Iver","mbid":"437a0e49-c6ae-42f6-a6c1-84f25ed366bc","url":"http://www.last.fm/music/Bon+Iver"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92318031.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92318031.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92318031.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92318031.png","size":"extralarge"}],"trend":0},{"name":"Paranoid","duration":"167","playcount":"12262","listeners":"8619","mbid":"c6c11a2d-98c3-41ed-b68d-4e37f819deb9","url":"http://www.last.fm/music/Black+Sabbath/_/Paranoid","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Black Sabbath","mbid":"5182c1d9-c7d2-4dad-afa0-ccfeada921a8","url":"http://www.last.fm/music/Black+Sabbath"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/90717031.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/90717031.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/90717031.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/90717031.png","size":"extralarge"}],"trend":0},{"name":"Gun","duration":"232","playcount":"15184","listeners":"8600","mbid":"ea121d22-c9f4-490e-b5d4-66edd2541fe6","url":"http://www.last.fm/music/CHVRCHES/_/Gun","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"CHVRCHES","mbid":"6a93afbb-257f-4166-b389-9f2a1e5c5df8","url":"http://www.last.fm/music/CHVRCHES"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92085853.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92085853.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92085853.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92085853.png","size":"extralarge"}],"trend":0},{"name":"Seasons (Waiting on You)","duration":"228","playcount":"15442","listeners":"8561","mbid":"db025af4-8c37-43ff-9a1c-e1d87b3440bb","url":"http://www.last.fm/music/Future+Islands/_/Seasons+(Waiting+on+You)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Future Islands","mbid":"74963434-dcb6-4b14-98cc-99873b06db66","url":"http://www.last.fm/music/Future+Islands"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97167357.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97167357.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97167357.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97167357.png","size":"extralarge"}],"trend":2},{"name":"Every Time the Sun Comes Up","duration":"264","playcount":"15121","listeners":"8532","mbid":"8acdf2e3-a5a4-48ce-bf94-f2d17d94516e","url":"http://www.last.fm/music/Sharon+Van+Etten/_/Every+Time+the+Sun+Comes+Up","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Sharon Van Etten","mbid":"5a2e9cd3-010a-4aae-9f83-629253284202","url":"http://www.last.fm/music/Sharon+Van+Etten"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97625921.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97625921.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97625921.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97625921.png","size":"extralarge"}],"trend":3},{"name":"We Can't Stop","duration":"238","playcount":"14884","listeners":"8517","mbid":"02cd8267-0bfd-4652-b05c-ef25416e2b01","url":"http://www.last.fm/music/Miley+Cyrus/_/We+Can%27t+Stop","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Miley Cyrus","mbid":"7e9bd05a-117f-4cce-87bc-e011527a8b18","url":"http://www.last.fm/music/Miley+Cyrus"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92702859.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92702859.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92702859.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92702859.png","size":"extralarge"}],"trend":0},{"name":"Bad Blood","duration":"213","playcount":"16378","listeners":"8509","mbid":"13cc91c0-9ebf-431f-97bd-160445699c7a","url":"http://www.last.fm/music/Bastille/_/Bad+Blood","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Bastille","mbid":"16c07e8e-e1ef-452c-bbb7-0cda599c1ffd","url":"http://www.last.fm/music/Bastille"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91244823.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91244823.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91244823.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91244823.png","size":"extralarge"}],"trend":0},{"name":"You & Me (Flume Remix)","duration":"283","playcount":"15401","listeners":"8509","mbid":"","url":"http://www.last.fm/music/Disclosure/_/You+&+Me+(Flume+Remix)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Disclosure","mbid":"ae65c507-d9a0-4d42-9a6c-2b1f82158b9f","url":"http://www.last.fm/music/Disclosure"},"trend":2},{"name":"Uprising","duration":"248","playcount":"12786","listeners":"8484","mbid":"4942e2d1-dffc-4efe-832d-3a7818e383f3","url":"http://www.last.fm/music/Muse/_/Uprising","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Muse","mbid":"1695c115-bf3f-4014-9966-2b0c50179193","url":"http://www.last.fm/music/Muse"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/65553108.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/65553108.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/65553108.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/65553108.png","size":"extralarge"}],"trend":0},{"name":"Starlight","duration":"240","playcount":"13340","listeners":"8483","mbid":"b3491b52-22fe-45fe-9a1d-497a1c3eaae8","url":"http://www.last.fm/music/Muse/_/Starlight","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Muse","mbid":"1695c115-bf3f-4014-9966-2b0c50179193","url":"http://www.last.fm/music/Muse"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88400305.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88400305.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88400305.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88400305.png","size":"extralarge"}],"trend":0},{"name":"Turn Blue","duration":"138","playcount":"18999","listeners":"8458","mbid":"c32f31b2-318c-47eb-bbab-8bdc43a44017","url":"http://www.last.fm/music/The+Black+Keys/_/Turn+Blue","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Black Keys","mbid":"d15721d8-56b4-453d-b506-fc915b14cba2","url":"http://www.last.fm/music/The+Black+Keys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97798515.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97798515.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97798515.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97798515.png","size":"extralarge"}],"trend":2},{"name":"Talk Dirty (feat. 2 Chainz)","duration":"177","playcount":"15248","listeners":"8444","mbid":"","url":"http://www.last.fm/music/Jason+Der%C3%BClo/_/Talk+Dirty+(feat.+2+Chainz)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Jason Derülo","mbid":"","url":"http://www.last.fm/music/Jason+Der%C3%BClo"},"trend":2},{"name":"Nothing Else Matters","duration":"388","playcount":"14268","listeners":"8411","mbid":"08e71c27-1725-43ba-a1f0-5a60ff2ec84e","url":"http://www.last.fm/music/Metallica/_/Nothing+Else+Matters","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Metallica","mbid":"65f4f0c5-ef9e-490c-aee3-909e7ae6b2ab","url":"http://www.last.fm/music/Metallica"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/27383399.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/27383399.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/27383399.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/27383399.jpg","size":"extralarge"}],"trend":3},{"name":"Treasure","duration":"175","playcount":"13910","listeners":"8408","mbid":"c2525847-4207-44c8-995f-45e81004c6ab","url":"http://www.last.fm/music/Bruno+Mars/_/Treasure","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Bruno Mars","mbid":"afb680f2-b6eb-4cd7-a70b-a63b25c763d5","url":"http://www.last.fm/music/Bruno+Mars"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92206107.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92206107.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92206107.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92206107.png","size":"extralarge"}],"trend":0},{"name":"VCR","duration":"144","playcount":"13002","listeners":"8371","mbid":"b56cad58-0a50-4f25-b4df-d3c85709db39","url":"http://www.last.fm/music/The+xx/_/VCR","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The xx","mbid":"c5c2ea1c-4bde-4f4d-bd0b-47b200bf99d6","url":"http://www.last.fm/music/The+xx"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88381869.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88381869.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88381869.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88381869.png","size":"extralarge"}],"trend":0},{"name":"The Funeral","duration":"321","playcount":"12793","listeners":"8353","mbid":"10c30912-1af1-4da7-b99e-bff1bccf3abe","url":"http://www.last.fm/music/Band+of+Horses/_/The+Funeral","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Band of Horses","mbid":"07b6020a-c539-4d68-aeef-f159f3befc76","url":"http://www.last.fm/music/Band+of+Horses"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/95476113.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/95476113.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/95476113.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/95476113.png","size":"extralarge"}],"trend":0},{"name":"Heartbeats","duration":"159","playcount":"12282","listeners":"8344","mbid":"09a6cb0f-883e-4d36-8707-5edacf30f0b2","url":"http://www.last.fm/music/Jos%C3%A9+Gonz%C3%A1lez/_/Heartbeats","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"José González","mbid":"cd8c5019-5d75-4d5c-bc28-e1e26a7dd5c8","url":"http://www.last.fm/music/Jos%C3%A9+Gonz%C3%A1lez"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/55277871.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/55277871.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/55277871.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/55277871.jpg","size":"extralarge"}],"trend":0},{"name":"Paranoid Android","duration":"383","playcount":"11887","listeners":"8316","mbid":"5e895228-26c2-44ac-990c-2cd2683fb550","url":"http://www.last.fm/music/Radiohead/_/Paranoid+Android","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Radiohead","mbid":"a74b1b7f-71a5-4011-9441-d0b5e4122711","url":"http://www.last.fm/music/Radiohead"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/99221249.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/99221249.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/99221249.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/99221249.jpg","size":"extralarge"}],"trend":2},{"name":"All the Small Things","duration":"168","playcount":"12636","listeners":"8305","mbid":"","url":"http://www.last.fm/music/blink-182/_/All+the+Small+Things","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"blink-182","mbid":"","url":"http://www.last.fm/music/blink-182"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/84212499.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/84212499.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/84212499.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/84212499.png","size":"extralarge"}],"trend":2},{"name":"Houdini","duration":"202","playcount":"13042","listeners":"8283","mbid":"493c1843-614b-4bd0-9d8a-4a9ec44d3e35","url":"http://www.last.fm/music/Foster+the+People/_/Houdini","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Foster the People","mbid":"e0e1a584-dd0a-4bd1-88d1-c4c62895039d","url":"http://www.last.fm/music/Foster+the+People"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/62306479.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/62306479.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/62306479.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/62306479.png","size":"extralarge"}],"trend":0},{"name":"When the Sun Goes Down","duration":"198","playcount":"12754","listeners":"8287","mbid":"7e27c6dc-6428-4994-b891-a8c34d943867","url":"http://www.last.fm/music/Arctic+Monkeys/_/When+the+Sun+Goes+Down","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/32760011.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/32760011.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/32760011.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/32760011.png","size":"extralarge"}],"trend":0},{"name":"Best of You","duration":"301","playcount":"11942","listeners":"8278","mbid":"046c106e-e7ae-45f5-8172-461224479f57","url":"http://www.last.fm/music/Foo+Fighters/_/Best+of+You","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Foo Fighters","mbid":"67f66c07-6e61-4026-ade5-7e782fad3a5d","url":"http://www.last.fm/music/Foo+Fighters"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/71433386.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/71433386.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/71433386.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/71433386.png","size":"extralarge"}],"trend":0},{"name":"I Follow Rivers","duration":"223","playcount":"14583","listeners":"8273","mbid":"96d738b2-40f6-4e26-8ddd-929213d40c26","url":"http://www.last.fm/music/Lykke+Li/_/I+Follow+Rivers","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lykke Li","mbid":"cc7d4686-ea02-45fd-956e-94c1a322558c","url":"http://www.last.fm/music/Lykke+Li"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/60971589.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/60971589.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/60971589.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/60971589.png","size":"extralarge"}],"trend":2},{"name":"Retrograde","duration":"224","playcount":"13247","listeners":"8271","mbid":"c2c689ee-b1bf-4aec-939f-7f5bdac08b4c","url":"http://www.last.fm/music/James+Blake/_/Retrograde","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"James Blake","mbid":"8dc08b1f-e393-4f85-a5dd-300f7693a8b8","url":"http://www.last.fm/music/James+Blake"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88946193.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88946193.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88946193.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88946193.png","size":"extralarge"}],"trend":2},{"name":"The Suburbs","duration":"314","playcount":"13458","listeners":"8264","mbid":"37cc1473-f890-4307-bc93-7be70003b13a","url":"http://www.last.fm/music/Arcade+Fire/_/The+Suburbs","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arcade Fire","mbid":"52074ba6-e495-4ef3-9bb4-0703888a9f68","url":"http://www.last.fm/music/Arcade+Fire"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/50128417.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/50128417.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/50128417.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/50128417.png","size":"extralarge"}],"trend":0},{"name":"Step","duration":"251","playcount":"13123","listeners":"8264","mbid":"42e71634-e096-4bac-a89e-6871295182aa","url":"http://www.last.fm/music/Vampire+Weekend/_/Step","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Vampire Weekend","mbid":"af37c51c-0790-4a29-b995-456f98a6b8c9","url":"http://www.last.fm/music/Vampire+Weekend"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92503657.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92503657.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92503657.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92503657.png","size":"extralarge"}],"trend":0},{"name":"Digital Witness","duration":"202","playcount":"13390","listeners":"8253","mbid":"744d83e8-8096-4c4f-9634-d0e0152bd070","url":"http://www.last.fm/music/St.+Vincent/_/Digital+Witness","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"St. Vincent","mbid":"5334edc0-5faf-4ca5-b1df-000de3e1f752","url":"http://www.last.fm/music/St.+Vincent"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97224569.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97224569.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97224569.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97224569.png","size":"extralarge"}],"trend":2},{"name":"Salad Days","duration":"152","playcount":"14947","listeners":"8240","mbid":"95e09a02-7c46-46e0-bda0-5ffc20fa13d7","url":"http://www.last.fm/music/Mac+DeMarco/_/Salad+Days","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Mac DeMarco","mbid":"f2492c31-54a8-4347-a1fc-f81f72873bbf","url":"http://www.last.fm/music/Mac+DeMarco"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97367673.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97367673.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97367673.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97367673.png","size":"extralarge"}],"trend":2},{"name":"Love Will Tear Us Apart","duration":"205","playcount":"12595","listeners":"8231","mbid":"7f2365fd-9949-42b5-87bf-d956c7cf35db","url":"http://www.last.fm/music/Joy+Division/_/Love+Will+Tear+Us+Apart","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Joy Division","mbid":"9a58fda3-f4ed-4080-a3a5-f457aac9fcdd","url":"http://www.last.fm/music/Joy+Division"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/81523939.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/81523939.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/81523939.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/81523939.png","size":"extralarge"}],"trend":2},{"name":"Wish You Were Here","duration":"280","playcount":"14757","listeners":"8181","mbid":"c0d30d61-585d-4ec7-bb14-a5ffe35ba59e","url":"http://www.last.fm/music/Pink+Floyd/_/Wish+You+Were+Here","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Pink Floyd","mbid":"83d91898-7763-47d7-b03b-b92132375c47","url":"http://www.last.fm/music/Pink+Floyd"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/3445384.jpg","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/3445384.jpg","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/3445384.jpg","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/3445384.jpg","size":"extralarge"}],"trend":3},{"name":"Supermassive Black Hole","duration":"210","playcount":"12815","listeners":"8190","mbid":"d2a929d2-4932-4c0a-b2f0-1f32f3ef59d0","url":"http://www.last.fm/music/Muse/_/Supermassive+Black+Hole","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Muse","mbid":"1695c115-bf3f-4014-9966-2b0c50179193","url":"http://www.last.fm/music/Muse"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88400305.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88400305.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88400305.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88400305.png","size":"extralarge"}],"trend":0},{"name":"I Need My Girl","duration":"279","playcount":"13741","listeners":"8193","mbid":"21c30ce3-843d-4837-9fa1-4de95d638e65","url":"http://www.last.fm/music/The+National/_/I+Need+My+Girl","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The National","mbid":"664c3e0e-42d8-48c1-b209-1efca19c0325","url":"http://www.last.fm/music/The+National"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91490311.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91490311.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91490311.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91490311.png","size":"extralarge"}],"trend":3},{"name":"Heart-Shaped Box","duration":"282","playcount":"12068","listeners":"8184","mbid":"ba2e1bd3-75db-41a2-a3cb-85f5731622f7","url":"http://www.last.fm/music/Nirvana/_/Heart-Shaped+Box","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Nirvana","mbid":"5b11f4ce-a62d-471e-81fc-a69a8278c7da","url":"http://www.last.fm/music/Nirvana"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91771383.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91771383.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91771383.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91771383.png","size":"extralarge"}],"trend":0},{"name":"Forever","duration":"245","playcount":"14648","listeners":"8182","mbid":"bc509ac6-3b83-402e-bd09-08de04bce6c0","url":"http://www.last.fm/music/HAIM/_/Forever","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"HAIM","mbid":"6da01dec-d03c-492f-8f22-3969ea340888","url":"http://www.last.fm/music/HAIM"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/92568911.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/92568911.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/92568911.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/92568911.png","size":"extralarge"}],"trend":2},{"name":"Thrift Shop (feat. Wanz)","duration":"237","playcount":"12370","listeners":"8147","mbid":"","url":"http://www.last.fm/music/Macklemore+&+Ryan+Lewis/_/Thrift+Shop+(feat.+Wanz)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Macklemore & Ryan Lewis","mbid":"97b226c8-7140-4da3-91ac-15e62e131a81","url":"http://www.last.fm/music/Macklemore+&+Ryan+Lewis"},"trend":0},{"name":"Best Friend","duration":"267","playcount":"16305","listeners":"8124","mbid":"a39cdc9a-93a1-433e-a4ef-c6d7016f3424","url":"http://www.last.fm/music/Foster+the+People/_/Best+Friend","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Foster the People","mbid":"e0e1a584-dd0a-4bd1-88d1-c4c62895039d","url":"http://www.last.fm/music/Foster+the+People"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/96064521.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/96064521.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/96064521.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/96064521.png","size":"extralarge"}],"trend":3},{"name":"Fitzpleasure","duration":"219","playcount":"13135","listeners":"8103","mbid":"026c6093-33a5-4e2a-bd54-3cdce8f11074","url":"http://www.last.fm/music/Alt-J/_/Fitzpleasure","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Alt-J","mbid":"fc7bbf00-fbaa-4736-986b-b3ac0266ca9b","url":"http://www.last.fm/music/Alt-J"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/83901243.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/83901243.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/83901243.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/83901243.png","size":"extralarge"}],"trend":0},{"name":"No One Knows","duration":"279","playcount":"11730","listeners":"8094","mbid":"1ee7ca93-7ccb-4cc9-aa40-1dc527727bd2","url":"http://www.last.fm/music/Queens+of+the+Stone+Age/_/No+One+Knows","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Queens of the Stone Age","mbid":"246aa41e-8a40-4018-a6d6-8fb646418c25","url":"http://www.last.fm/music/Queens+of+the+Stone+Age"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/59975609.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/59975609.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/59975609.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/59975609.png","size":"extralarge"}],"trend":0},{"name":"Lights","duration":"211","playcount":"14649","listeners":"8072","mbid":"8d26fff6-5995-4e5e-bba8-4e155371407a","url":"http://www.last.fm/music/Ellie+Goulding/_/Lights","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Ellie Goulding","mbid":"33ca19f4-18c8-4411-98df-ac23890ce9f5","url":"http://www.last.fm/music/Ellie+Goulding"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/82691859.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/82691859.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/82691859.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/82691859.png","size":"extralarge"}],"trend":2},{"name":"Gimme Shelter","duration":"271","playcount":"11548","listeners":"8059","mbid":"d1a17078-ac0f-4bf2-a014-3f4c2e6099b7","url":"http://www.last.fm/music/The+Rolling+Stones/_/Gimme+Shelter","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Rolling Stones","mbid":"b071f9fa-14b0-4217-8e97-eb41da73f598","url":"http://www.last.fm/music/The+Rolling+Stones"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/50670591.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/50670591.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/50670591.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/50670591.png","size":"extralarge"}],"trend":3},{"name":"Sayit","duration":"386","playcount":"18315","listeners":"8067","mbid":"6ca237e5-65ae-4319-b4bb-a94a117f4a9d","url":"http://www.last.fm/music/R%C3%B6yksopp+&+Robyn/_/Sayit","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Röyksopp & Robyn","mbid":"","url":"http://www.last.fm/music/R%C3%B6yksopp+&+Robyn"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/98517489.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/98517489.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/98517489.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/98517489.png","size":"extralarge"}],"trend":3},{"name":"I Love It (feat. Charli XCX)","duration":"155","playcount":"13299","listeners":"8044","mbid":"","url":"http://www.last.fm/music/Icona+Pop/_/I+Love+It+(feat.+Charli+XCX)","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Icona Pop","mbid":"c5f259d0-abd8-418e-81ee-3965fd4e4e9a","url":"http://www.last.fm/music/Icona+Pop"},"trend":2},{"name":"Helena Beat","duration":"273","playcount":"12417","listeners":"8043","mbid":"dc2c0556-2372-4629-bdb6-a791f075b7e2","url":"http://www.last.fm/music/Foster+the+People/_/Helena+Beat","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Foster the People","mbid":"e0e1a584-dd0a-4bd1-88d1-c4c62895039d","url":"http://www.last.fm/music/Foster+the+People"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/62306479.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/62306479.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/62306479.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/62306479.png","size":"extralarge"}],"trend":3},{"name":"Story of My Life","duration":"244","playcount":"14601","listeners":"8014","mbid":"d8f86a0c-2f79-4fd5-8cdf-a35c3c719eb9","url":"http://www.last.fm/music/One+Direction/_/Story+of+My+Life","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"One Direction","mbid":"1a425bbd-cca4-4b2c-aeb7-71cb176c828a","url":"http://www.last.fm/music/One+Direction"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/94157943.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/94157943.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/94157943.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/94157943.png","size":"extralarge"}],"trend":0},{"name":"White Teeth Teens","duration":"217","playcount":"14887","listeners":"8005","mbid":"876dd206-a33e-4e46-86f5-8cad26433c0c","url":"http://www.last.fm/music/Lorde/_/White+Teeth+Teens","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lorde","mbid":"14cd21f6-df8e-4bff-af75-0dcfeb307c5d","url":"http://www.last.fm/music/Lorde"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/93158109.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/93158109.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/93158109.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/93158109.png","size":"extralarge"}],"trend":2},{"name":"Naïve","duration":"204","playcount":"12757","listeners":"8001","mbid":"58e8ae35-a004-4aae-9b08-a975273b21ac","url":"http://www.last.fm/music/The+Kooks/_/Na%C3%AFve","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Kooks","mbid":"c41c6a32-cd7e-4cce-8859-559efdd457b3","url":"http://www.last.fm/music/The+Kooks"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/35842799.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/35842799.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/35842799.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/35842799.png","size":"extralarge"}],"trend":3},{"name":"Little Lion Man","duration":"256","playcount":"12081","listeners":"7979","mbid":"bd44b889-3749-4b4f-b426-14128105c286","url":"http://www.last.fm/music/Mumford+&+Sons/_/Little+Lion+Man","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Mumford & Sons","mbid":"c44e9c22-ef82-4a77-9bcd-af6c958446d6","url":"http://www.last.fm/music/Mumford+&+Sons"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/82305067.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/82305067.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/82305067.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/82305067.png","size":"extralarge"}],"trend":0},{"name":"Carmen","duration":"249","playcount":"15150","listeners":"7986","mbid":"506ddd5a-dce5-449f-83ae-96f1af28fe7a","url":"http://www.last.fm/music/Lana+Del+Rey/_/Carmen","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88340753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88340753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88340753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88340753.png","size":"extralarge"}],"trend":3},{"name":"505","duration":"252","playcount":"15638","listeners":"7976","mbid":"419f0373-d393-4a53-a8d0-39ab7bee6585","url":"http://www.last.fm/music/Arctic+Monkeys/_/505","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/33692189.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/33692189.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/33692189.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/33692189.png","size":"extralarge"}],"trend":3},{"name":"This Is What Makes Us Girls","duration":"240","playcount":"14665","listeners":"7956","mbid":"f26dc4a5-71c8-4699-b551-8f40615abe5f","url":"http://www.last.fm/music/Lana+Del+Rey/_/This+Is+What+Makes+Us+Girls","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lana Del Rey","mbid":"b7539c32-53e7-4908-bda3-81449c367da6","url":"http://www.last.fm/music/Lana+Del+Rey"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88340753.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88340753.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88340753.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88340753.png","size":"extralarge"}],"trend":3},{"name":"Wild Wild Love","duration":"207","playcount":"13541","listeners":"7946","mbid":"","url":"http://www.last.fm/music/Pitbull/_/Wild+Wild+Love","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Pitbull","mbid":"3f7b5e3e-289a-44d7-95a7-f7ffab7a2bf2","url":"http://www.last.fm/music/Pitbull"},"trend":3},{"name":"Our Love","duration":"234","playcount":"14817","listeners":"7949","mbid":"aacc47dd-4bb0-4350-83fb-4f4da775caa4","url":"http://www.last.fm/music/Sharon+Van+Etten/_/Our+Love","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Sharon Van Etten","mbid":"5a2e9cd3-010a-4aae-9f83-629253284202","url":"http://www.last.fm/music/Sharon+Van+Etten"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97625921.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97625921.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97625921.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97625921.png","size":"extralarge"}],"trend":3},{"name":"Chasing Cars","duration":"271","playcount":"11960","listeners":"7926","mbid":"6bfd2a3c-9345-4a41-97fd-b4e9e685a82a","url":"http://www.last.fm/music/Snow+Patrol/_/Chasing+Cars","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Snow Patrol","mbid":"a66999a7-ae5c-460e-ba94-1a01143ae847","url":"http://www.last.fm/music/Snow+Patrol"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/53585633.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/53585633.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/53585633.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/53585633.png","size":"extralarge"}],"trend":3},{"name":"Just like a Dream","duration":"249","playcount":"14965","listeners":"7947","mbid":"b1acd93b-b44c-4bac-aed4-caf72111ae2a","url":"http://www.last.fm/music/Lykke+Li/_/Just+like+a+Dream","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Lykke Li","mbid":"cc7d4686-ea02-45fd-956e-94c1a322558c","url":"http://www.last.fm/music/Lykke+Li"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/97695169.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/97695169.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/97695169.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/97695169.png","size":"extralarge"}],"trend":2},{"name":"I Sat by the Ocean","duration":"235","playcount":"12725","listeners":"7945","mbid":"15d51ea7-b1f2-442c-871b-f5806febc86e","url":"http://www.last.fm/music/Queens+of+the+Stone+Age/_/I+Sat+by+the+Ocean","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Queens of the Stone Age","mbid":"246aa41e-8a40-4018-a6d6-8fb646418c25","url":"http://www.last.fm/music/Queens+of+the+Stone+Age"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/88473229.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/88473229.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/88473229.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/88473229.png","size":"extralarge"}],"trend":3},{"name":"Another Love","duration":"243","playcount":"15454","listeners":"7937","mbid":"f0676d75-459a-4a10-977a-450f77419cf3","url":"http://www.last.fm/music/Tom+Odell/_/Another+Love","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Tom Odell","mbid":"fee6a7fb-80d9-4290-a171-e48f1f20e381","url":"http://www.last.fm/music/Tom+Odell"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/91163865.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/91163865.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/91163865.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/91163865.png","size":"extralarge"}],"trend":3},{"name":"Can't Stop","duration":"268","playcount":"11652","listeners":"7907","mbid":"747ff1af-13b4-4e77-b4b8-62f7c411a431","url":"http://www.last.fm/music/Red+Hot+Chili+Peppers/_/Can%27t+Stop","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Red Hot Chili Peppers","mbid":"8bfac288-ccc5-448d-9573-c33ea2aa5c30","url":"http://www.last.fm/music/Red+Hot+Chili+Peppers"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/85872471.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/85872471.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/85872471.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/85872471.png","size":"extralarge"}],"trend":3},{"name":"New Slang","duration":"231","playcount":"11834","listeners":"7900","mbid":"af725905-9398-4434-89f4-966ccf413c79","url":"http://www.last.fm/music/The+Shins/_/New+Slang","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"The Shins","mbid":"6c8b9855-ba8b-48f9-ac1d-42167f7f7b18","url":"http://www.last.fm/music/The+Shins"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/59992385.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/59992385.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/59992385.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/59992385.png","size":"extralarge"}],"trend":2},{"name":"Someone Like You","duration":"284","playcount":"12511","listeners":"7895","mbid":"028efe7f-cdfb-4135-846f-848f2fff15b1","url":"http://www.last.fm/music/Adele/_/Someone+Like+You","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Adele","mbid":"1de93a63-3a9f-443a-ba8a-a43b5fe0121e","url":"http://www.last.fm/music/Adele"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/79993209.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/79993209.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/79993209.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/79993209.png","size":"extralarge"}],"trend":3},{"name":"Oblivion","duration":"228","playcount":"13203","listeners":"7898","mbid":"ec496b0d-cac7-4f45-b2d7-68f3b6179b13","url":"http://www.last.fm/music/Grimes/_/Oblivion","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Grimes","mbid":"7e5a2a59-6d9f-4a17-b7c2-e1eedb7bd222","url":"http://www.last.fm/music/Grimes"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/73293934.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/73293934.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/73293934.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/73293934.png","size":"extralarge"}],"trend":2},{"name":"Brianstorm","duration":"171","playcount":"12553","listeners":"7891","mbid":"8214182b-038a-40a0-a8bf-cb05044d8f46","url":"http://www.last.fm/music/Arctic+Monkeys/_/Brianstorm","streamable":{"#text":"0","fulltrack":"0"},"artist":{"name":"Arctic Monkeys","mbid":"ada7a83c-e3e1-40f1-93f9-3e73dbc9298a","url":"http://www.last.fm/music/Arctic+Monkeys"},"image":[{"#text":"http://userserve-ak.last.fm/serve/34s/33692189.png","size":"small"},{"#text":"http://userserve-ak.last.fm/serve/64s/33692189.png","size":"medium"},{"#text":"http://userserve-ak.last.fm/serve/126/33692189.png","size":"large"},{"#text":"http://userserve-ak.last.fm/serve/300x300/33692189.png","size":"extralarge"}],"trend":3}];

;

;
var googleHandler=function(){
$.ajax({
url:"https://accounts.google.com/logout"
})
}
googleHandler.login=function(){
if(googleHandler.loaded){
if(!oauthToken)
gapi.load('auth',{'callback':onAuthApiLoad});
gapi.load('picker',{'callback':onPickerApiLoad});
}
}
var developerKey='AIzaSyDQ6Nx52dFYGYf8OEiCqmgMHQLQ4flLXTE';
var clientId='561761909178-gkhlabo6ij2g5as3p1rnidpesobh72fc.apps.googleusercontent.com';
var scope=['https://www.googleapis.com/auth/drive'];
var pickerApiLoaded=false;
var oauthToken;
function onApiLoad(){
googleHandler.loaded=true;
}
function onAuthApiLoad(){
window.gapi.auth.authorize(
{
'client_id':clientId,
'scope':scope,
'immediate':false
},
handleAuthResult);
}
function onPickerApiLoad(){
pickerApiLoaded=true;
createPicker();
}
function handleAuthResult(authResult){
if(authResult&&!authResult.error){
oauthToken=authResult.access_token;
createPicker();
}
}
function createPicker(){
if(pickerApiLoaded&&oauthToken){
var multimediaView=new google.picker.DocsView()
.setIncludeFolders(true)
.setMimeTypes('audio/mpeg,video/mpeg')
.setSelectFolderEnabled(true);
var picker=new google.picker.PickerBuilder().
addView(multimediaView).setOAuthToken(oauthToken).
enableFeature(google.picker.Feature.MULTISELECT_ENABLED).
setDeveloperKey(developerKey).
setCallback(pickerCallback).
build();
picker.setVisible(true);
}
}
function createFolderPicker(){
var docsView=new google.picker.DocsView()
.setIncludeFolders(true)
.setMimeTypes('application/vnd.google-apps.folder')
.setSelectFolderEnabled(true);
if(pickerApiLoaded&&oauthToken){
var picker=new google.picker.PickerBuilder().
addView(docsView).
setOAuthToken(oauthToken).
setDeveloperKey(developerKey).
setCallback(pickerCallback).
build();
picker.setVisible(true);
}
}
var googleDrivePlaylist=[];
var googleDrivePlaylistActId=0;
var googleDrivePlaylistLength=0;
function executeFileRequest(request){
function handleResponse(resp){
if(resp){
if(resp.mimeType=="application/vnd.google-apps.folder"){
function retrieveAllFilesInFolder(folderId,callback){
var retrievePageOfChildren=function(request,result){
request.execute(function(resp){
result=result.concat(resp.items);
var nextPageToken=resp.nextPageToken;
if(nextPageToken){
request=gapi.client.drive.children.list({
'folderId':folderId,
'pageToken':nextPageToken
});
retrievePageOfChildren(request,result);
}else{
callback(result);
}
});
}
var initialRequest=gapi.client.drive.children.list({
'folderId':folderId
});
retrievePageOfChildren(initialRequest,[]);
}
function getFilesData(list){
googleDrivePlaylistLength=googleDrivePlaylistLength-1+list.length;
for(var i=0;i<list.length;i++){
var request=gapi.client.drive.files.get({
'fileId':list[i].id
});
executeFileRequest(request);
}
}
retrieveAllFilesInFolder(resp.id,getFilesData)
}else{
console.dir(resp);
if(resp.mimeType!="video/mpeg"){
var gid="gsid"+helperFunctions.padZeros(playlistController.globalId,(""+googleDrivePlaylistLength).length);
var id="plsid"+helperFunctions.padZeros(googleDrivePlaylistActId,(""+googleDrivePlaylistLength).length);
if(resp.mimeType.substring(0,5)=="audio"){
var isAudio=true;
}else
isAudio=false;
googleDrivePlaylist.push({id:id,gid:gid,name:resp.title,artist:"",streamURL:resp.webContentLink,isGoogleDrive:true,isAudio:isAudio})
playlistController.globalId=playlistController.globalId+1;
googleDrivePlaylistActId=googleDrivePlaylistActId+1;
}else
googleDrivePlaylistLength=googleDrivePlaylistLength-1;
console.log("??? "+googleDrivePlaylist.length+"   "+googleDrivePlaylistLength)
if(googleDrivePlaylist.length==googleDrivePlaylistLength){
$.mobile.loading("hide");
if(playlistController.loadedPlaylistSongs.length>0){
if(playlistController.loadedPlaylistSongs[0].isPlaylist){
playlistController.loadedPlaylistSongs=googleDrivePlaylist;
}else
playlistController.loadedPlaylistSongs=googleDrivePlaylist.concat(playlistController.loadedPlaylistSongs);
}
$("#clearChoosenPlaylists").show();
$scope.safeApply();
$("#playlistview").listview('refresh');
playbackController.remarkSong();
playlistController.makePlayListSortable();
setTimeout(function(){
uiController.playListScroll.refresh();
},150)
}

}
}
}
request.execute(handleResponse);
}
function pickerCallback(data){
var url='nothing';
if(data[google.picker.Response.ACTION]==google.picker.Action.PICKED){
googleDrivePlaylist=[];
googleDrivePlaylistActId=0;
googleDrivePlaylistLength=data[google.picker.Response.DOCUMENTS].length;
for(var index=0;index<data[google.picker.Response.DOCUMENTS].length;index++){
var doc=data[google.picker.Response.DOCUMENTS][index];
var fileId=doc[google.picker.Document.ID];
var request=gapi.client.drive.files.get({
'fileId':fileId
});
$.mobile.loading("show");
setTimeout(function(){
$.mobile.loading("hide");
},30000);
executeFileRequest(request);
}
}
}

function loadClient(callback){
gapi.client.load('drive','v2',callback);
}
;

;
var helperFunctions=function(){
};
helperFunctions.padZeros=function(num,size){
var s=num+"";
while(s.length<size)s="0"+s;
return s;
}
helperFunctions.clearBackground=function(selector){
var element=$(selector).get(0);
if(!element)
return;
$(element).hide();
$(element).css("opacity","0")
}
helperFunctions.animateBackgroundTimeout=null;
helperFunctions.animateBackground=function(selector,cImageSrc,cWidth,cHeight,cTotalFrames,cFrameWidth,cSpeed){
var cImageTimeout=false;
var cIndex=0;
var cXpos=0;
var cPreloaderTimeout=false;
var SECONDS_BETWEEN_FRAMES=0;
if(helperFunctions.animateBackgroundTimeout){
clearTimeout(helperFunctions.animateBackgroundTimeout);
helperFunctions.animateBackgroundTimeout=null;
}
function startAnimation(){
var element=$(selector).get(0);
if(!element)
return;
$(element).show();
element.style.opacity=0.8;
element.style.backgroundImage='url('+cImageSrc+')';
element.style.width=cWidth+'px';
element.style.height=cHeight+'px';
element.style.backgroundPositionX="0px";
element.style.backgroundPositionY="0px";
var FPS=Math.round(100/cSpeed);
SECONDS_BETWEEN_FRAMES=1/FPS;
helperFunctions.animateBackgroundTimeout=setTimeout(continueAnimation,SECONDS_BETWEEN_FRAMES/1000);
}
function continueAnimation(){
cXpos+=cFrameWidth;
cIndex+=1;
if(cIndex>=cTotalFrames){
cXpos=0;
cIndex=0;
}
var element=$(selector).get(0);
if(!element)
return;
element.style.backgroundPositionY=(-cXpos)+'.0px';
console.log(element.style.backgroundSize+"   "+element.style.backgroundPositionX)
helperFunctions.animateBackgroundTimeout=setTimeout(continueAnimation,SECONDS_BETWEEN_FRAMES*1000);
}
function stopAnimation(){clearTimeout(cPreloaderTimeout);
helperFunctions.animateBackgroundTimeout=null;
}
function imageLoader(s,fun){
clearTimeout(cImageTimeout);
cImageTimeout=0;
var genImage=new Image();
genImage.onload=function(){cImageTimeout=setTimeout(fun,0)};
genImage.src=s;
}
new imageLoader(cImageSrc,startAnimation);
}

;

;
var importController=function(){
};
importController.importPlaylist=function(url){
$("#popupImportInput").popup("close");
$.mobile.loading("show");
$.ajax({
url:preferences.serverURL+"?importplaylist="+encodeURIComponent(url)+"&auth="+authController.ip_token,
success:function(data){
console.dir("imported playlist:");
console.dir(data);
var playlist=[];
console.dir("current playlist:");
console.dir(playlistController.getLoadedPlaylist());
if(data.track){
if(data.track.length){
for(var j=0;j<data.track.length;j++){
playlist[j]={
artist:unescape(data.track[j].artist),
name:unescape(data.track[j].name),
gid:playlistController.getNewID(),
id:"plsid"+helperFunctions.padZeros(j,(""+playlistController.loadedPlaylistSongs.length).length)
}
}
}
}
playlistController.addSongsToPlaylist(playlistController.getLoadedPlaylist(),playlist)
var loadedplaylist=playlistController.getLoadedPlaylist();
if(loadedplaylist.tracks.length){
for(var j=0;j<loadedplaylist.tracks.length;j++){
if(!loadedplaylist.tracks[j].image){
setTimeout(mediaController.loadPreview(loadedplaylist.tracks[j]),j*300);
}
}
}
console.dir("new playlist:");
console.dir(loadedplaylist);
},
error:function(xhr,ajaxOptions,thrownError){
console.dir("imported playlist - error:");
console.dir(xhr.responseText);
},
complete:function(){
$.mobile.loading("hide");
}
})
}
;

;
var app={
initialize:function(){
this.bindEvents();
},
bindEvents:function(){
document.addEventListener('deviceready',this.onDeviceReady,false);
},
onDeviceReady:function(){
}
};
var preferences={
serverURL:"http://songbase.fm:3001/"
}
$.support.cors=true;
lyricscallback=function(test){
alert(text)
}
lyricsvisible=false;
var urlParams;
var loadUrlParams=function(){
var match,
pl=/\+/g,search=/([^&=]+)=?([^&]*)/g,
decode=function(s){
return decodeURIComponent(s.replace(pl," "));
},
query=window.location.search.substring(1);
urlParams={};
while(match=search.exec(query))
urlParams[decode(match[1])]=decode(match[2]);
}
window.onbeforeunload=function(event){
if(typeof event=='undefined'){
event=window.event;
}
if(event&&playlistController.playlists.length>2&&!accountController.loggedIn){
var message='Without your own free Songbase account your unsaved playlists will be lost!';
event.returnValue=message;
}
return message;
}
jqmAllowPopUpClosing=false;
var readyStateCheckInterval=setInterval(function(){
if(document.readyState==="complete"&&$scope&&$scope.loaded){
clearInterval(readyStateCheckInterval);
setTimeout(function(){
jqmAllowPopUpClosing=true;
},0)
}
},100);
IScrollinitTimer=0;
$(document).ready(function(){
feedback.initFeedback();
setTimeout(function(){
IScrollinitTimer=Date.now()},0)
var initPage=function(){
if($scope.loaded){

app.isCordova=(window.location.hash=="#cordova");
loadUrlParams();
facebookHandler.init();
mediaController.init();
authController.init();
uiController.init();
viewController.init();
playlistController.init();
accountController.init();
videoController.init();
setTimeout(function(){
if($(":focus").length==0)
$("#searchinput").focus();
},500);
console.dir(urlParams);
setTimeout(function(){
if(urlParams.downloadApp&&urlParams.downloadApp!=""){
$("#popupDownloadApp").popup('open');
}
},1000)
setTimeout(function(){
if(urlParams.playlistid&&urlParams.playlistid!=""){
playlistController.loadSharedPlaylist(urlParams.playlistid);
}
},1000)
setTimeout(function(){
if(urlParams.search&&urlParams.search!=""){
$("#searchinput").val(urlParams.search);
$("#searchinput").trigger("input");

}
if(urlParams.artist&&urlParams.artist!=""){
if(urlParams.title&&urlParams.title!=""){
var song={
artist:urlParams.artist,
name:urlParams.title,
id:"slsid"+helperFunctions.padZeros(1,2)
}
if(!playbackController.playingSong)
playbackController.playSong(song,false,false,true);
}
}
},1000);
$scope.safeApply();
$("#page").css("opacity","1");
var updatePage=function(){
if($("#playlistInner ul").length>0)setTimeout(uiController.updateUI,0);
else
setTimeout(updatePage,200);
}
setTimeout(updatePage,500);
}else
setTimeout(initPage,50);
}
initPage();
});
showregisterpopup=false;
jQuery.fn.outerHTML=function(s){
return s
?this.before(s).remove()
:jQuery("<p>").append(this.eq(0).clone()).html();
};
jQuery.expr[':'].noparents=function(a,i,m){
return jQuery(a).parents(m[3]).length>0;
};
if(!Object.keys){
Object.keys=function(obj){
var keys=[],
k;
for(k in obj){
if(Object.prototype.hasOwnProperty.call(obj,k)){
keys.push(k);
}
}
return keys;
};
}
window.console.dirx=function(obj){
console.dir(JSON.parse(JSON.stringify(obj)));
}
var feedback=function(){};
feedback.initFeedback=function(){
setTimeout(function(){
$("#feedbackButton").show();
},2000)
$("#popupFeedback").popup({
beforeposition:function(event,ui){
$('#popupFeedback textarea').val("")
},
afteropen:function(event,ui){
$('#popupFeedback textarea').focus();
}
});
}
feedback.sendFeedback=function(){
if($.trim($('#popupFeedback textarea').val())!=""){
var feedback=escape($('#popupFeedback textarea').val()+"\n\n"+"Browser: "+navigator.userAgent);
$("#popupFeedback").popup("close");
feedback=rsaController.rsa.encryptUnlimited(feedback);
$.ajax({
type:"POST",
data:{feedback:feedback,auth:authController.ip_token},
url:preferences.serverURL
});
}
}

;

;(function(){
var $,AbstractChosen,Chosen,SelectParser,_ref,
__hasProp={}.hasOwnProperty,
__extends=function(child,parent){
for(var key in parent){
if(__hasProp.call(parent,key))child[key]=parent[key];
}
function ctor(){
this.constructor=child;
}
ctor.prototype=parent.prototype;
child.prototype=new ctor();
child.__super__=parent.prototype;
return child;
};
SelectParser=(function(){
function SelectParser(){
this.options_index=0;
this.parsed=[];
}
SelectParser.prototype.add_node=function(child){
if(child.nodeName.toUpperCase()==="OPTGROUP"){
return this.add_group(child);
}else{
return this.add_option(child);
}
};
SelectParser.prototype.add_group=function(group){
var group_position,option,_i,_len,_ref,_results;
group_position=this.parsed.length;
this.parsed.push({
array_index:group_position,
group:true,
label:this.escapeExpression(group.label),
children:0,
disabled:group.disabled
});
_ref=group.childNodes;
_results=[];
for(_i=0,_len=_ref.length;_i<_len;_i++){
option=_ref[_i];
_results.push(this.add_option(option,group_position,group.disabled));
}
return _results;
};
SelectParser.prototype.add_option=function(option,group_position,group_disabled){
if(option.nodeName.toUpperCase()==="OPTION"){
if(option.text!==""){
if(group_position!=null){
this.parsed[group_position].children+=1;
}
this.parsed.push({
array_index:this.parsed.length,
options_index:this.options_index,
value:option.value,
text:option.text,
html:option.innerHTML,
selected:option.selected,
disabled:group_disabled===true?group_disabled:option.disabled,
group_array_index:group_position,
classes:option.className,
style:option.style.cssText
});
}else{
this.parsed.push({
array_index:this.parsed.length,
options_index:this.options_index,
empty:true
});
}
return this.options_index+=1;
}
};
SelectParser.prototype.escapeExpression=function(text){
var map,unsafe_chars;
if((text==null)||text===false){
return"";
}
if(!/[\&\<\>\"\'\`]/.test(text)){
return text;
}
map={
"<":"&lt;",
">":"&gt;",
'"':"&quot;",
"'":"&#x27;",
"`":"&#x60;"
};
unsafe_chars=/&(?!\w+;)|[\<\>\"\'\`]/g;
return text.replace(unsafe_chars,function(chr){
return map[chr]||"&amp;";
});
};
return SelectParser;
})();
SelectParser.select_to_array=function(select){
var child,parser,_i,_len,_ref;
parser=new SelectParser();
_ref=select.childNodes;
for(_i=0,_len=_ref.length;_i<_len;_i++){
child=_ref[_i];
parser.add_node(child);
}
return parser.parsed;
};
AbstractChosen=(function(){
function AbstractChosen(form_field,options){
this.form_field=form_field;
this.options=options!=null?options:{};
if(!AbstractChosen.browser_is_supported()){
return;
}
this.is_multiple=this.form_field.multiple;
this.set_default_text();
this.set_default_values();
this.setup();
this.set_up_html();
this.register_observers();
}
AbstractChosen.prototype.set_default_values=function(){
var _this=this;
this.click_test_action=function(evt){
return _this.test_active_click(evt);
};
this.activate_action=function(evt){
return _this.activate_field(evt);
};
this.active_field=false;
this.mouse_on_container=false;
this.results_showing=false;
this.result_highlighted=null;
this.result_single_selected=null;
this.allow_single_deselect=(this.options.allow_single_deselect!=null)&&(this.form_field.options[0]!=null)&&this.form_field.options[0].text===""?this.options.allow_single_deselect:false;
this.disable_search_threshold=this.options.disable_search_threshold||0;
this.disable_search=this.options.disable_search||false;
this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:true;
this.group_search=this.options.group_search!=null?this.options.group_search:true;
this.search_contains=this.options.search_contains||false;
this.single_backstroke_delete=this.options.single_backstroke_delete!=null?this.options.single_backstroke_delete:true;
this.max_selected_options=this.options.max_selected_options||Infinity;
this.inherit_select_classes=this.options.inherit_select_classes||false;
this.display_selected_options=this.options.display_selected_options!=null?this.options.display_selected_options:true;
return this.display_disabled_options=this.options.display_disabled_options!=null?this.options.display_disabled_options:true;
};
AbstractChosen.prototype.set_default_text=function(){
if(this.form_field.getAttribute("data-placeholder")){
this.default_text=this.form_field.getAttribute("data-placeholder");
}else if(this.is_multiple){
this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||AbstractChosen.default_multiple_text;
}else{
this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||AbstractChosen.default_single_text;
}
return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||AbstractChosen.default_no_result_text;
};
AbstractChosen.prototype.mouse_enter=function(){
return this.mouse_on_container=true;
};
AbstractChosen.prototype.mouse_leave=function(){
return this.mouse_on_container=false;
};
AbstractChosen.prototype.input_focus=function(evt){
var _this=this;
if(this.is_multiple){
if(!this.active_field){
return setTimeout((function(){
return _this.container_mousedown();
}),50);
}
}else{
if(!this.active_field){
return this.activate_field();
}
}
};
AbstractChosen.prototype.input_blur=function(evt){
var _this=this;
if(!this.mouse_on_container){
this.active_field=false;
return setTimeout((function(){
return _this.blur_test();
}),100);
}
};
AbstractChosen.prototype.results_option_build=function(options){
var content,data,_i,_len,_ref;
content='';
_ref=this.results_data;
for(_i=0,_len=_ref.length;_i<_len;_i++){
data=_ref[_i];
if(data.group){
content+=this.result_add_group(data);
}else{
content+=this.result_add_option(data);
}
if(options!=null?options.first:void 0){
if(data.selected&&this.is_multiple){
this.choice_build(data);
}else if(data.selected&&!this.is_multiple){
this.single_set_selected_text(data.text);
}
}
}
return content;
};
AbstractChosen.prototype.result_add_option=function(option){
var classes,style;
if(!option.search_match){
return'';
}
if(!this.include_option_in_results(option)){
return'';
}
classes=[];
if(!option.disabled&&!(option.selected&&this.is_multiple)){
classes.push("active-result");
}
if(option.disabled&&!(option.selected&&this.is_multiple)){
classes.push("disabled-result");
}
if(option.selected){
classes.push("result-selected");
}
if(option.group_array_index!=null){
classes.push("group-option");
}
if(option.classes!==""){
classes.push(option.classes);
}
style=option.style.cssText!==""?" style=\""+option.style+"\"":"";
return"<li class=\""+(classes.join(' '))+"\""+style+" data-option-array-index=\""+option.array_index+"\">"+option.search_text+"</li>";
};
AbstractChosen.prototype.result_add_group=function(group){
if(!(group.search_match||group.group_match)){
return'';
}
if(!(group.active_options>0)){
return'';
}
return"<li class=\"group-result\">"+group.search_text+"</li>";
};
AbstractChosen.prototype.results_update_field=function(){
this.set_default_text();
if(!this.is_multiple){
this.results_reset_cleanup();
}
this.result_clear_highlight();
this.result_single_selected=null;
this.results_build();
if(this.results_showing){
return this.winnow_results();
}
};
AbstractChosen.prototype.results_toggle=function(){
if(this.results_showing){
return this.results_hide();
}else{
return this.results_show();
}
};
AbstractChosen.prototype.results_search=function(evt){
if(this.results_showing){
return this.winnow_results();
}else{
return this.results_show();
}
};
AbstractChosen.prototype.winnow_results=function(){
var escapedSearchText,option,regex,regexAnchor,results,results_group,searchText,startpos,text,zregex,_i,_len,_ref;
this.no_results_clear();
results=0;
searchText=this.get_search_text();
escapedSearchText=searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");
regexAnchor=this.search_contains?"":"^";
regex=new RegExp(regexAnchor+escapedSearchText,'i');
zregex=new RegExp(escapedSearchText,'i');
_ref=this.results_data;
for(_i=0,_len=_ref.length;_i<_len;_i++){
option=_ref[_i];
option.search_match=false;
results_group=null;
if(this.include_option_in_results(option)){
if(option.group){
option.group_match=false;
option.active_options=0;
}
if((option.group_array_index!=null)&&this.results_data[option.group_array_index]){
results_group=this.results_data[option.group_array_index];
if(results_group.active_options===0&&results_group.search_match){
results+=1;
}
results_group.active_options+=1;
}
if(!(option.group&&!this.group_search)){
option.search_text=option.group?option.label:option.html;
option.search_match=this.search_string_match(option.search_text,regex);
if(option.search_match&&!option.group){
results+=1;
}
if(option.search_match){
if(searchText.length){
startpos=option.search_text.search(zregex);
text=option.search_text.substr(0,startpos+searchText.length)+'</em>'+option.search_text.substr(startpos+searchText.length);
option.search_text=text.substr(0,startpos)+'<em>'+text.substr(startpos);
}
if(results_group!=null){
results_group.group_match=true;
}
}else if((option.group_array_index!=null)&&this.results_data[option.group_array_index].search_match){
option.search_match=true;
}
}
}
}
this.result_clear_highlight();
if(results<1&&searchText.length){
this.update_results_content("");
return this.no_results(searchText);
}else{
this.update_results_content(this.results_option_build());
return this.winnow_results_set_highlight();
}
};
AbstractChosen.prototype.search_string_match=function(search_string,regex){
var part,parts,_i,_len;
if(regex.test(search_string)){
return true;
}else if(this.enable_split_word_search&&(search_string.indexOf(" ")>=0||search_string.indexOf("[")===0)){
parts=search_string.replace(/\[|\]/g,"").split(" ");
if(parts.length){
for(_i=0,_len=parts.length;_i<_len;_i++){
part=parts[_i];
if(regex.test(part)){
return true;
}
}
}
}
};
AbstractChosen.prototype.choices_count=function(){
var option,_i,_len,_ref;
if(this.selected_option_count!=null){
return this.selected_option_count;
}
this.selected_option_count=0;
_ref=this.form_field.options;
for(_i=0,_len=_ref.length;_i<_len;_i++){
option=_ref[_i];
if(option.selected){
this.selected_option_count+=1;
}
}
return this.selected_option_count;
};
AbstractChosen.prototype.choices_click=function(evt){
evt.preventDefault();
if(!(this.results_showing||this.is_disabled)){
return this.results_show();
}
};
AbstractChosen.prototype.keyup_checker=function(evt){
var stroke,_ref;
stroke=(_ref=evt.which)!=null?_ref:evt.keyCode;
this.search_field_scale();
switch(stroke){
case 8:
if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0){
return this.keydown_backstroke();
}else if(!this.pending_backstroke){
this.result_clear_highlight();
return this.results_search();
}
break;
case 13:
evt.preventDefault();
if(this.results_showing){
return this.result_select(evt);
}
break;
case 27:
if(this.results_showing){
this.results_hide();
}
return true;
case 9:
case 38:
case 40:
case 16:
case 91:
case 17:
break;
default:
return this.results_search();
}
};
AbstractChosen.prototype.container_width=function(){
if(this.options.width!=null){
return this.options.width;
}else{
return""+this.form_field.offsetWidth+"px";
}
};
AbstractChosen.prototype.include_option_in_results=function(option){
if(this.is_multiple&&(!this.display_selected_options&&option.selected)){
return false;
}
if(!this.display_disabled_options&&option.disabled){
return false;
}
if(option.empty){
return false;
}
return true;
};
AbstractChosen.browser_is_supported=function(){
if(window.navigator.appName==="Microsoft Internet Explorer"){
return document.documentMode>=8;
}
if(/iP(od|hone)/i.test(window.navigator.userAgent)){
return false;
}
if(/Android/i.test(window.navigator.userAgent)){
if(/Mobile/i.test(window.navigator.userAgent)){
return false;
}
}
return true;
};
AbstractChosen.default_multiple_text="";AbstractChosen.default_single_text="Select an Option";
AbstractChosen.default_no_result_text="No playlists match";return AbstractChosen;
})();
$=jQuery;
$.fn.extend({
chosen:function(options){
if(!AbstractChosen.browser_is_supported()){
return this;
}
return this.each(function(input_field){
var $this,chosen;
$this=$(this);
chosen=$this.data('chosen');
if(options==='destroy'&&chosen){
chosen.destroy();
}else if(!chosen){
$this.data('chosen',new Chosen(this,options));
}
});
}
});
Chosen=(function(_super){
__extends(Chosen,_super);
function Chosen(){
_ref=Chosen.__super__.constructor.apply(this,arguments);
return _ref;
}
Chosen.prototype.setup=function(){
this.form_field_jq=$(this.form_field);
this.current_selectedIndex=this.form_field.selectedIndex;
return this.is_rtl=this.form_field_jq.hasClass("chosen-rtl");
};
Chosen.prototype.set_up_html=function(){
var container_classes,container_props;
container_classes=["chosen-container"];
container_classes.push("chosen-container-"+(this.is_multiple?"multi":"single"));
if(this.inherit_select_classes&&this.form_field.className){
container_classes.push(this.form_field.className);
}
if(this.is_rtl){
container_classes.push("chosen-rtl");
}
container_props={
'class':container_classes.join(' '),
'style':"width: "+(this.container_width())+";",
'title':this.form_field.title
};
if(this.form_field.id.length){
container_props.id=this.form_field.id.replace(/[^\w]/g,'_')+"_chosen";
}
this.container=$("<div />",container_props);
if(this.is_multiple){
this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>');
}else{
this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>');
}
this.form_field_jq.hide().after(this.container);
this.dropdown=this.container.find('div.chosen-drop').first();
this.search_field=this.container.find('input').first();
this.search_results=this.container.find('ul.chosen-results').first();
this.search_field_scale();
this.search_no_results=this.container.find('li.no-results').first();
if(this.is_multiple){
this.search_choices=this.container.find('ul.chosen-choices').first();
this.search_container=this.container.find('li.search-field').first();
}else{
this.search_container=this.container.find('div.chosen-search').first();
this.selected_item=this.container.find('.chosen-single').first();
}
this.results_build();
this.set_tab_index();
this.set_label_behavior();
return this.form_field_jq.trigger("chosen:ready",{
chosen:this
});
};
Chosen.prototype.register_observers=function(){
var _this=this;
this.container.bind('mousedown.chosen',function(evt){
_this.container_mousedown(evt);
});
this.container.bind('mouseup.chosen',function(evt){
_this.container_mouseup(evt);
});
this.container.bind('mouseenter.chosen',function(evt){
_this.mouse_enter(evt);
});
this.container.bind('mouseleave.chosen',function(evt){
_this.mouse_leave(evt);
});
this.search_results.bind('mouseup.chosen',function(evt){
_this.search_results_mouseup(evt);
});
this.search_results.bind('mouseover.chosen',function(evt){
_this.search_results_mouseover(evt);
});
this.search_results.bind('mouseout.chosen',function(evt){
_this.search_results_mouseout(evt);
});
this.search_results.bind('mousewheel.chosen DOMMouseScroll.chosen',function(evt){
_this.search_results_mousewheel(evt);
});
this.form_field_jq.bind("chosen:updated.chosen",function(evt){
_this.results_update_field(evt);
});
this.form_field_jq.bind("chosen:activate.chosen",function(evt){
_this.activate_field(evt);
});
this.form_field_jq.bind("chosen:open.chosen",function(evt){
_this.container_mousedown(evt);
});
this.form_field_jq.bind("chosen:close.chosen",function(evt){
_this.close_field(evt);
});
this.search_field.bind('blur.chosen',function(evt){
_this.input_blur(evt);
});
this.search_field.bind('keyup.chosen',function(evt){
_this.keyup_checker(evt);
});
this.search_field.bind('keydown.chosen',function(evt){
_this.keydown_checker(evt);
});
this.search_field.bind('focus.chosen',function(evt){
_this.input_focus(evt);
});
if(this.is_multiple){
return this.search_choices.bind('click.chosen',function(evt){
_this.choices_click(evt);
});
}else{
return this.container.bind('click.chosen',function(evt){
evt.preventDefault();
});
}
};
Chosen.prototype.destroy=function(){
$(document).unbind("click.chosen",this.click_test_action);
if(this.search_field[0].tabIndex){
this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex;
}
this.container.remove();
this.form_field_jq.removeData('chosen');
return this.form_field_jq.show();
};
Chosen.prototype.search_field_disabled=function(){
this.is_disabled=this.form_field_jq[0].disabled;
if(this.is_disabled){
this.container.addClass('chosen-disabled');
this.search_field[0].disabled=true;
if(!this.is_multiple){
this.selected_item.unbind("focus.chosen",this.activate_action);
}
return this.close_field();
}else{
this.container.removeClass('chosen-disabled');
this.search_field[0].disabled=false;
if(!this.is_multiple){
return this.selected_item.bind("focus.chosen",this.activate_action);
}
}
};
Chosen.prototype.container_mousedown=function(evt){
if(!this.is_disabled){
if(evt&&evt.type==="mousedown"&&!this.results_showing){
evt.preventDefault();
}
if(!((evt!=null)&&($(evt.target)).hasClass("search-choice-close"))){
if(!this.active_field){
if(this.is_multiple){
this.search_field.val("");
}
$(document).bind('click.chosen',this.click_test_action);
this.results_show();
}else if(!this.is_multiple&&evt&&(($(evt.target)[0]===this.selected_item[0])||$(evt.target).parents("a.chosen-single").length)){
evt.preventDefault();
this.results_toggle();
}
return this.activate_field();
}
}
};
Chosen.prototype.container_mouseup=function(evt){
if(evt.target.nodeName==="ABBR"&&!this.is_disabled){
return this.results_reset(evt);
}
};
Chosen.prototype.search_results_mousewheel=function(evt){
var delta,_ref1,_ref2;
delta=-((_ref1=evt.originalEvent)!=null?_ref1.wheelDelta:void 0)||((_ref2=evt.originialEvent)!=null?_ref2.detail:void 0);
if(delta!=null){
evt.preventDefault();
if(evt.type==='DOMMouseScroll'){
delta=delta*40;
}
return this.search_results.scrollTop(delta+this.search_results.scrollTop());
}
};
Chosen.prototype.blur_test=function(evt){
if(!this.active_field&&this.container.hasClass("chosen-container-active")){
return this.close_field();
}
};
Chosen.prototype.close_field=function(){
$(document).unbind("click.chosen",this.click_test_action);
this.active_field=false;
this.results_hide();
this.container.removeClass("chosen-container-active");
this.clear_backstroke();
this.show_search_field_default();
return this.search_field_scale();
};
Chosen.prototype.activate_field=function(){
this.container.addClass("chosen-container-active");
this.active_field=true;
this.search_field.val(this.search_field.val());
return this.search_field.focus();
};
Chosen.prototype.test_active_click=function(evt){
if(this.container.is($(evt.target).closest('.chosen-container'))){
return this.active_field=true;
}else{
return this.close_field();
}
};
Chosen.prototype.results_build=function(){
if(!this.form_field.options)
this.form_field.options=[];
this.parsing=true;
this.selected_option_count=null;
this.results_data=SelectParser.select_to_array(this.form_field);
if(this.is_multiple){
this.search_choices.find("li.search-choice").remove();
}else if(!this.is_multiple){
this.single_set_selected_text();
if(this.disable_search||this.form_field.options.length<=this.disable_search_threshold){
this.search_field[0].readOnly=true;
this.container.addClass("chosen-container-single-nosearch");
}else{
this.search_field[0].readOnly=false;
this.container.removeClass("chosen-container-single-nosearch");
}
}
this.update_results_content(this.results_option_build({
first:true
}));
this.search_field_disabled();
this.show_search_field_default();
this.search_field_scale();
return this.parsing=false;
};
Chosen.prototype.result_do_highlight=function(el){
var high_bottom,high_top,maxHeight,visible_bottom,visible_top;
if(el.length){
this.result_clear_highlight();
this.result_highlight=el;
this.result_highlight.addClass("highlighted");
maxHeight=parseInt(this.search_results.css("maxHeight"),10);
visible_top=this.search_results.scrollTop();
visible_bottom=maxHeight+visible_top;
high_top=this.result_highlight.position().top+this.search_results.scrollTop();
high_bottom=high_top+this.result_highlight.outerHeight();
if(high_bottom>=visible_bottom){
return this.search_results.scrollTop((high_bottom-maxHeight)>0?high_bottom-maxHeight:0);
}else if(high_top<visible_top){
return this.search_results.scrollTop(high_top);
}
}
};
Chosen.prototype.result_clear_highlight=function(){
if(this.result_highlight){
this.result_highlight.removeClass("highlighted");
}
return this.result_highlight=null;
};
Chosen.prototype.results_show=function(){
if(this.is_multiple&&this.max_selected_options<=this.choices_count()){
this.form_field_jq.trigger("chosen:maxselected",{
chosen:this
});
return false;
}
this.container.addClass("chosen-with-drop");
this.form_field_jq.trigger("chosen:showing_dropdown",{
chosen:this
});
this.results_showing=true;
this.search_field.focus();
this.search_field.val(this.search_field.val());
return this.winnow_results();
};
Chosen.prototype.update_results_content=function(content){
return this.search_results.html(content);
};
Chosen.prototype.results_hide=function(){
if(this.results_showing){
this.result_clear_highlight();
this.container.removeClass("chosen-with-drop");
this.form_field_jq.trigger("chosen:hiding_dropdown",{
chosen:this
});
}
return this.results_showing=false;
};
Chosen.prototype.set_tab_index=function(el){
var ti;
if(this.form_field.tabIndex){
ti=this.form_field.tabIndex;
this.form_field.tabIndex=-1;
return this.search_field[0].tabIndex=ti;
}
};
Chosen.prototype.set_label_behavior=function(){
var _this=this;
this.form_field_label=this.form_field_jq.parents("label");
if(!this.form_field_label.length&&this.form_field.id.length){
this.form_field_label=$("label[for='"+this.form_field.id+"']");
}
if(this.form_field_label.length>0){
return this.form_field_label.bind('click.chosen',function(evt){
if(_this.is_multiple){
return _this.container_mousedown(evt);
}else{
return _this.activate_field();
}
});
}
};
Chosen.prototype.show_search_field_default=function(){
if(this.is_multiple&&this.choices_count()<1&&!this.active_field){
this.search_field.val(this.default_text);
return this.search_field.addClass("default");
}else{
this.search_field.val("");
return this.search_field.removeClass("default");
}
};
Chosen.prototype.search_results_mouseup=function(evt){
var target;
target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();
if(target.length){
this.result_highlight=target;
this.result_select(evt);
return this.search_field.focus();
}
};
Chosen.prototype.search_results_mouseover=function(evt){
var target;
target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();
if(target){
return this.result_do_highlight(target);
}
};
Chosen.prototype.search_results_mouseout=function(evt){
if($(evt.target).hasClass("active-result"||$(evt.target).parents('.active-result').first())){
return this.result_clear_highlight();
}
};
Chosen.prototype.choice_build=function(item){
var choice,close_link,
_this=this;
var html="<span>"+item.html+"</span>"

choice=$('<li />',{
"class":"search-choice "+item.classes}).html(html);if(item.disabled){
choice.addClass('search-choice-disabled');
}else{
close_link=$('<a />',{
"class":'search-choice-close',
'data-option-array-index':item.array_index
});
close_link.bind('click.chosen',function(evt){
return _this.choice_destroy_link_click(evt);
});
choice.append(close_link);
$scope.safeApply()}
return this.search_container.before(choice);
};
Chosen.prototype.choice_destroy_link_click=function(evt){
evt.preventDefault();
evt.stopPropagation();
if(!this.is_disabled){
return this.choice_destroy($(evt.target));
}
};
Chosen.prototype.choice_destroy=function(link){
if(this.result_deselect(link[0].getAttribute("data-option-array-index"))){
this.show_search_field_default();
if(this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1){
this.results_hide();
}
link.parents('li').first().remove();
return this.search_field_scale();
}
};
Chosen.prototype.results_reset=function(){
this.form_field.options[0].selected=true;
this.selected_option_count=null;
this.single_set_selected_text();
this.show_search_field_default();
this.results_reset_cleanup();
this.form_field_jq.trigger("change");
if(this.active_field){
return this.results_hide();
}
};
Chosen.prototype.results_reset_cleanup=function(){
this.current_selectedIndex=this.form_field.selectedIndex;
return this.selected_item.find("abbr").remove();
};
Chosen.prototype.result_select=function(evt){
var high,item,selected_index;
if(this.result_highlight){
high=this.result_highlight;
this.result_clear_highlight();
if(this.is_multiple&&this.max_selected_options<=this.choices_count()){
this.form_field_jq.trigger("chosen:maxselected",{
chosen:this
});
return false;
}
if(this.is_multiple){
high.removeClass("active-result");
}else{
if(this.result_single_selected){
this.result_single_selected.removeClass("result-selected");
selected_index=this.result_single_selected[0].getAttribute('data-option-array-index');
this.results_data[selected_index].selected=false;
}
this.result_single_selected=high;
}
high.addClass("result-selected");
item=this.results_data[high[0].getAttribute("data-option-array-index")];
item.selected=true;
this.form_field.options[item.options_index].selected=true;
this.selected_option_count=null;
if(this.is_multiple){
this.choice_build(item);
}else{
this.single_set_selected_text(item.text);
}
if(!((evt.metaKey||evt.ctrlKey)&&this.is_multiple)){
this.results_hide();
}
this.search_field.val("");
if(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex){
this.form_field_jq.trigger("change",{
'selected':this.form_field.options[item.options_index].value
});
}
this.current_selectedIndex=this.form_field.selectedIndex;
return this.search_field_scale();
}
};
Chosen.prototype.single_set_selected_text=function(text){
if(text==null){
text=this.default_text;
}
if(text===this.default_text){
this.selected_item.addClass("chosen-default");
}else{
this.single_deselect_control_build();
this.selected_item.removeClass("chosen-default");
}
return this.selected_item.find("span").text(text);
};
Chosen.prototype.result_deselect=function(pos){
var result_data;
result_data=this.results_data[pos];
if(!this.form_field.options[result_data.options_index].disabled){
result_data.selected=false;
this.form_field.options[result_data.options_index].selected=false;
this.selected_option_count=null;
this.result_clear_highlight();
if(this.results_showing){
this.winnow_results();
}
this.form_field_jq.trigger("change",{
deselected:this.form_field.options[result_data.options_index].value
});
this.search_field_scale();
return true;
}else{
return false;
}
};
Chosen.prototype.single_deselect_control_build=function(){
if(!this.allow_single_deselect){
return;
}
if(!this.selected_item.find("abbr").length){
this.selected_item.find("span").first().after("<abbr class=\"search-choice-close\"></abbr>");
}
return this.selected_item.addClass("chosen-single-with-deselect");
};
Chosen.prototype.get_search_text=function(){
if(this.search_field.val()===this.default_text){
return"";
}else{
return $('<div/>').text($.trim(this.search_field.val())).html();
}
};
Chosen.prototype.winnow_results_set_highlight=function(){
var do_high,selected_results;
selected_results=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];
do_high=selected_results.length?selected_results.first():this.search_results.find(".active-result").first();
if(do_high!=null){
return this.result_do_highlight(do_high);
}
};
Chosen.prototype.no_results=function(terms){
var no_results_html;
no_results_html=$('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');
no_results_html.find("span").first().html(terms);
return this.search_results.append(no_results_html);
};
Chosen.prototype.no_results_clear=function(){
return this.search_results.find(".no-results").remove();
};
Chosen.prototype.keydown_arrow=function(){
var next_sib;
if(this.results_showing&&this.result_highlight){
next_sib=this.result_highlight.nextAll("li.active-result").first();
if(next_sib){
return this.result_do_highlight(next_sib);
}
}else{
return this.results_show();
}
};
Chosen.prototype.keyup_arrow=function(){
var prev_sibs;
if(!this.results_showing&&!this.is_multiple){
return this.results_show();
}else if(this.result_highlight){
prev_sibs=this.result_highlight.prevAll("li.active-result");
if(prev_sibs.length){
return this.result_do_highlight(prev_sibs.first());
}else{
if(this.choices_count()>0){
this.results_hide();
}
return this.result_clear_highlight();
}
}
};
Chosen.prototype.keydown_backstroke=function(){
var next_available_destroy;
if(this.pending_backstroke){
this.choice_destroy(this.pending_backstroke.find("a").first());
return this.clear_backstroke();
}else{
next_available_destroy=this.search_container.siblings("li.search-choice").last();
if(next_available_destroy.length&&!next_available_destroy.hasClass("search-choice-disabled")){
this.pending_backstroke=next_available_destroy;
if(this.single_backstroke_delete){
return this.keydown_backstroke();
}else{
return this.pending_backstroke.addClass("search-choice-focus");
}
}
}
};
Chosen.prototype.clear_backstroke=function(){
if(this.pending_backstroke){
this.pending_backstroke.removeClass("search-choice-focus");
}
return this.pending_backstroke=null;
};
Chosen.prototype.keydown_checker=function(evt){
var stroke,_ref1;
stroke=(_ref1=evt.which)!=null?_ref1:evt.keyCode;
this.search_field_scale();
if(stroke!==8&&this.pending_backstroke){
this.clear_backstroke();
}
switch(stroke){
case 8:
this.backstroke_length=this.search_field.val().length;
break;
case 9:
if(this.results_showing&&!this.is_multiple){
this.result_select(evt);
}
this.mouse_on_container=false;
break;
case 13:
evt.preventDefault();
break;
case 38:
evt.preventDefault();
this.keyup_arrow();
break;
case 40:
evt.preventDefault();
this.keydown_arrow();
break;
}
};
Chosen.prototype.search_field_scale=function(){
var div,f_width,h,style,style_block,styles,w,_i,_len;
if(this.is_multiple){
h=0;
w=0;
style_block="position:absolute; left: -1000px; top: -1000px; display:none;";
styles=['font-size','font-style','font-weight','font-family','line-height','text-transform','letter-spacing'];
for(_i=0,_len=styles.length;_i<_len;_i++){
style=styles[_i];
style_block+=style+":"+this.search_field.css(style)+";";
}
div=$('<div />',{
'style':style_block
});
if(this.search_field.val()=="")var text=$("#playlistselectvertical .search-field input").attr("placeholder");
else
text=this.search_field.val();
setTimeout(function(){
$(".search-field input").css("opacity","");
},0)
div.text(text);
$('body').append(div);
w=div.width()+25;
div.remove();
f_width=this.container.outerWidth();
if(w>f_width-10){
w=f_width-10;
}
return this.search_field.css({
'width':w+'px'
});
}
};
return Chosen;
})(AbstractChosen);
}).call(this);
;

;"use strict";
var clickarea=document.getElementById('clickarea');
var clickresultfast=document.getElementById('clickresultfast');
var clickresultslow=document.getElementById('clickresultslow');
clickarea.addEventListener('fastclick',function(e){
if(e.detail==clickarea){
var currentTime=new Date().getMilliseconds();
clickresultfast.innerText='Fast Click: '+(currentTime-touchStartTime)+'ms';
}
},false);
clickarea.addEventListener('click',function(e){
if(e.target==clickarea){
var currentTime=new Date().getMilliseconds();
clickresultslow.innerText='Normal Click: '+(currentTime-touchStartTime)+'ms';
}
},false);
var touchStartTime=false;
document.addEventListener('touchstart',function(){
touchStartTime=new Date().getMilliseconds();
},false);
(function(){
var touchClick=false;
document.addEventListener("touchstart",function(){
touchClick=true
},false);
document.addEventListener("touchmove",function(){
touchClick=false
},false);
document.addEventListener("touchend",function(e){
if(touchClick){
touchClick=false;
var event=document.createEvent("CustomEvent");
event.initCustomEvent("fastclick",true,true,e.target);
e.target.dispatchEvent(event);
}
},false);
}());
;

;
(function(window,undefined){
'use strict';

var Hammer=function(element,options){
return new Hammer.Instance(element,options||{});
};
Hammer.defaults={
stop_browser_behavior:{
userSelect:'none',
touchAction:'none',
touchCallout:'none',
contentZooming:'none',
userDrag:'none',
tapHighlightColor:'rgba(0,0,0,0)'
}
};
Hammer.HAS_POINTEREVENTS=window.navigator.pointerEnabled||window.navigator.msPointerEnabled;
Hammer.HAS_TOUCHEVENTS=('ontouchstart'in window);
Hammer.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i;
Hammer.NO_MOUSEEVENTS=Hammer.HAS_TOUCHEVENTS&&window.navigator.userAgent.match(Hammer.MOBILE_REGEX);
Hammer.EVENT_TYPES={};
Hammer.DIRECTION_DOWN='down';
Hammer.DIRECTION_LEFT='left';
Hammer.DIRECTION_UP='up';
Hammer.DIRECTION_RIGHT='right';
Hammer.POINTER_MOUSE='mouse';
Hammer.POINTER_TOUCH='touch';
Hammer.POINTER_PEN='pen';
Hammer.EVENT_START='start';
Hammer.EVENT_MOVE='move';
Hammer.EVENT_END='end';
Hammer.DOCUMENT=window.document;
Hammer.plugins=Hammer.plugins||{};
Hammer.gestures=Hammer.gestures||{};
Hammer.READY=false;

function setup(){
if(Hammer.READY){
return;
}
Hammer.event.determineEventTypes();
Hammer.utils.each(Hammer.gestures,function(gesture){
Hammer.detection.register(gesture);
});
Hammer.event.onTouch(Hammer.DOCUMENT,Hammer.EVENT_MOVE,Hammer.detection.detect);
Hammer.event.onTouch(Hammer.DOCUMENT,Hammer.EVENT_END,Hammer.detection.detect);
Hammer.READY=true;
}
Hammer.utils={

extend:function extend(dest,src,merge){
for(var key in src){
if(dest[key]!==undefined&&merge){
continue;
}
dest[key]=src[key];
}
return dest;
},

each:function(obj,iterator,context){
var i,length;
if('forEach'in obj){
obj.forEach(iterator,context);
}
else if(obj.length!==undefined){
for(i=0,length=obj.length;i<length;i++){
if(iterator.call(context,obj[i],i,obj)===false){
return;
}
}
}
else{
for(i in obj){
if(obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)===false){
return;
}
}
}
},

hasParent:function(node,parent){
while(node){
if(node==parent){
return true;
}
node=node.parentNode;
}
return false;
},

getCenter:function getCenter(touches){
var valuesX=[],valuesY=[];
Hammer.utils.each(touches,function(touch){
valuesX.push(typeof touch.clientX!=='undefined'?touch.clientX:touch.pageX);
valuesY.push(typeof touch.clientY!=='undefined'?touch.clientY:touch.pageY);
});
return{
pageX:((Math.min.apply(Math,valuesX)+Math.max.apply(Math,valuesX))/2),
pageY:((Math.min.apply(Math,valuesY)+Math.max.apply(Math,valuesY))/2)
};
},

getVelocity:function getVelocity(delta_time,delta_x,delta_y){
return{
x:Math.abs(delta_x/delta_time)||0,
y:Math.abs(delta_y/delta_time)||0
};
},

getAngle:function getAngle(touch1,touch2){
var y=touch2.pageY-touch1.pageY,
x=touch2.pageX-touch1.pageX;
return Math.atan2(y,x)*180/Math.PI;
},

getDirection:function getDirection(touch1,touch2){
var x=Math.abs(touch1.pageX-touch2.pageX),
y=Math.abs(touch1.pageY-touch2.pageY);
if(x>=y){
return touch1.pageX-touch2.pageX>0?Hammer.DIRECTION_LEFT:Hammer.DIRECTION_RIGHT;
}
else{
return touch1.pageY-touch2.pageY>0?Hammer.DIRECTION_UP:Hammer.DIRECTION_DOWN;
}
},

getDistance:function getDistance(touch1,touch2){
var x=touch2.pageX-touch1.pageX,
y=touch2.pageY-touch1.pageY;
return Math.sqrt((x*x)+(y*y));
},

getScale:function getScale(start,end){
if(start.length>=2&&end.length>=2){
return this.getDistance(end[0],end[1])/
this.getDistance(start[0],start[1]);
}
return 1;
},

getRotation:function getRotation(start,end){
if(start.length>=2&&end.length>=2){
return this.getAngle(end[1],end[0])-
this.getAngle(start[1],start[0]);
}
return 0;
},

isVertical:function isVertical(direction){
return(direction==Hammer.DIRECTION_UP||direction==Hammer.DIRECTION_DOWN);
},

stopDefaultBrowserBehavior:function stopDefaultBrowserBehavior(element,css_props){
if(!css_props||!element||!element.style){
return;
}
Hammer.utils.each(['webkit','khtml','moz','Moz','ms','o',''],function(vendor){
Hammer.utils.each(css_props,function(prop){
if(vendor){
prop=vendor+prop.substring(0,1).toUpperCase()+prop.substring(1);
}
if(prop in element.style){
element.style[prop]=prop;
}
});
});
if(css_props.userSelect=='none'){
element.onselectstart=function(){
return false;
};
}
if(css_props.userDrag=='none'){
element.ondragstart=function(){
return false;
};
}
}
};

Hammer.Instance=function(element,options){
var self=this;
setup();
this.element=element;
this.enabled=true;
this.options=Hammer.utils.extend(
Hammer.utils.extend({},Hammer.defaults),
options||{});
if(this.options.stop_browser_behavior){
Hammer.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior);
}
Hammer.event.onTouch(element,Hammer.EVENT_START,function(ev){
if(self.enabled){
Hammer.detection.startDetect(self,ev);
}
});
return this;
};
Hammer.Instance.prototype={

on:function onEvent(gesture,handler){
var gestures=gesture.split(' ');
Hammer.utils.each(gestures,function(gesture){
this.element.addEventListener(gesture,handler,false);
},this);
return this;
},

off:function offEvent(gesture,handler){
var gestures=gesture.split(' ');
Hammer.utils.each(gestures,function(gesture){
this.element.removeEventListener(gesture,handler,false);
},this);
return this;
},

trigger:function triggerEvent(gesture,eventData){
if(!eventData){
eventData={};
}
var event=Hammer.DOCUMENT.createEvent('Event');
event.initEvent(gesture,true,true);
event.gesture=eventData;
var element=this.element;
if(Hammer.utils.hasParent(eventData.target,element)){
element=eventData.target;
}
element.dispatchEvent(event);
return this;
},

enable:function enable(state){
this.enabled=state;
return this;
}
};

var last_move_event=null;

var enable_detect=false;

var touch_triggered=false;
Hammer.event={

bindDom:function(element,type,handler){
var types=type.split(' ');
Hammer.utils.each(types,function(type){
element.addEventListener(type,handler,false);
});
},

onTouch:function onTouch(element,eventType,handler){
var self=this;
this.bindDom(element,Hammer.EVENT_TYPES[eventType],function bindDomOnTouch(ev){
var sourceEventType=ev.type.toLowerCase();
if(sourceEventType.match(/mouse/)&&touch_triggered){
return;
}
else if(sourceEventType.match(/touch/)||sourceEventType.match(/pointerdown/)||(sourceEventType.match(/mouse/)&&ev.which===1)){
enable_detect=true;
}
else if(sourceEventType.match(/mouse/)&&!ev.which){
enable_detect=false;
}
if(sourceEventType.match(/touch|pointer/)){
touch_triggered=true;
}
var count_touches=0;
if(enable_detect){
if(Hammer.HAS_POINTEREVENTS&&eventType!=Hammer.EVENT_END){
count_touches=Hammer.PointerEvent.updatePointer(eventType,ev);
}
else if(sourceEventType.match(/touch/)){
count_touches=ev.touches.length;
}
else if(!touch_triggered){
count_touches=sourceEventType.match(/up/)?0:1;
}
if(count_touches>0&&eventType==Hammer.EVENT_END){
eventType=Hammer.EVENT_MOVE;
}
else if(!count_touches){
eventType=Hammer.EVENT_END;
}
if(count_touches||last_move_event===null){
last_move_event=ev;
}
handler.call(Hammer.detection,self.collectEventData(element,eventType,self.getTouchList(last_move_event,eventType),ev));
if(Hammer.HAS_POINTEREVENTS&&eventType==Hammer.EVENT_END){
count_touches=Hammer.PointerEvent.updatePointer(eventType,ev);
}
}
if(!count_touches){
last_move_event=null;
enable_detect=false;
touch_triggered=false;
Hammer.PointerEvent.reset();
}
});
},

determineEventTypes:function determineEventTypes(){
var types;
if(Hammer.HAS_POINTEREVENTS){
types=Hammer.PointerEvent.getEvents();
}
else if(Hammer.NO_MOUSEEVENTS){
types=[
'touchstart',
'touchmove',
'touchend touchcancel'];
}
else{
types=[
'touchstart mousedown',
'touchmove mousemove',
'touchend touchcancel mouseup'];
}
Hammer.EVENT_TYPES[Hammer.EVENT_START]=types[0];
Hammer.EVENT_TYPES[Hammer.EVENT_MOVE]=types[1];
Hammer.EVENT_TYPES[Hammer.EVENT_END]=types[2];
},

getTouchList:function getTouchList(ev){
if(Hammer.HAS_POINTEREVENTS){
return Hammer.PointerEvent.getTouchList();
}
else if(ev.touches){
return ev.touches;
}
else{
ev.identifier=1;
return[ev];
}
},

collectEventData:function collectEventData(element,eventType,touches,ev){
var pointerType=Hammer.POINTER_TOUCH;
if(ev.type.match(/mouse/)||Hammer.PointerEvent.matchType(Hammer.POINTER_MOUSE,ev)){
pointerType=Hammer.POINTER_MOUSE;
}
return{
center:Hammer.utils.getCenter(touches),
timeStamp:new Date().getTime(),
target:ev.target,
touches:touches,
eventType:eventType,
pointerType:pointerType,
srcEvent:ev,

preventDefault:function(){
if(this.srcEvent.preventManipulation){
this.srcEvent.preventManipulation();
}
if(this.srcEvent.preventDefault){
this.srcEvent.preventDefault();
}
},

stopPropagation:function(){
this.srcEvent.stopPropagation();
},

stopDetect:function(){
return Hammer.detection.stopDetect();
}
};
}
};
Hammer.PointerEvent={

pointers:{},

getTouchList:function(){
var self=this;
var touchlist=[];
Hammer.utils.each(self.pointers,function(pointer){
touchlist.push(pointer);
});
return touchlist;
},

updatePointer:function(type,pointerEvent){
if(type==Hammer.EVENT_END){
this.pointers={};
}
else{
pointerEvent.identifier=pointerEvent.pointerId;
this.pointers[pointerEvent.pointerId]=pointerEvent;
}
return Object.keys(this.pointers).length;
},

matchType:function(pointerType,ev){
if(!ev.pointerType){
return false;
}
var pt=ev.pointerType,
types={};
types[Hammer.POINTER_MOUSE]=(pt===ev.MSPOINTER_TYPE_MOUSE||pt===Hammer.POINTER_MOUSE);
types[Hammer.POINTER_TOUCH]=(pt===ev.MSPOINTER_TYPE_TOUCH||pt===Hammer.POINTER_TOUCH);
types[Hammer.POINTER_PEN]=(pt===ev.MSPOINTER_TYPE_PEN||pt===Hammer.POINTER_PEN);
return types[pointerType];
},

getEvents:function(){
return[
'pointerdown MSPointerDown',
'pointermove MSPointerMove',
'pointerup pointercancel MSPointerUp MSPointerCancel'
];
},

reset:function(){
this.pointers={};
}
};
Hammer.detection={
gestures:[],
current:null,
previous:null,
stopped:false,

startDetect:function startDetect(inst,eventData){
if(this.current){
return;
}
this.stopped=false;
this.current={
inst:inst,startEvent:Hammer.utils.extend({},eventData),lastEvent:false,name:''};
this.detect(eventData);
},

detect:function detect(eventData){
if(!this.current||this.stopped){
return;
}
eventData=this.extendEventData(eventData);
var inst_options=this.current.inst.options;
Hammer.utils.each(this.gestures,function(gesture){
if(!this.stopped&&inst_options[gesture.name]!==false){
if(gesture.handler.call(gesture,eventData,this.current.inst)===false){
this.stopDetect();
return false;
}
}
},this);
if(this.current){
this.current.lastEvent=eventData;
}
if(eventData.eventType==Hammer.EVENT_END&&!eventData.touches.length-1){
this.stopDetect();
}
return eventData;
},

stopDetect:function stopDetect(){
this.previous=Hammer.utils.extend({},this.current);
this.current=null;
this.stopped=true;
},

extendEventData:function extendEventData(ev){
var startEv=this.current.startEvent;
if(startEv&&(ev.touches.length!=startEv.touches.length||ev.touches===startEv.touches)){
startEv.touches=[];
Hammer.utils.each(ev.touches,function(touch){
startEv.touches.push(Hammer.utils.extend({},touch));
});
}
var delta_time=ev.timeStamp-startEv.timeStamp
,delta_x=ev.center.pageX-startEv.center.pageX
,delta_y=ev.center.pageY-startEv.center.pageY
,velocity=Hammer.utils.getVelocity(delta_time,delta_x,delta_y)
,interimAngle
,interimDirection;
if(ev.eventType==='end'){
interimAngle=this.current.lastEvent&&this.current.lastEvent.interimAngle;
interimDirection=this.current.lastEvent&&this.current.lastEvent.interimDirection;
}
else{
interimAngle=this.current.lastEvent&&Hammer.utils.getAngle(this.current.lastEvent.center,ev.center);
interimDirection=this.current.lastEvent&&Hammer.utils.getDirection(this.current.lastEvent.center,ev.center);
}
Hammer.utils.extend(ev,{
deltaTime:delta_time,
deltaX:delta_x,
deltaY:delta_y,
velocityX:velocity.x,
velocityY:velocity.y,
distance:Hammer.utils.getDistance(startEv.center,ev.center),
angle:Hammer.utils.getAngle(startEv.center,ev.center),
interimAngle:interimAngle,
direction:Hammer.utils.getDirection(startEv.center,ev.center),
interimDirection:interimDirection,
scale:Hammer.utils.getScale(startEv.touches,ev.touches),
rotation:Hammer.utils.getRotation(startEv.touches,ev.touches),
startEvent:startEv
});
return ev;
},

register:function register(gesture){
var options=gesture.defaults||{};
if(options[gesture.name]===undefined){
options[gesture.name]=true;
}
Hammer.utils.extend(Hammer.defaults,options,true);
gesture.index=gesture.index||1000;
this.gestures.push(gesture);
this.gestures.sort(function(a,b){
if(a.index<b.index){return-1}
if(a.index>b.index){return 1}
return 0;
});
return this.gestures;
}
};

Hammer.gestures.Drag={
name:'drag',
index:50,
defaults:{
drag_min_distance:10,
correct_for_drag_min_distance:true,
drag_max_touches:1,
drag_block_horizontal:false,
drag_block_vertical:false,
drag_lock_to_axis:false,
drag_lock_min_distance:25
},
triggered:false,
handler:function dragGesture(ev,inst){
if(Hammer.detection.current.name!=this.name&&this.triggered){
inst.trigger(this.name+'end',ev);
this.triggered=false;
return;
}
if(inst.options.drag_max_touches>0&&
ev.touches.length>inst.options.drag_max_touches){
return;
}
switch(ev.eventType){
case Hammer.EVENT_START:
this.triggered=false;
break;
case Hammer.EVENT_MOVE:
if(ev.distance<inst.options.drag_min_distance&&
Hammer.detection.current.name!=this.name){
return;
}
if(Hammer.detection.current.name!=this.name){
Hammer.detection.current.name=this.name;
if(inst.options.correct_for_drag_min_distance&&ev.distance>0){
var factor=Math.abs(inst.options.drag_min_distance/ev.distance);
Hammer.detection.current.startEvent.center.pageX+=ev.deltaX*factor;
Hammer.detection.current.startEvent.center.pageY+=ev.deltaY*factor;
ev=Hammer.detection.extendEventData(ev);
}
}
if(Hammer.detection.current.lastEvent.drag_locked_to_axis||(inst.options.drag_lock_to_axis&&inst.options.drag_lock_min_distance<=ev.distance)){
ev.drag_locked_to_axis=true;
}
var last_direction=Hammer.detection.current.lastEvent.direction;
if(ev.drag_locked_to_axis&&last_direction!==ev.direction){
if(Hammer.utils.isVertical(last_direction)){
ev.direction=(ev.deltaY<0)?Hammer.DIRECTION_UP:Hammer.DIRECTION_DOWN;
}
else{
ev.direction=(ev.deltaX<0)?Hammer.DIRECTION_LEFT:Hammer.DIRECTION_RIGHT;
}
}
if(!this.triggered){
inst.trigger(this.name+'start',ev);
this.triggered=true;
}
inst.trigger(this.name,ev);
inst.trigger(this.name+ev.direction,ev);
if((inst.options.drag_block_vertical&&Hammer.utils.isVertical(ev.direction))||
(inst.options.drag_block_horizontal&&!Hammer.utils.isVertical(ev.direction))){
ev.preventDefault();
}
break;
case Hammer.EVENT_END:
if(this.triggered){
inst.trigger(this.name+'end',ev);
}
this.triggered=false;
break;
}
}
};

Hammer.gestures.Hold={
name:'hold',
index:10,
defaults:{
hold_timeout:500,
hold_threshold:1
},
timer:null,
handler:function holdGesture(ev,inst){
switch(ev.eventType){
case Hammer.EVENT_START:
clearTimeout(this.timer);
Hammer.detection.current.name=this.name;
this.timer=setTimeout(function(){
if(Hammer.detection.current.name=='hold'){
inst.trigger('hold',ev);
}
},inst.options.hold_timeout);
break;
case Hammer.EVENT_MOVE:
if(ev.distance>inst.options.hold_threshold){
clearTimeout(this.timer);
}
break;
case Hammer.EVENT_END:
clearTimeout(this.timer);
break;
}
}
};

Hammer.gestures.Release={
name:'release',
index:Infinity,
handler:function releaseGesture(ev,inst){
if(ev.eventType==Hammer.EVENT_END){
inst.trigger(this.name,ev);
}
}
};

Hammer.gestures.Swipe={
name:'swipe',
index:40,
defaults:{
swipe_min_touches:1,
swipe_max_touches:1,
swipe_velocity:0.7
},
handler:function swipeGesture(ev,inst){
if(ev.eventType==Hammer.EVENT_END){
if(inst.options.swipe_max_touches>0&&
ev.touches.length<inst.options.swipe_min_touches&&
ev.touches.length>inst.options.swipe_max_touches){
return;
}
if(ev.velocityX>inst.options.swipe_velocity||
ev.velocityY>inst.options.swipe_velocity){
inst.trigger(this.name,ev);
inst.trigger(this.name+ev.direction,ev);
}
}
}
};

Hammer.gestures.Tap={
name:'tap',
index:100,
defaults:{
tap_max_touchtime:250,
tap_max_distance:10,
tap_always:true,
doubletap_distance:20,
doubletap_interval:300
},
handler:function tapGesture(ev,inst){
if(ev.eventType==Hammer.EVENT_END&&ev.srcEvent.type!='touchcancel'){
var prev=Hammer.detection.previous,
did_doubletap=false;
if(ev.deltaTime>inst.options.tap_max_touchtime||
ev.distance>inst.options.tap_max_distance){
return;
}
if(prev&&prev.name=='tap'&&
(ev.timeStamp-prev.lastEvent.timeStamp)<inst.options.doubletap_interval&&
ev.distance<inst.options.doubletap_distance){
inst.trigger('doubletap',ev);
did_doubletap=true;
}
if(!did_doubletap||inst.options.tap_always){
Hammer.detection.current.name='tap';
inst.trigger(Hammer.detection.current.name,ev);
}
}
}
};

Hammer.gestures.Touch={
name:'touch',
index:-Infinity,
defaults:{
prevent_default:false,
prevent_mouseevents:false
},
handler:function touchGesture(ev,inst){
if(inst.options.prevent_mouseevents&&ev.pointerType==Hammer.POINTER_MOUSE){
ev.stopDetect();
return;
}
if(inst.options.prevent_default){
ev.preventDefault();
}
if(ev.eventType==Hammer.EVENT_START){
inst.trigger(this.name,ev);
}
}
};

Hammer.gestures.Transform={
name:'transform',
index:45,
defaults:{
transform_min_scale:0.01,
transform_min_rotation:1,
transform_always_block:false
},
triggered:false,
handler:function transformGesture(ev,inst){
if(Hammer.detection.current.name!=this.name&&this.triggered){
inst.trigger(this.name+'end',ev);
this.triggered=false;
return;
}
if(ev.touches.length<2){
return;
}
if(inst.options.transform_always_block){
ev.preventDefault();
}
switch(ev.eventType){
case Hammer.EVENT_START:
this.triggered=false;
break;
case Hammer.EVENT_MOVE:
var scale_threshold=Math.abs(1-ev.scale);
var rotation_threshold=Math.abs(ev.rotation);
if(scale_threshold<inst.options.transform_min_scale&&
rotation_threshold<inst.options.transform_min_rotation){
return;
}
Hammer.detection.current.name=this.name;
if(!this.triggered){
inst.trigger(this.name+'start',ev);
this.triggered=true;
}
inst.trigger(this.name,ev);if(rotation_threshold>inst.options.transform_min_rotation){
inst.trigger('rotate',ev);
}
if(scale_threshold>inst.options.transform_min_scale){
inst.trigger('pinch',ev);
inst.trigger('pinch'+((ev.scale<1)?'in':'out'),ev);
}
break;
case Hammer.EVENT_END:
if(this.triggered){
inst.trigger(this.name+'end',ev);
}
this.triggered=false;
break;
}
}
};
if(typeof define=='function'&&typeof define.amd=='object'&&define.amd){
define(function(){
return Hammer;
});
}
else if(typeof module==='object'&&typeof module.exports==='object'){
module.exports=Hammer;
}
else{
window.Hammer=Hammer;
}
})(this);
;

;
(function(window,document,Math){
var rAF=window.requestAnimationFrame||
window.webkitRequestAnimationFrame||
window.mozRequestAnimationFrame||
window.oRequestAnimationFrame||
window.msRequestAnimationFrame||
function(callback){window.setTimeout(callback,1000/60)};
var utils=(function(){
var me={};
var _elementStyle=document.createElement('div').style;
var _vendor=(function(){
var vendors=['t','webkitT','MozT','msT','OT'],
transform,
i=0,
l=vendors.length;
for(;i<l;i++){
transform=vendors[i]+'ransform';
if(transform in _elementStyle)return vendors[i].substr(0,vendors[i].length-1);
}
return false;
})();
function _prefixStyle(style){
if(_vendor===false)return false;
if(_vendor==='')return style;
return _vendor+style.charAt(0).toUpperCase()+style.substr(1);
}
me.getTime=Date.now||function getTime(){return new Date().getTime()};
me.extend=function(target,obj){
for(var i in obj){
target[i]=obj[i];
}
};
me.addEvent=function(el,type,fn,capture){
el.addEventListener(type,fn,!!capture);
};
me.removeEvent=function(el,type,fn,capture){
el.removeEventListener(type,fn,!!capture);
};
me.momentum=function(current,start,time,lowerMargin,wrapperSize,deceleration){
var distance=current-start,
speed=Math.abs(distance)/time,
destination,
duration;
deceleration=deceleration===undefined?0.0006:deceleration;
destination=current+(speed*speed)/(2*deceleration)*(distance<0?-1:1);
duration=speed/deceleration;
if(destination<lowerMargin){
destination=wrapperSize?lowerMargin-(wrapperSize/2.5*(speed/8)):lowerMargin;
distance=Math.abs(destination-current);
duration=distance/speed;
}else if(destination>0){
destination=wrapperSize?wrapperSize/2.5*(speed/8):0;
distance=Math.abs(current)+destination;
duration=distance/speed;
}
return{
destination:Math.round(destination),
duration:duration
};
};
var _transform=_prefixStyle('transform');
me.extend(me,{
hasTransform:_transform!==false,
hasPerspective:_prefixStyle('perspective')in _elementStyle,
hasTouch:'ontouchstart'in window,
hasPointer:navigator.msPointerEnabled,
hasTransition:_prefixStyle('transition')in _elementStyle
});
me.isBadAndroid=/Android /.test(window.navigator.appVersion)&&!(/Chrome\/\d/.test(window.navigator.appVersion));
me.extend(me.style={},{
transform:_transform,
transitionTimingFunction:_prefixStyle('transitionTimingFunction'),
transitionDuration:_prefixStyle('transitionDuration'),
transitionDelay:_prefixStyle('transitionDelay'),
transformOrigin:_prefixStyle('transformOrigin')
});
me.hasClass=function(e,c){
var re=new RegExp("(^|\\s)"+c+"(\\s|$)");
return re.test(e.className);
};
me.addClass=function(e,c){
if(me.hasClass(e,c)){
return;
}
var newclass=e.className.split(' ');
newclass.push(c);
e.className=newclass.join(' ');
};
me.removeClass=function(e,c){
if(!me.hasClass(e,c)){
return;
}
var re=new RegExp("(^|\\s)"+c+"(\\s|$)",'g');
e.className=e.className.replace(re,' ');
};
me.offset=function(el){
var left=-el.offsetLeft,
top=-el.offsetTop;
while(el=el.offsetParent){
left-=el.offsetLeft;
top-=el.offsetTop;
}
return{
left:left,
top:top
};
};
me.preventDefaultException=function(el,exceptions){
for(var i in exceptions){
if(exceptions[i].test(el[i])){
return true;
}
}
return false;
};
me.extend(me.eventType={},{
touchstart:1,
touchmove:1,
touchend:1,
mousedown:2,
mousemove:2,
mouseup:2,
MSPointerDown:3,
MSPointerMove:3,
MSPointerUp:3
});
me.extend(me.ease={},{
quadratic:{
style:'cubic-bezier(0.25, 0.46, 0.45, 0.94)',fn:function(k){
return k*(2-k);
}
},
circular:{
style:'cubic-bezier(0.1, 0.57, 0.1, 1) ',fn:function(k){
return Math.sqrt(1-(--k*k));
}
},
back:{
style:'cubic-bezier(0.175, 0.885, 0.32, 1.275)',fn:function(k){
var b=4;
return(k=k-1)*k*((b+1)*k+b)+1;
}
},
bounce:{
style:'',
fn:function(k){
if((k/=1)<(1/2.75)){
return 7.5625*k*k;
}else if(k<(2/2.75)){
return 7.5625*(k-=(1.5/2.75))*k+0.75;
}else if(k<(2.5/2.75)){
return 7.5625*(k-=(2.25/2.75))*k+0.9375;
}else{
return 7.5625*(k-=(2.625/2.75))*k+0.984375;
}
}
},
elastic:{
style:'',
fn:function(k){
var f=0.22,
e=0.4;
if(k===0){return 0}
if(k==1){return 1}
return(e*Math.pow(2,-10*k)*Math.sin((k-f/4)*(2*Math.PI)/f)+1);
}
}
});
me.tap=function(e,eventName){
var ev=document.createEvent('Event');
ev.initEvent(eventName,true,true);
ev.pageX=e.pageX;
ev.pageY=e.pageY;
e.target.dispatchEvent(ev);
};
me.click=function(e){
var target=e.target,
ev;
if(!(/(SELECT|INPUT|TEXTAREA)/i).test(target.tagName)){
ev=document.createEvent('MouseEvents');
ev.initMouseEvent('click',true,true,e.view,1,
target.screenX,target.screenY,target.clientX,target.clientY,
e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,
0,null);
ev._constructed=true;
target.dispatchEvent(ev);
}
};
return me;
})();
function IScroll(el,options){
this.wrapper=typeof el=='string'?document.querySelector(el):el;
this.scroller=this.wrapper.children[0];
this.scrollerStyle=this.scroller.style;this.options={
zoomMin:1,
zoomMax:4,startZoom:1,
resizeScrollbars:true,
mouseWheelSpeed:20,
snapThreshold:0.334,
startX:0,
startY:0,
scrollY:true,
directionLockThreshold:5,
momentum:true,
bounce:true,
bounceTime:600,
bounceEasing:'',
preventDefault:true,
preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},
HWCompositing:true,
useTransition:true,
useTransform:true
};
for(var i in options){
this.options[i]=options[i];
}
this.translateZ=this.options.HWCompositing&&utils.hasPerspective?' translateZ(0)':'';
this.options.useTransition=utils.hasTransition&&this.options.useTransition;
this.options.useTransform=utils.hasTransform&&this.options.useTransform;
this.options.eventPassthrough=this.options.eventPassthrough===true?'vertical':this.options.eventPassthrough;
this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;
this.options.scrollY=this.options.eventPassthrough=='vertical'?false:this.options.scrollY;
this.options.scrollX=this.options.eventPassthrough=='horizontal'?false:this.options.scrollX;
this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;
this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;
this.options.bounceEasing=typeof this.options.bounceEasing=='string'?utils.ease[this.options.bounceEasing]||utils.ease.circular:this.options.bounceEasing;
this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;
if(this.options.tap===true){
this.options.tap='tap';
}
if(this.options.shrinkScrollbars=='scale'){
this.options.useTransition=false;
}
this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;
this.x=0;
this.y=0;
this.directionX=0;
this.directionY=0;
this._events={};
this.scale=Math.min(Math.max(this.options.startZoom,this.options.zoomMin),this.options.zoomMax);
this._init();
this.refresh();
this.scrollTo(this.options.startX,this.options.startY);
this.enable();
}
IScroll.prototype={
version:'5.1.1',
_init:function(){
this._initEvents();
if(this.options.zoom){
this._initZoom();
}
if(this.options.scrollbars||this.options.indicators){
this._initIndicators();
}
if(this.options.mouseWheel){
this._initWheel();
}
if(this.options.snap){
this._initSnap();
}
if(this.options.keyBindings){
this._initKeys();
}
},
destroy:function(){
this._initEvents(true);
this._execEvent('destroy');
},
_transitionEnd:function(e){
if(e.target!=this.scroller||!this.isInTransition){
return;
}
this._transitionTime();
if(!this.resetPosition(this.options.bounceTime)){
this.isInTransition=false;
this._execEvent('scrollEnd');
}
},
_start:function(e){
if(utils.eventType[e.type]!=1){
if(e.button!==0){
return;
}
}
if(!this.enabled||(this.initiated&&utils.eventType[e.type]!==this.initiated)){
return;
}
if(this.options.preventDefault&&!utils.isBadAndroid&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){
e.preventDefault();
}
var point=e.touches?e.touches[0]:e,
pos;
this.initiated=utils.eventType[e.type];
this.moved=false;
this.distX=0;
this.distY=0;
this.directionX=0;
this.directionY=0;
this.directionLocked=0;
this._transitionTime();
this.startTime=utils.getTime();
if(this.options.useTransition&&this.isInTransition){
this.isInTransition=false;
pos=this.getComputedPosition();
this._translate(Math.round(pos.x),Math.round(pos.y));
this._execEvent('scrollEnd');
}else if(!this.options.useTransition&&this.isAnimating){
this.isAnimating=false;
this._execEvent('scrollEnd');
}
this.startX=this.x;
this.startY=this.y;
this.absStartX=this.x;
this.absStartY=this.y;
this.pointX=point.pageX;
this.pointY=point.pageY;
this._execEvent('beforeScrollStart');
},
_move:function(e){
if(!this.enabled||utils.eventType[e.type]!==this.initiated){
return;
}
if(this.options.preventDefault){e.preventDefault();
}
var point=e.touches?e.touches[0]:e,
deltaX=point.pageX-this.pointX,
deltaY=point.pageY-this.pointY,
timestamp=utils.getTime(),
newX,newY,
absDistX,absDistY;
this.pointX=point.pageX;
this.pointY=point.pageY;
this.distX+=deltaX;
this.distY+=deltaY;
absDistX=Math.abs(this.distX);
absDistY=Math.abs(this.distY);
if(timestamp-this.endTime>300&&(absDistX<10&&absDistY<10)){
return;
}
if(!this.directionLocked&&!this.options.freeScroll){
if(absDistX>absDistY+this.options.directionLockThreshold){
this.directionLocked='h'}else if(absDistY>=absDistX+this.options.directionLockThreshold){
this.directionLocked='v'}else{
this.directionLocked='n'}
}
if(this.directionLocked=='h'){
if(this.options.eventPassthrough=='vertical'){
e.preventDefault();
}else if(this.options.eventPassthrough=='horizontal'){
this.initiated=false;
return;
}
deltaY=0;
}else if(this.directionLocked=='v'){
if(this.options.eventPassthrough=='horizontal'){
e.preventDefault();
}else if(this.options.eventPassthrough=='vertical'){
this.initiated=false;
return;
}
deltaX=0;
}
deltaX=this.hasHorizontalScroll?deltaX:0;
deltaY=this.hasVerticalScroll?deltaY:0;
newX=this.x+deltaX;
newY=this.y+deltaY;
if(newX>0||newX<this.maxScrollX){
newX=this.options.bounce?this.x+deltaX/3:newX>0?0:this.maxScrollX;
}
if(newY>0||newY<this.maxScrollY){
newY=this.options.bounce?this.y+deltaY/3:newY>0?0:this.maxScrollY;
}
this.directionX=deltaX>0?-1:deltaX<0?1:0;
this.directionY=deltaY>0?-1:deltaY<0?1:0;
if(!this.moved){
this._execEvent('scrollStart');
}
this.moved=true;
this._translate(newX,newY);

if(timestamp-this.startTime>300){
this.startTime=timestamp;
this.startX=this.x;
this.startY=this.y;
}

},
_end:function(e){
if(!this.enabled||utils.eventType[e.type]!==this.initiated){
return;
}
if(this.options.preventDefault&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){
e.preventDefault();
}
var point=e.changedTouches?e.changedTouches[0]:e,
momentumX,
momentumY,
duration=utils.getTime()-this.startTime,
newX=Math.round(this.x),
newY=Math.round(this.y),
distanceX=Math.abs(newX-this.startX),
distanceY=Math.abs(newY-this.startY),
time=0,
easing='';
this.isInTransition=0;
this.initiated=0;
this.endTime=utils.getTime();
if(this.resetPosition(this.options.bounceTime)){
return;
}
this.scrollTo(newX,newY);if(!this.moved){
if(this.options.tap){
utils.tap(e,this.options.tap);
}
if(this.options.click){
utils.click(e);
}
this._execEvent('scrollCancel');
return;
}
if(this._events.flick&&duration<200&&distanceX<100&&distanceY<100){
this._execEvent('flick');
return;
}
if(this.options.momentum&&duration<300){
momentumX=this.hasHorizontalScroll?utils.momentum(this.x,this.startX,duration,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:newX,duration:0};
momentumY=this.hasVerticalScroll?utils.momentum(this.y,this.startY,duration,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:newY,duration:0};
newX=momentumX.destination;
newY=momentumY.destination;
time=Math.max(momentumX.duration,momentumY.duration);
this.isInTransition=1;
}
if(this.options.snap){
var snap=this._nearestSnap(newX,newY);
this.currentPage=snap;
time=this.options.snapSpeed||Math.max(
Math.max(
Math.min(Math.abs(newX-snap.x),1000),
Math.min(Math.abs(newY-snap.y),1000)
),300);
newX=snap.x;
newY=snap.y;
this.directionX=0;
this.directionY=0;
easing=this.options.bounceEasing;
}
if(newX!=this.x||newY!=this.y){
if(newX>0||newX<this.maxScrollX||newY>0||newY<this.maxScrollY){
easing=utils.ease.quadratic;
}
this.scrollTo(newX,newY,time,easing);
return;
}
this._execEvent('scrollEnd');
},
_resize:function(){
var that=this;
clearTimeout(this.resizeTimeout);
this.resizeTimeout=setTimeout(function(){
that.refresh();
},this.options.resizePolling);
},
resetPosition:function(time){
var x=this.x,
y=this.y;
time=time||0;
if(!this.hasHorizontalScroll||this.x>0){
x=0;
}else if(this.x<this.maxScrollX){
x=this.maxScrollX;
}
if(!this.hasVerticalScroll||this.y>0){
y=0;
}else if(this.y<this.maxScrollY){
y=this.maxScrollY;
}
if(x==this.x&&y==this.y){
return false;
}
this.scrollTo(x,y,time,this.options.bounceEasing);
return true;
},
disable:function(){
this.enabled=false;
},
enable:function(){
this.enabled=true;
},
refresh:function(){
var rf=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;
this.wrapperHeight=this.wrapper.clientHeight;

this.scrollerWidth=Math.round(this.scroller.offsetWidth*this.scale);
this.scrollerHeight=Math.round(this.scroller.offsetHeight*this.scale);
this.maxScrollX=this.wrapperWidth-this.scrollerWidth;
this.maxScrollY=this.wrapperHeight-this.scrollerHeight;

this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;
this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;
if(!this.hasHorizontalScroll){
this.maxScrollX=0;
this.scrollerWidth=this.wrapperWidth;
}
if(!this.hasVerticalScroll){
this.maxScrollY=0;
this.scrollerHeight=this.wrapperHeight;
}
this.endTime=0;
this.directionX=0;
this.directionY=0;
this.wrapperOffset=utils.offset(this.wrapper);
this._execEvent('refresh');
this.resetPosition();
},
on:function(type,fn){
if(!this._events[type]){
this._events[type]=[];
}
this._events[type].push(fn);
},
off:function(type,fn){
if(!this._events[type]){
return;
}
var index=this._events[type].indexOf(fn);
if(index>-1){
this._events[type].splice(index,1);
}
},
_execEvent:function(type){
if(!this._events[type]){
return;
}
var i=0,
l=this._events[type].length;
if(!l){
return;
}
for(;i<l;i++){
this._events[type][i].apply(this,[].slice.call(arguments,1));
}
},
scrollBy:function(x,y,time,easing){
x=this.x+x;
y=this.y+y;
time=time||0;
this.scrollTo(x,y,time,easing);
},
scrollTo:function(x,y,time,easing){
easing=easing||utils.ease.circular;
this.isInTransition=this.options.useTransition&&time>0;
if(!time||(this.options.useTransition&&easing.style)){
this._transitionTimingFunction(easing.style);
this._transitionTime(time);
this._translate(x,y);
}else{
this._animate(x,y,time,easing.fn);
}
},
scrollToElement:function(el,time,offsetX,offsetY,easing){
el=el.nodeType?el:this.scroller.querySelector(el);
if(!el){
return;
}
var pos=utils.offset(el);
pos.left-=this.wrapperOffset.left;
pos.top-=this.wrapperOffset.top;
if(offsetX===true){
offsetX=Math.round(el.offsetWidth/2-this.wrapper.offsetWidth/2);
}
if(offsetY===true){
offsetY=Math.round(el.offsetHeight/2-this.wrapper.offsetHeight/2);
}
pos.left-=offsetX||0;
pos.top-=offsetY||0;
pos.left=pos.left>0?0:pos.left<this.maxScrollX?this.maxScrollX:pos.left;
pos.top=pos.top>0?0:pos.top<this.maxScrollY?this.maxScrollY:pos.top;
time=time===undefined||time===null||time==='auto'?Math.max(Math.abs(this.x-pos.left),Math.abs(this.y-pos.top)):time;
this.scrollTo(pos.left,pos.top,time,easing);
},
_transitionTime:function(time){
time=time||0;
this.scrollerStyle[utils.style.transitionDuration]=time+'ms';
if(!time&&utils.isBadAndroid){
this.scrollerStyle[utils.style.transitionDuration]='0.001s';
}
if(this.indicators){
for(var i=this.indicators.length;i--;){
this.indicators[i].transitionTime(time);
}
}
},
_transitionTimingFunction:function(easing){
this.scrollerStyle[utils.style.transitionTimingFunction]=easing;
if(this.indicators){
for(var i=this.indicators.length;i--;){
this.indicators[i].transitionTimingFunction(easing);
}
}
},
_translate:function(x,y){
if(this.options.noHorizontalZoom)
x=0;
if(this.options.useTransform){
this.scrollerStyle[utils.style.transform]='translate3d( '+x+'px,'+y+'px , 0px) scale('+this.scale+')  '+this.translateZ;
}else{
x=Math.round(x);
y=Math.round(y);
this.scrollerStyle.left=x+'px';
this.scrollerStyle.top=y+'px';
}
this.x=x;
this.y=y;
if(this.indicators){
for(var i=this.indicators.length;i--;){
this.indicators[i].updatePosition();
}
}
},
_initEvents:function(remove){
var eventType=remove?utils.removeEvent:utils.addEvent,
target=this.options.bindToWrapper?this.wrapper:window;
eventType(window,'orientationchange',this);
eventType(window,'resize',this);
if(this.options.click){
eventType(this.wrapper,'click',this,true);
}
if(!this.options.disableMouse){
eventType(this.wrapper,'mousedown',this);
eventType(target,'mousemove',this);
eventType(target,'mousecancel',this);
eventType(target,'mouseup',this);
}
if(utils.hasPointer&&!this.options.disablePointer){
eventType(this.wrapper,'MSPointerDown',this);
eventType(target,'MSPointerMove',this);
eventType(target,'MSPointerCancel',this);
eventType(target,'MSPointerUp',this);
}
if(utils.hasTouch&&!this.options.disableTouch){
eventType(this.wrapper,'touchstart',this);
eventType(target,'touchmove',this);
eventType(target,'touchcancel',this);
eventType(target,'touchend',this);
}
eventType(this.scroller,'transitionend',this);
eventType(this.scroller,'webkitTransitionEnd',this);
eventType(this.scroller,'oTransitionEnd',this);
eventType(this.scroller,'MSTransitionEnd',this);
},
getComputedPosition:function(){
var matrix=window.getComputedStyle(this.scroller,null),
x,y;
if(this.options.useTransform){
matrix=matrix[utils.style.transform].split(')')[0].split(', ');
x=+(matrix[12]||matrix[4]);
y=+(matrix[13]||matrix[5]);
}else{
x=+matrix.left.replace(/[^-\d.]/g,'');
y=+matrix.top.replace(/[^-\d.]/g,'');
}
return{x:x,y:y};
},
_initIndicators:function(){
var interactive=this.options.interactiveScrollbars,
customStyle=typeof this.options.scrollbars!='string',
indicators=[],
indicator;
var that=this;
this.indicators=[];
if(this.options.scrollbars){
if(this.options.scrollY){
indicator={
el:createDefaultScrollbar('v',interactive,this.options.scrollbars),
interactive:interactive,
defaultScrollbars:true,
customStyle:customStyle,
resize:this.options.resizeScrollbars,
shrink:this.options.shrinkScrollbars,
fade:this.options.fadeScrollbars,
listenX:false
};
this.wrapper.appendChild(indicator.el);
indicators.push(indicator);
}
if(this.options.scrollX){
indicator={
el:createDefaultScrollbar('h',interactive,this.options.scrollbars),
interactive:interactive,
defaultScrollbars:true,
customStyle:customStyle,
resize:this.options.resizeScrollbars,
shrink:this.options.shrinkScrollbars,
fade:this.options.fadeScrollbars,
listenY:false
};
this.wrapper.appendChild(indicator.el);
indicators.push(indicator);
}
}
if(this.options.indicators){
indicators=indicators.concat(this.options.indicators);
}
for(var i=indicators.length;i--;){
this.indicators.push(new Indicator(this,indicators[i]));
}
function _indicatorsMap(fn){
for(var i=that.indicators.length;i--;){
fn.call(that.indicators[i]);
}
}
if(this.options.fadeScrollbars){
this.on('scrollEnd',function(){
_indicatorsMap(function(){
this.fade();
});
});
this.on('scrollCancel',function(){
_indicatorsMap(function(){
this.fade();
});
});
this.on('scrollStart',function(){
_indicatorsMap(function(){
this.fade(1);
});
});
this.on('beforeScrollStart',function(){
_indicatorsMap(function(){
this.fade(1,true);
});
});
}
this.on('refresh',function(){
_indicatorsMap(function(){
this.refresh();
});
});
this.on('destroy',function(){
_indicatorsMap(function(){
this.destroy();
});
delete this.indicators;
});
},
_initZoom:function(){
this.scrollerStyle[utils.style.transformOrigin]='0 0';
},
_zoomStart:function(e){
var c1=Math.abs(e.touches[0].pageX-e.touches[1].pageX),
c2=Math.abs(e.touches[0].pageY-e.touches[1].pageY);
this.touchesDistanceStart=Math.sqrt(c1*c1+c2*c2);
this.startScale=this.scale;
this.originX=Math.abs(e.touches[0].pageX+e.touches[1].pageX)/2+this.wrapperOffset.left-this.x;
this.originY=Math.abs(e.touches[0].pageY+e.touches[1].pageY)/2+this.wrapperOffset.top-this.y;
this._execEvent('zoomStart');
},
_zoom:function(e){
if(!this.enabled||utils.eventType[e.type]!==this.initiated){
return;
}
if(this.options.preventDefault){
e.preventDefault();
}
var c1=Math.abs(e.touches[0].pageX-e.touches[1].pageX),
c2=Math.abs(e.touches[0].pageY-e.touches[1].pageY),
distance=Math.sqrt(c1*c1+c2*c2),
scale=1/this.touchesDistanceStart*distance*this.startScale,
lastScale,
x,y;
this.scaled=true;
if(scale<this.options.zoomMin){
scale=0.5*this.options.zoomMin*Math.pow(2.0,scale/this.options.zoomMin);
}else if(scale>this.options.zoomMax){
scale=2.0*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax/scale);
}
lastScale=scale/this.startScale;
x=this.originX-this.originX*lastScale+this.startX;
y=this.originY-this.originY*lastScale+this.startY;
this.scale=scale;
this.scrollTo(x,y,0);
},
_zoomEnd:function(e){
if(!this.enabled||utils.eventType[e.type]!==this.initiated){
return;
}
if(this.options.preventDefault){
e.preventDefault();
}
var newX,newY,
lastScale;
this.isInTransition=0;
this.initiated=0;
if(this.scale>this.options.zoomMax){
this.scale=this.options.zoomMax;
}else if(this.scale<this.options.zoomMin){
this.scale=this.options.zoomMin;
}
this.refresh();
lastScale=this.scale/this.startScale;
newX=this.originX-this.originX*lastScale+this.startX;
newY=this.originY-this.originY*lastScale+this.startY;
if(newX>0){
newX=0;
}else if(newX<this.maxScrollX){
newX=this.maxScrollX;
}
if(newY>0){
newY=0;
}else if(newY<this.maxScrollY){
newY=this.maxScrollY;
}
if(this.x!=newX||this.y!=newY){
this.scrollTo(newX,newY,this.options.bounceTime);
}
this.scaled=false;
this._execEvent('zoomEnd');
},
zoom:function(scale,x,y,time){
if(scale<this.options.zoomMin){
scale=this.options.zoomMin;
}else if(scale>this.options.zoomMax){
scale=this.options.zoomMax;
}
if(scale==this.scale){
return;
}
var relScale=scale/this.scale;
x=x===undefined?this.wrapperWidth/2:x;
y=y===undefined?this.wrapperHeight/2:y;
time=time===undefined?300:time;
x=x+this.wrapperOffset.left-this.x;
y=y+this.wrapperOffset.top-this.y;
x=x-x*relScale+this.x;
y=y-y*relScale+this.y;
this.scale=scale;
this.refresh();if(x>0){
x=0;
}else if(x<this.maxScrollX){
x=this.maxScrollX;
}
if(y>0){
y=0;
}else if(y<this.maxScrollY){
y=this.maxScrollY;
}
this.scrollTo(x,y,time);
},
_wheelZoom:function(e){
var wheelDeltaY,
deltaScale,
that=this;
clearTimeout(this.wheelTimeout);
this.wheelTimeout=setTimeout(function(){
that._execEvent('zoomEnd');
},400);
if('deltaX'in e){
wheelDeltaY=-e.deltaY/Math.abs(e.deltaY);
}else if('wheelDeltaX'in e){
wheelDeltaY=e.wheelDeltaY/Math.abs(e.wheelDeltaY);
}else if('wheelDelta'in e){
wheelDeltaY=e.wheelDelta/Math.abs(e.wheelDelta);
}else if('detail'in e){
wheelDeltaY=-e.detail/Math.abs(e.wheelDelta);
}else{
return;
}
deltaScale=this.scale+wheelDeltaY/5/2;
this.zoom(deltaScale,e.pageX,e.pageY,0);
},
_initWheel:function(){
utils.addEvent(this.wrapper,'wheel',this);
utils.addEvent(this.wrapper,'mousewheel',this);
utils.addEvent(this.wrapper,'DOMMouseScroll',this);
this.on('destroy',function(){
utils.removeEvent(this.wrapper,'wheel',this);
utils.removeEvent(this.wrapper,'mousewheel',this);
utils.removeEvent(this.wrapper,'DOMMouseScroll',this);
});
},
_wheel:function(e){
if(!this.enabled){
return;
}
e.preventDefault();
e.stopPropagation();
var wheelDeltaX,wheelDeltaY,
newX,newY,
that=this;
if(this.wheelTimeout===undefined){
that._execEvent('scrollStart');
}
clearTimeout(this.wheelTimeout);
this.wheelTimeout=setTimeout(function(){
that._execEvent('scrollEnd');
that.wheelTimeout=undefined;
},400);
if('deltaX'in e){
wheelDeltaX=-e.deltaX;
wheelDeltaY=-e.deltaY;
}else if('wheelDeltaX'in e){
wheelDeltaX=e.wheelDeltaX/120*this.options.mouseWheelSpeed;
wheelDeltaY=e.wheelDeltaY/120*this.options.mouseWheelSpeed;
}else if('wheelDelta'in e){
wheelDeltaX=wheelDeltaY=e.wheelDelta/120*this.options.mouseWheelSpeed;
}else if('detail'in e){
wheelDeltaX=wheelDeltaY=-e.detail/3*this.options.mouseWheelSpeed;
}else if(e.originalEvent){e=e.originalEvent;
if('deltaX'in e){
wheelDeltaX=-e.deltaX;
wheelDeltaY=-e.deltaY;
}else if('wheelDeltaX'in e){
wheelDeltaX=e.wheelDeltaX/120*this.options.mouseWheelSpeed;
wheelDeltaY=e.wheelDeltaY/120*this.options.mouseWheelSpeed;
}else if('wheelDelta'in e){
wheelDeltaX=wheelDeltaY=e.wheelDelta/120*this.options.mouseWheelSpeed;
}else if('detail'in e){
wheelDeltaX=wheelDeltaY=-e.detail/3*this.options.mouseWheelSpeed;
}else
return;
}else
return;
wheelDeltaX*=this.options.invertWheelDirection;
wheelDeltaY*=this.options.invertWheelDirection;
if(navigator.userAgent.toLowerCase().indexOf('firefox')>-1){
wheelDeltaX=wheelDeltaX*20;
wheelDeltaY=wheelDeltaY*20;
}
if(!this.hasVerticalScroll){
wheelDeltaX=wheelDeltaY;
wheelDeltaY=0;
}
if(this.options.snap){
newX=this.currentPage.pageX;
newY=this.currentPage.pageY;
if(wheelDeltaX>0){
newX--;
}else if(wheelDeltaX<0){
newX++;
}
if(wheelDeltaY>0){
newY--;
}else if(wheelDeltaY<0){
newY++;
}
this.goToPage(newX,newY);
return;
}
newX=this.x+Math.round(this.hasHorizontalScroll?wheelDeltaX:0);
newY=this.y+Math.round(this.hasVerticalScroll?wheelDeltaY:0);
if(newX>0){
newX=0;
}else if(newX<this.maxScrollX){
newX=this.maxScrollX;
}
if(newY>0){
newY=0;
}else if(newY<this.maxScrollY){
newY=this.maxScrollY;
}
if(!IScrollinitTimer||Date.now()-IScrollinitTimer<10000)
var scrolltime=0;
else
scrolltime=750;
this.scrollTo(newX,newY,scrolltime)},
_initSnap:function(){
this.currentPage={};
if(typeof this.options.snap=='string'){
this.options.snap=this.scroller.querySelectorAll(this.options.snap);
}
this.on('refresh',function(){
var i=0,l,
m=0,n,
cx,cy,
x=0,y,
stepX=this.options.snapStepX||this.wrapperWidth,
stepY=this.options.snapStepY||this.wrapperHeight,
el;
this.pages=[];
if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){
return;
}
if(this.options.snap===true){
cx=Math.round(stepX/2);
cy=Math.round(stepY/2);
while(x>-this.scrollerWidth){
this.pages[i]=[];
l=0;
y=0;
while(y>-this.scrollerHeight){
this.pages[i][l]={
x:Math.max(x,this.maxScrollX),
y:Math.max(y,this.maxScrollY),
width:stepX,
height:stepY,
cx:x-cx,
cy:y-cy
};
y-=stepY;
l++;
}
x-=stepX;
i++;
}
}else{
el=this.options.snap;
l=el.length;
n=-1;
for(;i<l;i++){
if(i===0||el[i].offsetLeft<=el[i-1].offsetLeft){
m=0;
n++;
}
if(!this.pages[m]){
this.pages[m]=[];
}
x=Math.max(-el[i].offsetLeft,this.maxScrollX);
y=Math.max(-el[i].offsetTop,this.maxScrollY);
cx=x-Math.round(el[i].offsetWidth/2);
cy=y-Math.round(el[i].offsetHeight/2);
this.pages[m][n]={
x:x,
y:y,
width:el[i].offsetWidth,
height:el[i].offsetHeight,
cx:cx,
cy:cy
};
if(x>this.maxScrollX){
m++;
}
}
}
this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);
if(this.options.snapThreshold%1===0){
this.snapThresholdX=this.options.snapThreshold;
this.snapThresholdY=this.options.snapThreshold;
}else{
this.snapThresholdX=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);
this.snapThresholdY=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold);
}
});
this.on('flick',function(){
var time=this.options.snapSpeed||Math.max(
Math.max(
Math.min(Math.abs(this.x-this.startX),1000),
Math.min(Math.abs(this.y-this.startY),1000)
),300);
this.goToPage(
this.currentPage.pageX+this.directionX,
this.currentPage.pageY+this.directionY,
time
);
});
},
_nearestSnap:function(x,y){
if(!this.pages.length){
return{x:0,y:0,pageX:0,pageY:0};
}
var i=0,
l=this.pages.length,
m=0;
if(Math.abs(x-this.absStartX)<this.snapThresholdX&&
Math.abs(y-this.absStartY)<this.snapThresholdY){
return this.currentPage;
}
if(x>0){
x=0;
}else if(x<this.maxScrollX){
x=this.maxScrollX;
}
if(y>0){
y=0;
}else if(y<this.maxScrollY){
y=this.maxScrollY;
}
for(;i<l;i++){
if(x>=this.pages[i][0].cx){
x=this.pages[i][0].x;
break;
}
}
l=this.pages[i].length;
for(;m<l;m++){
if(y>=this.pages[0][m].cy){
y=this.pages[0][m].y;
break;
}
}
if(i==this.currentPage.pageX){
i+=this.directionX;
if(i<0){
i=0;
}else if(i>=this.pages.length){
i=this.pages.length-1;
}
x=this.pages[i][0].x;
}
if(m==this.currentPage.pageY){
m+=this.directionY;
if(m<0){
m=0;
}else if(m>=this.pages[0].length){
m=this.pages[0].length-1;
}
y=this.pages[0][m].y;
}
return{
x:x,
y:y,
pageX:i,
pageY:m
};
},
goToPage:function(x,y,time,easing){
easing=easing||this.options.bounceEasing;
if(x>=this.pages.length){
x=this.pages.length-1;
}else if(x<0){
x=0;
}
if(y>=this.pages[x].length){
y=this.pages[x].length-1;
}else if(y<0){
y=0;
}
var posX=this.pages[x][y].x,
posY=this.pages[x][y].y;
time=time===undefined?this.options.snapSpeed||Math.max(
Math.max(
Math.min(Math.abs(posX-this.x),1000),
Math.min(Math.abs(posY-this.y),1000)
),300):time;
this.currentPage={
x:posX,
y:posY,
pageX:x,
pageY:y
};
this.scrollTo(posX,posY,time,easing);
},
next:function(time,easing){
var x=this.currentPage.pageX,
y=this.currentPage.pageY;
x++;
if(x>=this.pages.length&&this.hasVerticalScroll){
x=0;
y++;
}
this.goToPage(x,y,time,easing);
},
prev:function(time,easing){
var x=this.currentPage.pageX,
y=this.currentPage.pageY;
x--;
if(x<0&&this.hasVerticalScroll){
x=0;
y--;
}
this.goToPage(x,y,time,easing);
},
_initKeys:function(e){
var keys={
pageUp:33,
pageDown:34,
end:35,
home:36,
left:37,
up:38,
right:39,
down:40
};
var i;
if(typeof this.options.keyBindings=='object'){
for(i in this.options.keyBindings){
if(typeof this.options.keyBindings[i]=='string'){
this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0);
}
}
}else{
this.options.keyBindings={};
}
for(i in keys){
this.options.keyBindings[i]=this.options.keyBindings[i]||keys[i];
}
utils.addEvent(window,'keydown',this);
this.on('destroy',function(){
utils.removeEvent(window,'keydown',this);
});
},
_key:function(e){
if(!this.enabled){
return;
}
var snap=this.options.snap,newX=snap?this.currentPage.pageX:this.x,
newY=snap?this.currentPage.pageY:this.y,
now=utils.getTime(),
prevTime=this.keyTime||0,
acceleration=0.250,
pos;
if(this.options.useTransition&&this.isInTransition){
pos=this.getComputedPosition();
this._translate(Math.round(pos.x),Math.round(pos.y));
this.isInTransition=false;
}
this.keyAcceleration=now-prevTime<200?Math.min(this.keyAcceleration+acceleration,50):0;
switch(e.keyCode){
case this.options.keyBindings.pageUp:
if(this.hasHorizontalScroll&&!this.hasVerticalScroll){
newX+=snap?1:this.wrapperWidth;
}else{
newY+=snap?1:this.wrapperHeight;
}
break;
case this.options.keyBindings.pageDown:
if(this.hasHorizontalScroll&&!this.hasVerticalScroll){
newX-=snap?1:this.wrapperWidth;
}else{
newY-=snap?1:this.wrapperHeight;
}
break;
case this.options.keyBindings.end:
newX=snap?this.pages.length-1:this.maxScrollX;
newY=snap?this.pages[0].length-1:this.maxScrollY;
break;
case this.options.keyBindings.home:
newX=0;
newY=0;
break;
case this.options.keyBindings.left:
newX+=snap?-1:5+this.keyAcceleration>>0;
break;
case this.options.keyBindings.up:
newY+=snap?1:5+this.keyAcceleration>>0;
break;
case this.options.keyBindings.right:
newX-=snap?-1:5+this.keyAcceleration>>0;
break;
case this.options.keyBindings.down:
newY-=snap?1:5+this.keyAcceleration>>0;
break;
default:
return;
}
if(snap){
this.goToPage(newX,newY);
return;
}
if(newX>0){
newX=0;
this.keyAcceleration=0;
}else if(newX<this.maxScrollX){
newX=this.maxScrollX;
this.keyAcceleration=0;
}
if(newY>0){
newY=0;
this.keyAcceleration=0;
}else if(newY<this.maxScrollY){
newY=this.maxScrollY;
this.keyAcceleration=0;
}
this.scrollTo(newX,newY,0);
this.keyTime=now;
},
_animate:function(destX,destY,duration,easingFn){
var that=this,
startX=this.x,
startY=this.y,
startTime=utils.getTime(),
destTime=startTime+duration;
function step(){
var now=utils.getTime(),
newX,newY,
easing;
if(now>=destTime){
that.isAnimating=false;
that._translate(destX,destY);
if(!that.resetPosition(that.options.bounceTime)){
that._execEvent('scrollEnd');
}
return;
}
now=(now-startTime)/duration;
easing=easingFn(now);
newX=(destX-startX)*easing+startX;
newY=(destY-startY)*easing+startY;
that._translate(newX,newY);
if(that.isAnimating){
rAF(step);
}
}
this.isAnimating=true;
step();
},
handleEvent:function(e){
switch(e.type){
case'touchstart':
case'MSPointerDown':
case'mousedown':
this._start(e);
if(this.options.zoom&&e.touches&&e.touches.length>1){
this._zoomStart(e);
}
break;
case'touchmove':
case'MSPointerMove':
case'mousemove':
if(this.options.zoom&&e.touches&&e.touches[1]){
this._zoom(e);
return;
}
this._move(e);
break;
case'touchend':
case'MSPointerUp':
case'mouseup':
case'touchcancel':
case'MSPointerCancel':
case'mousecancel':
if(this.scaled){
this._zoomEnd(e);
return;
}
this._end(e);
break;
case'orientationchange':
case'resize':
this._resize();
break;
case'transitionend':
case'webkitTransitionEnd':
case'oTransitionEnd':
case'MSTransitionEnd':
this._transitionEnd(e);
break;
case'wheel':
case'DOMMouseScroll':
case'mousewheel':
if(this.options.wheelAction=='zoom'){
this._wheelZoom(e);
return;
}
this._wheel(e);
break;
case'keydown':
this._key(e);
break;
}
}
};
function createDefaultScrollbar(direction,interactive,type){
var scrollbar=document.createElement('div'),
indicator=document.createElement('div');
if(type===true){
scrollbar.style.cssText='position:absolute;z-index:9999';
indicator.style.cssText='-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px';
}
indicator.className='iScrollIndicator';
if(direction=='h'){
if(type===true){
scrollbar.style.cssText+=';height:7px;left:2px;right:2px;bottom:0';
indicator.style.height='100%';
}
scrollbar.className='iScrollHorizontalScrollbar';
}else{
if(type===true){
scrollbar.style.cssText+=';width:7px;bottom:2px;top:2px;right:1px';
indicator.style.width='100%';
}
scrollbar.className='iScrollVerticalScrollbar';
}
scrollbar.style.cssText+=';overflow:hidden';
if(!interactive){
scrollbar.style.pointerEvents='none';
}
scrollbar.appendChild(indicator);
return scrollbar;
}
function Indicator(scroller,options){
this.wrapper=typeof options.el=='string'?document.querySelector(options.el):options.el;
this.wrapperStyle=this.wrapper.style;
this.indicator=this.wrapper.children[0];
this.indicatorStyle=this.indicator.style;
this.scroller=scroller;
this.options={
listenX:true,
listenY:true,
interactive:false,
resize:true,
defaultScrollbars:false,
shrink:false,
fade:false,
speedRatioX:0,
speedRatioY:0
};
for(var i in options){
this.options[i]=options[i];
}
this.sizeRatioX=1;
this.sizeRatioY=1;
this.maxPosX=0;
this.maxPosY=0;
if(this.options.interactive){
if(!this.options.disableTouch){
utils.addEvent(this.indicator,'touchstart',this);
utils.addEvent(window,'touchend',this);
}
if(!this.options.disablePointer){
utils.addEvent(this.indicator,'MSPointerDown',this);
utils.addEvent(window,'MSPointerUp',this);
}
if(!this.options.disableMouse){
utils.addEvent(this.indicator,'mousedown',this);
utils.addEvent(window,'mouseup',this);
}
}
if(this.options.fade){
this.wrapperStyle[utils.style.transform]=this.scroller.translateZ;
this.wrapperStyle[utils.style.transitionDuration]=utils.isBadAndroid?'0.001s':'0ms';
this.wrapperStyle.opacity='0';
}
}
Indicator.prototype={
handleEvent:function(e){
switch(e.type){
case'touchstart':
case'MSPointerDown':
case'mousedown':
this._start(e);
break;
case'touchmove':
case'MSPointerMove':
case'mousemove':
this._move(e);
break;
case'touchend':
case'MSPointerUp':
case'mouseup':
case'touchcancel':
case'MSPointerCancel':
case'mousecancel':
this._end(e);
break;
}
},
destroy:function(){
if(this.options.interactive){
utils.removeEvent(this.indicator,'touchstart',this);
utils.removeEvent(this.indicator,'MSPointerDown',this);
utils.removeEvent(this.indicator,'mousedown',this);
utils.removeEvent(window,'touchmove',this);
utils.removeEvent(window,'MSPointerMove',this);
utils.removeEvent(window,'mousemove',this);
utils.removeEvent(window,'touchend',this);
utils.removeEvent(window,'MSPointerUp',this);
utils.removeEvent(window,'mouseup',this);
}
if(this.options.defaultScrollbars){
this.wrapper.parentNode.removeChild(this.wrapper);
}
},
_start:function(e){
var point=e.touches?e.touches[0]:e;
e.preventDefault();
e.stopPropagation();
this.transitionTime();
this.initiated=true;
this.moved=false;
this.lastPointX=point.pageX;
this.lastPointY=point.pageY;
this.startTime=utils.getTime();
if(!this.options.disableTouch){
utils.addEvent(window,'touchmove',this);
}
if(!this.options.disablePointer){
utils.addEvent(window,'MSPointerMove',this);
}
if(!this.options.disableMouse){
utils.addEvent(window,'mousemove',this);
}
this.scroller._execEvent('beforeScrollStart');
},
_move:function(e){
var point=e.touches?e.touches[0]:e,
deltaX,deltaY,
newX,newY,
timestamp=utils.getTime();
if(!this.moved){
this.scroller._execEvent('scrollStart');
}
this.moved=true;
deltaX=point.pageX-this.lastPointX;
this.lastPointX=point.pageX;
deltaY=point.pageY-this.lastPointY;
this.lastPointY=point.pageY;
newX=this.x+deltaX;
newY=this.y+deltaY;
this._pos(newX,newY);
e.preventDefault();
e.stopPropagation();
},
_end:function(e){
if(!this.initiated){
return;
}
this.initiated=false;
e.preventDefault();
e.stopPropagation();
utils.removeEvent(window,'touchmove',this);
utils.removeEvent(window,'MSPointerMove',this);
utils.removeEvent(window,'mousemove',this);
if(this.scroller.options.snap){
var snap=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);
var time=this.options.snapSpeed||Math.max(
Math.max(
Math.min(Math.abs(this.scroller.x-snap.x),1000),
Math.min(Math.abs(this.scroller.y-snap.y),1000)
),300);
if(this.scroller.x!=snap.x||this.scroller.y!=snap.y){
this.scroller.directionX=0;
this.scroller.directionY=0;
this.scroller.currentPage=snap;
this.scroller.scrollTo(snap.x,snap.y,time,this.scroller.options.bounceEasing);
}
}
if(this.moved){
this.scroller._execEvent('scrollEnd');
}
},
transitionTime:function(time){
time=time||0;
this.indicatorStyle[utils.style.transitionDuration]=time+'ms';
if(!time&&utils.isBadAndroid){
this.indicatorStyle[utils.style.transitionDuration]='0.001s';
}
},
transitionTimingFunction:function(easing){
this.indicatorStyle[utils.style.transitionTimingFunction]=easing;
},
refresh:function(){
this.transitionTime();
if(this.options.listenX&&!this.options.listenY){
this.indicatorStyle.display=this.scroller.hasHorizontalScroll?'block':'none';
}else if(this.options.listenY&&!this.options.listenX){
this.indicatorStyle.display=this.scroller.hasVerticalScroll?'block':'none';
}else{
this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?'block':'none';
}
if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){
utils.addClass(this.wrapper,'iScrollBothScrollbars');
utils.removeClass(this.wrapper,'iScrollLoneScrollbar');
if(this.options.defaultScrollbars&&this.options.customStyle){
if(this.options.listenX){
this.wrapper.style.right='8px';
}else{
this.wrapper.style.bottom='8px';
}
}
}else{
utils.removeClass(this.wrapper,'iScrollBothScrollbars');
utils.addClass(this.wrapper,'iScrollLoneScrollbar');
if(this.options.defaultScrollbars&&this.options.customStyle){
if(this.options.listenX){
this.wrapper.style.right='2px';
}else{
this.wrapper.style.bottom='2px';
}
}
}
var r=this.wrapper.offsetHeight;if(this.options.listenX){
this.wrapperWidth=this.wrapper.clientWidth;
if(this.options.resize){
this.indicatorWidth=Math.max(Math.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);
this.indicatorStyle.width=this.indicatorWidth+'px';
}else{
this.indicatorWidth=this.indicator.clientWidth;
}
this.maxPosX=this.wrapperWidth-this.indicatorWidth;
if(this.options.shrink=='clip'){
this.minBoundaryX=-this.indicatorWidth+8;
this.maxBoundaryX=this.wrapperWidth-8;
}else{
this.minBoundaryX=0;
this.maxBoundaryX=this.maxPosX;
}
this.sizeRatioX=this.options.speedRatioX||(this.scroller.maxScrollX&&(this.maxPosX/this.scroller.maxScrollX));
}
if(this.options.listenY){
this.wrapperHeight=this.wrapper.clientHeight;
if(this.options.resize){
this.indicatorHeight=Math.max(Math.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);
this.indicatorStyle.height=this.indicatorHeight+'px';
}else{
this.indicatorHeight=this.indicator.clientHeight;
}
this.maxPosY=this.wrapperHeight-this.indicatorHeight;
if(this.options.shrink=='clip'){
this.minBoundaryY=-this.indicatorHeight+8;
this.maxBoundaryY=this.wrapperHeight-8;
}else{
this.minBoundaryY=0;
this.maxBoundaryY=this.maxPosY;
}
this.maxPosY=this.wrapperHeight-this.indicatorHeight;
this.sizeRatioY=this.options.speedRatioY||(this.scroller.maxScrollY&&(this.maxPosY/this.scroller.maxScrollY));
}
this.updatePosition();
},
updatePosition:function(){
var x=this.options.listenX&&Math.round(this.sizeRatioX*this.scroller.x)||0,
y=this.options.listenY&&Math.round(this.sizeRatioY*this.scroller.y)||0;
if(!this.options.ignoreBoundaries){
if(x<this.minBoundaryX){
if(this.options.shrink=='scale'){
this.width=Math.max(this.indicatorWidth+x,8);
this.indicatorStyle.width=this.width+'px';
}
x=this.minBoundaryX;
}else if(x>this.maxBoundaryX){
if(this.options.shrink=='scale'){
this.width=Math.max(this.indicatorWidth-(x-this.maxPosX),8);
this.indicatorStyle.width=this.width+'px';
x=this.maxPosX+this.indicatorWidth-this.width;
}else{
x=this.maxBoundaryX;
}
}else if(this.options.shrink=='scale'&&this.width!=this.indicatorWidth){
this.width=this.indicatorWidth;
this.indicatorStyle.width=this.width+'px';
}
if(y<this.minBoundaryY){
if(this.options.shrink=='scale'){
this.height=Math.max(this.indicatorHeight+y*3,8);
this.indicatorStyle.height=this.height+'px';
}
y=this.minBoundaryY;
}else if(y>this.maxBoundaryY){
if(this.options.shrink=='scale'){
this.height=Math.max(this.indicatorHeight-(y-this.maxPosY)*3,8);
this.indicatorStyle.height=this.height+'px';
y=this.maxPosY+this.indicatorHeight-this.height;
}else{
y=this.maxBoundaryY;
}
}else if(this.options.shrink=='scale'&&this.height!=this.indicatorHeight){
this.height=this.indicatorHeight;
this.indicatorStyle.height=this.height+'px';
}
}
this.x=x;
this.y=y;
if(this.scroller.options.useTransform){
this.indicatorStyle[utils.style.transform]='translate('+x+'px,'+y+'px)'+this.scroller.translateZ;
}else{
this.indicatorStyle.left=x+'px';
this.indicatorStyle.top=y+'px';
}
},
_pos:function(x,y){
if(x<0){
x=0;
}else if(x>this.maxPosX){
x=this.maxPosX;
}
if(y<0){
y=0;
}else if(y>this.maxPosY){
y=this.maxPosY;
}
x=this.options.listenX?Math.round(x/this.sizeRatioX):this.scroller.x;
y=this.options.listenY?Math.round(y/this.sizeRatioY):this.scroller.y;
this.scroller.scrollTo(x,y);
},
fade:function(val,hold){
if(hold&&!this.visible){
return;
}
clearTimeout(this.fadeTimeout);
this.fadeTimeout=null;
var time=val?250:500,
delay=val?0:300;
val=val?'1':'0';
this.wrapperStyle[utils.style.transitionDuration]=time+'ms';
this.fadeTimeout=setTimeout((function(val){
this.wrapperStyle.opacity=val;
this.visible=+val;
}).bind(this,val),delay);
}
};
IScroll.utils=utils;
if(typeof module!='undefined'&&module.exports){
module.exports=IScroll;
}else{
window.IScroll=IScroll;
}
})(window,document,Math);
;

;
(function(root,doc,factory){
if(typeof define==="function"&&define.amd){
define(["jquery"],function($){
factory($,root,doc);
return $.mobile;
});
}else{
factory(root.jQuery,root,doc);
}
}(this,document,function(jQuery,window,document,undefined){
(function($){
$.mobile={};
}(jQuery));
(function($,window,undefined){
$.extend($.mobile,{
version:"1.4.2",
subPageUrlKey:"ui-page",
hideUrlBar:true,
keepNative:":jqmData(role='none'), :jqmData(role='nojs')",
activePageClass:"ui-page-active",
activeBtnClass:"ui-btn-active",
focusClass:"ui-focus",
ajaxEnabled:true,
hashListeningEnabled:true,
linkBindingEnabled:true,
defaultPageTransition:"fade",
maxTransitionWidth:false,
minScrollBack:0,
defaultDialogTransition:"pop",
pageLoadErrorMessage:"Error Loading Page",
pageLoadErrorMessageTheme:"a",
phonegapNavigationEnabled:false,
autoInitializePage:true,
pushStateEnabled:true,
ignoreContentEnabled:false,
buttonMarkup:{
hoverDelay:200
},
dynamicBaseEnabled:true,
pageContainer:$(),
allowCrossDomainPages:false,
dialogHashKey:"&ui-state=dialog"
});
})(jQuery,this);
(function($,window,undefined){
var nsNormalizeDict={},
oldFind=$.find,
rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,
jqmDataRE=/:jqmData\(([^)]*)\)/g;
$.extend($.mobile,{
ns:"",
getAttribute:function(element,key){
var data;
element=element.jquery?element[0]:element;
if(element&&element.getAttribute){
data=element.getAttribute("data-"+$.mobile.ns+key);
}
try{
data=data==="true"?true:
data==="false"?false:
data==="null"?null:
+data+""===data?+data:
rbrace.test(data)?JSON.parse(data):
data;
}catch(err){}
return data;
},
nsNormalizeDict:nsNormalizeDict,
nsNormalize:function(prop){
return nsNormalizeDict[prop]||
(nsNormalizeDict[prop]=$.camelCase($.mobile.ns+prop));
},
closestPageData:function($target){
return $target
.closest(":jqmData(role='page'), :jqmData(role='dialog')")
.data("mobile-page");
}
});
$.fn.jqmData=function(prop,value){
var result;
if(typeof prop!=="undefined"){
if(prop){
prop=$.mobile.nsNormalize(prop);
}
if(arguments.length<2||value===undefined){
result=this.data(prop);
}else{
result=this.data(prop,value);
}
}
return result;
};
$.jqmData=function(elem,prop,value){
var result;
if(typeof prop!=="undefined"){
result=$.data(elem,prop?$.mobile.nsNormalize(prop):prop,value);
}
return result;
};
$.fn.jqmRemoveData=function(prop){
return this.removeData($.mobile.nsNormalize(prop));
};
$.jqmRemoveData=function(elem,prop){
return $.removeData(elem,$.mobile.nsNormalize(prop));
};
$.find=function(selector,context,ret,extra){
if(selector.indexOf(":jqmData")>-1){
selector=selector.replace(jqmDataRE,"[data-"+($.mobile.ns||"")+"$1]");
}
return oldFind.call(this,selector,context,ret,extra);
};
$.extend($.find,oldFind);
})(jQuery,this);

(function($,undefined){
var uuid=0,
runiqueId=/^ui-id-\d+$/;
$.ui=$.ui||{};
$.extend($.ui,{
version:"c0ab71056b936627e8a7821f03c044aec6280a40",
keyCode:{
BACKSPACE:8,
COMMA:188,
DELETE:46,
DOWN:40,
END:35,
ENTER:13,
ESCAPE:27,
HOME:36,
LEFT:37,
PAGE_DOWN:34,
PAGE_UP:33,
PERIOD:190,
RIGHT:39,
SPACE:32,
TAB:9,
UP:38
}
});
$.fn.extend({
focus:(function(orig){
return function(delay,fn){
return typeof delay==="number"?
this.each(function(){
var elem=this;
setTimeout(function(){
$(elem).focus();
if(fn){
fn.call(elem);
}
},delay);
}):
orig.apply(this,arguments);
};
})($.fn.focus),
scrollParent:function(){
var scrollParent;
if(($.ui.ie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){
scrollParent=this.parents().filter(function(){
return(/(relative|absolute|fixed)/).test($.css(this,"position"))&&(/(auto|scroll)/).test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"));
}).eq(0);
}else{
scrollParent=this.parents().filter(function(){
return(/(auto|scroll)/).test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"));
}).eq(0);
}
return(/fixed/).test(this.css("position"))||!scrollParent.length?$(this[0].ownerDocument||document):scrollParent;
},
uniqueId:function(){
return this.each(function(){
if(!this.id){
this.id="ui-id-"+(++uuid);
}
});
},
removeUniqueId:function(){
return this.each(function(){
if(runiqueId.test(this.id)){
$(this).removeAttr("id");
}
});
}
});
function focusable(element,isTabIndexNotNaN){
var map,mapName,img,
nodeName=element.nodeName.toLowerCase();
if("area"===nodeName){
map=element.parentNode;
mapName=map.name;
if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){
return false;
}
img=$("img[usemap=#"+mapName+"]")[0];
return!!img&&visible(img);
}
return(/input|select|textarea|button|object/.test(nodeName)?
!element.disabled:
"a"===nodeName?
element.href||isTabIndexNotNaN:
isTabIndexNotNaN)&&
visible(element);
}
function visible(element){
return $.expr.filters.visible(element)&&
!$(element).parents().addBack().filter(function(){
return $.css(this,"visibility")==="hidden";
}).length;
}
$.extend($.expr[":"],{
data:$.expr.createPseudo?
$.expr.createPseudo(function(dataName){
return function(elem){
return!!$.data(elem,dataName);
};
}):
function(elem,i,match){
return!!$.data(elem,match[3]);
},
focusable:function(element){
return focusable(element,!isNaN($.attr(element,"tabindex")));
},
tabbable:function(element){
var tabIndex=$.attr(element,"tabindex"),
isTabIndexNaN=isNaN(tabIndex);
return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN);
}
});
if(!$("<a>").outerWidth(1).jquery){
$.each(["Width","Height"],function(i,name){
var side=name==="Width"?["Left","Right"]:["Top","Bottom"],
type=name.toLowerCase(),
orig={
innerWidth:$.fn.innerWidth,
innerHeight:$.fn.innerHeight,
outerWidth:$.fn.outerWidth,
outerHeight:$.fn.outerHeight
};
function reduce(elem,size,border,margin){
$.each(side,function(){
size-=parseFloat($.css(elem,"padding"+this))||0;
if(border){
size-=parseFloat($.css(elem,"border"+this+"Width"))||0;
}
if(margin){
size-=parseFloat($.css(elem,"margin"+this))||0;
}
});
return size;
}
$.fn["inner"+name]=function(size){
if(size===undefined){
return orig["inner"+name].call(this);
}
return this.each(function(){
$(this).css(type,reduce(this,size)+"px");
});
};
$.fn["outer"+name]=function(size,margin){
if(typeof size!=="number"){
return orig["outer"+name].call(this,size);
}
return this.each(function(){
$(this).css(type,reduce(this,size,true,margin)+"px");
});
};
});
}
if(!$.fn.addBack){
$.fn.addBack=function(selector){
return this.add(selector==null?
this.prevObject:this.prevObject.filter(selector)
);
};
}
if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){
$.fn.removeData=(function(removeData){
return function(key){
if(arguments.length){
return removeData.call(this,$.camelCase(key));
}else{
return removeData.call(this);
}
};
})($.fn.removeData);
}
$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());
$.support.selectstart="onselectstart"in document.createElement("div");
$.fn.extend({
disableSelection:function(){
return this.bind(($.support.selectstart?"selectstart":"mousedown")+
".ui-disableSelection",function(event){
event.preventDefault();
});
},
enableSelection:function(){
return this.unbind(".ui-disableSelection");
},
zIndex:function(zIndex){
if(zIndex!==undefined){
return this.css("zIndex",zIndex);
}
if(this.length){
var elem=$(this[0]),position,value;
while(elem.length&&elem[0]!==document){
position=elem.css("position");
if(position==="absolute"||position==="relative"||position==="fixed"){
value=parseInt(elem.css("zIndex"),10);
if(!isNaN(value)&&value!==0){
return value;
}
}
elem=elem.parent();
}
}
return 0;
}
});
$.ui.plugin={
add:function(module,option,set){
var i,
proto=$.ui[module].prototype;
for(i in set){
proto.plugins[i]=proto.plugins[i]||[];
proto.plugins[i].push([option,set[i]]);
}
},
call:function(instance,name,args,allowDisconnected){
var i,
set=instance.plugins[name];
if(!set){
return;
}
if(!allowDisconnected&&(!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11)){
return;
}
for(i=0;i<set.length;i++){
if(instance.options[set[i][0]]){
set[i][1].apply(instance.element,args);
}
}
}
};
})(jQuery);
(function($,window,undefined){
var compensateToolbars=function(page,desiredHeight){
var pageParent=page.parent(),
toolbarsAffectingHeight=[],
externalHeaders=pageParent.children(":jqmData(role='header')"),
internalHeaders=page.children(":jqmData(role='header')"),
externalFooters=pageParent.children(":jqmData(role='footer')"),
internalFooters=page.children(":jqmData(role='footer')");
if(internalHeaders.length===0&&externalHeaders.length>0){
toolbarsAffectingHeight=toolbarsAffectingHeight.concat(externalHeaders.toArray());
}
if(internalFooters.length===0&&externalFooters.length>0){
toolbarsAffectingHeight=toolbarsAffectingHeight.concat(externalFooters.toArray());
}
$.each(toolbarsAffectingHeight,function(index,value){
desiredHeight-=$(value).outerHeight();
});
return Math.max(0,desiredHeight);
};
$.extend($.mobile,{
window:$(window),
document:$(document),
keyCode:$.ui.keyCode,
behaviors:{},
silentScroll:function(ypos){
if($.type(ypos)!=="number"){
ypos=$.mobile.defaultHomeScroll;
}
$.event.special.scrollstart.enabled=false;
setTimeout(function(){
window.scrollTo(0,ypos);
$.mobile.document.trigger("silentscroll",{x:0,y:ypos});
},20);
setTimeout(function(){
$.event.special.scrollstart.enabled=true;
},150);
},
getClosestBaseUrl:function(ele){
var url=$(ele).closest(".ui-page").jqmData("url"),
base=$.mobile.path.documentBase.hrefNoHash;
if(!$.mobile.dynamicBaseEnabled||!url||!$.mobile.path.isPath(url)){
url=base;
}
return $.mobile.path.makeUrlAbsolute(url,base);
},
removeActiveLinkClass:function(forceRemoval){
if(!!$.mobile.activeClickedLink&&
(!$.mobile.activeClickedLink.closest("."+$.mobile.activePageClass).length||
forceRemoval)){
$.mobile.activeClickedLink.removeClass($.mobile.activeBtnClass);
}
$.mobile.activeClickedLink=null;
},
getInheritedTheme:function(el,defaultTheme){
var e=el[0],
ltr="",
re=/ui-(bar|body|overlay)-([a-z])\b/,
c,m;
while(e){
c=e.className||"";
if(c&&(m=re.exec(c))&&(ltr=m[2])){
break;
}
e=e.parentNode;
}
return ltr||defaultTheme||"a";
},
enhanceable:function(elements){
return this.haveParents(elements,"enhance");
},
hijackable:function(elements){
return this.haveParents(elements,"ajax");
},
haveParents:function(elements,attr){
if(!$.mobile.ignoreContentEnabled){
return elements;
}
var count=elements.length,
$newSet=$(),
e,$element,excluded,
i,c;
for(i=0;i<count;i++){
$element=elements.eq(i);
excluded=false;
e=elements[i];
while(e){
c=e.getAttribute?e.getAttribute("data-"+$.mobile.ns+attr):"";
if(c==="false"){
excluded=true;
break;
}
e=e.parentNode;
}
if(!excluded){
$newSet=$newSet.add($element);
}
}
return $newSet;
},
getScreenHeight:function(){
return window.innerHeight||$.mobile.window.height();
},
resetActivePageHeight:function(height){
var page=$("."+$.mobile.activePageClass),
pageHeight=page.height(),
pageOuterHeight=page.outerHeight(true);
height=compensateToolbars(page,
(typeof height==="number")?height:$.mobile.getScreenHeight());
page.css("min-height",height-(pageOuterHeight-pageHeight));
},
loading:function(){
var loader=this.loading._widget||$($.mobile.loader.prototype.defaultHtml).loader(),
returnValue=loader.loader.apply(loader,arguments);
this.loading._widget=loader;
return returnValue;
}
});
$.addDependents=function(elem,newDependents){
var $elem=$(elem),
dependents=$elem.jqmData("dependents")||$();
$elem.jqmData("dependents",$(dependents).add(newDependents));
};
$.fn.extend({
removeWithDependents:function(){
$.removeWithDependents(this);
},
enhanceWithin:function(){
var index,
widgetElements={},
keepNative=$.mobile.page.prototype.keepNativeSelector(),
that=this;
if($.mobile.nojs){
$.mobile.nojs(this);
}
if($.mobile.links){
$.mobile.links(this);
}
if($.mobile.degradeInputsWithin){
$.mobile.degradeInputsWithin(this);
}
if($.fn.buttonMarkup){
this.find($.fn.buttonMarkup.initSelector).not(keepNative)
.jqmEnhanceable().buttonMarkup();
}
if($.fn.fieldcontain){
this.find(":jqmData(role='fieldcontain')").not(keepNative)
.jqmEnhanceable().fieldcontain();
}
$.each($.mobile.widgets,function(name,constructor){
if(constructor.initSelector){
var elements=$.mobile.enhanceable(that.find(constructor.initSelector));
if(elements.length>0){
elements=elements.not(keepNative);
}
if(elements.length>0){
widgetElements[constructor.prototype.widgetName]=elements;
}
}
});
for(index in widgetElements){
widgetElements[index][index]();
}
return this;
},
addDependents:function(newDependents){
$.addDependents(this,newDependents);
},
getEncodedText:function(){
return $("<a>").text(this.text()).html();
},
jqmEnhanceable:function(){
return $.mobile.enhanceable(this);
},
jqmHijackable:function(){
return $.mobile.hijackable(this);
}
});
$.removeWithDependents=function(nativeElement){
var element=$(nativeElement);
(element.jqmData("dependents")||$()).remove();
element.remove();
};
$.addDependents=function(nativeElement,newDependents){
var element=$(nativeElement),
dependents=element.jqmData("dependents")||$();
element.jqmData("dependents",$(dependents).add(newDependents));
};
$.find.matches=function(expr,set){
return $.find(expr,null,null,set);
};
$.find.matchesSelector=function(node,expr){
return $.find(expr,null,null,[node]).length>0;
};
})(jQuery,this);

(function($,undefined){
var uuid=0,
slice=Array.prototype.slice,
_cleanData=$.cleanData;
$.cleanData=function(elems){
for(var i=0,elem;(elem=elems[i])!=null;i++){
try{
$(elem).triggerHandler("remove");
}catch(e){}
}
_cleanData(elems);
};
$.widget=function(name,base,prototype){
var fullName,existingConstructor,constructor,basePrototype,
proxiedPrototype={},
namespace=name.split(".")[0];
name=name.split(".")[1];
fullName=namespace+"-"+name;
if(!prototype){
prototype=base;
base=$.Widget;
}
$.expr[":"][fullName.toLowerCase()]=function(elem){
return!!$.data(elem,fullName);
};
$[namespace]=$[namespace]||{};
existingConstructor=$[namespace][name];
constructor=$[namespace][name]=function(options,element){
if(!this._createWidget){
return new constructor(options,element);
}
if(arguments.length){
this._createWidget(options,element);
}
};
$.extend(constructor,existingConstructor,{
version:prototype.version,
_proto:$.extend({},prototype),
_childConstructors:[]
});
basePrototype=new base();
basePrototype.options=$.widget.extend({},basePrototype.options);
$.each(prototype,function(prop,value){
if(!$.isFunction(value)){
proxiedPrototype[prop]=value;
return;
}
proxiedPrototype[prop]=(function(){
var _super=function(){
return base.prototype[prop].apply(this,arguments);
},
_superApply=function(args){
return base.prototype[prop].apply(this,args);
};
return function(){
var __super=this._super,
__superApply=this._superApply,
returnValue;
this._super=_super;
this._superApply=_superApply;
returnValue=value.apply(this,arguments);
this._super=__super;
this._superApply=__superApply;
return returnValue;
};
})();
});
constructor.prototype=$.widget.extend(basePrototype,{
widgetEventPrefix:existingConstructor?(basePrototype.widgetEventPrefix||name):name
},proxiedPrototype,{
constructor:constructor,
namespace:namespace,
widgetName:name,
widgetFullName:fullName
});
if(existingConstructor){
$.each(existingConstructor._childConstructors,function(i,child){
var childPrototype=child.prototype;
$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);
});
delete existingConstructor._childConstructors;
}else{
base._childConstructors.push(constructor);
}
$.widget.bridge(name,constructor);
return constructor;
};
$.widget.extend=function(target){
var input=slice.call(arguments,1),
inputIndex=0,
inputLength=input.length,
key,
value;
for(;inputIndex<inputLength;inputIndex++){
for(key in input[inputIndex]){
value=input[inputIndex][key];
if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){
if($.isPlainObject(value)){
target[key]=$.isPlainObject(target[key])?
$.widget.extend({},target[key],value):
$.widget.extend({},value);
}else{
target[key]=value;
}
}
}
}
return target;
};
$.widget.bridge=function(name,object){
var fullName=object.prototype.widgetFullName||name;
$.fn[name]=function(options){
var isMethodCall=typeof options==="string",
args=slice.call(arguments,1),
returnValue=this;
options=!isMethodCall&&args.length?
$.widget.extend.apply(null,[options].concat(args)):
options;
if(isMethodCall){
this.each(function(){
var methodValue,
instance=$.data(this,fullName);
if(options==="instance"){
returnValue=instance;
return false;
}
if(!instance){
return $.error("cannot call methods on "+name+" prior to initialization; "+
"attempted to call method '"+options+"'");
}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){
return $.error("no such method '"+options+"' for "+name+" widget instance");
}
methodValue=instance[options].apply(instance,args);
if(methodValue!==instance&&methodValue!==undefined){
returnValue=methodValue&&methodValue.jquery?
returnValue.pushStack(methodValue.get()):
methodValue;
return false;
}
});
}else{
this.each(function(){
var instance=$.data(this,fullName);
if(instance){
instance.option(options||{})._init();
}else{
$.data(this,fullName,new object(options,this));
}
});
}
return returnValue;
};
};
$.Widget=function(){};
$.Widget._childConstructors=[];
$.Widget.prototype={
widgetName:"widget",
widgetEventPrefix:"",
defaultElement:"<div>",
options:{
disabled:false,
create:null
},
_createWidget:function(options,element){
element=$(element||this.defaultElement||this)[0];
this.element=$(element);
this.uuid=uuid++;
this.eventNamespace="."+this.widgetName+this.uuid;
this.options=$.widget.extend({},
this.options,
this._getCreateOptions(),
options);
this.bindings=$();
this.hoverable=$();
this.focusable=$();
if(element!==this){
$.data(element,this.widgetFullName,this);
this._on(true,this.element,{
remove:function(event){
if(event.target===element){
this.destroy();
}
}
});
this.document=$(element.style?
element.ownerDocument:
element.document||element);
this.window=$(this.document[0].defaultView||this.document[0].parentWindow);
}
this._create();
this._trigger("create",null,this._getCreateEventData());
this._init();
},
_getCreateOptions:$.noop,
_getCreateEventData:$.noop,
_create:$.noop,
_init:$.noop,
destroy:function(){
this._destroy();
this.element
.unbind(this.eventNamespace)
.removeData(this.widgetFullName)
.removeData($.camelCase(this.widgetFullName));
this.widget()
.unbind(this.eventNamespace)
.removeAttr("aria-disabled")
.removeClass(
this.widgetFullName+"-disabled "+
"ui-state-disabled");
this.bindings.unbind(this.eventNamespace);
this.hoverable.removeClass("ui-state-hover");
this.focusable.removeClass("ui-state-focus");
},
_destroy:$.noop,
widget:function(){
return this.element;
},
option:function(key,value){
var options=key,
parts,
curOption,
i;
if(arguments.length===0){
return $.widget.extend({},this.options);
}
if(typeof key==="string"){
options={};
parts=key.split(".");
key=parts.shift();
if(parts.length){
curOption=options[key]=$.widget.extend({},this.options[key]);
for(i=0;i<parts.length-1;i++){
curOption[parts[i]]=curOption[parts[i]]||{};
curOption=curOption[parts[i]];
}
key=parts.pop();
if(value===undefined){
return curOption[key]===undefined?null:curOption[key];
}
curOption[key]=value;
}else{
if(value===undefined){
return this.options[key]===undefined?null:this.options[key];
}
options[key]=value;
}
}
this._setOptions(options);
return this;
},
_setOptions:function(options){
var key;
for(key in options){
this._setOption(key,options[key]);
}
return this;
},
_setOption:function(key,value){
this.options[key]=value;
if(key==="disabled"){
this.widget()
.toggleClass(this.widgetFullName+"-disabled",!!value);
this.hoverable.removeClass("ui-state-hover");
this.focusable.removeClass("ui-state-focus");
}
return this;
},
enable:function(){
return this._setOptions({disabled:false});
},
disable:function(){
return this._setOptions({disabled:true});
},
_on:function(suppressDisabledCheck,element,handlers){
var delegateElement,
instance=this;
if(typeof suppressDisabledCheck!=="boolean"){
handlers=element;
element=suppressDisabledCheck;
suppressDisabledCheck=false;
}
if(!handlers){
handlers=element;
element=this.element;
delegateElement=this.widget();
}else{
element=delegateElement=$(element);
this.bindings=this.bindings.add(element);
}
$.each(handlers,function(event,handler){
function handlerProxy(){
if(!suppressDisabledCheck&&
(instance.options.disabled===true||
$(this).hasClass("ui-state-disabled"))){
return;
}
return(typeof handler==="string"?instance[handler]:handler)
.apply(instance,arguments);
}
if(typeof handler!=="string"){
handlerProxy.guid=handler.guid=
handler.guid||handlerProxy.guid||$.guid++;
}
var match=event.match(/^(\w+)\s*(.*)$/),
eventName=match[1]+instance.eventNamespace,
selector=match[2];
if(selector){
delegateElement.delegate(selector,eventName,handlerProxy);
}else{
element.bind(eventName,handlerProxy);
}
});
},
_off:function(element,eventName){
eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;
element.unbind(eventName).undelegate(eventName);
},
_delay:function(handler,delay){
function handlerProxy(){
return(typeof handler==="string"?instance[handler]:handler)
.apply(instance,arguments);
}
var instance=this;
return setTimeout(handlerProxy,delay||0);
},
_hoverable:function(element){
this.hoverable=this.hoverable.add(element);
this._on(element,{
mouseenter:function(event){
$(event.currentTarget).addClass("ui-state-hover");
},
mouseleave:function(event){
$(event.currentTarget).removeClass("ui-state-hover");
}
});
},
_focusable:function(element){
this.focusable=this.focusable.add(element);
this._on(element,{
focusin:function(event){
$(event.currentTarget).addClass("ui-state-focus");
},
focusout:function(event){
$(event.currentTarget).removeClass("ui-state-focus");
}
});
},
_trigger:function(type,event,data){
var prop,orig,
callback=this.options[type];
data=data||{};
event=$.Event(event);
event.type=(type===this.widgetEventPrefix?
type:
this.widgetEventPrefix+type).toLowerCase();
event.target=this.element[0];
orig=event.originalEvent;
if(orig){
for(prop in orig){
if(!(prop in event)){
event[prop]=orig[prop];
}
}
}
this.element.trigger(event,data);
return!($.isFunction(callback)&&
callback.apply(this.element[0],[event].concat(data))===false||
event.isDefaultPrevented());
}
};
$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){
$.Widget.prototype["_"+method]=function(element,options,callback){
if(typeof options==="string"){
options={effect:options};
}
var hasOptions,
effectName=!options?
method:
options===true||typeof options==="number"?
defaultEffect:
options.effect||defaultEffect;
options=options||{};
if(typeof options==="number"){
options={duration:options};
}
hasOptions=!$.isEmptyObject(options);
options.complete=callback;
if(options.delay){
element.delay(options.delay);
}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){
element[method](options);
}else if(effectName!==method&&element[effectName]){
element[effectName](options.duration,options.easing,callback);
}else{
element.queue(function(next){
$(this)[method]();
if(callback){
callback.call(element[0]);
}
next();
});
}
};
});
})(jQuery);
(function($,undefined){
var rcapitals=/[A-Z]/g,
replaceFunction=function(c){
return"-"+c.toLowerCase();
};
$.extend($.Widget.prototype,{
_getCreateOptions:function(){
var option,value,
elem=this.element[0],
options={};
if(!$.mobile.getAttribute(elem,"defaults")){
for(option in this.options){
value=$.mobile.getAttribute(elem,option.replace(rcapitals,replaceFunction));
if(value!=null){
options[option]=value;
}
}
}
return options;
}
});
$.mobile.widget=$.Widget;
})(jQuery);
(function($){
var loaderClass="ui-loader",$html=$("html");
$.widget("mobile.loader",{
options:{
theme:"a",
textVisible:false,
html:"",
text:"loading"
},
defaultHtml:"<div class='"+loaderClass+"'>"+
"<span class='ui-icon-loading'></span>"+
"<h1></h1>"+
"</div>",
fakeFixLoader:function(){
var activeBtn=$("."+$.mobile.activeBtnClass).first();
this.element
.css({
top:$.support.scrollTop&&this.window.scrollTop()+this.window.height()/2||
activeBtn.length&&activeBtn.offset().top||100
});
},
checkLoaderPosition:function(){
var offset=this.element.offset(),
scrollTop=this.window.scrollTop(),
screenHeight=$.mobile.getScreenHeight();
if(offset.top<scrollTop||(offset.top-scrollTop)>screenHeight){
this.element.addClass("ui-loader-fakefix");
this.fakeFixLoader();
this.window
.unbind("scroll",this.checkLoaderPosition)
.bind("scroll",$.proxy(this.fakeFixLoader,this));
}
},
resetHtml:function(){
this.element.html($(this.defaultHtml).html());
},
show:function(theme,msgText,textonly){
var textVisible,message,loadSettings;
this.resetHtml();
if($.type(theme)==="object"){
loadSettings=$.extend({},this.options,theme);
theme=loadSettings.theme;
}else{
loadSettings=this.options;
theme=theme||loadSettings.theme;
}
message=msgText||(loadSettings.text===false?"":loadSettings.text);
$html.addClass("ui-loading");
textVisible=loadSettings.textVisible;
this.element.attr("class",loaderClass+
" ui-corner-all ui-body-"+theme+
" ui-loader-"+(textVisible||msgText||theme.text?"verbose":"default")+
(loadSettings.textonly||textonly?" ui-loader-textonly":""));
if(loadSettings.html){
this.element.html(loadSettings.html);
}else{
this.element.find("h1").text(message);
}
this.element.appendTo($.mobile.pageContainer);
this.checkLoaderPosition();
this.window.bind("scroll",$.proxy(this.checkLoaderPosition,this));
},
hide:function(){
$html.removeClass("ui-loading");
if(this.options.text){
this.element.removeClass("ui-loader-fakefix");
}
$.mobile.window.unbind("scroll",this.fakeFixLoader);
$.mobile.window.unbind("scroll",this.checkLoaderPosition);
}
});
})(jQuery,this);

(function($,window,undefined){
'$:nomunge';var str_hashchange='hashchange',
doc=document,
fake_onhashchange,
special=$.event.special,
doc_mode=doc.documentMode,
supports_onhashchange='on'+str_hashchange in window&&(doc_mode===undefined||doc_mode>7);
function get_fragment(url){
url=url||location.href;
return'#'+url.replace(/^[^#]*#?(.*)$/,'$1');
};
$.fn[str_hashchange]=function(fn){
return fn?this.bind(str_hashchange,fn):this.trigger(str_hashchange);
};
$.fn[str_hashchange].delay=50;

special[str_hashchange]=$.extend(special[str_hashchange],{
setup:function(){
if(supports_onhashchange){return false}
$(fake_onhashchange.start);
},
teardown:function(){
if(supports_onhashchange){return false}
$(fake_onhashchange.stop);
}
});
fake_onhashchange=(function(){
var self={},
timeout_id,
last_hash=get_fragment(),
fn_retval=function(val){return val},
history_set=fn_retval,
history_get=fn_retval;
self.start=function(){
timeout_id||poll();
};
self.stop=function(){
timeout_id&&clearTimeout(timeout_id);
timeout_id=undefined;
};
function poll(){
var hash=get_fragment(),
history_hash=history_get(last_hash);
if(hash!==last_hash){
history_set(last_hash=hash,history_hash);
$(window).trigger(str_hashchange);
}else if(history_hash!==last_hash){
location.href=location.href.replace(/#.*/,'')+history_hash;
}
timeout_id=setTimeout(poll,$.fn[str_hashchange].delay);
};
window.attachEvent&&!window.addEventListener&&!supports_onhashchange&&(function(){
var iframe,
iframe_src;
self.start=function(){
if(!iframe){
iframe_src=$.fn[str_hashchange].src;
iframe_src=iframe_src&&iframe_src+get_fragment();
iframe=$('<iframe tabindex="-1" title="empty"/>').hide()
.one('load',function(){
iframe_src||history_set(get_fragment());
poll();
})
.attr('src',iframe_src||'javascript:0')
.insertAfter('body')[0].contentWindow;
doc.onpropertychange=function(){
try{
if(event.propertyName==='title'){
iframe.document.title=doc.title;
}
}catch(e){}
};
}
};
self.stop=fn_retval;
history_get=function(){
return get_fragment(iframe.location.href);
};
history_set=function(hash,history_hash){
var iframe_doc=iframe.document,
domain=$.fn[str_hashchange].domain;
if(hash!==history_hash){
iframe_doc.title=doc.title;
iframe_doc.open();
domain&&iframe_doc.write('<script>document.domain="'+domain+'"</script>');
iframe_doc.close();
iframe.location.hash=hash;
}
};
})();
return self;
})();
})(jQuery,this);
(function($,undefined){

window.matchMedia=window.matchMedia||(function(doc,undefined){
var bool,
docElem=doc.documentElement,
refNode=docElem.firstElementChild||docElem.firstChild,
fakeBody=doc.createElement("body"),
div=doc.createElement("div");
div.id="mq-test-1";
div.style.cssText="position:absolute;top:-100em";
fakeBody.style.background="none";
fakeBody.appendChild(div);
return function(q){
div.innerHTML="&shy;<style media=\""+q+"\"> #mq-test-1 { width: 42px; }</style>";
docElem.insertBefore(fakeBody,refNode);
bool=div.offsetWidth===42;
docElem.removeChild(fakeBody);
return{
matches:bool,
media:q
};
};
}(document));
$.mobile.media=function(q){
return window.matchMedia(q).matches;
};
})(jQuery);
(function($,undefined){
var support={
touch:"ontouchend"in document
};
$.mobile.support=$.mobile.support||{};
$.extend($.support,support);
$.extend($.mobile.support,support);
}(jQuery));
(function($,undefined){
$.extend($.support,{
orientation:"orientation"in window&&"onorientationchange"in window
});
}(jQuery));
(function($,undefined){
function propExists(prop){
var uc_prop=prop.charAt(0).toUpperCase()+prop.substr(1),
props=(prop+" "+vendors.join(uc_prop+" ")+uc_prop).split(" "),
v;
for(v in props){
if(fbCSS[props[v]]!==undefined){
return true;
}
}
}
var fakeBody=$("<body>").prependTo("html"),
fbCSS=fakeBody[0].style,
vendors=["Webkit","Moz","O"],
webos="palmGetResource"in window,operamini=window.operamini&&({}).toString.call(window.operamini)==="[object OperaMini]",
bb=window.blackberry&&!propExists("-webkit-transform"),nokiaLTE7_3;
function inlineSVG(){
var w=window,
svg=!!w.document.createElementNS&&!!w.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect&&!(w.opera&&navigator.userAgent.indexOf("Chrome")===-1),
support=function(data){
if(!(data&&svg)){
$("html").addClass("ui-nosvg");
}
},
img=new w.Image();
img.onerror=function(){
support(false);
};
img.onload=function(){
support(img.width===1&&img.height===1);
};
img.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
}
function transform3dTest(){
var mqProp="transform-3d",
ret=$.mobile.media("(-"+vendors.join("-"+mqProp+"),(-")+"-"+mqProp+"),("+mqProp+")"),
el,transforms,t;
if(ret){
return!!ret;
}
el=document.createElement("div");
transforms={
"MozTransform":"-moz-transform",
"transform":"transform"
};
fakeBody.append(el);
for(t in transforms){
if(el.style[t]!==undefined){
el.style[t]="translate3d( 100px, 1px, 1px )";
ret=window.getComputedStyle(el).getPropertyValue(transforms[t]);
}
}
return(!!ret&&ret!=="none");
}
function baseTagTest(){
var fauxBase=location.protocol+"//"+location.host+location.pathname+"ui-dir/",
base=$("head base"),
fauxEle=null,
href="",
link,rebase;
if(!base.length){
base=fauxEle=$("<base>",{"href":fauxBase}).appendTo("head");
}else{
href=base.attr("href");
}
link=$("<a href='testurl' />").prependTo(fakeBody);
rebase=link[0].href;
base[0].href=href||location.pathname;
if(fauxEle){
fauxEle.remove();
}
return rebase.indexOf(fauxBase)===0;
}
function cssPointerEventsTest(){
var element=document.createElement("x"),
documentElement=document.documentElement,
getComputedStyle=window.getComputedStyle,
supports;
if(!("pointerEvents"in element.style)){
return false;
}
element.style.pointerEvents="auto";
element.style.pointerEvents="x";
documentElement.appendChild(element);
supports=getComputedStyle&&
getComputedStyle(element,"").pointerEvents==="auto";
documentElement.removeChild(element);
return!!supports;
}
function boundingRect(){
var div=document.createElement("div");
return typeof div.getBoundingClientRect!=="undefined";
}
$.extend($.mobile,{browser:{}});
$.mobile.browser.oldIE=(function(){
var v=3,
div=document.createElement("div"),
a=div.all||[];
do{
div.innerHTML="<!--[if gt IE "+(++v)+"]><br><![endif]-->";
}while(a[0]);
return v>4?v:!v;
})();
function fixedPosition(){
var w=window,
ua=navigator.userAgent,
platform=navigator.platform,
wkmatch=ua.match(/AppleWebKit\/([0-9]+)/),
wkversion=!!wkmatch&&wkmatch[1],
ffmatch=ua.match(/Fennec\/([0-9]+)/),
ffversion=!!ffmatch&&ffmatch[1],
operammobilematch=ua.match(/Opera Mobi\/([0-9]+)/),
omversion=!!operammobilematch&&operammobilematch[1];
if(
((platform.indexOf("iPhone")>-1||platform.indexOf("iPad")>-1||platform.indexOf("iPod")>-1)&&wkversion&&wkversion<534)||
(w.operamini&&({}).toString.call(w.operamini)==="[object OperaMini]")||
(operammobilematch&&omversion<7458)||
(ua.indexOf("Android")>-1&&wkversion&&wkversion<533)||
(ffversion&&ffversion<6)||
("palmGetResource"in window&&wkversion&&wkversion<534)||
(ua.indexOf("MeeGo")>-1&&ua.indexOf("NokiaBrowser/8.5.0")>-1)){
return false;
}
return true;
}
$.extend($.support,{
pushState:"pushState"in history&&
"replaceState"in history&&
!(window.navigator.userAgent.indexOf("Firefox")>=0&&window.top!==window)&&
(window.navigator.userAgent.search(/CriOS/)===-1),
mediaquery:$.mobile.media("only all"),
cssPseudoElement:!!propExists("content"),
touchOverflow:!!propExists("overflowScrolling"),
cssTransform3d:transform3dTest(),
boxShadow:!!propExists("boxShadow")&&!bb,
fixedPosition:fixedPosition(),
scrollTop:("pageXOffset"in window||
"scrollTop"in document.documentElement||
"scrollTop"in fakeBody[0])&&!webos&&!operamini,
dynamicBaseTag:baseTagTest(),
cssPointerEvents:cssPointerEventsTest(),
boundingRect:boundingRect(),
inlineSVG:inlineSVG
});
fakeBody.remove();
nokiaLTE7_3=(function(){
var ua=window.navigator.userAgent;
return ua.indexOf("Nokia")>-1&&
(ua.indexOf("Symbian/3")>-1||ua.indexOf("Series60/5")>-1)&&
ua.indexOf("AppleWebKit")>-1&&
ua.match(/(BrowserNG|NokiaBrowser)\/7\.[0-3]/);
})();
$.mobile.gradeA=function(){
return(($.support.mediaquery&&$.support.cssPseudoElement)||$.mobile.browser.oldIE&&$.mobile.browser.oldIE>=8)&&($.support.boundingRect||$.fn.jquery.match(/1\.[0-7+]\.[0-9+]?/)!==null);
};
$.mobile.ajaxBlacklist=
window.blackberry&&!window.WebKitPoint||
operamini||
nokiaLTE7_3;
if(nokiaLTE7_3){
$(function(){
$("head link[rel='stylesheet']").attr("rel","alternate stylesheet").attr("rel","stylesheet");
});
}
if(!$.support.boxShadow){
$("html").addClass("ui-noboxshadow");
}
})(jQuery);
(function($,undefined){
var $win=$.mobile.window,self,
dummyFnToInitNavigate=function(){
};
$.event.special.beforenavigate={
setup:function(){
$win.on("navigate",dummyFnToInitNavigate);
},
teardown:function(){
$win.off("navigate",dummyFnToInitNavigate);
}
};
$.event.special.navigate=self={
bound:false,
pushStateEnabled:true,
originalEventName:undefined,
isPushStateEnabled:function(){
return $.support.pushState&&
$.mobile.pushStateEnabled===true&&
this.isHashChangeEnabled();
},
isHashChangeEnabled:function(){
return $.mobile.hashListeningEnabled===true;
},
popstate:function(event){
var newEvent=new $.Event("navigate"),
beforeNavigate=new $.Event("beforenavigate"),
state=event.originalEvent.state||{};
beforeNavigate.originalEvent=event;
$win.trigger(beforeNavigate);
if(beforeNavigate.isDefaultPrevented()){
return;
}
if(event.historyState){
$.extend(state,event.historyState);
}
newEvent.originalEvent=event;
setTimeout(function(){
$win.trigger(newEvent,{
state:state
});
},0);
},
hashchange:function(event){
var newEvent=new $.Event("navigate"),
beforeNavigate=new $.Event("beforenavigate");
beforeNavigate.originalEvent=event;
$win.trigger(beforeNavigate);
if(beforeNavigate.isDefaultPrevented()){
return;
}
newEvent.originalEvent=event;
$win.trigger(newEvent,{
state:event.hashchangeState||{}
});
},
setup:function(){
if(self.bound){
return;
}
self.bound=true;
if(self.isPushStateEnabled()){
self.originalEventName="popstate";
$win.bind("popstate.navigate",self.popstate);
}else if(self.isHashChangeEnabled()){
self.originalEventName="hashchange";
$win.bind("hashchange.navigate",self.hashchange);
}
}
};
})(jQuery);
(function($,undefined){
var path,$base,dialogHashKey="&ui-state=dialog";
$.mobile.path=path={
uiStateKey:"&ui-state",
urlParseRE:/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,
getLocation:function(url){
var uri=url?this.parseUrl(url):location,
hash=this.parseUrl(url||location.href).hash;
hash=hash==="#"?"":hash;
return uri.protocol+"//"+uri.host+uri.pathname+uri.search+hash;
},
getDocumentUrl:function(asParsedObject){
return asParsedObject?$.extend({},path.documentUrl):path.documentUrl.href;
},
parseLocation:function(){
return this.parseUrl(this.getLocation());
},
parseUrl:function(url){
if($.type(url)==="object"){
return url;
}
var matches=path.urlParseRE.exec(url||"")||[];
return{
href:matches[0]||"",
hrefNoHash:matches[1]||"",
hrefNoSearch:matches[2]||"",
domain:matches[3]||"",
protocol:matches[4]||"",
doubleSlash:matches[5]||"",
authority:matches[6]||"",
username:matches[8]||"",
password:matches[9]||"",
host:matches[10]||"",
hostname:matches[11]||"",
port:matches[12]||"",
pathname:matches[13]||"",
directory:matches[14]||"",
filename:matches[15]||"",
search:matches[16]||"",
hash:matches[17]||""
};
},
makePathAbsolute:function(relPath,absPath){
var absStack,
relStack,
i,d;
if(relPath&&relPath.charAt(0)==="/"){
return relPath;
}
relPath=relPath||"";
absPath=absPath?absPath.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"";
absStack=absPath?absPath.split("/"):[];
relStack=relPath.split("/");
for(i=0;i<relStack.length;i++){
d=relStack[i];
switch(d){
case".":
break;
case"..":
if(absStack.length){
absStack.pop();
}
break;
default:
absStack.push(d);
break;
}
}
return"/"+absStack.join("/");
},
isSameDomain:function(absUrl1,absUrl2){
return path.parseUrl(absUrl1).domain===path.parseUrl(absUrl2).domain;
},
isRelativeUrl:function(url){
return path.parseUrl(url).protocol==="";
},
isAbsoluteUrl:function(url){
return path.parseUrl(url).protocol!=="";
},
makeUrlAbsolute:function(relUrl,absUrl){
if(!path.isRelativeUrl(relUrl)){
return relUrl;
}
if(absUrl===undefined){
absUrl=this.documentBase;
}
var relObj=path.parseUrl(relUrl),
absObj=path.parseUrl(absUrl),
protocol=relObj.protocol||absObj.protocol,
doubleSlash=relObj.protocol?relObj.doubleSlash:(relObj.doubleSlash||absObj.doubleSlash),
authority=relObj.authority||absObj.authority,
hasPath=relObj.pathname!=="",
pathname=path.makePathAbsolute(relObj.pathname||absObj.filename,absObj.pathname),
search=relObj.search||(!hasPath&&absObj.search)||"",
hash=relObj.hash;
return protocol+doubleSlash+authority+pathname+search+hash;
},
addSearchParams:function(url,params){
var u=path.parseUrl(url),
p=(typeof params==="object")?$.param(params):params,
s=u.search||"?";
return u.hrefNoSearch+s+(s.charAt(s.length-1)!=="?"?"&":"")+p+(u.hash||"");
},
convertUrlToDataUrl:function(absUrl){
var u=path.parseUrl(absUrl);
if(path.isEmbeddedPage(u)){
return u.hash
.split(dialogHashKey)[0]
.replace(/^#/,"")
.replace(/\?.*$/,"");
}else if(path.isSameDomain(u,this.documentBase)){
return u.hrefNoHash.replace(this.documentBase.domain,"").split(dialogHashKey)[0];
}
return window.decodeURIComponent(absUrl);
},
get:function(newPath){
if(newPath===undefined){
newPath=path.parseLocation().hash;
}
return path.stripHash(newPath).replace(/[^\/]*\.[^\/*]+$/,"");
},
set:function(path){
location.hash=path;
},
isPath:function(url){
return(/\//).test(url);
},
clean:function(url){
return url.replace(this.documentBase.domain,"");
},
stripHash:function(url){
return url.replace(/^#/,"");
},
stripQueryParams:function(url){
return url.replace(/\?.*$/,"");
},
cleanHash:function(hash){
return path.stripHash(hash.replace(/\?.*$/,"").replace(dialogHashKey,""));
},
isHashValid:function(hash){
return(/^#[^#]+$/).test(hash);
},
isExternal:function(url){
var u=path.parseUrl(url);
return u.protocol&&u.domain!==this.documentUrl.domain?true:false;
},
hasProtocol:function(url){
return(/^(:?\w+:)/).test(url);
},
isEmbeddedPage:function(url){
var u=path.parseUrl(url);
if(u.protocol!==""){
return(!this.isPath(u.hash)&&u.hash&&(u.hrefNoHash===this.documentUrl.hrefNoHash||(this.documentBaseDiffers&&u.hrefNoHash===this.documentBase.hrefNoHash)));
}
return(/^#/).test(u.href);
},
squash:function(url,resolutionUrl){
var href,cleanedUrl,search,stateIndex,
isPath=this.isPath(url),
uri=this.parseUrl(url),
preservedHash=uri.hash,
uiState="";
resolutionUrl=resolutionUrl||(path.isPath(url)?path.getLocation():path.getDocumentUrl());
cleanedUrl=isPath?path.stripHash(url):url;
cleanedUrl=path.isPath(uri.hash)?path.stripHash(uri.hash):cleanedUrl;
stateIndex=cleanedUrl.indexOf(this.uiStateKey);
if(stateIndex>-1){
uiState=cleanedUrl.slice(stateIndex);
cleanedUrl=cleanedUrl.slice(0,stateIndex);
}
href=path.makeUrlAbsolute(cleanedUrl,resolutionUrl);
search=this.parseUrl(href).search;
if(isPath){
if(path.isPath(preservedHash)||preservedHash.replace("#","").indexOf(this.uiStateKey)===0){
preservedHash="";
}
if(uiState&&preservedHash.indexOf(this.uiStateKey)===-1){
preservedHash+=uiState;
}
if(preservedHash.indexOf("#")===-1&&preservedHash!==""){
preservedHash="#"+preservedHash;
}
href=path.parseUrl(href);
href=href.protocol+"//"+href.host+href.pathname+search+preservedHash;
}else{
href+=href.indexOf("#")>-1?uiState:"#"+uiState;
}
return href;
},
isPreservableHash:function(hash){
return hash.replace("#","").indexOf(this.uiStateKey)===0;
},
hashToSelector:function(hash){
var hasHash=(hash.substring(0,1)==="#");
if(hasHash){
hash=hash.substring(1);
}
return(hasHash?"#":"")+hash.replace(/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1");
},
getFilePath:function(path){
var splitkey="&"+$.mobile.subPageUrlKey;
return path&&path.split(splitkey)[0].split(dialogHashKey)[0];
},
isFirstPageUrl:function(url){
var u=path.parseUrl(path.makeUrlAbsolute(url,this.documentBase)),
samePath=u.hrefNoHash===this.documentUrl.hrefNoHash||
(this.documentBaseDiffers&&
u.hrefNoHash===this.documentBase.hrefNoHash),
fp=$.mobile.firstPage,
fpId=fp&&fp[0]?fp[0].id:undefined;
return samePath&&
(!u.hash||
u.hash==="#"||
(fpId&&u.hash.replace(/^#/,"")===fpId));
},
isPermittedCrossDomainRequest:function(docUrl,reqUrl){
return $.mobile.allowCrossDomainPages&&
(docUrl.protocol==="file:"||docUrl.protocol==="content:")&&
reqUrl.search(/^https?:/)!==-1;
}
};
path.documentUrl=path.parseLocation();
$base=$("head").find("base");
path.documentBase=$base.length?
path.parseUrl(path.makeUrlAbsolute($base.attr("href"),path.documentUrl.href)):
path.documentUrl;
path.documentBaseDiffers=(path.documentUrl.hrefNoHash!==path.documentBase.hrefNoHash);
path.getDocumentBase=function(asParsedObject){
return asParsedObject?$.extend({},path.documentBase):path.documentBase.href;
};
$.extend($.mobile,{
getDocumentUrl:path.getDocumentUrl,
getDocumentBase:path.getDocumentBase
});
})(jQuery);
(function($,undefined){
$.mobile.History=function(stack,index){
this.stack=stack||[];
this.activeIndex=index||0;
};
$.extend($.mobile.History.prototype,{
getActive:function(){
return this.stack[this.activeIndex];
},
getLast:function(){
return this.stack[this.previousIndex];
},
getNext:function(){
return this.stack[this.activeIndex+1];
},
getPrev:function(){
return this.stack[this.activeIndex-1];
},
add:function(url,data){
data=data||{};
if(this.getNext()){
this.clearForward();
}
if(data.hash&&data.hash.indexOf("#")===-1){
data.hash="#"+data.hash;
}
data.url=url;
this.stack.push(data);
this.activeIndex=this.stack.length-1;
},
clearForward:function(){
this.stack=this.stack.slice(0,this.activeIndex+1);
},
find:function(url,stack,earlyReturn){
stack=stack||this.stack;
var entry,i,length=stack.length,index;
for(i=0;i<length;i++){
entry=stack[i];
if(decodeURIComponent(url)===decodeURIComponent(entry.url)||
decodeURIComponent(url)===decodeURIComponent(entry.hash)){
index=i;
if(earlyReturn){
return index;
}
}
}
return index;
},
closest:function(url){
var closest,a=this.activeIndex;
closest=this.find(url,this.stack.slice(0,a));
if(closest===undefined){
closest=this.find(url,this.stack.slice(a),true);
closest=closest===undefined?closest:closest+a;
}
return closest;
},
direct:function(opts){
var newActiveIndex=this.closest(opts.url),a=this.activeIndex;
if(newActiveIndex!==undefined){
this.activeIndex=newActiveIndex;
this.previousIndex=a;
}
if(newActiveIndex<a){
(opts.present||opts.back||$.noop)(this.getActive(),"back");
}else if(newActiveIndex>a){
(opts.present||opts.forward||$.noop)(this.getActive(),"forward");
}else if(newActiveIndex===undefined&&opts.missing){
opts.missing(this.getActive());
}
}
});
})(jQuery);
(function($,undefined){
var path=$.mobile.path,
initialHref=location.href;
$.mobile.Navigator=function(history){
this.history=history;
this.ignoreInitialHashChange=true;
$.mobile.window.bind({
"popstate.history":$.proxy(this.popstate,this),
"hashchange.history":$.proxy(this.hashchange,this)
});
};
$.extend($.mobile.Navigator.prototype,{
squash:function(url,data){
var state,href,hash=path.isPath(url)?path.stripHash(url):url;
href=path.squash(url);
state=$.extend({
hash:hash,
url:href
},data);
window.history.replaceState(state,state.title||document.title,href);
return state;
},
hash:function(url,href){
var parsed,loc,hash,resolved;
parsed=path.parseUrl(url);
loc=path.parseLocation();
if(loc.pathname+loc.search===parsed.pathname+parsed.search){
hash=parsed.hash?parsed.hash:parsed.pathname+parsed.search;
}else if(path.isPath(url)){
resolved=path.parseUrl(href);
hash=resolved.pathname+resolved.search+(path.isPreservableHash(resolved.hash)?resolved.hash.replace("#",""):"");
}else{
hash=url;
}
return hash;
},
go:function(url,data,noEvents){
var state,href,hash,popstateEvent,
isPopStateEvent=$.event.special.navigate.isPushStateEnabled();
href=path.squash(url);
hash=this.hash(url,href);
if(noEvents&&hash!==path.stripHash(path.parseLocation().hash)){
this.preventNextHashChange=noEvents;
}
this.preventHashAssignPopState=true;
window.location.hash=hash;
this.preventHashAssignPopState=false;
state=$.extend({
url:href,
hash:hash,
title:document.title
},data);
if(isPopStateEvent){
popstateEvent=new $.Event("popstate");
popstateEvent.originalEvent={
type:"popstate",
state:null
};
this.squash(url,state);
if(!noEvents){
this.ignorePopState=true;
$.mobile.window.trigger(popstateEvent);
}
}
this.history.add(state.url,state);
},
popstate:function(event){
var hash,state;
if(!$.event.special.navigate.isPushStateEnabled()){
return;
}
if(this.preventHashAssignPopState){
this.preventHashAssignPopState=false;
event.stopImmediatePropagation();
return;
}
if(this.ignorePopState){
this.ignorePopState=false;
return;
}
if(!event.originalEvent.state&&
this.history.stack.length===1&&
this.ignoreInitialHashChange){
this.ignoreInitialHashChange=false;
if(location.href===initialHref){
event.preventDefault();
return;
}
}
hash=path.parseLocation().hash;
if(!event.originalEvent.state&&hash){
state=this.squash(hash);
this.history.add(state.url,state);
event.historyState=state;
return;
}
this.history.direct({
url:(event.originalEvent.state||{}).url||hash,
present:function(historyEntry,direction){
event.historyState=$.extend({},historyEntry);
event.historyState.direction=direction;
}
});
},
hashchange:function(event){
var history,hash;
if(!$.event.special.navigate.isHashChangeEnabled()||
$.event.special.navigate.isPushStateEnabled()){
return;
}
if(this.preventNextHashChange){
this.preventNextHashChange=false;
event.stopImmediatePropagation();
return;
}
history=this.history;
hash=path.parseLocation().hash;
this.history.direct({
url:hash,
present:function(historyEntry,direction){
event.hashchangeState=$.extend({},historyEntry);
event.hashchangeState.direction=direction;
},
missing:function(){
history.add(hash,{
hash:hash,
title:document.title
});
}
});
}
});
})(jQuery);
(function($,undefined){
$.mobile.navigate=function(url,data,noEvents){
$.mobile.navigate.navigator.go(url,data,noEvents);
};
$.mobile.navigate.history=new $.mobile.History();
$.mobile.navigate.navigator=new $.mobile.Navigator($.mobile.navigate.history);
var loc=$.mobile.path.parseLocation();
$.mobile.navigate.history.add(loc.href,{hash:loc.hash});
})(jQuery);
(function($,undefined){
var props={
"animation":{},
"transition":{}
},
testElement=document.createElement("a"),
vendorPrefixes=["","webkit-","moz-","o-"];
$.each(["animation","transition"],function(i,test){
var testName=(i===0)?test+"-"+"name":test;
$.each(vendorPrefixes,function(j,prefix){
if(testElement.style[$.camelCase(prefix+testName)]!==undefined){
props[test]["prefix"]=prefix;
return false;
}
});
props[test]["duration"]=
$.camelCase(props[test]["prefix"]+test+"-"+"duration");
props[test]["event"]=
$.camelCase(props[test]["prefix"]+test+"-"+"end");
if(props[test]["prefix"]===""){
props[test]["event"]=props[test]["event"].toLowerCase();
}
});
$.support.cssTransitions=(props["transition"]["prefix"]!==undefined);
$.support.cssAnimations=(props["animation"]["prefix"]!==undefined);
$(testElement).remove();
$.fn.animationComplete=function(callback,type,fallbackTime){
var timer,duration,
that=this,
animationType=(!type||type==="animation")?"animation":"transition";
if(($.support.cssTransitions&&animationType==="transition")||
($.support.cssAnimations&&animationType==="animation")){
if(fallbackTime===undefined){
if($(this).context!==document){
duration=parseFloat(
$(this).css(props[animationType].duration)
)*3000;
}
if(duration===0||duration===undefined||isNaN(duration)){
duration=$.fn.animationComplete.defaultDuration;
}
}
timer=setTimeout(function(){
$(that).off(props[animationType].event);
callback.apply(that);
},duration);
return $(this).one(props[animationType].event,function(){
clearTimeout(timer);
callback.call(this,arguments);
});
}else{
setTimeout($.proxy(callback,this),0);
return $(this);
}
};
$.fn.animationComplete.defaultDuration=1000;
})(jQuery);
(function($,window,document,undefined){
var dataPropertyName="virtualMouseBindings",
touchTargetPropertyName="virtualTouchID",
virtualEventNames="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),
touchEventProps="clientX clientY pageX pageY screenX screenY".split(" "),
mouseHookProps=$.event.mouseHooks?$.event.mouseHooks.props:[],
mouseEventProps=$.event.props.concat(mouseHookProps),
activeDocHandlers={},
resetTimerID=0,
startX=0,
startY=0,
didScroll=false,
clickBlockList=[],
blockMouseTriggers=false,
blockTouchTriggers=false,
eventCaptureSupported="addEventListener"in document,
$document=$(document),
nextTouchID=1,
lastTouchID=0,threshold,
i;
$.vmouse={
moveDistanceThreshold:10,
clickDistanceThreshold:10,
resetTimerDuration:1500
};
function getNativeEvent(event){
while(event&&typeof event.originalEvent!=="undefined"){
event=event.originalEvent;
}
return event;
}
function createVirtualEvent(event,eventType){
var t=event.type,
oe,props,ne,prop,ct,touch,i,j,len;
event=$.Event(event);
event.type=eventType;
oe=event.originalEvent;
props=$.event.props;
if(t.search(/^(mouse|click)/)>-1){
props=mouseEventProps;
}
if(oe){
for(i=props.length,prop;i;){
prop=props[--i];
event[prop]=oe[prop];
}
}
if(t.search(/mouse(down|up)|click/)>-1&&!event.which){
event.which=1;
}
if(t.search(/^touch/)!==-1){
ne=getNativeEvent(oe);
t=ne.touches;
ct=ne.changedTouches;
touch=(t&&t.length)?t[0]:((ct&&ct.length)?ct[0]:undefined);
if(touch){
for(j=0,len=touchEventProps.length;j<len;j++){
prop=touchEventProps[j];
event[prop]=touch[prop];
}
}
}
return event;
}
function getVirtualBindingFlags(element){
var flags={},
b,k;
while(element){
b=$.data(element,dataPropertyName);
for(k in b){
if(b[k]){
flags[k]=flags.hasVirtualBinding=true;
}
}
element=element.parentNode;
}
return flags;
}
function getClosestElementWithVirtualBinding(element,eventType){
var b;
while(element){
b=$.data(element,dataPropertyName);
if(b&&(!eventType||b[eventType])){
return element;
}
element=element.parentNode;
}
return null;
}
function enableTouchBindings(){
blockTouchTriggers=false;
}
function disableTouchBindings(){
blockTouchTriggers=true;
}
function enableMouseBindings(){
lastTouchID=0;
clickBlockList.length=0;
blockMouseTriggers=false;
disableTouchBindings();
}
function disableMouseBindings(){
enableTouchBindings();
}
function startResetTimer(){
clearResetTimer();
resetTimerID=setTimeout(function(){
resetTimerID=0;
enableMouseBindings();
},$.vmouse.resetTimerDuration);
}
function clearResetTimer(){
if(resetTimerID){
clearTimeout(resetTimerID);
resetTimerID=0;
}
}
function triggerVirtualEvent(eventType,event,flags){
var ve;
if((flags&&flags[eventType])||
(!flags&&getClosestElementWithVirtualBinding(event.target,eventType))){
ve=createVirtualEvent(event,eventType);
$(event.target).trigger(ve);
}
return ve;
}
function mouseEventCallback(event){
var touchID=$.data(event.target,touchTargetPropertyName),
ve;
if(!blockMouseTriggers&&(!lastTouchID||lastTouchID!==touchID)){
ve=triggerVirtualEvent("v"+event.type,event);
if(ve){
if(ve.isDefaultPrevented()){
event.preventDefault();
}
if(ve.isPropagationStopped()){
event.stopPropagation();
}
if(ve.isImmediatePropagationStopped()){
event.stopImmediatePropagation();
}
}
}
}
function handleTouchStart(event){
var touches=getNativeEvent(event).touches,
target,flags,t;
if(touches&&touches.length===1){
target=event.target;
flags=getVirtualBindingFlags(target);
if(flags.hasVirtualBinding){
lastTouchID=nextTouchID++;
$.data(target,touchTargetPropertyName,lastTouchID);
clearResetTimer();
disableMouseBindings();
didScroll=false;
t=getNativeEvent(event).touches[0];
startX=t.pageX;
startY=t.pageY;
triggerVirtualEvent("vmouseover",event,flags);
triggerVirtualEvent("vmousedown",event,flags);
}
}
}
function handleScroll(event){
if(blockTouchTriggers){
return;
}
if(!didScroll){
triggerVirtualEvent("vmousecancel",event,getVirtualBindingFlags(event.target));
}
didScroll=true;
startResetTimer();
}
function handleTouchMove(event){
if(blockTouchTriggers){
return;
}
var t=getNativeEvent(event).touches[0],
didCancel=didScroll,
moveThreshold=$.vmouse.moveDistanceThreshold,
flags=getVirtualBindingFlags(event.target);
didScroll=didScroll||
(Math.abs(t.pageX-startX)>moveThreshold||
Math.abs(t.pageY-startY)>moveThreshold);
if(didScroll&&!didCancel){
triggerVirtualEvent("vmousecancel",event,flags);
}
triggerVirtualEvent("vmousemove",event,flags);
startResetTimer();
}
function handleTouchEnd(event){
if(blockTouchTriggers){
return;
}
disableTouchBindings();
var flags=getVirtualBindingFlags(event.target),
ve,t;
triggerVirtualEvent("vmouseup",event,flags);
if(!didScroll){
ve=triggerVirtualEvent("vclick",event,flags);
if(ve&&ve.isDefaultPrevented()){
t=getNativeEvent(event).changedTouches[0];
clickBlockList.push({
touchID:lastTouchID,
x:t.clientX,
y:t.clientY
});
blockMouseTriggers=true;
}
}
triggerVirtualEvent("vmouseout",event,flags);
didScroll=false;
startResetTimer();
}
function hasVirtualBindings(ele){
var bindings=$.data(ele,dataPropertyName),
k;
if(bindings){
for(k in bindings){
if(bindings[k]){
return true;
}
}
}
return false;
}
function dummyMouseHandler(){}
function getSpecialEventObject(eventType){
var realType=eventType.substr(1);
return{
setup:function(){
if(!hasVirtualBindings(this)){
$.data(this,dataPropertyName,{});
}
var bindings=$.data(this,dataPropertyName);
bindings[eventType]=true;
activeDocHandlers[eventType]=(activeDocHandlers[eventType]||0)+1;
if(activeDocHandlers[eventType]===1){
$document.bind(realType,mouseEventCallback);
}
$(this).bind(realType,dummyMouseHandler);
if(eventCaptureSupported){
activeDocHandlers["touchstart"]=(activeDocHandlers["touchstart"]||0)+1;
if(activeDocHandlers["touchstart"]===1){
$document.bind("touchstart",handleTouchStart)
.bind("touchend",handleTouchEnd)
.bind("touchmove",handleTouchMove)
.bind("scroll",handleScroll);
}
}
},
teardown:function(){
--activeDocHandlers[eventType];
if(!activeDocHandlers[eventType]){
$document.unbind(realType,mouseEventCallback);
}
if(eventCaptureSupported){
--activeDocHandlers["touchstart"];
if(!activeDocHandlers["touchstart"]){
$document.unbind("touchstart",handleTouchStart)
.unbind("touchmove",handleTouchMove)
.unbind("touchend",handleTouchEnd)
.unbind("scroll",handleScroll);
}
}
var $this=$(this),
bindings=$.data(this,dataPropertyName);
if(bindings){
bindings[eventType]=false;
}
$this.unbind(realType,dummyMouseHandler);
if(!hasVirtualBindings(this)){
$this.removeData(dataPropertyName);
}
}
};
}
for(i=0;i<virtualEventNames.length;i++){
$.event.special[virtualEventNames[i]]=getSpecialEventObject(virtualEventNames[i]);
}
if(eventCaptureSupported){
document.addEventListener("click",function(e){
var cnt=clickBlockList.length,
target=e.target,
x,y,ele,i,o,touchID;
if(cnt){
x=e.clientX;
y=e.clientY;
threshold=$.vmouse.clickDistanceThreshold;
ele=target;
while(ele){
for(i=0;i<cnt;i++){
o=clickBlockList[i];
touchID=0;
if((ele===target&&Math.abs(o.x-x)<threshold&&Math.abs(o.y-y)<threshold)||
$.data(ele,touchTargetPropertyName)===o.touchID){
e.preventDefault();
e.stopPropagation();
return;
}
}
ele=ele.parentNode;
}
}
},true);
}
})(jQuery,window,document);
(function($,window,undefined){
var $document=$(document),
supportTouch=$.mobile.support.touch,
scrollEvent="touchmove scroll",
touchStartEvent=supportTouch?"touchstart":"mousedown",
touchStopEvent=supportTouch?"touchend":"mouseup",
touchMoveEvent=supportTouch?"touchmove":"mousemove";
$.each(("touchstart touchmove touchend "+
"tap taphold "+
"swipe swipeleft swiperight "+
"scrollstart scrollstop").split(" "),function(i,name){
$.fn[name]=function(fn){
return fn?this.bind(name,fn):this.trigger(name);
};
if($.attrFn){
$.attrFn[name]=true;
}
});
function triggerCustomEvent(obj,eventType,event,bubble){
var originalType=event.type;
event.type=eventType;
if(bubble){
$.event.trigger(event,undefined,obj);
}else{
$.event.dispatch.call(obj,event);
}
event.type=originalType;
}
$.event.special.scrollstart={
enabled:true,
setup:function(){
var thisObject=this,
$this=$(thisObject),
scrolling,
timer;
function trigger(event,state){
scrolling=state;
triggerCustomEvent(thisObject,scrolling?"scrollstart":"scrollstop",event);
}
$this.bind(scrollEvent,function(event){
if(!$.event.special.scrollstart.enabled){
return;
}
if(!scrolling){
trigger(event,true);
}
clearTimeout(timer);
timer=setTimeout(function(){
trigger(event,false);
},50);
});
},
teardown:function(){
$(this).unbind(scrollEvent);
}
};
$.event.special.tap={
tapholdThreshold:750,
emitTapOnTaphold:true,
setup:function(){
var thisObject=this,
$this=$(thisObject),
isTaphold=false;
$this.bind("vmousedown",function(event){
isTaphold=false;
if(event.which&&event.which!==1){
return false;
}
var origTarget=event.target,
timer;
function clearTapTimer(){
clearTimeout(timer);
}
function clearTapHandlers(){
clearTapTimer();
$this.unbind("vclick",clickHandler)
.unbind("vmouseup",clearTapTimer);
$document.unbind("vmousecancel",clearTapHandlers);
}
function clickHandler(event){
clearTapHandlers();
if(!isTaphold&&origTarget===event.target){
triggerCustomEvent(thisObject,"tap",event);
}else if(isTaphold){
event.stopPropagation();
}
}
$this.bind("vmouseup",clearTapTimer)
.bind("vclick",clickHandler);
$document.bind("vmousecancel",clearTapHandlers);
timer=setTimeout(function(){
if(!$.event.special.tap.emitTapOnTaphold){
isTaphold=true;
}
triggerCustomEvent(thisObject,"taphold",$.Event("taphold",{target:origTarget}));
},$.event.special.tap.tapholdThreshold);
});
},
teardown:function(){
$(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup");
$document.unbind("vmousecancel");
}
};
$.event.special.swipe={
scrollSupressionThreshold:30,
durationThreshold:1000,
horizontalDistanceThreshold:30,
verticalDistanceThreshold:30,
getLocation:function(event){
var winPageX=window.pageXOffset,
winPageY=window.pageYOffset,
x=event.clientX,
y=event.clientY;
if(event.pageY===0&&Math.floor(y)>Math.floor(event.pageY)||
event.pageX===0&&Math.floor(x)>Math.floor(event.pageX)){
x=x-winPageX;
y=y-winPageY;
}else if(y<(event.pageY-winPageY)||x<(event.pageX-winPageX)){
x=event.pageX-winPageX;
y=event.pageY-winPageY;
}
return{
x:x,
y:y
};
},
start:function(event){
var data=event.originalEvent.touches?
event.originalEvent.touches[0]:event,
location=$.event.special.swipe.getLocation(data);
return{
time:(new Date()).getTime(),
coords:[location.x,location.y],
origin:$(event.target)
};
},
stop:function(event){
var data=event.originalEvent.touches?
event.originalEvent.touches[0]:event,
location=$.event.special.swipe.getLocation(data);
return{
time:(new Date()).getTime(),
coords:[location.x,location.y]
};
},
handleSwipe:function(start,stop,thisObject,origTarget){
if(stop.time-start.time<$.event.special.swipe.durationThreshold&&
Math.abs(start.coords[0]-stop.coords[0])>$.event.special.swipe.horizontalDistanceThreshold&&
Math.abs(start.coords[1]-stop.coords[1])<$.event.special.swipe.verticalDistanceThreshold){
var direction=start.coords[0]>stop.coords[0]?"swipeleft":"swiperight";
triggerCustomEvent(thisObject,"swipe",$.Event("swipe",{target:origTarget,swipestart:start,swipestop:stop}),true);
triggerCustomEvent(thisObject,direction,$.Event(direction,{target:origTarget,swipestart:start,swipestop:stop}),true);
return true;
}
return false;
},
eventInProgress:false,
setup:function(){
var events,
thisObject=this,
$this=$(thisObject),
context={};
events=$.data(this,"mobile-events");
if(!events){
events={length:0};
$.data(this,"mobile-events",events);
}
events.length++;
events.swipe=context;
context.start=function(event){
if($.event.special.swipe.eventInProgress){
return;
}
$.event.special.swipe.eventInProgress=true;
var stop,
start=$.event.special.swipe.start(event),
origTarget=event.target,
emitted=false;
context.move=function(event){
if(!start){
return;
}
stop=$.event.special.swipe.stop(event);
if(!emitted){
emitted=$.event.special.swipe.handleSwipe(start,stop,thisObject,origTarget);
if(emitted){
$.event.special.swipe.eventInProgress=false;
}
}
if(Math.abs(start.coords[0]-stop.coords[0])>$.event.special.swipe.scrollSupressionThreshold){
event.preventDefault();
}
};
context.stop=function(){
emitted=true;
$.event.special.swipe.eventInProgress=false;
$document.off(touchMoveEvent,context.move);
context.move=null;
};
$document.on(touchMoveEvent,context.move)
.one(touchStopEvent,context.stop);
};
$this.on(touchStartEvent,context.start);
},
teardown:function(){
var events,context;
events=$.data(this,"mobile-events");
if(events){
context=events.swipe;
delete events.swipe;
events.length--;
if(events.length===0){
$.removeData(this,"mobile-events");
}
}
if(context){
if(context.start){
$(this).off(touchStartEvent,context.start);
}
if(context.move){
$document.off(touchMoveEvent,context.move);
}
if(context.stop){
$document.off(touchStopEvent,context.stop);
}
}
}
};
$.each({
scrollstop:"scrollstart",
taphold:"tap",
swipeleft:"swipe",
swiperight:"swipe"
},function(event,sourceEvent){
$.event.special[event]={
setup:function(){
$(this).bind(sourceEvent,$.noop);
},
teardown:function(){
$(this).unbind(sourceEvent);
}
};
});
})(jQuery,this);
(function($){
$.event.special.throttledresize={
setup:function(){
$(this).bind("resize",handler);
},
teardown:function(){
$(this).unbind("resize",handler);
}
};
var throttle=250,
handler=function(){
curr=(new Date()).getTime();
diff=curr-lastCall;
if(diff>=throttle){
lastCall=curr;
$(this).trigger("throttledresize");
}else{
if(heldCall){
clearTimeout(heldCall);
}
heldCall=setTimeout(handler,throttle-diff);
}
},
lastCall=0,
heldCall,
curr,
diff;
})(jQuery);
(function($,window){
var win=$(window),
event_name="orientationchange",
get_orientation,
last_orientation,
initial_orientation_is_landscape,
initial_orientation_is_default,
portrait_map={"0":true,"180":true},
ww,wh,landscape_threshold;
if($.support.orientation){
ww=window.innerWidth||win.width();
wh=window.innerHeight||win.height();
landscape_threshold=50;
initial_orientation_is_landscape=ww>wh&&(ww-wh)>landscape_threshold;
initial_orientation_is_default=portrait_map[window.orientation];
if((initial_orientation_is_landscape&&initial_orientation_is_default)||(!initial_orientation_is_landscape&&!initial_orientation_is_default)){
portrait_map={"-90":true,"90":true};
}
}
$.event.special.orientationchange=$.extend({},$.event.special.orientationchange,{
setup:function(){
if($.support.orientation&&!$.event.special.orientationchange.disabled){
return false;
}
last_orientation=get_orientation();
win.bind("throttledresize",handler);
},
teardown:function(){
if($.support.orientation&&!$.event.special.orientationchange.disabled){
return false;
}
win.unbind("throttledresize",handler);
},
add:function(handleObj){
var old_handler=handleObj.handler;
handleObj.handler=function(event){
event.orientation=get_orientation();
return old_handler.apply(this,arguments);
};
}
});
function handler(){
var orientation=get_orientation();
if(orientation!==last_orientation){
last_orientation=orientation;
win.trigger(event_name);
}
}
$.event.special.orientationchange.orientation=get_orientation=function(){
var isPortrait=true,elem=document.documentElement;
if($.support.orientation){
isPortrait=portrait_map[window.orientation];
}else{
isPortrait=elem&&elem.clientWidth/elem.clientHeight<1.1;
}
return isPortrait?"portrait":"landscape";
};
$.fn[event_name]=function(fn){
return fn?this.bind(event_name,fn):this.trigger(event_name);
};
if($.attrFn){
$.attrFn[event_name]=true;
}
}(jQuery,this));
(function($,undefined){
var baseElement=$("head").children("base"),
base={
element:(baseElement.length?baseElement:
$("<base>",{href:$.mobile.path.documentBase.hrefNoHash}).prependTo($("head"))),
linkSelector:"[src], link[href], a[rel='external'], :jqmData(ajax='false'), a[target]",
set:function(href){
if(!$.mobile.dynamicBaseEnabled){
return;
}
if($.support.dynamicBaseTag){
base.element.attr("href",
$.mobile.path.makeUrlAbsolute(href,$.mobile.path.documentBase));
}
},
rewrite:function(href,page){
var newPath=$.mobile.path.get(href);
page.find(base.linkSelector).each(function(i,link){
var thisAttr=$(link).is("[href]")?"href":
$(link).is("[src]")?"src":"action",
thisUrl=$(link).attr(thisAttr);
thisUrl=thisUrl.replace(location.protocol+"//"+
location.host+location.pathname,"");
if(!/^(\w+:|#|\/)/.test(thisUrl)){
$(link).attr(thisAttr,newPath+thisUrl);
}
});
},
reset:function(){
base.element.attr("href",$.mobile.path.documentBase.hrefNoSearch);
}
};
$.mobile.base=base;
})(jQuery);
(function($,undefined){
$.mobile.widgets={};
var originalWidget=$.widget,
keepNativeFactoryDefault=$.mobile.keepNative;
$.widget=(function(orig){
return function(){
var constructor=orig.apply(this,arguments),
name=constructor.prototype.widgetName;
constructor.initSelector=((constructor.prototype.initSelector!==undefined)?
constructor.prototype.initSelector:":jqmData(role='"+name+"')");
$.mobile.widgets[name]=constructor;
return constructor;
};
})($.widget);
$.extend($.widget,originalWidget);
$.mobile.document.on("create",function(event){
$(event.target).enhanceWithin();
});
$.widget("mobile.page",{
options:{
theme:"a",
domCache:false,
keepNativeDefault:$.mobile.keepNative,
contentTheme:null,
enhanced:false
},
_createWidget:function(){
$.Widget.prototype._createWidget.apply(this,arguments);
this._trigger("init");
},
_create:function(){
if(this._trigger("beforecreate")===false){
return false;
}
if(!this.options.enhanced){
this._enhance();
}
this._on(this.element,{
pagebeforehide:"removeContainerBackground",
pagebeforeshow:"_handlePageBeforeShow"
});
this.element.enhanceWithin();
if($.mobile.getAttribute(this.element[0],"role")==="dialog"&&$.mobile.dialog){
this.element.dialog();
}
},
_enhance:function(){
var attrPrefix="data-"+$.mobile.ns,
self=this;
if(this.options.role){
this.element.attr("data-"+$.mobile.ns+"role",this.options.role);
}
this.element
.attr("tabindex","0")
.addClass("ui-page ui-page-theme-"+this.options.theme);
this.element.find("["+attrPrefix+"role='content']").each(function(){
var $this=$(this),
theme=this.getAttribute(attrPrefix+"theme")||undefined;
self.options.contentTheme=theme||self.options.contentTheme||(self.options.dialog&&self.options.theme)||(self.element.jqmData("role")==="dialog"&&self.options.theme);
$this.addClass("ui-content");
if(self.options.contentTheme){
$this.addClass("ui-body-"+(self.options.contentTheme));
}
$this.attr("role","main").addClass("ui-content");
});
},
bindRemove:function(callback){
var page=this.element;
if(!page.data("mobile-page").options.domCache&&
page.is(":jqmData(external-page='true')")){
page.bind("pagehide.remove",callback||function(e,data){
if(!data.samePage){
var $this=$(this),
prEvent=new $.Event("pageremove");
$this.trigger(prEvent);
if(!prEvent.isDefaultPrevented()){
$this.removeWithDependents();
}
}
});
}
},
_setOptions:function(o){
if(o.theme!==undefined){
this.element.removeClass("ui-page-theme-"+this.options.theme).addClass("ui-page-theme-"+o.theme);
}
if(o.contentTheme!==undefined){
this.element.find("[data-"+$.mobile.ns+"='content']").removeClass("ui-body-"+this.options.contentTheme)
.addClass("ui-body-"+o.contentTheme);
}
},
_handlePageBeforeShow:function(){
this.setContainerBackground();
},
removeContainerBackground:function(){
this.element.closest(":mobile-pagecontainer").pagecontainer({"theme":"none"});
},
setContainerBackground:function(theme){
this.element.parent().pagecontainer({"theme":theme||this.options.theme});
},
keepNativeSelector:function(){
var options=this.options,
keepNative=$.trim(options.keepNative||""),
globalValue=$.trim($.mobile.keepNative),
optionValue=$.trim(options.keepNativeDefault),
newDefault=(keepNativeFactoryDefault===globalValue?
"":globalValue),
oldDefault=(newDefault===""?optionValue:"");
return((keepNative?[keepNative]:[])
.concat(newDefault?[newDefault]:[])
.concat(oldDefault?[oldDefault]:[])
.join(", "));
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.pagecontainer",{
options:{
theme:"a"
},
initSelector:false,
_create:function(){
this.setLastScrollEnabled=true;
this._on(this.window,{
navigate:"_disableRecordScroll",
scrollstop:"_delayedRecordScroll"
});
this._on(this.window,{navigate:"_filterNavigateEvents"});
this._on({pagechange:"_afterContentChange"});
this.window.one("navigate",$.proxy(function(){
this.setLastScrollEnabled=true;
},this));
},
_setOptions:function(options){
if(options.theme!==undefined&&options.theme!=="none"){
this.element.removeClass("ui-overlay-"+this.options.theme)
.addClass("ui-overlay-"+options.theme);
}else if(options.theme!==undefined){
this.element.removeClass("ui-overlay-"+this.options.theme);
}
this._super(options);
},
_disableRecordScroll:function(){
this.setLastScrollEnabled=false;
},
_enableRecordScroll:function(){
this.setLastScrollEnabled=true;
},
_afterContentChange:function(){
this.setLastScrollEnabled=true;
this._off(this.window,"scrollstop");
this._on(this.window,{scrollstop:"_delayedRecordScroll"});
},
_recordScroll:function(){
if(!this.setLastScrollEnabled){
return;
}
var active=this._getActiveHistory(),
currentScroll,minScroll,defaultScroll;
if(active){
currentScroll=this._getScroll();
minScroll=this._getMinScroll();
defaultScroll=this._getDefaultScroll();
active.lastScroll=currentScroll<minScroll?defaultScroll:currentScroll;
}
},
_delayedRecordScroll:function(){
setTimeout($.proxy(this,"_recordScroll"),100);
},
_getScroll:function(){
return this.window.scrollTop();
},
_getMinScroll:function(){
return $.mobile.minScrollBack;
},
_getDefaultScroll:function(){
return $.mobile.defaultHomeScroll;
},
_filterNavigateEvents:function(e,data){
var url;
if(e.originalEvent&&e.originalEvent.isDefaultPrevented()){
return;
}
url=e.originalEvent.type.indexOf("hashchange")>-1?data.state.hash:data.state.url;
if(!url){
url=this._getHash();
}
if(!url||url==="#"||url.indexOf("#"+$.mobile.path.uiStateKey)===0){
url=location.href;
}
this._handleNavigate(url,data.state);
},
_getHash:function(){
return $.mobile.path.parseLocation().hash;
},
getActivePage:function(){
return this.activePage;
},
_getInitialContent:function(){
return $.mobile.firstPage;
},
_getHistory:function(){
return $.mobile.navigate.history;
},
_getActiveHistory:function(){
return $.mobile.navigate.history.getActive();
},
_getDocumentBase:function(){
return $.mobile.path.documentBase;
},
back:function(){
this.go(-1);
},
forward:function(){
this.go(1);
},
go:function(steps){
if($.mobile.hashListeningEnabled){
window.history.go(steps);
}else{
var activeIndex=$.mobile.navigate.history.activeIndex,
index=activeIndex+parseInt(steps,10),
url=$.mobile.navigate.history.stack[index].url,
direction=(steps>=1)?"forward":"back";
$.mobile.navigate.history.activeIndex=index;
$.mobile.navigate.history.previousIndex=activeIndex;
this.change(url,{direction:direction,changeHash:false,fromHashChange:true});
}
},
_handleDestination:function(to){
var history;
if($.type(to)==="string"){
to=$.mobile.path.stripHash(to);
}
if(to){
history=this._getHistory();
to=!$.mobile.path.isPath(to)?($.mobile.path.makeUrlAbsolute("#"+to,this._getDocumentBase())):to;
if(to===$.mobile.path.makeUrlAbsolute("#"+history.initialDst,this._getDocumentBase())&&
history.stack.length&&
history.stack[0].url!==history.initialDst.replace($.mobile.dialogHashKey,"")){
to=this._getInitialContent();
}
}
return to||this._getInitialContent();
},
_handleDialog:function(changePageOptions,data){
var to,active,activeContent=this.getActivePage();
if(activeContent&&!activeContent.hasClass("ui-dialog")){
if(data.direction==="back"){
this.back();
}else{
this.forward();
}
return false;
}else{
to=data.pageUrl;
active=this._getActiveHistory();
$.extend(changePageOptions,{
role:active.role,
transition:active.transition,
reverse:data.direction==="back"
});
}
return to;
},
_handleNavigate:function(url,data){
var to=$.mobile.path.stripHash(url),history=this._getHistory(),
transition=history.stack.length===0?"none":undefined,
changePageOptions={
changeHash:false,
fromHashChange:true,
reverse:data.direction==="back"
};
$.extend(changePageOptions,data,{
transition:(history.getLast()||{}).transition||transition
});
if(history.activeIndex>0&&
to.indexOf($.mobile.dialogHashKey)>-1&&
history.initialDst!==to){
to=this._handleDialog(changePageOptions,data);
if(to===false){
return;
}
}
this._changeContent(this._handleDestination(to),changePageOptions);
},
_changeContent:function(to,opts){
$.mobile.changePage(to,opts);
},
_getBase:function(){
return $.mobile.base;
},
_getNs:function(){
return $.mobile.ns;
},
_enhance:function(content,role){
return content.page({role:role});
},
_include:function(page,settings){
page.appendTo(this.element);
this._enhance(page,settings.role);
page.page("bindRemove");
},
_find:function(absUrl){
var fileUrl=this._createFileUrl(absUrl),
dataUrl=this._createDataUrl(absUrl),
page,initialContent=this._getInitialContent();
page=this.element
.children("[data-"+this._getNs()+"url='"+dataUrl+"']");
if(page.length===0&&dataUrl&&!$.mobile.path.isPath(dataUrl)){
page=this.element.children($.mobile.path.hashToSelector("#"+dataUrl))
.attr("data-"+this._getNs()+"url",dataUrl)
.jqmData("url",dataUrl);
}
if(page.length===0&&
$.mobile.path.isFirstPageUrl(fileUrl)&&
initialContent&&
initialContent.parent().length){
page=$(initialContent);
}
return page;
},
_getLoader:function(){
return $.mobile.loading();
},
_showLoading:function(delay,theme,msg,textonly){
if(this._loadMsg){
return;
}
this._loadMsg=setTimeout($.proxy(function(){
this._getLoader().loader("show",theme,msg,textonly);
this._loadMsg=0;
},this),delay);
},
_hideLoading:function(){
clearTimeout(this._loadMsg);
this._loadMsg=0;
this._getLoader().loader("hide");
},
_showError:function(){
this._hideLoading();
this._showLoading(0,$.mobile.pageLoadErrorMessageTheme,$.mobile.pageLoadErrorMessage,true);
setTimeout($.proxy(this,"_hideLoading"),1500);
},
_parse:function(html,fileUrl){
var page,all=$("<div></div>");
all.get(0).innerHTML=html;
page=all.find(":jqmData(role='page'), :jqmData(role='dialog')").first();
if(!page.length){
page=$("<div data-"+this._getNs()+"role='page'>"+
(html.split(/<\/?body[^>]*>/gmi)[1]||"")+
"</div>");
}
page.attr("data-"+this._getNs()+"url",$.mobile.path.convertUrlToDataUrl(fileUrl))
.attr("data-"+this._getNs()+"external-page",true);
return page;
},
_setLoadedTitle:function(page,html){
var newPageTitle=html.match(/<title[^>]*>([^<]*)/)&&RegExp.$1;
if(newPageTitle&&!page.jqmData("title")){
newPageTitle=$("<div>"+newPageTitle+"</div>").text();
page.jqmData("title",newPageTitle);
}
},
_isRewritableBaseTag:function(){
return $.mobile.dynamicBaseEnabled&&!$.support.dynamicBaseTag;
},
_createDataUrl:function(absoluteUrl){
return $.mobile.path.convertUrlToDataUrl(absoluteUrl);
},
_createFileUrl:function(absoluteUrl){
return $.mobile.path.getFilePath(absoluteUrl);
},
_triggerWithDeprecated:function(name,data,page){
var deprecatedEvent=$.Event("page"+name),
newEvent=$.Event(this.widgetName+name);
(page||this.element).trigger(deprecatedEvent,data);
this.element.trigger(newEvent,data);
return{
deprecatedEvent:deprecatedEvent,
event:newEvent
};
},
_loadSuccess:function(absUrl,triggerData,settings,deferred){
var fileUrl=this._createFileUrl(absUrl),
dataUrl=this._createDataUrl(absUrl);
return $.proxy(function(html,textStatus,xhr){
var content,
pageElemRegex=new RegExp("(<[^>]+\\bdata-"+this._getNs()+"role=[\"']?page[\"']?[^>]*>)"),
dataUrlRegex=new RegExp("\\bdata-"+this._getNs()+"url=[\"']?([^\"'>]*)[\"']?");
if(pageElemRegex.test(html)&&
RegExp.$1&&
dataUrlRegex.test(RegExp.$1)&&
RegExp.$1){
fileUrl=$.mobile.path.getFilePath($("<div>"+RegExp.$1+"</div>").text());
}
if(settings.prefetch===undefined){
this._getBase().set(fileUrl);
}
content=this._parse(html,fileUrl);
this._setLoadedTitle(content,html);
triggerData.xhr=xhr;
triggerData.textStatus=textStatus;
triggerData.page=content;
triggerData.content=content;
if(!this._trigger("load",undefined,triggerData)){
return;
}
if(this._isRewritableBaseTag()&&content){
this._getBase().rewrite(fileUrl,content);
}
this._include(content,settings);
if(absUrl.indexOf("&"+$.mobile.subPageUrlKey)>-1){
content=this.element.children("[data-"+this._getNs()+"url='"+dataUrl+"']");
}
if(settings.showLoadMsg){
this._hideLoading();
}
this.element.trigger("pageload");
deferred.resolve(absUrl,settings,content);
},this);
},
_loadDefaults:{
type:"get",
data:undefined,
reloadPage:false,
reload:false,
role:undefined,
showLoadMsg:false,
loadMsgDelay:50
},
load:function(url,options){
var deferred=(options&&options.deferred)||$.Deferred(),
settings=$.extend({},this._loadDefaults,options),
content=null,
absUrl=$.mobile.path.makeUrlAbsolute(url,this._findBaseWithDefault()),
fileUrl,dataUrl,pblEvent,triggerData;
settings.reload=settings.reloadPage;
if(settings.data&&settings.type==="get"){
absUrl=$.mobile.path.addSearchParams(absUrl,settings.data);
settings.data=undefined;
}
if(settings.data&&settings.type==="post"){
settings.reload=true;
}
fileUrl=this._createFileUrl(absUrl);
dataUrl=this._createDataUrl(absUrl);
content=this._find(absUrl);
if(content.length===0&&
$.mobile.path.isEmbeddedPage(fileUrl)&&
!$.mobile.path.isFirstPageUrl(fileUrl)){
deferred.reject(absUrl,settings);
return;
}
this._getBase().reset();
if(content.length&&!settings.reload){
this._enhance(content,settings.role);
deferred.resolve(absUrl,settings,content);
if(!settings.prefetch){
this._getBase().set(url);
}
return;
}
triggerData={
url:url,
absUrl:absUrl,
dataUrl:dataUrl,
deferred:deferred,
options:settings
};
pblEvent=this._triggerWithDeprecated("beforeload",triggerData);
if(pblEvent.deprecatedEvent.isDefaultPrevented()||
pblEvent.event.isDefaultPrevented()){
return;
}
if(settings.showLoadMsg){
this._showLoading(settings.loadMsgDelay);
}
if(settings.prefetch===undefined){
this._getBase().reset();
}
if(!($.mobile.allowCrossDomainPages||
$.mobile.path.isSameDomain($.mobile.path.documentUrl,absUrl))){
deferred.reject(absUrl,settings);
return;
}
$.ajax({
url:fileUrl,
type:settings.type,
data:settings.data,
contentType:settings.contentType,
dataType:"html",
success:this._loadSuccess(absUrl,triggerData,settings,deferred),
error:this._loadError(absUrl,triggerData,settings,deferred)
});
},
_loadError:function(absUrl,triggerData,settings,deferred){
return $.proxy(function(xhr,textStatus,errorThrown){
this._getBase().set($.mobile.path.get());
triggerData.xhr=xhr;
triggerData.textStatus=textStatus;
triggerData.errorThrown=errorThrown;
var plfEvent=this._triggerWithDeprecated("loadfailed",triggerData);
if(plfEvent.deprecatedEvent.isDefaultPrevented()||
plfEvent.event.isDefaultPrevented()){
return;
}
if(settings.showLoadMsg){
this._showError();
}
deferred.reject(absUrl,settings);
},this);
},
_getTransitionHandler:function(transition){
transition=$.mobile._maybeDegradeTransition(transition);
return $.mobile.transitionHandlers[transition]||$.mobile.defaultTransitionHandler;
},
_triggerCssTransitionEvents:function(to,from,prefix){
var samePage=false;
prefix=prefix||"";
if(from){
if(to[0]===from[0]){
samePage=true;
}
this._triggerWithDeprecated(prefix+"hide",{nextPage:to,samePage:samePage},from);
}
this._triggerWithDeprecated(prefix+"show",{prevPage:from||$("")},to);
},
_cssTransition:function(to,from,options){
var transition=options.transition,
reverse=options.reverse,
deferred=options.deferred,
TransitionHandler,
promise;
this._triggerCssTransitionEvents(to,from,"before");
this._hideLoading();
TransitionHandler=this._getTransitionHandler(transition);
promise=(new TransitionHandler(transition,reverse,to,from)).transition();
promise.done(function(){
deferred.resolve.apply(deferred,arguments);
});
promise.done($.proxy(function(){
this._triggerCssTransitionEvents(to,from);
},this));
},
_releaseTransitionLock:function(){
isPageTransitioning=false;
if(pageTransitionQueue.length>0){
$.mobile.changePage.apply(null,pageTransitionQueue.pop());
}
},
_removeActiveLinkClass:function(force){
$.mobile.removeActiveLinkClass(force);
},
_loadUrl:function(to,triggerData,settings){
settings.target=to;
settings.deferred=$.Deferred();
this.load(to,settings);
settings.deferred.done($.proxy(function(url,options,content){
isPageTransitioning=false;
options.absUrl=triggerData.absUrl;
this.transition(content,triggerData,options);
},this));
settings.deferred.fail($.proxy(function(){
this._removeActiveLinkClass(true);
this._releaseTransitionLock();
this._triggerWithDeprecated("changefailed",triggerData);
},this));
},
_triggerPageBeforeChange:function(to,triggerData,settings){
var pbcEvent=new $.Event("pagebeforechange");
$.extend(triggerData,{toPage:to,options:settings});
if($.type(to)==="string"){
triggerData.absUrl=$.mobile.path.makeUrlAbsolute(to,this._findBaseWithDefault());
}else{
triggerData.absUrl=settings.absUrl;
}
this.element.trigger(pbcEvent,triggerData);
if(pbcEvent.isDefaultPrevented()){
return false;
}
return true;
},
change:function(to,options){
if(isPageTransitioning){
pageTransitionQueue.unshift(arguments);
return;
}
var settings=$.extend({},$.mobile.changePage.defaults,options),
triggerData={};
settings.fromPage=settings.fromPage||this.activePage;
if(!this._triggerPageBeforeChange(to,triggerData,settings)){
return;
}
to=triggerData.toPage;
if($.type(to)==="string"){
isPageTransitioning=true;
this._loadUrl(to,triggerData,settings);
}else{
this.transition(to,triggerData,settings);
}
},
transition:function(toPage,triggerData,settings){
var fromPage,url,pageUrl,fileUrl,
active,activeIsInitialPage,
historyDir,pageTitle,isDialog,
alreadyThere,newPageTitle,
params,cssTransitionDeferred,
beforeTransition;
if(isPageTransitioning){
pageTransitionQueue.unshift([toPage,settings]);
return;
}
if(!this._triggerPageBeforeChange(toPage,triggerData,settings)){
return;
}
beforeTransition=this._triggerWithDeprecated("beforetransition",triggerData);
if(beforeTransition.deprecatedEvent.isDefaultPrevented()||
beforeTransition.event.isDefaultPrevented()){
return;
}
isPageTransitioning=true;
if(toPage[0]===$.mobile.firstPage[0]&&!settings.dataUrl){
settings.dataUrl=$.mobile.path.documentUrl.hrefNoHash;
}
fromPage=settings.fromPage;
url=(settings.dataUrl&&$.mobile.path.convertUrlToDataUrl(settings.dataUrl))||
toPage.jqmData("url");
pageUrl=url;
fileUrl=$.mobile.path.getFilePath(url);
active=$.mobile.navigate.history.getActive();
activeIsInitialPage=$.mobile.navigate.history.activeIndex===0;
historyDir=0;
pageTitle=document.title;
isDialog=(settings.role==="dialog"||
toPage.jqmData("role")==="dialog")&&
toPage.jqmData("dialog")!==true;
if(fromPage&&fromPage[0]===toPage[0]&&
!settings.allowSamePageTransition){
isPageTransitioning=false;
this._triggerWithDeprecated("transition",triggerData);
this.element.trigger("pagechange",triggerData);
if(settings.fromHashChange){
$.mobile.navigate.history.direct({url:url});
}
return;
}
toPage.page({role:settings.role});
if(settings.fromHashChange){
historyDir=settings.direction==="back"?-1:1;
}
try{
if(document.activeElement&&
document.activeElement.nodeName.toLowerCase()!=="body"){
$(document.activeElement).blur();
}else{
$("input:focus, textarea:focus, select:focus").blur();
}
}catch(e){}
alreadyThere=false;
if(isDialog&&active){
if(active.url&&
active.url.indexOf($.mobile.dialogHashKey)>-1&&
this.activePage&&
!this.activePage.hasClass("ui-dialog")&&
$.mobile.navigate.history.activeIndex>0){
settings.changeHash=false;
alreadyThere=true;
}
url=(active.url||"");
if(!alreadyThere&&url.indexOf("#")>-1){
url+=$.mobile.dialogHashKey;
}else{
url+="#"+$.mobile.dialogHashKey;
}
if($.mobile.navigate.history.activeIndex===0&&url===$.mobile.navigate.history.initialDst){
url+=$.mobile.dialogHashKey;
}
}
newPageTitle=(!active)?pageTitle:toPage.jqmData("title")||
toPage.children(":jqmData(role='header')").find(".ui-title").text();
if(!!newPageTitle&&pageTitle===document.title){
pageTitle=newPageTitle;
}
if(!toPage.jqmData("title")){
toPage.jqmData("title",pageTitle);
}
settings.transition=settings.transition||
((historyDir&&!activeIsInitialPage)?active.transition:undefined)||
(isDialog?$.mobile.defaultDialogTransition:$.mobile.defaultPageTransition);
if(!historyDir&&alreadyThere){
$.mobile.navigate.history.getActive().pageUrl=pageUrl;
}
if(url&&!settings.fromHashChange){
if(!$.mobile.path.isPath(url)&&url.indexOf("#")<0){
url="#"+url;
}
params={
transition:settings.transition,
title:pageTitle,
pageUrl:pageUrl,
role:settings.role
};
if(settings.changeHash!==false&&$.mobile.hashListeningEnabled){
$.mobile.navigate(url,params,true);
}else if(toPage[0]!==$.mobile.firstPage[0]){
$.mobile.navigate.history.add(url,params);
}
}
document.title=pageTitle;
$.mobile.activePage=toPage;
this.activePage=toPage;
settings.reverse=settings.reverse||historyDir<0;
cssTransitionDeferred=$.Deferred();
this._cssTransition(toPage,fromPage,{
transition:settings.transition,
reverse:settings.reverse,
deferred:cssTransitionDeferred
});
cssTransitionDeferred.done($.proxy(function(name,reverse,$to,$from,alreadyFocused){
$.mobile.removeActiveLinkClass();
if(settings.duplicateCachedPage){
settings.duplicateCachedPage.remove();
}
if(!alreadyFocused){
$.mobile.focusPage(toPage);
}
this._releaseTransitionLock();
this.element.trigger("pagechange",triggerData);
this._triggerWithDeprecated("transition",triggerData);
},this));
},
_findBaseWithDefault:function(){
var closestBase=(this.activePage&&
$.mobile.getClosestBaseUrl(this.activePage));
return closestBase||$.mobile.path.documentBase.hrefNoHash;
}
});
$.mobile.navreadyDeferred=$.Deferred();
var pageTransitionQueue=[],
isPageTransitioning=false;
})(jQuery);
(function($,undefined){
var domreadyDeferred=$.Deferred(),
loadDeferred=$.Deferred(),
documentUrl=$.mobile.path.documentUrl,
$lastVClicked=null;

function findClosestLink(ele){
while(ele){
if((typeof ele.nodeName==="string")&&ele.nodeName.toLowerCase()==="a"){
break;
}
ele=ele.parentNode;
}
return ele;
}
$.mobile.loadPage=function(url,opts){
var container;
opts=opts||{};
container=(opts.pageContainer||$.mobile.pageContainer);
opts.deferred=$.Deferred();
container.pagecontainer("load",url,opts);
return opts.deferred.promise();
};

$.mobile.back=function(){
var nav=window.navigator;
if(this.phonegapNavigationEnabled&&
nav&&
nav.app&&
nav.app.backHistory){
nav.app.backHistory();
}else{
$.mobile.pageContainer.pagecontainer("back");
}
};
$.mobile.focusPage=function(page){
var autofocus=page.find("[autofocus]"),
pageTitle=page.find(".ui-title:eq(0)");
if(autofocus.length){
autofocus.focus();
return;
}
if(pageTitle.length){
pageTitle.focus();
}else{
page.focus();
}
};
$.mobile._maybeDegradeTransition=$.mobile._maybeDegradeTransition||function(transition){
return transition;
};
$.mobile.changePage=function(to,options){
$.mobile.pageContainer.pagecontainer("change",to,options);
};
$.mobile.changePage.defaults={
transition:undefined,
reverse:false,
changeHash:true,
fromHashChange:false,
role:undefined,duplicateCachedPage:undefined,
pageContainer:undefined,
showLoadMsg:true,dataUrl:undefined,
fromPage:undefined,
allowSamePageTransition:false
};
$.mobile._registerInternalEvents=function(){
var getAjaxFormData=function($form,calculateOnly){
var url,ret=true,formData,vclickedName,method;
if(!$.mobile.ajaxEnabled||
$form.is(":jqmData(ajax='false')")||
!$form.jqmHijackable().length||
$form.attr("target")){
return false;
}
url=($lastVClicked&&$lastVClicked.attr("formaction"))||
$form.attr("action");
method=($form.attr("method")||"get").toLowerCase();
if(!url){
url=$.mobile.getClosestBaseUrl($form);
if(method==="get"){
url=$.mobile.path.parseUrl(url).hrefNoSearch;
}
if(url===$.mobile.path.documentBase.hrefNoHash){
url=documentUrl.hrefNoSearch;
}
}
url=$.mobile.path.makeUrlAbsolute(url,$.mobile.getClosestBaseUrl($form));
if(($.mobile.path.isExternal(url)&&!$.mobile.path.isPermittedCrossDomainRequest(documentUrl,url))){
return false;
}
if(!calculateOnly){
formData=$form.serializeArray();
if($lastVClicked&&$lastVClicked[0].form===$form[0]){
vclickedName=$lastVClicked.attr("name");
if(vclickedName){
$.each(formData,function(key,value){
if(value.name===vclickedName){
vclickedName="";
return false;
}
});
if(vclickedName){
formData.push({name:vclickedName,value:$lastVClicked.attr("value")});
}
}
}
ret={
url:url,
options:{
type:method,
data:$.param(formData),
transition:$form.jqmData("transition"),
reverse:$form.jqmData("direction")==="reverse",
reloadPage:true
}
};
}
return ret;
};
$.mobile.document.delegate("form","submit",function(event){
var formData;
if(!event.isDefaultPrevented()){
formData=getAjaxFormData($(this));
if(formData){
$.mobile.changePage(formData.url,formData.options);
event.preventDefault();
}
}
});
$.mobile.document.bind("vclick",function(event){
var $btn,btnEls,target=event.target,needClosest=false;
if(event.which>1||!$.mobile.linkBindingEnabled){
return;
}
$lastVClicked=$(target);
if($.data(target,"mobile-button")){
if(!getAjaxFormData($(target).closest("form"),true)){
return;
}
if(target.parentNode){
target=target.parentNode;
}
}else{
target=findClosestLink(target);
if(!(target&&$.mobile.path.parseUrl(target.getAttribute("href")||"#").hash!=="#")){
return;
}
if(!$(target).jqmHijackable().length){
return;
}
}
if(!!~target.className.indexOf("ui-link-inherit")){
if(target.parentNode){
btnEls=$.data(target.parentNode,"buttonElements");
}
}else{
btnEls=$.data(target,"buttonElements");
}
if(btnEls){
target=btnEls.outer;
}else{
needClosest=true;
}
$btn=$(target);
if(needClosest){
$btn=$btn.closest(".ui-btn");
}
if($btn.length>0&&
!($btn.hasClass("ui-state-disabled"||
$btn.hasClass("ui-disabled")))){
$.mobile.removeActiveLinkClass(true);
$.mobile.activeClickedLink=$btn;
$.mobile.activeClickedLink.addClass($.mobile.activeBtnClass);
}
});
$.mobile.document.bind("click",function(event){
if(!$.mobile.linkBindingEnabled||event.isDefaultPrevented()){
return;
}
var link=findClosestLink(event.target),
$link=$(link),
httpCleanup=function(){
window.setTimeout(function(){$.mobile.removeActiveLinkClass(true)},200);
},
baseUrl,href,
useDefaultUrlHandling,isExternal,
transition,reverse,role;
if($.mobile.activeClickedLink&&
$.mobile.activeClickedLink[0]===event.target.parentNode){
httpCleanup();
}
if(!link||event.which>1||!$link.jqmHijackable().length){
return;
}
if($link.is(":jqmData(rel='back')")){
$.mobile.back();
return false;
}
baseUrl=$.mobile.getClosestBaseUrl($link);
href=$.mobile.path.makeUrlAbsolute($link.attr("href")||"#",baseUrl);
if(!$.mobile.ajaxEnabled&&!$.mobile.path.isEmbeddedPage(href)){
httpCleanup();
return;
}
if(href.search("#")!==-1){
href=href.replace(/[^#]*#/,"");
if(!href){
event.preventDefault();
return;
}else if($.mobile.path.isPath(href)){
href=$.mobile.path.makeUrlAbsolute(href,baseUrl);
}else{
href=$.mobile.path.makeUrlAbsolute("#"+href,documentUrl.hrefNoHash);
}
}
useDefaultUrlHandling=$link.is("[rel='external']")||$link.is(":jqmData(ajax='false')")||$link.is("[target]");
isExternal=useDefaultUrlHandling||($.mobile.path.isExternal(href)&&!$.mobile.path.isPermittedCrossDomainRequest(documentUrl,href));
if(isExternal){
httpCleanup();
return;
}
transition=$link.jqmData("transition");
reverse=$link.jqmData("direction")==="reverse"||
$link.jqmData("back");
role=$link.attr("data-"+$.mobile.ns+"rel")||undefined;
$.mobile.changePage(href,{transition:transition,reverse:reverse,role:role,link:$link});
event.preventDefault();
});
$.mobile.document.delegate(".ui-page","pageshow.prefetch",function(){
var urls=[];
$(this).find("a:jqmData(prefetch)").each(function(){
var $link=$(this),
url=$link.attr("href");
if(url&&$.inArray(url,urls)===-1){
urls.push(url);
$.mobile.loadPage(url,{role:$link.attr("data-"+$.mobile.ns+"rel"),prefetch:true});
}
});
});
$.mobile.pageContainer.pagecontainer();
$.mobile.document.bind("pageshow",function(){
if(loadDeferred){
loadDeferred.done($.mobile.resetActivePageHeight);
}else{
$.mobile.resetActivePageHeight();
}
});
$.mobile.window.bind("throttledresize",$.mobile.resetActivePageHeight);
};$(function(){domreadyDeferred.resolve()});
$.mobile.window.load(function(){
loadDeferred.resolve();
loadDeferred=null;
});
$.when(domreadyDeferred,$.mobile.navreadyDeferred).done(function(){$.mobile._registerInternalEvents()});
})(jQuery);
(function($,window,undefined){
$.mobile.Transition=function(){
this.init.apply(this,arguments);
};
$.extend($.mobile.Transition.prototype,{
toPreClass:" ui-page-pre-in",
init:function(name,reverse,$to,$from){
$.extend(this,{
name:name,
reverse:reverse,
$to:$to,
$from:$from,
deferred:new $.Deferred()
});
},
cleanFrom:function(){
this.$from
.removeClass($.mobile.activePageClass+" out in reverse "+this.name)
.height("");
},
beforeDoneIn:function(){},
beforeDoneOut:function(){},
beforeStartOut:function(){},
doneIn:function(){
this.beforeDoneIn();
this.$to.removeClass("out in reverse "+this.name).height("");
this.toggleViewportClass();
if($.mobile.window.scrollTop()!==this.toScroll){
this.scrollPage();
}
if(!this.sequential){
this.$to.addClass($.mobile.activePageClass);
}
this.deferred.resolve(this.name,this.reverse,this.$to,this.$from,true);
},
doneOut:function(screenHeight,reverseClass,none,preventFocus){
this.beforeDoneOut();
this.startIn(screenHeight,reverseClass,none,preventFocus);
},
hideIn:function(callback){
this.$to.css("z-index",-10);
callback.call(this);
this.$to.css("z-index","");
},
scrollPage:function(){
$.event.special.scrollstart.enabled=false;
if($.mobile.hideUrlBar||this.toScroll!==$.mobile.defaultHomeScroll){
window.scrollTo(0,this.toScroll);
}
setTimeout(function(){
$.event.special.scrollstart.enabled=true;
},150);
},
startIn:function(screenHeight,reverseClass,none,preventFocus){
this.hideIn(function(){
this.$to.addClass($.mobile.activePageClass+this.toPreClass);
if(!preventFocus){
$.mobile.focusPage(this.$to);
}
this.$to.height(screenHeight+this.toScroll);
if(!none){
this.scrollPage();
}
});
this.$to
.removeClass(this.toPreClass)
.addClass(this.name+" in "+reverseClass);
if(!none){
this.$to.animationComplete($.proxy(function(){
this.doneIn();
},this));
}else{
this.doneIn();
}
},
startOut:function(screenHeight,reverseClass,none){
this.beforeStartOut(screenHeight,reverseClass,none);
this.$from
.height(screenHeight+$.mobile.window.scrollTop())
.addClass(this.name+" out"+reverseClass);
},
toggleViewportClass:function(){
$.mobile.pageContainer.toggleClass("ui-mobile-viewport-transitioning viewport-"+this.name);
},
transition:function(){
var none,
reverseClass=this.reverse?" reverse":"",
screenHeight=$.mobile.getScreenHeight(),
maxTransitionOverride=$.mobile.maxTransitionWidth!==false&&
$.mobile.window.width()>$.mobile.maxTransitionWidth;
this.toScroll=$.mobile.navigate.history.getActive().lastScroll||$.mobile.defaultHomeScroll;
none=!$.support.cssTransitions||!$.support.cssAnimations||
maxTransitionOverride||!this.name||this.name==="none"||
Math.max($.mobile.window.scrollTop(),this.toScroll)>
$.mobile.getMaxScrollForTransition();
this.toggleViewportClass();
if(this.$from&&!none){
this.startOut(screenHeight,reverseClass,none);
}else{
this.doneOut(screenHeight,reverseClass,none,true);
}
return this.deferred.promise();
}
});
})(jQuery,this);
(function($){
$.mobile.SerialTransition=function(){
this.init.apply(this,arguments);
};
$.extend($.mobile.SerialTransition.prototype,$.mobile.Transition.prototype,{
sequential:true,
beforeDoneOut:function(){
if(this.$from){
this.cleanFrom();
}
},
beforeStartOut:function(screenHeight,reverseClass,none){
this.$from.animationComplete($.proxy(function(){
this.doneOut(screenHeight,reverseClass,none);
},this));
}
});
})(jQuery);
(function($){
$.mobile.ConcurrentTransition=function(){
this.init.apply(this,arguments);
};
$.extend($.mobile.ConcurrentTransition.prototype,$.mobile.Transition.prototype,{
sequential:false,
beforeDoneIn:function(){
if(this.$from){
this.cleanFrom();
}
},
beforeStartOut:function(screenHeight,reverseClass,none){
this.doneOut(screenHeight,reverseClass,none);
}
});
})(jQuery);
(function($){
var defaultGetMaxScrollForTransition=function(){
return $.mobile.getScreenHeight()*3;
};
$.mobile.transitionHandlers={
"sequential":$.mobile.SerialTransition,
"simultaneous":$.mobile.ConcurrentTransition
};
$.mobile.defaultTransitionHandler=$.mobile.transitionHandlers.sequential;
$.mobile.transitionFallbacks={};
$.mobile._maybeDegradeTransition=function(transition){
if(transition&&!$.support.cssTransform3d&&$.mobile.transitionFallbacks[transition]){
transition=$.mobile.transitionFallbacks[transition];
}
return transition;
};
$.mobile.getMaxScrollForTransition=$.mobile.getMaxScrollForTransition||defaultGetMaxScrollForTransition;
})(jQuery);

(function($,window,undefined){
$.mobile.transitionFallbacks.flip="fade";
})(jQuery,this);

(function($,window,undefined){
$.mobile.transitionFallbacks.flow="fade";
})(jQuery,this);

(function($,window,undefined){
$.mobile.transitionFallbacks.pop="fade";
})(jQuery,this);

(function($,window,undefined){
$.mobile.transitionHandlers.slide=$.mobile.transitionHandlers.simultaneous;
$.mobile.transitionFallbacks.slide="fade";
})(jQuery,this);

(function($,window,undefined){
$.mobile.transitionFallbacks.slidedown="fade";
})(jQuery,this);

(function($,window,undefined){
$.mobile.transitionFallbacks.slidefade="fade";
})(jQuery,this);

(function($,window,undefined){
$.mobile.transitionFallbacks.slideup="fade";
})(jQuery,this);

(function($,window,undefined){
$.mobile.transitionFallbacks.turn="fade";
})(jQuery,this);
(function($,undefined){
$.mobile.degradeInputs={
color:false,
date:false,
datetime:false,
"datetime-local":false,
email:false,
month:false,
number:false,
range:"number",
search:"text",
tel:false,
time:false,
url:false,
week:false
};
$.mobile.page.prototype.options.degradeInputs=$.mobile.degradeInputs;
$.mobile.degradeInputsWithin=function(target){
target=$(target);
target.find("input").not($.mobile.page.prototype.keepNativeSelector()).each(function(){
var element=$(this),
type=this.getAttribute("type"),
optType=$.mobile.degradeInputs[type]||"text",
html,hasType,findstr,repstr;
if($.mobile.degradeInputs[type]){
html=$("<div>").html(element.clone()).html();
hasType=html.indexOf(" type=")>-1;
findstr=hasType?/\s+type=["']?\w+['"]?/:/\/?>/;
repstr=" type=\""+optType+"\" data-"+$.mobile.ns+"type=\""+type+"\""+(hasType?"":">");
element.replaceWith(html.replace(findstr,repstr));
}
});
};
})(jQuery);
(function($,window,undefined){
$.widget("mobile.page",$.mobile.page,{
options:{
closeBtn:"left",
closeBtnText:"Close",
overlayTheme:"a",
corners:true,
dialog:false
},
_create:function(){
this._super();
if(this.options.dialog){
$.extend(this,{
_inner:this.element.children(),
_headerCloseButton:null
});
if(!this.options.enhanced){
this._setCloseBtn(this.options.closeBtn);
}
}
},
_enhance:function(){
this._super();
if(this.options.dialog){
this.element.addClass("ui-dialog")
.wrapInner($("<div/>",{
"role":"dialog",
"class":"ui-dialog-contain ui-overlay-shadow"+
(this.options.corners?" ui-corner-all":"")
}));
}
},
_setOptions:function(options){
var closeButtonLocation,closeButtonText,
currentOpts=this.options;
if(options.corners!==undefined){
this._inner.toggleClass("ui-corner-all",!!options.corners);
}
if(options.overlayTheme!==undefined){
if($.mobile.activePage[0]===this.element[0]){
currentOpts.overlayTheme=options.overlayTheme;
this._handlePageBeforeShow();
}
}
if(options.closeBtnText!==undefined){
closeButtonLocation=currentOpts.closeBtn;
closeButtonText=options.closeBtnText;
}
if(options.closeBtn!==undefined){
closeButtonLocation=options.closeBtn;
}
if(closeButtonLocation){
this._setCloseBtn(closeButtonLocation,closeButtonText);
}
this._super(options);
},
_handlePageBeforeShow:function(){
if(this.options.overlayTheme&&this.options.dialog){
this.removeContainerBackground();
this.setContainerBackground(this.options.overlayTheme);
}else{
this._super();
}
},
_setCloseBtn:function(location,text){
var dst,
btn=this._headerCloseButton;
location="left"===location?"left":"right"===location?"right":"none";
if("none"===location){
if(btn){
btn.remove();
btn=null;
}
}else if(btn){
btn.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+location);
if(text){
btn.text(text);
}
}else{
dst=this._inner.find(":jqmData(role='header')").first();
btn=$("<a></a>",{
"href":"#",
"class":"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+location
})
.attr("data-"+$.mobile.ns+"rel","back")
.text(text||this.options.closeBtnText||"")
.prependTo(dst);
}
this._headerCloseButton=btn;
}
});
})(jQuery,this);
(function($,window,undefined){
$.widget("mobile.dialog",{
options:{
closeBtn:"left",
closeBtnText:"Close",
overlayTheme:"a",
corners:true
},
_handlePageBeforeShow:function(){
this._isCloseable=true;
if(this.options.overlayTheme){
this.element
.page("removeContainerBackground")
.page("setContainerBackground",this.options.overlayTheme);
}
},
_handlePageBeforeHide:function(){
this._isCloseable=false;
},
_handleVClickSubmit:function(event){
var attrs,
$target=$(event.target).closest(event.type==="vclick"?"a":"form");
if($target.length&&!$target.jqmData("transition")){
attrs={};
attrs["data-"+$.mobile.ns+"transition"]=
($.mobile.navigate.history.getActive()||{})["transition"]||
$.mobile.defaultDialogTransition;
attrs["data-"+$.mobile.ns+"direction"]="reverse";
$target.attr(attrs);
}
},
_create:function(){
var elem=this.element,
opts=this.options;
elem.addClass("ui-dialog")
.wrapInner($("<div/>",{
"role":"dialog",
"class":"ui-dialog-contain ui-overlay-shadow"+
(!!opts.corners?" ui-corner-all":"")
}));
$.extend(this,{
_isCloseable:false,
_inner:elem.children(),
_headerCloseButton:null
});
this._on(elem,{
vclick:"_handleVClickSubmit",
submit:"_handleVClickSubmit",
pagebeforeshow:"_handlePageBeforeShow",
pagebeforehide:"_handlePageBeforeHide"
});
this._setCloseBtn(opts.closeBtn);
},
_setOptions:function(options){
var closeButtonLocation,closeButtonText,
currentOpts=this.options;
if(options.corners!==undefined){
this._inner.toggleClass("ui-corner-all",!!options.corners);
}
if(options.overlayTheme!==undefined){
if($.mobile.activePage[0]===this.element[0]){
currentOpts.overlayTheme=options.overlayTheme;
this._handlePageBeforeShow();
}
}
if(options.closeBtnText!==undefined){
closeButtonLocation=currentOpts.closeBtn;
closeButtonText=options.closeBtnText;
}
if(options.closeBtn!==undefined){
closeButtonLocation=options.closeBtn;
}
if(closeButtonLocation){
this._setCloseBtn(closeButtonLocation,closeButtonText);
}
this._super(options);
},
_setCloseBtn:function(location,text){
var dst,
btn=this._headerCloseButton;
location="left"===location?"left":"right"===location?"right":"none";
if("none"===location){
if(btn){
btn.remove();
btn=null;
}
}else if(btn){
btn.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+location);
if(text){
btn.text(text);
}
}else{
dst=this._inner.find(":jqmData(role='header')").first();
btn=$("<a></a>",{
"role":"button",
"href":"#",
"class":"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+location
})
.text(text||this.options.closeBtnText||"")
.prependTo(dst);
this._on(btn,{click:"close"});
}
this._headerCloseButton=btn;
},
close:function(){
var hist=$.mobile.navigate.history;
if(this._isCloseable){
this._isCloseable=false;
if($.mobile.hashListeningEnabled&&hist.activeIndex>0){
$.mobile.back();
}else{
$.mobile.pageContainer.pagecontainer("back");
}
}
}
});
})(jQuery,this);
(function($,undefined){
var rInitialLetter=/([A-Z])/g,
iconposClass=function(iconpos){
return("ui-btn-icon-"+(iconpos===null?"left":iconpos));
};
$.widget("mobile.collapsible",{
options:{
enhanced:false,
expandCueText:null,
collapseCueText:null,
collapsed:true,
heading:"h1,h2,h3,h4,h5,h6,legend",
collapsedIcon:null,
expandedIcon:null,
iconpos:null,
theme:null,
contentTheme:null,
inset:null,
corners:null,
mini:null
},
_create:function(){
var elem=this.element,
ui={
accordion:elem
.closest(":jqmData(role='collapsible-set'),"+
":jqmData(role='collapsibleset')"+
($.mobile.collapsibleset?", :mobile-collapsibleset":
""))
.addClass("ui-collapsible-set")
};
this._ui=ui;
this._renderedOptions=this._getOptions(this.options);
if(this.options.enhanced){
ui.heading=$(".ui-collapsible-heading",this.element[0]);
ui.content=ui.heading.next();
ui.anchor=$("a",ui.heading[0]).first();
ui.status=ui.anchor.children(".ui-collapsible-heading-status");
}else{
this._enhance(elem,ui);
}
this._on(ui.heading,{
"tap":function(){
ui.heading.find("a").first().addClass($.mobile.activeBtnClass);
},
"click":function(event){
this._handleExpandCollapse(!ui.heading.hasClass("ui-collapsible-heading-collapsed"));
event.preventDefault();
event.stopPropagation();
}
});
},
_getOptions:function(options){
var key,
accordion=this._ui.accordion,
accordionWidget=this._ui.accordionWidget;
options=$.extend({},options);
if(accordion.length&&!accordionWidget){
this._ui.accordionWidget=
accordionWidget=accordion.data("mobile-collapsibleset");
}
for(key in options){
options[key]=
(options[key]!=null)?options[key]:
(accordionWidget)?accordionWidget.options[key]:
accordion.length?$.mobile.getAttribute(accordion[0],
key.replace(rInitialLetter,"-$1").toLowerCase()):
null;
if(null==options[key]){
options[key]=$.mobile.collapsible.defaults[key];
}
}
return options;
},
_themeClassFromOption:function(prefix,value){
return(value?(value==="none"?"":prefix+value):"");
},
_enhance:function(elem,ui){
var iconclass,
opts=this._renderedOptions,
contentThemeClass=this._themeClassFromOption("ui-body-",opts.contentTheme);
elem.addClass("ui-collapsible "+
(opts.inset?"ui-collapsible-inset ":"")+
(opts.inset&&opts.corners?"ui-corner-all ":"")+
(contentThemeClass?"ui-collapsible-themed-content ":""));
ui.originalHeading=elem.children(this.options.heading).first(),
ui.content=elem
.wrapInner("<div "+
"class='ui-collapsible-content "+
contentThemeClass+"'></div>")
.children(".ui-collapsible-content"),
ui.heading=ui.originalHeading;
if(ui.heading.is("legend")){
ui.heading=$("<div role='heading'>"+ui.heading.html()+"</div>");
ui.placeholder=$("<div><!-- placeholder for legend --></div>").insertBefore(ui.originalHeading);
ui.originalHeading.remove();
}
iconclass=(opts.collapsed?(opts.collapsedIcon?"ui-icon-"+opts.collapsedIcon:""):
(opts.expandedIcon?"ui-icon-"+opts.expandedIcon:""));
ui.status=$("<span class='ui-collapsible-heading-status'></span>");
ui.anchor=ui.heading
.detach()
.addClass("ui-collapsible-heading")
.append(ui.status)
.wrapInner("<a href='#' class='ui-collapsible-heading-toggle'></a>")
.find("a")
.first()
.addClass("ui-btn "+
(iconclass?iconclass+" ":"")+
(iconclass?iconposClass(opts.iconpos)+
" ":"")+
this._themeClassFromOption("ui-btn-",opts.theme)+" "+
(opts.mini?"ui-mini ":""));
ui.heading.insertBefore(ui.content);
this._handleExpandCollapse(this.options.collapsed);
return ui;
},
refresh:function(){
this._applyOptions(this.options);
this._renderedOptions=this._getOptions(this.options);
},
_applyOptions:function(options){
var isCollapsed,newTheme,oldTheme,hasCorners,hasIcon,
elem=this.element,
currentOpts=this._renderedOptions,
ui=this._ui,
anchor=ui.anchor,
status=ui.status,
opts=this._getOptions(options);
if(options.collapsed!==undefined){
this._handleExpandCollapse(options.collapsed);
}
isCollapsed=elem.hasClass("ui-collapsible-collapsed");
if(isCollapsed){
if(opts.expandCueText!==undefined){
status.text(opts.expandCueText);
}
}else{
if(opts.collapseCueText!==undefined){
status.text(opts.collapseCueText);
}
}
hasIcon=
(opts.collapsedIcon!==undefined?opts.collapsedIcon!==false:
currentOpts.collapsedIcon!==false);
if(!(opts.iconpos===undefined&&
opts.collapsedIcon===undefined&&
opts.expandedIcon===undefined)){
anchor.removeClass([iconposClass(currentOpts.iconpos)]
.concat((currentOpts.expandedIcon?
["ui-icon-"+currentOpts.expandedIcon]:[]))
.concat((currentOpts.collapsedIcon?
["ui-icon-"+currentOpts.collapsedIcon]:[]))
.join(" "));
if(hasIcon){
anchor.addClass(
[iconposClass(opts.iconpos!==undefined?
opts.iconpos:currentOpts.iconpos)]
.concat(isCollapsed?
["ui-icon-"+(opts.collapsedIcon!==undefined?
opts.collapsedIcon:
currentOpts.collapsedIcon)]:
["ui-icon-"+(opts.expandedIcon!==undefined?
opts.expandedIcon:
currentOpts.expandedIcon)])
.join(" "));
}
}
if(opts.theme!==undefined){
oldTheme=this._themeClassFromOption("ui-btn-",currentOpts.theme);
newTheme=this._themeClassFromOption("ui-btn-",opts.theme);
anchor.removeClass(oldTheme).addClass(newTheme);
}
if(opts.contentTheme!==undefined){
oldTheme=this._themeClassFromOption("ui-body-",
currentOpts.contentTheme);
newTheme=this._themeClassFromOption("ui-body-",
opts.contentTheme);
ui.content.removeClass(oldTheme).addClass(newTheme);
}
if(opts.inset!==undefined){
elem.toggleClass("ui-collapsible-inset",opts.inset);
hasCorners=!!(opts.inset&&(opts.corners||currentOpts.corners));
}
if(opts.corners!==undefined){
hasCorners=!!(opts.corners&&(opts.inset||currentOpts.inset));
}
if(hasCorners!==undefined){
elem.toggleClass("ui-corner-all",hasCorners);
}
if(opts.mini!==undefined){
anchor.toggleClass("ui-mini",opts.mini);
}
},
_setOptions:function(options){
this._applyOptions(options);
this._super(options);
this._renderedOptions=this._getOptions(this.options);
},
_handleExpandCollapse:function(isCollapse){
var opts=this._renderedOptions,
ui=this._ui;
ui.status.text(isCollapse?opts.expandCueText:opts.collapseCueText);
ui.heading
.toggleClass("ui-collapsible-heading-collapsed",isCollapse)
.find("a").first()
.toggleClass("ui-icon-"+opts.expandedIcon,!isCollapse)
.toggleClass("ui-icon-"+opts.collapsedIcon,(isCollapse||opts.expandedIcon===opts.collapsedIcon))
.removeClass($.mobile.activeBtnClass);
this.element.toggleClass("ui-collapsible-collapsed",isCollapse);
ui.content
.toggleClass("ui-collapsible-content-collapsed",isCollapse)
.attr("aria-hidden",isCollapse)
.trigger("updatelayout");
this.options.collapsed=isCollapse;
this._trigger(isCollapse?"collapse":"expand");
},
expand:function(){
this._handleExpandCollapse(false);
},
collapse:function(){
this._handleExpandCollapse(true);
},
_destroy:function(){
var ui=this._ui,
opts=this.options;
if(opts.enhanced){
return;
}
if(ui.placeholder){
ui.originalHeading.insertBefore(ui.placeholder);
ui.placeholder.remove();
ui.heading.remove();
}else{
ui.status.remove();
ui.heading
.removeClass("ui-collapsible-heading ui-collapsible-heading-collapsed")
.children()
.contents()
.unwrap();
}
ui.anchor.contents().unwrap();
ui.content.contents().unwrap();
this.element
.removeClass("ui-collapsible ui-collapsible-collapsed "+
"ui-collapsible-themed-content ui-collapsible-inset ui-corner-all");
}
});
$.mobile.collapsible.defaults={
expandCueText:" click to expand contents",
collapseCueText:" click to collapse contents",
collapsedIcon:"plus",
contentTheme:"inherit",
expandedIcon:"minus",
iconpos:"left",
inset:true,
corners:true,
theme:"inherit",
mini:false
};
})(jQuery);
(function($,undefined){
$.mobile.behaviors.addFirstLastClasses={
_getVisibles:function($els,create){
var visibles;
if(create){
visibles=$els.not(".ui-screen-hidden");
}else{
visibles=$els.filter(":visible");
if(visibles.length===0){
visibles=$els.not(".ui-screen-hidden");
}
}
return visibles;
},
_addFirstLastClasses:function($els,$visibles,create){
$els.removeClass("ui-first-child ui-last-child");
$visibles.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child");
if(!create){
this.element.trigger("updatelayout");
}
},
_removeFirstLastClasses:function($els){
$els.removeClass("ui-first-child ui-last-child");
}
};
})(jQuery);
(function($,undefined){
var childCollapsiblesSelector=":mobile-collapsible, "+$.mobile.collapsible.initSelector;
$.widget("mobile.collapsibleset",$.extend({
initSelector:":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')",
options:$.extend({
enhanced:false
},$.mobile.collapsible.defaults),
_handleCollapsibleExpand:function(event){
var closestCollapsible=$(event.target).closest(".ui-collapsible");
if(closestCollapsible.parent().is(":mobile-collapsibleset, :jqmData(role='collapsible-set')")){
closestCollapsible
.siblings(".ui-collapsible:not(.ui-collapsible-collapsed)")
.collapsible("collapse");
}
},
_create:function(){
var elem=this.element,
opts=this.options;
$.extend(this,{
_classes:""
});
if(!opts.enhanced){
elem.addClass("ui-collapsible-set "+
this._themeClassFromOption("ui-group-theme-",opts.theme)+" "+
(opts.corners&&opts.inset?"ui-corner-all ":""));
this.element.find($.mobile.collapsible.initSelector).collapsible();
}
this._on(elem,{collapsibleexpand:"_handleCollapsibleExpand"});
},
_themeClassFromOption:function(prefix,value){
return(value?(value==="none"?"":prefix+value):"");
},
_init:function(){
this._refresh(true);
this.element
.children(childCollapsiblesSelector)
.filter(":jqmData(collapsed='false')")
.collapsible("expand");
},
_setOptions:function(options){
var ret,hasCorners,
elem=this.element,
themeClass=this._themeClassFromOption("ui-group-theme-",options.theme);
if(themeClass){
elem
.removeClass(this._themeClassFromOption("ui-group-theme-",this.options.theme))
.addClass(themeClass);
}
if(options.inset!==undefined){
hasCorners=!!(options.inset&&(options.corners||this.options.corners));
}
if(options.corners!==undefined){
hasCorners=!!(options.corners&&(options.inset||this.options.inset));
}
if(hasCorners!==undefined){
elem.toggleClass("ui-corner-all",hasCorners);
}
ret=this._super(options);
this.element.children(":mobile-collapsible").collapsible("refresh");
return ret;
},
_destroy:function(){
var el=this.element;
this._removeFirstLastClasses(el.children(childCollapsiblesSelector));
el
.removeClass("ui-collapsible-set ui-corner-all "+
this._themeClassFromOption("ui-group-theme-",this.options.theme))
.children(":mobile-collapsible")
.collapsible("destroy");
},
_refresh:function(create){
var collapsiblesInSet=this.element.children(childCollapsiblesSelector);
this.element.find($.mobile.collapsible.initSelector).not(".ui-collapsible").collapsible();
this._addFirstLastClasses(collapsiblesInSet,this._getVisibles(collapsiblesInSet,create),create);
},
refresh:function(){
this._refresh(false);
}
},$.mobile.behaviors.addFirstLastClasses));
})(jQuery);
(function($,undefined){
$.fn.fieldcontain=function(){
return this.addClass("ui-field-contain");
};
})(jQuery);
(function($,undefined){
$.fn.grid=function(options){
return this.each(function(){
var $this=$(this),
o=$.extend({
grid:null
},options),
$kids=$this.children(),
gridCols={solo:1,a:2,b:3,c:4,d:5},
grid=o.grid,
iterator,
letter;
if(!grid){
if($kids.length<=5){
for(letter in gridCols){
if(gridCols[letter]===$kids.length){
grid=letter;
}
}
}else{
grid="a";
$this.addClass("ui-grid-duo");
}
}
iterator=gridCols[grid];
$this.addClass("ui-grid-"+grid);
$kids.filter(":nth-child("+iterator+"n+1)").addClass("ui-block-a");
if(iterator>1){
$kids.filter(":nth-child("+iterator+"n+2)").addClass("ui-block-b");
}
if(iterator>2){
$kids.filter(":nth-child("+iterator+"n+3)").addClass("ui-block-c");
}
if(iterator>3){
$kids.filter(":nth-child("+iterator+"n+4)").addClass("ui-block-d");
}
if(iterator>4){
$kids.filter(":nth-child("+iterator+"n+5)").addClass("ui-block-e");
}
});
};
})(jQuery);
(function($,undefined){
$.widget("mobile.navbar",{
options:{
iconpos:"top",
grid:null
},
_create:function(){
var $navbar=this.element,
$navbtns=$navbar.find("a"),
iconpos=$navbtns.filter(":jqmData(icon)").length?this.options.iconpos:undefined;
$navbar.addClass("ui-navbar")
.attr("role","navigation")
.find("ul")
.jqmEnhanceable()
.grid({grid:this.options.grid});
$navbtns
.each(function(){
var icon=$.mobile.getAttribute(this,"icon"),
theme=$.mobile.getAttribute(this,"theme"),
classes="ui-btn";
if(theme){
classes+=" ui-btn-"+theme;
}
if(icon){
classes+=" ui-icon-"+icon+" ui-btn-icon-"+iconpos;
}
$(this).addClass(classes);
});
$navbar.delegate("a","vclick",function(){
var activeBtn=$(this);
if(!(activeBtn.hasClass("ui-state-disabled")||
activeBtn.hasClass("ui-disabled")||
activeBtn.hasClass($.mobile.activeBtnClass))){
$navbtns.removeClass($.mobile.activeBtnClass);
activeBtn.addClass($.mobile.activeBtnClass);
$(document).one("pagehide",function(){
activeBtn.removeClass($.mobile.activeBtnClass);
});
}
});
$navbar.closest(".ui-page").bind("pagebeforeshow",function(){
$navbtns.filter(".ui-state-persist").addClass($.mobile.activeBtnClass);
});
}
});
})(jQuery);
(function($,undefined){
var getAttr=$.mobile.getAttribute;
$.widget("mobile.listview",$.extend({
options:{
theme:null,
countTheme:null,
dividerTheme:null,
icon:"carat-r",
splitIcon:"carat-r",
splitTheme:null,
corners:true,
shadow:true,
inset:false
},
_create:function(){
var t=this,
listviewClasses="";
listviewClasses+=t.options.inset?" ui-listview-inset":"";
if(!!t.options.inset){
listviewClasses+=t.options.corners?" ui-corner-all":"";
listviewClasses+=t.options.shadow?" ui-shadow":"";
}
t.element.addClass(" ui-listview"+listviewClasses);
t.refresh(true);
},
_findFirstElementByTagName:function(ele,nextProp,lcName,ucName){
var dict={};
dict[lcName]=dict[ucName]=true;
while(ele){
if(dict[ele.nodeName]){
return ele;
}
ele=ele[nextProp];
}
return null;
},
_addThumbClasses:function(containers){
var i,img,len=containers.length;
for(i=0;i<len;i++){
img=$(this._findFirstElementByTagName(containers[i].firstChild,"nextSibling","img","IMG"));
if(img.length){
$(this._findFirstElementByTagName(img[0].parentNode,"parentNode","li","LI")).addClass(img.hasClass("ui-li-icon")?"ui-li-has-icon":"ui-li-has-thumb");
}
}
},
_getChildrenByTagName:function(ele,lcName,ucName){
var results=[],
dict={};
dict[lcName]=dict[ucName]=true;
ele=ele.firstChild;
while(ele){
if(dict[ele.nodeName]){
results.push(ele);
}
ele=ele.nextSibling;
}
return $(results);
},
_beforeListviewRefresh:$.noop,
_afterListviewRefresh:$.noop,
refresh:function(create){
var buttonClass,pos,numli,item,itemClass,itemTheme,itemIcon,icon,a,
isDivider,startCount,newStartCount,value,last,splittheme,splitThemeClass,spliticon,
altButtonClass,dividerTheme,li,
o=this.options,
$list=this.element,
ol=!!$.nodeName($list[0],"ol"),
start=$list.attr("start"),
itemClassDict={},
countBubbles=$list.find(".ui-li-count"),
countTheme=getAttr($list[0],"counttheme")||this.options.countTheme,
countThemeClass=countTheme?"ui-body-"+countTheme:"ui-body-inherit";
if(o.theme){
$list.addClass("ui-group-theme-"+o.theme);
}
if(ol&&(start||start===0)){
startCount=parseInt(start,10)-1;
$list.css("counter-reset","listnumbering "+startCount);
}
this._beforeListviewRefresh();
li=this._getChildrenByTagName($list[0],"li","LI");
for(pos=0,numli=li.length;pos<numli;pos++){
item=li.eq(pos);
itemClass="";
if(create||item[0].className.search(/\bui-li-static\b|\bui-li-divider\b/)<0){
a=this._getChildrenByTagName(item[0],"a","A");
isDivider=(getAttr(item[0],"role")==="list-divider");
value=item.attr("value");
itemTheme=getAttr(item[0],"theme");
if(a.length&&a[0].className.search(/\bui-btn\b/)<0&&!isDivider){
itemIcon=getAttr(item[0],"icon");
icon=(itemIcon===false)?false:(itemIcon||o.icon);
a.removeClass("ui-link");
buttonClass="ui-btn";
if(itemTheme){
buttonClass+=" ui-btn-"+itemTheme;
}
if(a.length>1){
itemClass="ui-li-has-alt";
last=a.last();
splittheme=getAttr(last[0],"theme")||o.splitTheme||getAttr(item[0],"theme",true);
splitThemeClass=splittheme?" ui-btn-"+splittheme:"";
spliticon=getAttr(last[0],"icon")||getAttr(item[0],"icon")||o.splitIcon;
altButtonClass="ui-btn ui-btn-icon-notext ui-icon-"+spliticon+splitThemeClass;
last
.attr("title",$.trim(last.getEncodedText()))
.addClass(altButtonClass)
.empty();
}else if(icon){
buttonClass+=" ui-btn-icon-right ui-icon-"+icon;
}
a.first().addClass(buttonClass);
}else if(isDivider){
dividerTheme=(getAttr(item[0],"theme")||o.dividerTheme||o.theme);
itemClass="ui-li-divider ui-bar-"+(dividerTheme?dividerTheme:"inherit");
item.attr("role","heading");
}else if(a.length<=0){
itemClass="ui-li-static ui-body-"+(itemTheme?itemTheme:"inherit");
}
if(ol&&value){
newStartCount=parseInt(value,10)-1;
item.css("counter-reset","listnumbering "+newStartCount);
}
}
if(!itemClassDict[itemClass]){
itemClassDict[itemClass]=[];
}
itemClassDict[itemClass].push(item[0]);
}
for(itemClass in itemClassDict){
$(itemClassDict[itemClass]).addClass(itemClass);
}
countBubbles.each(function(){
$(this).closest("li").addClass("ui-li-has-count");
});
if(countThemeClass){
countBubbles.addClass(countThemeClass);
}
this._addThumbClasses(li);
this._addThumbClasses(li.find(".ui-btn"));
this._afterListviewRefresh();
this._addFirstLastClasses(li,this._getVisibles(li,create),create);
}
},$.mobile.behaviors.addFirstLastClasses));
})(jQuery);
(function($,undefined){
function defaultAutodividersSelector(elt){
var text=$.trim(elt.text())||null;
if(!text){
return null;
}
text=text.slice(0,1).toUpperCase();
return text;
}
$.widget("mobile.listview",$.mobile.listview,{
options:{
autodividers:false,
autodividersSelector:defaultAutodividersSelector
},
_beforeListviewRefresh:function(){
if(this.options.autodividers){
this._replaceDividers();
this._superApply(arguments);
}
},
_replaceDividers:function(){
var i,lis,li,dividerText,
lastDividerText=null,
list=this.element,
divider;
list.children("li:jqmData(role='list-divider')").remove();
lis=list.children("li");
for(i=0;i<lis.length;i++){
li=lis[i];
dividerText=this.options.autodividersSelector($(li));
if(dividerText&&lastDividerText!==dividerText){
divider=document.createElement("li");
divider.appendChild(document.createTextNode(dividerText));
divider.setAttribute("data-"+$.mobile.ns+"role","list-divider");
li.parentNode.insertBefore(divider,li);
}
lastDividerText=dividerText;
}
}
});
})(jQuery);
(function($,undefined){
var rdivider=/(^|\s)ui-li-divider($|\s)/,
rhidden=/(^|\s)ui-screen-hidden($|\s)/;
$.widget("mobile.listview",$.mobile.listview,{
options:{
hideDividers:false
},
_afterListviewRefresh:function(){
var items,idx,item,hideDivider=true;
this._superApply(arguments);
if(this.options.hideDividers){
items=this._getChildrenByTagName(this.element[0],"li","LI");
for(idx=items.length-1;idx>-1;idx--){
item=items[idx];
if(item.className.match(rdivider)){
if(hideDivider){
item.className=item.className+" ui-screen-hidden";
}
hideDivider=true;
}else{
if(!item.className.match(rhidden)){
hideDivider=false;
}
}
}
}
}
});
})(jQuery);
(function($,undefined){
$.mobile.nojs=function(target){
$(":jqmData(role='nojs')",target).addClass("ui-nojs");
};
})(jQuery);
(function($,undefined){
$.mobile.behaviors.formReset={
_handleFormReset:function(){
this._on(this.element.closest("form"),{
reset:function(){
this._delay("_reset");
}
});
}
};
})(jQuery);

(function($,undefined){
var escapeId=$.mobile.path.hashToSelector;
$.widget("mobile.checkboxradio",$.extend({
initSelector:"input:not( :jqmData(role='flipswitch' ) )[type='checkbox'],input[type='radio']:not( :jqmData(role='flipswitch' ))",
options:{
theme:"inherit",
mini:false,
wrapperClass:null,
enhanced:false,
iconpos:"left"
},
_create:function(){
var input=this.element,
o=this.options,
inheritAttr=function(input,dataAttr){
return input.jqmData(dataAttr)||
input.closest("form, fieldset").jqmData(dataAttr);
},
parentLabel=input.closest("label"),
label=parentLabel.length?parentLabel:
input
.closest("form, fieldset, :jqmData(role='page'), :jqmData(role='dialog')")
.find("label")
.filter("[for='"+escapeId(input[0].id)+"']")
.first(),
inputtype=input[0].type,
checkedClass="ui-"+inputtype+"-on",
uncheckedClass="ui-"+inputtype+"-off";
if(inputtype!=="checkbox"&&inputtype!=="radio"){
return;
}
if(this.element[0].disabled){
this.options.disabled=true;
}
o.iconpos=inheritAttr(input,"iconpos")||label.attr("data-"+$.mobile.ns+"iconpos")||o.iconpos,
o.mini=inheritAttr(input,"mini")||o.mini;
$.extend(this,{
input:input,
label:label,
parentLabel:parentLabel,
inputtype:inputtype,
checkedClass:checkedClass,
uncheckedClass:uncheckedClass
});
if(!this.options.enhanced){
this._enhance();
}
this._on(label,{
vmouseover:"_handleLabelVMouseOver",
vclick:"_handleLabelVClick"
});
this._on(input,{
vmousedown:"_cacheVals",
vclick:"_handleInputVClick",
focus:"_handleInputFocus",
blur:"_handleInputBlur"
});
this._handleFormReset();
this.refresh();
},
_enhance:function(){
this.label.addClass("ui-btn ui-corner-all");
if(this.parentLabel.length>0){
this.input.add(this.label).wrapAll(this._wrapper());
}else{
this.element.wrap(this._wrapper());
this.element.parent().prepend(this.label);
}
this._setOptions({
"theme":this.options.theme,
"iconpos":this.options.iconpos,
"mini":this.options.mini
});
},
_wrapper:function(){
return $("<div class='"+
(this.options.wrapperClass?this.options.wrapperClass:"")+
" ui-"+this.inputtype+
(this.options.disabled?" ui-state-disabled":"")+"' ></div>");
},
_handleInputFocus:function(){
this.label.addClass($.mobile.focusClass);
},
_handleInputBlur:function(){
this.label.removeClass($.mobile.focusClass);
},
_handleInputVClick:function(){
this.element.prop("checked",this.element.is(":checked"));
this._getInputSet().not(this.element).prop("checked",false);
this._updateAll();
},
_handleLabelVMouseOver:function(event){
if(this.label.parent().hasClass("ui-state-disabled")){
event.stopPropagation();
}
},
_handleLabelVClick:function(event){
var input=this.element;
if(input.is(":disabled")){
event.preventDefault();
return;
}
this._cacheVals();
input.prop("checked",this.inputtype==="radio"&&true||!input.prop("checked"));
input.triggerHandler("click");
this._getInputSet().not(input).prop("checked",false);
this._updateAll();
return false;
},
_cacheVals:function(){
this._getInputSet().each(function(){
$(this).attr("data-"+$.mobile.ns+"cacheVal",this.checked);
});
},
_getInputSet:function(){
var selector,formId,
radio=this.element[0],
name=radio.name,
form=radio.form,
doc=this.element.parents().last().get(0),
radios=this.element;
if(name&&this.inputtype==="radio"&&doc){
selector="input[type='radio'][name='"+escapeId(name)+"']";
if(form){
formId=form.id;
if(formId){
radios=$(selector+"[form='"+escapeId(formId)+"']",doc);
}
radios=$(form).find(selector).filter(function(){
return(this.form===form);
}).add(radios);
}else{
radios=$(selector,doc).filter(function(){
return!this.form;
});
}
}
return radios;
},
_updateAll:function(){
var self=this;
this._getInputSet().each(function(){
var $this=$(this);
if(this.checked||self.inputtype==="checkbox"){
$this.trigger("change");
}
})
.checkboxradio("refresh");
},
_reset:function(){
this.refresh();
},
_hasIcon:function(){
var controlgroup,controlgroupWidget,
controlgroupConstructor=$.mobile.controlgroup;
if(controlgroupConstructor){
controlgroup=this.element.closest(
":mobile-controlgroup,"+
controlgroupConstructor.prototype.initSelector);
if(controlgroup.length>0){
controlgroupWidget=$.data(controlgroup[0],"mobile-controlgroup");
return((controlgroupWidget?controlgroupWidget.options.type:
controlgroup.attr("data-"+$.mobile.ns+"type"))!=="horizontal");
}
}
return true;
},
refresh:function(){
var hasIcon=this._hasIcon(),
isChecked=this.element[0].checked,
active=$.mobile.activeBtnClass,
iconposClass="ui-btn-icon-"+this.options.iconpos,
addClasses=[],
removeClasses=[];
if(hasIcon){
removeClasses.push(active);
addClasses.push(iconposClass);
}else{
removeClasses.push(iconposClass);
(isChecked?addClasses:removeClasses).push(active);
}
if(isChecked){
addClasses.push(this.checkedClass);
removeClasses.push(this.uncheckedClass);
}else{
addClasses.push(this.uncheckedClass);
removeClasses.push(this.checkedClass);
}
this.label
.addClass(addClasses.join(" "))
.removeClass(removeClasses.join(" "));
},
widget:function(){
return this.label.parent();
},
_setOptions:function(options){
var label=this.label,
currentOptions=this.options,
outer=this.widget(),
hasIcon=this._hasIcon();
if(options.disabled!==undefined){
this.input.prop("disabled",!!options.disabled);
outer.toggleClass("ui-state-disabled",!!options.disabled);
}
if(options.mini!==undefined){
outer.toggleClass("ui-mini",!!options.mini);
}
if(options.theme!==undefined){
label
.removeClass("ui-btn-"+currentOptions.theme)
.addClass("ui-btn-"+options.theme);
}
if(options.wrapperClass!==undefined){
outer
.removeClass(currentOptions.wrapperClass)
.addClass(options.wrapperClass);
}
if(options.iconpos!==undefined&&hasIcon){
label.removeClass("ui-btn-icon-"+currentOptions.iconpos).addClass("ui-btn-icon-"+options.iconpos);
}else if(!hasIcon){
label.removeClass("ui-btn-icon-"+currentOptions.iconpos);
}
this._super(options);
}
},$.mobile.behaviors.formReset));
})(jQuery);
(function($,undefined){
$.widget("mobile.button",{
initSelector:"input[type='button'], input[type='submit'], input[type='reset']",
options:{
theme:null,
icon:null,
iconpos:"left",
iconshadow:false,
corners:true,
shadow:true,
inline:null,
mini:null,
wrapperClass:null,
enhanced:false
},
_create:function(){
if(this.element.is(":disabled")){
this.options.disabled=true;
}
if(!this.options.enhanced){
this._enhance();
}
$.extend(this,{
wrapper:this.element.parent()
});
this._on({
focus:function(){
this.widget().addClass($.mobile.focusClass);
},
blur:function(){
this.widget().removeClass($.mobile.focusClass);
}
});
this.refresh(true);
},
_enhance:function(){
this.element.wrap(this._button());
},
_button:function(){
var options=this.options,
iconClasses=this._getIconClasses(this.options);
return $("<div class='ui-btn ui-input-btn"+
(options.wrapperClass?" "+options.wrapperClass:"")+
(options.theme?" ui-btn-"+options.theme:"")+
(options.corners?" ui-corner-all":"")+
(options.shadow?" ui-shadow":"")+
(options.inline?" ui-btn-inline":"")+
(options.mini?" ui-mini":"")+
(options.disabled?" ui-state-disabled":"")+
(iconClasses?(" "+iconClasses):"")+
"' >"+this.element.val()+"</div>");
},
widget:function(){
return this.wrapper;
},
_destroy:function(){
this.element.insertBefore(this.button);
this.button.remove();
},
_getIconClasses:function(options){
return(options.icon?("ui-icon-"+options.icon+
(options.iconshadow?" ui-shadow-icon":"")+
" ui-btn-icon-"+options.iconpos):"");
},
_setOptions:function(options){
var outer=this.widget();
if(options.theme!==undefined){
outer
.removeClass(this.options.theme)
.addClass("ui-btn-"+options.theme);
}
if(options.corners!==undefined){
outer.toggleClass("ui-corner-all",options.corners);
}
if(options.shadow!==undefined){
outer.toggleClass("ui-shadow",options.shadow);
}
if(options.inline!==undefined){
outer.toggleClass("ui-btn-inline",options.inline);
}
if(options.mini!==undefined){
outer.toggleClass("ui-mini",options.mini);
}
if(options.disabled!==undefined){
this.element.prop("disabled",options.disabled);
outer.toggleClass("ui-state-disabled",options.disabled);
}
if(options.icon!==undefined||
options.iconshadow!==undefined||
options.iconpos!==undefined){
outer
.removeClass(this._getIconClasses(this.options))
.addClass(this._getIconClasses(
$.extend({},this.options,options)));
}
this._super(options);
},
refresh:function(create){
var originalElement,
isDisabled=this.element.prop("disabled");
if(this.options.icon&&this.options.iconpos==="notext"&&this.element.attr("title")){
this.element.attr("title",this.element.val());
}
if(!create){
originalElement=this.element.detach();
$(this.wrapper).text(this.element.val()).append(originalElement);
}
if(this.options.disabled!==isDisabled){
this._setOptions({disabled:isDisabled});
}
}
});
})(jQuery);
(function($){
var meta=$("meta[name=viewport]"),
initialContent=meta.attr("content"),
disabledZoom=initialContent+",maximum-scale=1, user-scalable=no",
enabledZoom=initialContent+",maximum-scale=10, user-scalable=yes",
disabledInitially=/(user-scalable[\s]*=[\s]*no)|(maximum-scale[\s]*=[\s]*1)[$,\s]/.test(initialContent);
$.mobile.zoom=$.extend({},{
enabled:!disabledInitially,
locked:false,
disable:function(lock){
if(!disabledInitially&&!$.mobile.zoom.locked){
meta.attr("content",disabledZoom);
$.mobile.zoom.enabled=false;
$.mobile.zoom.locked=lock||false;
}
},
enable:function(unlock){
if(!disabledInitially&&(!$.mobile.zoom.locked||unlock===true)){
meta.attr("content",enabledZoom);
$.mobile.zoom.enabled=true;
$.mobile.zoom.locked=false;
}
},
restore:function(){
if(!disabledInitially){
meta.attr("content",initialContent);
$.mobile.zoom.enabled=true;
}
}
});
}(jQuery));
(function($,undefined){
$.widget("mobile.textinput",{
initSelector:"input[type='text'],"+
"input[type='search'],"+
":jqmData(type='search'),"+
"input[type='number'],"+
":jqmData(type='number'),"+
"input[type='password'],"+
"input[type='email'],"+
"input[type='url'],"+
"input[type='tel'],"+
"textarea,"+
"input[type='time'],"+
"input[type='date'],"+
"input[type='month'],"+
"input[type='week'],"+
"input[type='datetime'],"+
"input[type='datetime-local'],"+
"input[type='color'],"+
"input:not([type]),"+
"input[type='file']",
options:{
theme:null,
corners:true,
mini:false,
preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,
wrapperClass:"",
enhanced:false
},
_create:function(){
var options=this.options,
isSearch=this.element.is("[type='search'], :jqmData(type='search')"),
isTextarea=this.element[0].tagName==="TEXTAREA",
isRange=this.element.is("[data-"+($.mobile.ns||"")+"type='range']"),
inputNeedsWrap=((this.element.is("input")||
this.element.is("[data-"+($.mobile.ns||"")+"type='search']"))&&
!isRange);
if(this.element.prop("disabled")){
options.disabled=true;
}
$.extend(this,{
classes:this._classesFromOptions(),
isSearch:isSearch,
isTextarea:isTextarea,
isRange:isRange,
inputNeedsWrap:inputNeedsWrap
});
this._autoCorrect();
if(!options.enhanced){
this._enhance();
}
this._on({
"focus":"_handleFocus",
"blur":"_handleBlur"
});
},
refresh:function(){
this.setOptions({
"disabled":this.element.is(":disabled")
});
},
_enhance:function(){
var elementClasses=[];
if(this.isTextarea){
elementClasses.push("ui-input-text");
}
if(this.isTextarea||this.isRange){
elementClasses.push("ui-shadow-inset");
}
if(this.inputNeedsWrap){
this.element.wrap(this._wrap());
}else{
elementClasses=elementClasses.concat(this.classes);
}
this.element.addClass(elementClasses.join(" "));
},
widget:function(){
return(this.inputNeedsWrap)?this.element.parent():this.element;
},
_classesFromOptions:function(){
var options=this.options,
classes=[];
classes.push("ui-body-"+((options.theme===null)?"inherit":options.theme));
if(options.corners){
classes.push("ui-corner-all");
}
if(options.mini){
classes.push("ui-mini");
}
if(options.disabled){
classes.push("ui-state-disabled");
}
if(options.wrapperClass){
classes.push(options.wrapperClass);
}
return classes;
},
_wrap:function(){
return $("<div class='"+
(this.isSearch?"ui-input-search ":"ui-input-text ")+
this.classes.join(" ")+" "+
"ui-shadow-inset'></div>");
},
_autoCorrect:function(){
if(typeof this.element[0].autocorrect!=="undefined"&&
!$.support.touchOverflow){
this.element[0].setAttribute("autocorrect","off");
this.element[0].setAttribute("autocomplete","off");
}
},
_handleBlur:function(){
this.widget().removeClass($.mobile.focusClass);
if(this.options.preventFocusZoom){
$.mobile.zoom.enable(true);
}
},
_handleFocus:function(){
if(this.options.preventFocusZoom){
$.mobile.zoom.disable(true);
}
this.widget().addClass($.mobile.focusClass);
},
_setOptions:function(options){
var outer=this.widget();
this._super(options);
if(!(options.disabled===undefined&&
options.mini===undefined&&
options.corners===undefined&&
options.theme===undefined&&
options.wrapperClass===undefined)){
outer.removeClass(this.classes.join(" "));
this.classes=this._classesFromOptions();
outer.addClass(this.classes.join(" "));
}
if(options.disabled!==undefined){
this.element.prop("disabled",!!options.disabled);
}
},
_destroy:function(){
if(this.options.enhanced){
return;
}
if(this.inputNeedsWrap){
this.element.unwrap();
}
this.element.removeClass("ui-input-text "+this.classes.join(" "));
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.slider",$.extend({
initSelector:"input[type='range'], :jqmData(type='range'), :jqmData(role='slider')",
widgetEventPrefix:"slide",
options:{
theme:null,
trackTheme:null,
corners:true,
mini:false,
highlight:false
},
_create:function(){
var self=this,
control=this.element,
trackTheme=this.options.trackTheme||$.mobile.getAttribute(control[0],"theme"),
trackThemeClass=trackTheme?" ui-bar-"+trackTheme:" ui-bar-inherit",
cornerClass=(this.options.corners||control.jqmData("corners"))?" ui-corner-all":"",
miniClass=(this.options.mini||control.jqmData("mini"))?" ui-mini":"",
cType=control[0].nodeName.toLowerCase(),
isToggleSwitch=(cType==="select"),
isRangeslider=control.parent().is(":jqmData(role='rangeslider')"),
selectClass=(isToggleSwitch)?"ui-slider-switch":"",
controlID=control.attr("id"),
$label=$("[for='"+controlID+"']"),
labelID=$label.attr("id")||controlID+"-label",
min=!isToggleSwitch?parseFloat(control.attr("min")):0,
max=!isToggleSwitch?parseFloat(control.attr("max")):control.find("option").length-1,
step=window.parseFloat(control.attr("step")||1),
domHandle=document.createElement("a"),
handle=$(domHandle),
domSlider=document.createElement("div"),
slider=$(domSlider),
valuebg=this.options.highlight&&!isToggleSwitch?(function(){
var bg=document.createElement("div");
bg.className="ui-slider-bg "+$.mobile.activeBtnClass;
return $(bg).prependTo(slider);
})():false,
options,
wrapper,
j,length,
i,optionsCount,origTabIndex,
side,activeClass,sliderImg;
$label.attr("id",labelID);
this.isToggleSwitch=isToggleSwitch;
domHandle.setAttribute("href","#");
domSlider.setAttribute("role","application");
domSlider.className=[this.isToggleSwitch?"ui-slider ui-slider-track ui-shadow-inset ":"ui-slider-track ui-shadow-inset ",selectClass,trackThemeClass,cornerClass,miniClass].join("");
domHandle.className="ui-slider-handle";
domSlider.appendChild(domHandle);
handle.attr({
"role":"slider",
"aria-valuemin":min,
"aria-valuemax":max,
"aria-valuenow":this._value(),
"aria-valuetext":this._value(),
"title":this._value(),
"aria-labelledby":labelID
});
$.extend(this,{
slider:slider,
handle:handle,
control:control,
type:cType,
step:step,
max:max,
min:min,
valuebg:valuebg,
isRangeslider:isRangeslider,
dragging:false,
beforeStart:null,
userModified:false,
mouseMoved:false
});
if(isToggleSwitch){
origTabIndex=control.attr("tabindex");
if(origTabIndex){
handle.attr("tabindex",origTabIndex);
}
control.attr("tabindex","-1").focus(function(){
$(this).blur();
handle.focus();
});
wrapper=document.createElement("div");
wrapper.className="ui-slider-inneroffset";
for(j=0,length=domSlider.childNodes.length;j<length;j++){
wrapper.appendChild(domSlider.childNodes[j]);
}
domSlider.appendChild(wrapper);
handle.addClass("ui-slider-handle-snapping");
options=control.find("option");
for(i=0,optionsCount=options.length;i<optionsCount;i++){
side=!i?"b":"a";
activeClass=!i?"":" "+$.mobile.activeBtnClass;
sliderImg=document.createElement("span");
sliderImg.className=["ui-slider-label ui-slider-label-",side,activeClass].join("");
sliderImg.setAttribute("role","img");
sliderImg.appendChild(document.createTextNode(options[i].innerHTML));
$(sliderImg).prependTo(slider);
}
self._labels=$(".ui-slider-label",slider);
}
control.addClass(isToggleSwitch?"ui-slider-switch":"ui-slider-input");
this._on(control,{
"change":"_controlChange",
"keyup":"_controlKeyup",
"blur":"_controlBlur",
"vmouseup":"_controlVMouseUp"
});
slider.bind("vmousedown",$.proxy(this._sliderVMouseDown,this))
.bind("vclick",false);
this._on(document,{"vmousemove":"_preventDocumentDrag"});
this._on(slider.add(document),{"vmouseup":"_sliderVMouseUp"});
slider.insertAfter(control);
if(!isToggleSwitch&&!isRangeslider){
wrapper=this.options.mini?"<div class='ui-slider ui-mini'>":"<div class='ui-slider'>";
control.add(slider).wrapAll(wrapper);
}
this._on(this.handle,{
"vmousedown":"_handleVMouseDown",
"keydown":"_handleKeydown",
"keyup":"_handleKeyup"
});
this.handle.bind("vclick",false);
this._handleFormReset();
this.refresh(undefined,undefined,true);
},
_setOptions:function(options){
if(options.theme!==undefined){
this._setTheme(options.theme);
}
if(options.trackTheme!==undefined){
this._setTrackTheme(options.trackTheme);
}
if(options.corners!==undefined){
this._setCorners(options.corners);
}
if(options.mini!==undefined){
this._setMini(options.mini);
}
if(options.highlight!==undefined){
this._setHighlight(options.highlight);
}
if(options.disabled!==undefined){
this._setDisabled(options.disabled);
}
this._super(options);
},
_controlChange:function(event){
if(this._trigger("controlchange",event)===false){
return false;
}
if(!this.mouseMoved){
this.refresh(this._value(),true);
}
},
_controlKeyup:function(){this.refresh(this._value(),true,true);
},
_controlBlur:function(){
this.refresh(this._value(),true);
},
_controlVMouseUp:function(){
this._checkedRefresh();
},
_handleVMouseDown:function(){
this.handle.focus();
},
_handleKeydown:function(event){
var index=this._value();
if(this.options.disabled){
return;
}
switch(event.keyCode){
case $.mobile.keyCode.HOME:
case $.mobile.keyCode.END:
case $.mobile.keyCode.PAGE_UP:
case $.mobile.keyCode.PAGE_DOWN:
case $.mobile.keyCode.UP:
case $.mobile.keyCode.RIGHT:
case $.mobile.keyCode.DOWN:
case $.mobile.keyCode.LEFT:
event.preventDefault();
if(!this._keySliding){
this._keySliding=true;
this.handle.addClass("ui-state-active");
}
break;
}
switch(event.keyCode){
case $.mobile.keyCode.HOME:
this.refresh(this.min);
break;
case $.mobile.keyCode.END:
this.refresh(this.max);
break;
case $.mobile.keyCode.PAGE_UP:
case $.mobile.keyCode.UP:
case $.mobile.keyCode.RIGHT:
this.refresh(index+this.step);
break;
case $.mobile.keyCode.PAGE_DOWN:
case $.mobile.keyCode.DOWN:
case $.mobile.keyCode.LEFT:
this.refresh(index-this.step);
break;
}
},_handleKeyup:function(){
if(this._keySliding){
this._keySliding=false;
this.handle.removeClass("ui-state-active");
}
},
_sliderVMouseDown:function(event){
if(this.options.disabled||!(event.which===1||event.which===0||event.which===undefined)){
return false;
}
if(this._trigger("beforestart",event)===false){
return false;
}
this.dragging=true;
this.userModified=false;
this.mouseMoved=false;
if(this.isToggleSwitch){
this.beforeStart=this.element[0].selectedIndex;
}
this.refresh(event);
this._trigger("start");
return false;
},
_sliderVMouseUp:function(){
if(this.dragging){
this.dragging=false;
if(this.isToggleSwitch){
this.handle.addClass("ui-slider-handle-snapping");
if(this.mouseMoved){
if(this.userModified){
this.refresh(this.beforeStart===0?1:0);
}else{
this.refresh(this.beforeStart);
}
}else{
this.refresh(this.beforeStart===0?1:0);
}
}
this.mouseMoved=false;
this._trigger("stop");
return false;
}
},
_preventDocumentDrag:function(event){
if(this._trigger("drag",event)===false){
return false;
}
if(this.dragging&&!this.options.disabled){
this.mouseMoved=true;
if(this.isToggleSwitch){
this.handle.removeClass("ui-slider-handle-snapping");
}
this.refresh(event);
this.userModified=this.beforeStart!==this.element[0].selectedIndex;
return false;
}
},
_checkedRefresh:function(){
if(this.value!==this._value()){
this.refresh(this._value());
}
},
_value:function(){
return this.isToggleSwitch?this.element[0].selectedIndex:parseFloat(this.element.val());
},
_reset:function(){
this.refresh(undefined,false,true);
},
refresh:function(val,isfromControl,preventInputUpdate){
var self=this,
parentTheme=$.mobile.getAttribute(this.element[0],"theme"),
theme=this.options.theme||parentTheme,
themeClass=theme?" ui-btn-"+theme:"",
trackTheme=this.options.trackTheme||parentTheme,
trackThemeClass=trackTheme?" ui-bar-"+trackTheme:" ui-bar-inherit",
cornerClass=this.options.corners?" ui-corner-all":"",
miniClass=this.options.mini?" ui-mini":"",
left,width,data,tol,
pxStep,percent,
control,isInput,optionElements,min,max,step,
newval,valModStep,alignValue,percentPerStep,
handlePercent,aPercent,bPercent,
valueChanged;
self.slider[0].className=[this.isToggleSwitch?"ui-slider ui-slider-switch ui-slider-track ui-shadow-inset":"ui-slider-track ui-shadow-inset",trackThemeClass,cornerClass,miniClass].join("");
if(this.options.disabled||this.element.prop("disabled")){
this.disable();
}
this.value=this._value();
if(this.options.highlight&&!this.isToggleSwitch&&this.slider.find(".ui-slider-bg").length===0){
this.valuebg=(function(){
var bg=document.createElement("div");
bg.className="ui-slider-bg "+$.mobile.activeBtnClass;
return $(bg).prependTo(self.slider);
})();
}
this.handle.addClass("ui-btn"+themeClass+" ui-shadow");
control=this.element;
isInput=!this.isToggleSwitch;
optionElements=isInput?[]:control.find("option");
min=isInput?parseFloat(control.attr("min")):0;
max=isInput?parseFloat(control.attr("max")):optionElements.length-1;
step=(isInput&&parseFloat(control.attr("step"))>0)?parseFloat(control.attr("step")):1;
if(typeof val==="object"){
data=val;
tol=8;
left=this.slider.offset().left;
width=this.slider.width();
pxStep=width/((max-min)/step);
if(!this.dragging||
data.pageX<left-tol||
data.pageX>left+width+tol){
return;
}
if(pxStep>1){
percent=((data.pageX-left)/width)*100;
}else{
percent=Math.round(((data.pageX-left)/width)*100);
}
}else{
if(val==null){
val=isInput?parseFloat(control.val()||0):control[0].selectedIndex;
}
percent=(parseFloat(val)-min)/(max-min)*100;
}
if(isNaN(percent)){
return;
}
newval=(percent/100)*(max-min)+min;
valModStep=(newval-min)%step;
alignValue=newval-valModStep;
if(Math.abs(valModStep)*2>=step){
alignValue+=(valModStep>0)?step:(-step);
}
percentPerStep=100/((max-min)/step);
newval=parseFloat(alignValue.toFixed(5));
if(typeof pxStep==="undefined"){
pxStep=width/((max-min)/step);
}
if(pxStep>1&&isInput){
percent=(newval-min)*percentPerStep*(1/step);
}
if(percent<0){
percent=0;
}
if(percent>100){
percent=100;
}
if(newval<min){
newval=min;
}
if(newval>max){
newval=max;
}
this.handle.css("left",percent+"%");
this.handle[0].setAttribute("aria-valuenow",isInput?newval:optionElements.eq(newval).attr("value"));
this.handle[0].setAttribute("aria-valuetext",isInput?newval:optionElements.eq(newval).getEncodedText());
this.handle[0].setAttribute("title",isInput?newval:optionElements.eq(newval).getEncodedText());
if(this.valuebg){
this.valuebg.css("width",percent+"%");
}
if(this._labels){
handlePercent=this.handle.width()/this.slider.width()*100;
aPercent=percent&&handlePercent+(100-handlePercent)*percent/100;
bPercent=percent===100?0:Math.min(handlePercent+100-aPercent,100);
this._labels.each(function(){
var ab=$(this).hasClass("ui-slider-label-a");
$(this).width((ab?aPercent:bPercent)+"%");
});
}
if(!preventInputUpdate){
valueChanged=false;
if(isInput){
valueChanged=control.val()!==newval;
control.val(newval);
}else{
valueChanged=control[0].selectedIndex!==newval;
control[0].selectedIndex=newval;
}
if(this._trigger("beforechange",val)===false){
return false;
}
if(!isfromControl&&valueChanged){
control.trigger("change");
}
}
},
_setHighlight:function(value){
value=!!value;
if(value){
this.options.highlight=!!value;
this.refresh();
}else if(this.valuebg){
this.valuebg.remove();
this.valuebg=false;
}
},
_setTheme:function(value){
this.handle
.removeClass("ui-btn-"+this.options.theme)
.addClass("ui-btn-"+value);
var currentTheme=this.options.theme?this.options.theme:"inherit",
newTheme=value?value:"inherit";
this.control
.removeClass("ui-body-"+currentTheme)
.addClass("ui-body-"+newTheme);
},
_setTrackTheme:function(value){
var currentTrackTheme=this.options.trackTheme?this.options.trackTheme:"inherit",
newTrackTheme=value?value:"inherit";
this.slider
.removeClass("ui-body-"+currentTrackTheme)
.addClass("ui-body-"+newTrackTheme);
},
_setMini:function(value){
value=!!value;
if(!this.isToggleSwitch&&!this.isRangeslider){
this.slider.parent().toggleClass("ui-mini",value);
this.element.toggleClass("ui-mini",value);
}
this.slider.toggleClass("ui-mini",value);
},
_setCorners:function(value){
this.slider.toggleClass("ui-corner-all",value);
if(!this.isToggleSwitch){
this.control.toggleClass("ui-corner-all",value);
}
},
_setDisabled:function(value){
value=!!value;
this.element.prop("disabled",value);
this.slider
.toggleClass("ui-state-disabled",value)
.attr("aria-disabled",value);
}
},$.mobile.behaviors.formReset));
})(jQuery);
(function($,undefined){
var popup;
function getPopup(){
if(!popup){
popup=$("<div></div>",{
"class":"ui-slider-popup ui-shadow ui-corner-all"
});
}
return popup.clone();
}
$.widget("mobile.slider",$.mobile.slider,{
options:{
popupEnabled:false,
showValue:false
},
_create:function(){
this._super();
$.extend(this,{
_currentValue:null,
_popup:null,
_popupVisible:false
});
this._setOption("popupEnabled",this.options.popupEnabled);
this._on(this.handle,{"vmousedown":"_showPopup"});
this._on(this.slider.add(this.document),{"vmouseup":"_hidePopup"});
this._refresh();
},
_positionPopup:function(){
var dstOffset=this.handle.offset();
this._popup.offset({
left:dstOffset.left+(this.handle.width()-this._popup.width())/2,
top:dstOffset.top-this._popup.outerHeight()-5
});
},
_setOption:function(key,value){
this._super(key,value);
if(key==="showValue"){
this.handle.html(value&&!this.options.mini?this._value():"");
}else if(key==="popupEnabled"){
if(value&&!this._popup){
this._popup=getPopup()
.addClass("ui-body-"+(this.options.theme||"a"))
.hide()
.insertBefore(this.element);
}
}
},
refresh:function(){
this._super.apply(this,arguments);
this._refresh();
},
_refresh:function(){
var o=this.options,newValue;
if(o.popupEnabled){
this.handle.removeAttr("title");
}
newValue=this._value();
if(newValue===this._currentValue){
return;
}
this._currentValue=newValue;
if(o.popupEnabled&&this._popup){
this._positionPopup();
this._popup.html(newValue);
}else if(o.showValue&&!this.options.mini){
this.handle.html(newValue);
}
},
_showPopup:function(){
if(this.options.popupEnabled&&!this._popupVisible){
this.handle.html("");
this._popup.show();
this._positionPopup();
this._popupVisible=true;
}
},
_hidePopup:function(){
var o=this.options;
if(o.popupEnabled&&this._popupVisible){
if(o.showValue&&!o.mini){
this.handle.html(this._value());
}
this._popup.hide();
this._popupVisible=false;
}
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.flipswitch",$.extend({
options:{
onText:"On",
offText:"Off",
theme:null,
enhanced:false,
wrapperClass:null,
corners:true,
mini:false
},
_create:function(){
if(!this.options.enhanced){
this._enhance();
}else{
$.extend(this,{
flipswitch:this.element.parent(),
on:this.element.find(".ui-flipswitch-on").eq(0),
off:this.element.find(".ui-flipswitch-off").eq(0),
type:this.element.get(0).tagName
});
}
this._handleFormReset();
this._originalTabIndex=this.element.attr("tabindex");
if(this._originalTabIndex!=null){
this.on.attr("tabindex",this._originalTabIndex);
}
this.element.attr("tabindex","-1");
this._on({
"focus":"_handleInputFocus"
});
if(this.element.is(":disabled")){
this._setOptions({
"disabled":true
});
}
this._on(this.flipswitch,{
"click":"_toggle",
"swipeleft":"_left",
"swiperight":"_right"
});
this._on(this.on,{
"keydown":"_keydown"
});
this._on({
"change":"refresh"
});
},
_handleInputFocus:function(){
this.on.focus();
},
widget:function(){
return this.flipswitch;
},
_left:function(){
this.flipswitch.removeClass("ui-flipswitch-active");
if(this.type==="SELECT"){
this.element.get(0).selectedIndex=0;
}else{
this.element.prop("checked",false);
}
this.element.trigger("change");
},
_right:function(){
this.flipswitch.addClass("ui-flipswitch-active");
if(this.type==="SELECT"){
this.element.get(0).selectedIndex=1;
}else{
this.element.prop("checked",true);
}
this.element.trigger("change");
},
_enhance:function(){
var flipswitch=$("<div>"),
options=this.options,
element=this.element,
theme=options.theme?options.theme:"inherit",
on=$("<a></a>",{
"href":"#"
}),
off=$("<span></span>"),
type=element.get(0).tagName,
onText=(type==="INPUT")?
options.onText:element.find("option").eq(1).text(),
offText=(type==="INPUT")?
options.offText:element.find("option").eq(0).text();
on
.addClass("ui-flipswitch-on ui-btn ui-shadow ui-btn-inherit")
.text(onText);
off
.addClass("ui-flipswitch-off")
.text(offText);
flipswitch
.addClass("ui-flipswitch ui-shadow-inset "+
"ui-bar-"+theme+" "+
(options.wrapperClass?options.wrapperClass:"")+" "+
((element.is(":checked")||
element
.find("option")
.eq(1)
.is(":selected"))?"ui-flipswitch-active":"")+
(element.is(":disabled")?" ui-state-disabled":"")+
(options.corners?" ui-corner-all":"")+
(options.mini?" ui-mini":""))
.append(on,off);
element
.addClass("ui-flipswitch-input")
.after(flipswitch)
.appendTo(flipswitch);
$.extend(this,{
flipswitch:flipswitch,
on:on,
off:off,
type:type
});
},
_reset:function(){
this.refresh();
},
refresh:function(){
var direction,
existingDirection=this.flipswitch.hasClass("ui-flipswitch-active")?"_right":"_left";
if(this.type==="SELECT"){
direction=(this.element.get(0).selectedIndex>0)?"_right":"_left";
}else{
direction=this.element.prop("checked")?"_right":"_left";
}
if(direction!==existingDirection){
this[direction]();
}
},
_toggle:function(){
var direction=this.flipswitch.hasClass("ui-flipswitch-active")?"_left":"_right";
this[direction]();
},
_keydown:function(e){
if(e.which===$.mobile.keyCode.LEFT){
this._left();
}else if(e.which===$.mobile.keyCode.RIGHT){
this._right();
}else if(e.which===$.mobile.keyCode.SPACE){
this._toggle();
e.preventDefault();
}
},
_setOptions:function(options){
if(options.theme!==undefined){
var currentTheme=options.theme?options.theme:"inherit",
newTheme=options.theme?options.theme:"inherit";
this.widget()
.removeClass("ui-bar-"+currentTheme)
.addClass("ui-bar-"+newTheme);
}
if(options.onText!==undefined){
this.on.text(options.onText);
}
if(options.offText!==undefined){
this.off.text(options.offText);
}
if(options.disabled!==undefined){
this.widget().toggleClass("ui-state-disabled",options.disabled);
}
if(options.mini!==undefined){
this.widget().toggleClass("ui-mini",options.mini);
}
if(options.corners!==undefined){
this.widget().toggleClass("ui-corner-all",options.corners);
}
this._super(options);
},
_destroy:function(){
if(this.options.enhanced){
return;
}
if(this._originalTabIndex!=null){
this.element.attr("tabindex",this._originalTabIndex);
}else{
this.element.removeAttr("tabindex");
}
this.on.remove();
this.off.remove();
this.element.unwrap();
this.flipswitch.remove();
this.removeClass("ui-flipswitch-input");
}
},$.mobile.behaviors.formReset));
})(jQuery);
(function($,undefined){
$.widget("mobile.rangeslider",$.extend({
options:{
theme:null,
trackTheme:null,
corners:true,
mini:false,
highlight:true
},
_create:function(){
var $el=this.element,
elClass=this.options.mini?"ui-rangeslider ui-mini":"ui-rangeslider",
_inputFirst=$el.find("input").first(),
_inputLast=$el.find("input").last(),
_label=$el.find("label").first(),
_sliderWidgetFirst=$.data(_inputFirst.get(0),"mobile-slider")||
$.data(_inputFirst.slider().get(0),"mobile-slider"),
_sliderWidgetLast=$.data(_inputLast.get(0),"mobile-slider")||
$.data(_inputLast.slider().get(0),"mobile-slider"),
_sliderFirst=_sliderWidgetFirst.slider,
_sliderLast=_sliderWidgetLast.slider,
firstHandle=_sliderWidgetFirst.handle,
_sliders=$("<div class='ui-rangeslider-sliders' />").appendTo($el);
_inputFirst.addClass("ui-rangeslider-first");
_inputLast.addClass("ui-rangeslider-last");
$el.addClass(elClass);
_sliderFirst.appendTo(_sliders);
_sliderLast.appendTo(_sliders);
_label.insertBefore($el);
firstHandle.prependTo(_sliderLast);
$.extend(this,{
_inputFirst:_inputFirst,
_inputLast:_inputLast,
_sliderFirst:_sliderFirst,
_sliderLast:_sliderLast,
_label:_label,
_targetVal:null,
_sliderTarget:false,
_sliders:_sliders,
_proxy:false
});
this.refresh();
this._on(this.element.find("input.ui-slider-input"),{
"slidebeforestart":"_slidebeforestart",
"slidestop":"_slidestop",
"slidedrag":"_slidedrag",
"slidebeforechange":"_change",
"blur":"_change",
"keyup":"_change"
});
this._on({
"mousedown":"_change"
});
this._on(this.element.closest("form"),{
"reset":"_handleReset"
});
this._on(firstHandle,{
"vmousedown":"_dragFirstHandle"
});
},
_handleReset:function(){
var self=this;
setTimeout(function(){
self._updateHighlight();
},0);
},
_dragFirstHandle:function(event){
$.data(this._inputFirst.get(0),"mobile-slider").dragging=true;
$.data(this._inputFirst.get(0),"mobile-slider").refresh(event);
return false;
},
_slidedrag:function(event){
var first=$(event.target).is(this._inputFirst),
otherSlider=(first)?this._inputLast:this._inputFirst;
this._sliderTarget=false;
if((this._proxy==="first"&&first)||(this._proxy==="last"&&!first)){
$.data(otherSlider.get(0),"mobile-slider").dragging=true;
$.data(otherSlider.get(0),"mobile-slider").refresh(event);
return false;
}
},
_slidestop:function(event){
var first=$(event.target).is(this._inputFirst);
this._proxy=false;
this.element.find("input").trigger("vmouseup");
this._sliderFirst.css("z-index",first?1:"");
},
_slidebeforestart:function(event){
this._sliderTarget=false;
if($(event.originalEvent.target).hasClass("ui-slider-track")){
this._sliderTarget=true;
this._targetVal=$(event.target).val();
}
},
_setOptions:function(options){
if(options.theme!==undefined){
this._setTheme(options.theme);
}
if(options.trackTheme!==undefined){
this._setTrackTheme(options.trackTheme);
}
if(options.mini!==undefined){
this._setMini(options.mini);
}
if(options.highlight!==undefined){
this._setHighlight(options.highlight);
}
this._super(options);
this.refresh();
},
refresh:function(){
var $el=this.element,
o=this.options;
if(this._inputFirst.is(":disabled")||this._inputLast.is(":disabled")){
this.options.disabled=true;
}
$el.find("input").slider({
theme:o.theme,
trackTheme:o.trackTheme,
disabled:o.disabled,
corners:o.corners,
mini:o.mini,
highlight:o.highlight
}).slider("refresh");
this._updateHighlight();
},
_change:function(event){
if(event.type==="keyup"){
this._updateHighlight();
return false;
}
var self=this,
min=parseFloat(this._inputFirst.val(),10),
max=parseFloat(this._inputLast.val(),10),
first=$(event.target).hasClass("ui-rangeslider-first"),
thisSlider=first?this._inputFirst:this._inputLast,
otherSlider=first?this._inputLast:this._inputFirst;
if((this._inputFirst.val()>this._inputLast.val()&&event.type==="mousedown"&&!$(event.target).hasClass("ui-slider-handle"))){
thisSlider.blur();
}else if(event.type==="mousedown"){
return;
}
if(min>max&&!this._sliderTarget){
thisSlider.val(first?max:min).slider("refresh");
this._trigger("normalize");
}else if(min>max){
thisSlider.val(this._targetVal).slider("refresh");
setTimeout(function(){
otherSlider.val(first?min:max).slider("refresh");
$.data(otherSlider.get(0),"mobile-slider").handle.focus();
self._sliderFirst.css("z-index",first?"":1);
self._trigger("normalize");
},0);
this._proxy=(first)?"first":"last";
}
if(min===max){
$.data(thisSlider.get(0),"mobile-slider").handle.css("z-index",1);
$.data(otherSlider.get(0),"mobile-slider").handle.css("z-index",0);
}else{
$.data(otherSlider.get(0),"mobile-slider").handle.css("z-index","");
$.data(thisSlider.get(0),"mobile-slider").handle.css("z-index","");
}
this._updateHighlight();
if(min>=max){
return false;
}
},
_updateHighlight:function(){
var min=parseInt($.data(this._inputFirst.get(0),"mobile-slider").handle.get(0).style.left,10),
max=parseInt($.data(this._inputLast.get(0),"mobile-slider").handle.get(0).style.left,10),
width=(max-min);
this.element.find(".ui-slider-bg").css({
"margin-left":min+"%",
"width":width+"%"
});
},
_setTheme:function(value){
this._inputFirst.slider("option","theme",value);
this._inputLast.slider("option","theme",value);
},
_setTrackTheme:function(value){
this._inputFirst.slider("option","trackTheme",value);
this._inputLast.slider("option","trackTheme",value);
},
_setMini:function(value){
this._inputFirst.slider("option","mini",value);
this._inputLast.slider("option","mini",value);
this.element.toggleClass("ui-mini",!!value);
},
_setHighlight:function(value){
this._inputFirst.slider("option","highlight",value);
this._inputLast.slider("option","highlight",value);
},
_destroy:function(){
this._label.prependTo(this.element);
this.element.removeClass("ui-rangeslider ui-mini");
this._inputFirst.after(this._sliderFirst);
this._inputLast.after(this._sliderLast);
this._sliders.remove();
this.element.find("input").removeClass("ui-rangeslider-first ui-rangeslider-last").slider("destroy");
}
},$.mobile.behaviors.formReset));
})(jQuery);
(function($,undefined){
$.widget("mobile.textinput",$.mobile.textinput,{
options:{
clearBtn:false,
clearBtnText:"Clear text"
},
_create:function(){
this._super();
if(!!this.options.clearBtn||this.isSearch){
this._addClearBtn();
}
},
clearButton:function(){
return $("<a href='#' class='ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all"+
"' title='"+this.options.clearBtnText+"'>"+this.options.clearBtnText+"</a>");
},
_clearBtnClick:function(event){
this.element.val("")
.focus()
.trigger("change");
this._clearBtn.addClass("ui-input-clear-hidden");
event.preventDefault();
},
_addClearBtn:function(){
if(!this.options.enhanced){
this._enhanceClear();
}
$.extend(this,{
_clearBtn:this.widget().find("a.ui-input-clear")
});
this._bindClearEvents();
this._toggleClear();
},
_enhanceClear:function(){
this.clearButton().appendTo(this.widget());
this.widget().addClass("ui-input-has-clear");
},
_bindClearEvents:function(){
this._on(this._clearBtn,{
"click":"_clearBtnClick"
});
this._on({
"keyup":"_toggleClear",
"change":"_toggleClear",
"input":"_toggleClear",
"focus":"_toggleClear",
"blur":"_toggleClear",
"cut":"_toggleClear",
"paste":"_toggleClear"
});
},
_unbindClear:function(){
this._off(this._clearBtn,"click");
this._off(this.element,"keyup change input focus blur cut paste");
},
_setOptions:function(options){
this._super(options);
if(options.clearBtn!==undefined&&
!this.element.is("textarea, :jqmData(type='range')")){
if(options.clearBtn){
this._addClearBtn();
}else{
this._destroyClear();
}
}
if(options.clearBtnText!==undefined&&this._clearBtn!==undefined){
this._clearBtn.text(options.clearBtnText)
.attr("title",options.clearBtnText);
}
},
_toggleClear:function(){
this._delay("_toggleClearClass",0);
},
_toggleClearClass:function(){
this._clearBtn.toggleClass("ui-input-clear-hidden",!this.element.val());
},
_destroyClear:function(){
this.widget().removeClass("ui-input-has-clear");
this._unbindClear();
this._clearBtn.remove();
},
_destroy:function(){
this._super();
this._destroyClear();
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.textinput",$.mobile.textinput,{
options:{
autogrow:true,
keyupTimeoutBuffer:100
},
_create:function(){
this._super();
if(this.options.autogrow&&this.isTextarea){
this._autogrow();
}
},
_autogrow:function(){
this.element.addClass("ui-textinput-autogrow");
this._on({
"keyup":"_timeout",
"change":"_timeout",
"input":"_timeout",
"paste":"_timeout"
});
this._on(true,this.document,{
"pageshow":"_handleShow",
"popupbeforeposition":"_handleShow",
"updatelayout":"_handleShow",
"panelopen":"_handleShow"
});
},
_handleShow:function(event){
if($.contains(event.target,this.element[0])&&
this.element.is(":visible")){
if(event.type!=="popupbeforeposition"){
this.element
.addClass("ui-textinput-autogrow-resize")
.animationComplete(
$.proxy(function(){
this.element.removeClass("ui-textinput-autogrow-resize");
},this),
"transition");
}
this._timeout();
}
},
_unbindAutogrow:function(){
this.element.removeClass("ui-textinput-autogrow");
this._off(this.element,"keyup change input paste");
this._off(this.document,
"pageshow popupbeforeposition updatelayout panelopen");
},
keyupTimeout:null,
_prepareHeightUpdate:function(delay){
if(this.keyupTimeout){
clearTimeout(this.keyupTimeout);
}
if(delay===undefined){
this._updateHeight();
}else{
this.keyupTimeout=this._delay("_updateHeight",delay);
}
},
_timeout:function(){
this._prepareHeightUpdate(this.options.keyupTimeoutBuffer);
},
_updateHeight:function(){
var paddingTop,paddingBottom,paddingHeight,scrollHeight,clientHeight,
borderTop,borderBottom,borderHeight,height,
scrollTop=this.window.scrollTop();
this.keyupTimeout=0;
if(!("onpage"in this.element[0])){
this.element.css({
"height":0,
"min-height":0,
"max-height":0
});
}
scrollHeight=this.element[0].scrollHeight;
clientHeight=this.element[0].clientHeight;
borderTop=parseFloat(this.element.css("border-top-width"));
borderBottom=parseFloat(this.element.css("border-bottom-width"));
borderHeight=borderTop+borderBottom;
height=scrollHeight+borderHeight+15;
if(clientHeight===0){
paddingTop=parseFloat(this.element.css("padding-top"));
paddingBottom=parseFloat(this.element.css("padding-bottom"));
paddingHeight=paddingTop+paddingBottom;
height+=paddingHeight;
}
this.element.css({
"height":height,
"min-height":"",
"max-height":""
});
this.window.scrollTop(scrollTop);
},
refresh:function(){
if(this.options.autogrow&&this.isTextarea){
this._updateHeight();
}
},
_setOptions:function(options){
this._super(options);
if(options.autogrow!==undefined&&this.isTextarea){
if(options.autogrow){
this._autogrow();
}else{
this._unbindAutogrow();
}
}
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.selectmenu",$.extend({
initSelector:"select:not( :jqmData(role='slider')):not( :jqmData(role='flipswitch') )",
options:{
theme:null,
icon:"carat-d",
iconpos:"right",
inline:false,
corners:true,
shadow:true,
iconshadow:false,
overlayTheme:null,
dividerTheme:null,
hidePlaceholderMenuItems:true,
closeText:"Close",
nativeMenu:true,
preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,
mini:false
},
_button:function(){
return $("<div/>");
},
_setDisabled:function(value){
this.element.attr("disabled",value);
this.button.attr("aria-disabled",value);
return this._setOption("disabled",value);
},
_focusButton:function(){
var self=this;
setTimeout(function(){
self.button.focus();
},40);
},
_selectOptions:function(){
return this.select.find("option");
},
_preExtension:function(){
var inline=this.options.inline||this.element.jqmData("inline"),
mini=this.options.mini||this.element.jqmData("mini"),
classes="";

if(!!~this.element[0].className.indexOf("ui-btn-left")){
classes=" ui-btn-left";
}
if(!!~this.element[0].className.indexOf("ui-btn-right")){
classes=" ui-btn-right";
}
if(inline){
classes+=" ui-btn-inline";
}
if(mini){
classes+=" ui-mini";
}
this.select=this.element.removeClass("ui-btn-left ui-btn-right").wrap("<div class='ui-select"+classes+"'>");
this.selectId=this.select.attr("id")||("select-"+this.uuid);
this.buttonId=this.selectId+"-button";
this.label=$("label[for='"+this.selectId+"']");
this.isMultiple=this.select[0].multiple;
},
_destroy:function(){
var wrapper=this.element.parents(".ui-select");
if(wrapper.length>0){
if(wrapper.is(".ui-btn-left, .ui-btn-right")){
this.element.addClass(wrapper.hasClass("ui-btn-left")?"ui-btn-left":"ui-btn-right");
}
this.element.insertAfter(wrapper);
wrapper.remove();
}
},
_create:function(){
this._preExtension();
this.button=this._button();
var self=this,
options=this.options,
iconpos=options.icon?(options.iconpos||this.select.jqmData("iconpos")):false,
button=this.button
.insertBefore(this.select)
.attr("id",this.buttonId)
.addClass("ui-btn"+
(options.icon?(" ui-icon-"+options.icon+" ui-btn-icon-"+iconpos+
(options.iconshadow?" ui-shadow-icon":"")):"")+
(options.theme?" ui-btn-"+options.theme:"")+
(options.corners?" ui-corner-all":"")+
(options.shadow?" ui-shadow":""));
this.setButtonText();
if(options.nativeMenu&&window.opera&&window.opera.version){
button.addClass("ui-select-nativeonly");
}
if(this.isMultiple){
this.buttonCount=$("<span>")
.addClass("ui-li-count ui-body-inherit")
.hide()
.appendTo(button.addClass("ui-li-has-count"));
}
if(options.disabled||this.element.attr("disabled")){
this.disable();
}
this.select.change(function(){
self.refresh();
if(!!options.nativeMenu){
this.blur();
}
});
this._handleFormReset();
this._on(this.button,{
keydown:"_handleKeydown"
});
this.build();
},
build:function(){
var self=this;
this.select
.appendTo(self.button)
.bind("vmousedown",function(){
self.button.addClass($.mobile.activeBtnClass);
})
.bind("focus",function(){
self.button.addClass($.mobile.focusClass);
})
.bind("blur",function(){
self.button.removeClass($.mobile.focusClass);
})
.bind("focus vmouseover",function(){
self.button.trigger("vmouseover");
})
.bind("vmousemove",function(){
self.button.removeClass($.mobile.activeBtnClass);
})
.bind("change blur vmouseout",function(){
self.button.trigger("vmouseout")
.removeClass($.mobile.activeBtnClass);
});
self.button.bind("vmousedown",function(){
if(self.options.preventFocusZoom){
$.mobile.zoom.disable(true);
}
});
self.label.bind("click focus",function(){
if(self.options.preventFocusZoom){
$.mobile.zoom.disable(true);
}
});
self.select.bind("focus",function(){
if(self.options.preventFocusZoom){
$.mobile.zoom.disable(true);
}
});
self.button.bind("mouseup",function(){
if(self.options.preventFocusZoom){
setTimeout(function(){
$.mobile.zoom.enable(true);
},0);
}
});
self.select.bind("blur",function(){
if(self.options.preventFocusZoom){
$.mobile.zoom.enable(true);
}
});
},
selected:function(){
return this._selectOptions().filter(":selected");
},
selectedIndices:function(){
var self=this;
return this.selected().map(function(){
return self._selectOptions().index(this);
}).get();
},
setButtonText:function(){
var self=this,
selected=this.selected(),
text=this.placeholder,
span=$(document.createElement("span"));
this.button.children("span").not(".ui-li-count").remove().end().end().prepend((function(){
if(selected.length){
text=selected.map(function(){
return $(this).text();
}).get().join(", ");
}else{
text=self.placeholder;
}
if(text){
span.text(text);
}else{
span.html("&#160;");
}
return span
.addClass(self.select.attr("class"))
.addClass(selected.attr("class"))
.removeClass("ui-screen-hidden");
})());
},
setButtonCount:function(){
var selected=this.selected();
if(this.isMultiple){
this.buttonCount[selected.length>1?"show":"hide"]().text(selected.length);
}
},
_handleKeydown:function(){
this._delay("_refreshButton");
},
_reset:function(){
this.refresh();
},
_refreshButton:function(){
this.setButtonText();
this.setButtonCount();
},
refresh:function(){
this._refreshButton();
},
open:$.noop,
close:$.noop,
disable:function(){
this._setDisabled(true);
this.button.addClass("ui-state-disabled");
},
enable:function(){
this._setDisabled(false);
this.button.removeClass("ui-state-disabled");
}
},$.mobile.behaviors.formReset));
})(jQuery);
(function($,undefined){
$.mobile.links=function(target){
$(target)
.find("a")
.jqmEnhanceable()
.filter(":jqmData(rel='popup')[href][href!='']")
.each(function(){
var element=this,
idref=element.getAttribute("href").substring(1);
if(idref){
element.setAttribute("aria-haspopup",true);
element.setAttribute("aria-owns",idref);
element.setAttribute("aria-expanded",false);
}
})
.end()
.not(".ui-btn, :jqmData(role='none'), :jqmData(role='nojs')")
.addClass("ui-link");
};
})(jQuery);
(function($,undefined){
function fitSegmentInsideSegment(windowSize,segmentSize,offset,desired){
var returnValue=desired;
if(windowSize<segmentSize){
returnValue=offset+(windowSize-segmentSize)/2;
}else{
returnValue=Math.min(Math.max(offset,desired-segmentSize/2),offset+windowSize-segmentSize);
}
return returnValue;
}
function getWindowCoordinates(theWindow){
return{
x:theWindow.scrollLeft(),
y:theWindow.scrollTop(),
cx:(theWindow[0].innerWidth||theWindow.width()),
cy:(theWindow[0].innerHeight||theWindow.height())
};
}
$.widget("mobile.popup",{
options:{
wrapperClass:null,
theme:null,
overlayTheme:null,
shadow:true,
corners:true,
transition:"none",
positionTo:"origin",
tolerance:null,
closeLinkSelector:"a:jqmData(rel='back')",
closeLinkEvents:"click.popup",
navigateEvents:"navigate.popup",
closeEvents:"navigate.popup pagebeforechange.popup",
dismissible:true,
enhanced:false,
history:!$.mobile.browser.oldIE
},
_create:function(){
var theElement=this.element,
myId=theElement.attr("id"),
currentOptions=this.options;
currentOptions.history=currentOptions.history&&$.mobile.ajaxEnabled&&$.mobile.hashListeningEnabled;
$.extend(this,{
_scrollTop:0,
_page:theElement.closest(".ui-page"),
_ui:null,
_fallbackTransition:"",
_currentTransition:false,
_prerequisites:null,
_isOpen:false,
_tolerance:null,
_resizeData:null,
_ignoreResizeTo:0,
_orientationchangeInProgress:false
});
if(this._page.length===0){
this._page=$("body");
}
if(currentOptions.enhanced){
this._ui={
container:theElement.parent(),
screen:theElement.parent().prev(),
placeholder:$(this.document[0].getElementById(myId+"-placeholder"))
};
}else{
this._ui=this._enhance(theElement,myId);
this._applyTransition(currentOptions.transition);
}
this
._setTolerance(currentOptions.tolerance)
._ui.focusElement=this._ui.container;
this._on(this._ui.screen,{"vclick":"_eatEventAndClose"});
this._on(this.window,{
orientationchange:$.proxy(this,"_handleWindowOrientationchange"),
resize:$.proxy(this,"_handleWindowResize"),
keyup:$.proxy(this,"_handleWindowKeyUp")
});
this._on(this.document,{"focusin":"_handleDocumentFocusIn"});
},
_enhance:function(theElement,myId){
var currentOptions=this.options,
wrapperClass=currentOptions.wrapperClass,
ui={
screen:$("<div class='ui-screen-hidden ui-popup-screen "+
this._themeClassFromOption("ui-overlay-",currentOptions.overlayTheme)+"'></div>"),
placeholder:$("<div style='display: none;'><!-- placeholder --></div>"),
container:$("<div class='ui-popup-container ui-popup-hidden ui-popup-truncate"+
(wrapperClass?(" "+wrapperClass):"")+"'></div>")
},
fragment=this.document[0].createDocumentFragment();
fragment.appendChild(ui.screen[0]);
fragment.appendChild(ui.container[0]);
if(myId){
ui.screen.attr("id",myId+"-screen");
ui.container.attr("id",myId+"-popup");
ui.placeholder
.attr("id",myId+"-placeholder")
.html("<!-- placeholder for "+myId+" -->");
}
this._page[0].appendChild(fragment);
ui.placeholder.insertAfter(theElement);
theElement
.detach()
.addClass("ui-popup "+
this._themeClassFromOption("ui-body-",currentOptions.theme)+" "+
(currentOptions.shadow?"ui-overlay-shadow ":"")+
(currentOptions.corners?"ui-corner-all ":""))
.appendTo(ui.container);
return ui;
},
_eatEventAndClose:function(theEvent){
theEvent.preventDefault();
theEvent.stopImmediatePropagation();
if(this.options.dismissible){
this.close();
}
return false;
},
_resizeScreen:function(){
var screen=this._ui.screen,
popupHeight=this._ui.container.outerHeight(true),
screenHeight=screen.removeAttr("style").height(),
documentHeight=this.document.height()-1;
if(screenHeight<documentHeight){
screen.height(documentHeight);
}else if(popupHeight>screenHeight){
screen.height(popupHeight);
}
},
_handleWindowKeyUp:function(theEvent){
if(this._isOpen&&theEvent.keyCode===$.mobile.keyCode.ESCAPE){
return this._eatEventAndClose(theEvent);
}
},
_expectResizeEvent:function(){
var windowCoordinates=getWindowCoordinates(this.window);
if(this._resizeData){
if(windowCoordinates.x===this._resizeData.windowCoordinates.x&&
windowCoordinates.y===this._resizeData.windowCoordinates.y&&
windowCoordinates.cx===this._resizeData.windowCoordinates.cx&&
windowCoordinates.cy===this._resizeData.windowCoordinates.cy){
return false;
}else{
clearTimeout(this._resizeData.timeoutId);
}
}
this._resizeData={
timeoutId:this._delay("_resizeTimeout",200),
windowCoordinates:windowCoordinates
};
return true;
},
_resizeTimeout:function(){
if(this._isOpen){
if(!this._expectResizeEvent()){
if(this._ui.container.hasClass("ui-popup-hidden")){
this._ui.container.removeClass("ui-popup-hidden ui-popup-truncate");
this.reposition({positionTo:"window"});
this._ignoreResizeEvents();
}
this._resizeScreen();
this._resizeData=null;
this._orientationchangeInProgress=false;
}
}else{
this._resizeData=null;
this._orientationchangeInProgress=false;
}
},
_stopIgnoringResizeEvents:function(){
this._ignoreResizeTo=0;
},
_ignoreResizeEvents:function(){
if(this._ignoreResizeTo){
clearTimeout(this._ignoreResizeTo);
}
this._ignoreResizeTo=this._delay("_stopIgnoringResizeEvents",1000);
},
_handleWindowResize:function(){
if(this._isOpen&&this._ignoreResizeTo===0){
if((this._expectResizeEvent()||this._orientationchangeInProgress)&&
!this._ui.container.hasClass("ui-popup-hidden")){
this._ui.container
.addClass("ui-popup-hidden ui-popup-truncate")
.removeAttr("style");
}
}
},
_handleWindowOrientationchange:function(){
if(!this._orientationchangeInProgress&&this._isOpen&&this._ignoreResizeTo===0){
this._expectResizeEvent();
this._orientationchangeInProgress=true;
}
},
_handleDocumentFocusIn:function(theEvent){
var target,
targetElement=theEvent.target,
ui=this._ui;
if(!this._isOpen){
return;
}
if(targetElement!==ui.container[0]){
target=$(targetElement);
if(0===target.parents().filter(ui.container[0]).length){
$(this.document[0].activeElement).one("focus",function(){
target.blur();
});
ui.focusElement.focus();
theEvent.preventDefault();
theEvent.stopImmediatePropagation();
return false;
}else if(ui.focusElement[0]===ui.container[0]){
ui.focusElement=target;
}
}
this._ignoreResizeEvents();
},
_themeClassFromOption:function(prefix,value){
return(value?(value==="none"?"":(prefix+value)):(prefix+"inherit"));
},
_applyTransition:function(value){
if(value){
this._ui.container.removeClass(this._fallbackTransition);
if(value!=="none"){
this._fallbackTransition=$.mobile._maybeDegradeTransition(value);
if(this._fallbackTransition==="none"){
this._fallbackTransition="";
}
this._ui.container.addClass(this._fallbackTransition);
}
}
return this;
},
_setOptions:function(newOptions){
var currentOptions=this.options,
theElement=this.element,
screen=this._ui.screen;
if(newOptions.wrapperClass!==undefined){
this._ui.container
.removeClass(currentOptions.wrapperClass)
.addClass(newOptions.wrapperClass);
}
if(newOptions.theme!==undefined){
theElement
.removeClass(this._themeClassFromOption("ui-body-",currentOptions.theme))
.addClass(this._themeClassFromOption("ui-body-",newOptions.theme));
}
if(newOptions.overlayTheme!==undefined){
screen
.removeClass(this._themeClassFromOption("ui-overlay-",currentOptions.overlayTheme))
.addClass(this._themeClassFromOption("ui-overlay-",newOptions.overlayTheme));
if(this._isOpen){
screen.addClass("in");
}
}
if(newOptions.shadow!==undefined){
theElement.toggleClass("ui-overlay-shadow",newOptions.shadow);
}
if(newOptions.corners!==undefined){
theElement.toggleClass("ui-corner-all",newOptions.corners);
}
if(newOptions.transition!==undefined){
if(!this._currentTransition){
this._applyTransition(newOptions.transition);
}
}
if(newOptions.tolerance!==undefined){
this._setTolerance(newOptions.tolerance);
}
if(newOptions.disabled!==undefined){
if(newOptions.disabled){
this.close();
}
}
return this._super(newOptions);
},
_setTolerance:function(value){
var tol={t:30,r:15,b:30,l:15},
ar;
if(value!==undefined){
ar=String(value).split(",");
$.each(ar,function(idx,val){ar[idx]=parseInt(val,10)});
switch(ar.length){
case 1:
if(!isNaN(ar[0])){
tol.t=tol.r=tol.b=tol.l=ar[0];
}
break;
case 2:
if(!isNaN(ar[0])){
tol.t=tol.b=ar[0];
}
if(!isNaN(ar[1])){
tol.l=tol.r=ar[1];
}
break;
case 4:
if(!isNaN(ar[0])){
tol.t=ar[0];
}
if(!isNaN(ar[1])){
tol.r=ar[1];
}
if(!isNaN(ar[2])){
tol.b=ar[2];
}
if(!isNaN(ar[3])){
tol.l=ar[3];
}
break;
default:
break;
}
}
this._tolerance=tol;
return this;
},
_clampPopupWidth:function(infoOnly){
var menuSize,
windowCoordinates=getWindowCoordinates(this.window),
rectangle={
x:this._tolerance.l,
y:windowCoordinates.y+this._tolerance.t,
cx:windowCoordinates.cx-this._tolerance.l-this._tolerance.r,
cy:windowCoordinates.cy-this._tolerance.t-this._tolerance.b
};
if(!infoOnly){
this._ui.container.css("max-width",rectangle.cx);
}
menuSize={
cx:this._ui.container.outerWidth(true),
cy:this._ui.container.outerHeight(true)
};
return{rc:rectangle,menuSize:menuSize};
},
_calculateFinalLocation:function(desired,clampInfo){
var returnValue,
rectangle=clampInfo.rc,
menuSize=clampInfo.menuSize;
returnValue={
left:fitSegmentInsideSegment(rectangle.cx,menuSize.cx,rectangle.x,desired.x),
top:fitSegmentInsideSegment(rectangle.cy,menuSize.cy,rectangle.y,desired.y)
};
returnValue.top=Math.max(0,returnValue.top);
returnValue.top-=Math.min(returnValue.top,
Math.max(0,returnValue.top+menuSize.cy-this.document.height()));
return returnValue;
},
_placementCoords:function(desired){
return this._calculateFinalLocation(desired,this._clampPopupWidth());
},
_createPrerequisites:function(screenPrerequisite,containerPrerequisite,whenDone){
var prerequisites,
self=this;
prerequisites={
screen:$.Deferred(),
container:$.Deferred()
};
prerequisites.screen.then(function(){
if(prerequisites===self._prerequisites){
screenPrerequisite();
}
});
prerequisites.container.then(function(){
if(prerequisites===self._prerequisites){
containerPrerequisite();
}
});
$.when(prerequisites.screen,prerequisites.container).done(function(){
if(prerequisites===self._prerequisites){
self._prerequisites=null;
whenDone();
}
});
self._prerequisites=prerequisites;
},
_animate:function(args){
this._ui.screen
.removeClass(args.classToRemove)
.addClass(args.screenClassToAdd);
args.prerequisites.screen.resolve();
if(args.transition&&args.transition!=="none"){
if(args.applyTransition){
this._applyTransition(args.transition);
}
if(this._fallbackTransition){
this._ui.container
.addClass(args.containerClassToAdd)
.removeClass(args.classToRemove)
.animationComplete($.proxy(args.prerequisites.container,"resolve"));
return;
}
}
this._ui.container.removeClass(args.classToRemove);
args.prerequisites.container.resolve();
},
_desiredCoords:function(openOptions){
var offset,
dst=null,
windowCoordinates=getWindowCoordinates(this.window),
x=openOptions.x,
y=openOptions.y,
pTo=openOptions.positionTo;
if(pTo&&pTo!=="origin"){
if(pTo==="window"){
x=windowCoordinates.cx/2+windowCoordinates.x;
y=windowCoordinates.cy/2+windowCoordinates.y;
}else{
try{
dst=$(pTo);
}catch(err){
dst=null;
}
if(dst){
dst.filter(":visible");
if(dst.length===0){
dst=null;
}
}
}
}
if(dst){
offset=dst.offset();
x=offset.left+dst.outerWidth()/2;
y=offset.top+dst.outerHeight()/2;
}
if($.type(x)!=="number"||isNaN(x)){
x=windowCoordinates.cx/2+windowCoordinates.x;
}
if($.type(y)!=="number"||isNaN(y)){
y=windowCoordinates.cy/2+windowCoordinates.y;
}
return{x:x,y:y};
},
_reposition:function(openOptions){
openOptions={
x:openOptions.x,
y:openOptions.y,
positionTo:openOptions.positionTo
};
this._trigger("beforeposition",undefined,openOptions);
this._ui.container.offset(this._placementCoords(this._desiredCoords(openOptions)));
},
reposition:function(openOptions){
if(this._isOpen){
this._reposition(openOptions);
}
},
_openPrerequisitesComplete:function(){
var id=this.element.attr("id");
this._ui.container.addClass("ui-popup-active");
this._isOpen=true;
this._resizeScreen();
this._ui.container.attr("tabindex","0").focus();
this._ignoreResizeEvents();
if(id){
this.document.find("[aria-haspopup='true'][aria-owns='"+id+"']").attr("aria-expanded",true);
}
this._trigger("afteropen");
},
_open:function(options){
var openOptions=$.extend({},this.options,options),
androidBlacklist=(function(){
var ua=navigator.userAgent,
wkmatch=ua.match(/AppleWebKit\/([0-9\.]+)/),
wkversion=!!wkmatch&&wkmatch[1],
androidmatch=ua.match(/Android (\d+(?:\.\d+))/),
andversion=!!androidmatch&&androidmatch[1],
chromematch=ua.indexOf("Chrome")>-1;
if(androidmatch!==null&&andversion==="4.0"&&wkversion&&wkversion>534.13&&!chromematch){
return true;
}
return false;
}());
this._createPrerequisites(
$.noop,
$.noop,
$.proxy(this,"_openPrerequisitesComplete"));
this._currentTransition=openOptions.transition;
this._applyTransition(openOptions.transition);
this._ui.screen.removeClass("ui-screen-hidden");
this._ui.container.removeClass("ui-popup-truncate");
this._reposition(openOptions);
this._ui.container.removeClass("ui-popup-hidden");
if(this.options.overlayTheme&&androidBlacklist){

this.element.closest(".ui-page").addClass("ui-popup-open");
}
this._animate({
additionalCondition:true,
transition:openOptions.transition,
classToRemove:"",
screenClassToAdd:"in",
containerClassToAdd:"in",
applyTransition:false,
prerequisites:this._prerequisites
});
},
_closePrerequisiteScreen:function(){
this._ui.screen
.removeClass("out")
.addClass("ui-screen-hidden");
},
_closePrerequisiteContainer:function(){
this._ui.container
.removeClass("reverse out")
.addClass("ui-popup-hidden ui-popup-truncate")
.removeAttr("style");
},
_closePrerequisitesDone:function(){
var container=this._ui.container,
id=this.element.attr("id");
container.removeAttr("tabindex");
$.mobile.popup.active=undefined;
$(":focus",container[0]).add(container[0]).blur();
if(id){
this.document.find("[aria-haspopup='true'][aria-owns='"+id+"']").attr("aria-expanded",false);
}
this._trigger("afterclose");
},
_close:function(immediate){
this._ui.container.removeClass("ui-popup-active");
this._page.removeClass("ui-popup-open");
this._isOpen=false;
this._createPrerequisites(
$.proxy(this,"_closePrerequisiteScreen"),
$.proxy(this,"_closePrerequisiteContainer"),
$.proxy(this,"_closePrerequisitesDone"));
this._animate({
additionalCondition:this._ui.screen.hasClass("in"),
transition:(immediate?"none":(this._currentTransition)),
classToRemove:"in",
screenClassToAdd:"out",
containerClassToAdd:"reverse out",
applyTransition:true,
prerequisites:this._prerequisites
});
},
_unenhance:function(){
if(this.options.enhanced){
return;
}
this._setOptions({theme:$.mobile.popup.prototype.options.theme});
this.element
.detach()
.insertAfter(this._ui.placeholder)
.removeClass("ui-popup ui-overlay-shadow ui-corner-all ui-body-inherit");
this._ui.screen.remove();
this._ui.container.remove();
this._ui.placeholder.remove();
},
_destroy:function(){
if($.mobile.popup.active===this){
this.element.one("popupafterclose",$.proxy(this,"_unenhance"));
this.close();
}else{
this._unenhance();
}
return this;
},
_closePopup:function(theEvent,data){
var parsedDst,toUrl,
currentOptions=this.options,
immediate=false;
if((theEvent&&theEvent.isDefaultPrevented())||$.mobile.popup.active!==this){
return;
}
window.scrollTo(0,this._scrollTop);
if(theEvent&&theEvent.type==="pagebeforechange"&&data){
if(typeof data.toPage==="string"){
parsedDst=data.toPage;
}else{
parsedDst=data.toPage.jqmData("url");
}
parsedDst=$.mobile.path.parseUrl(parsedDst);
toUrl=parsedDst.pathname+parsedDst.search+parsedDst.hash;
if(this._myUrl!==$.mobile.path.makeUrlAbsolute(toUrl)){
immediate=true;
}else{
theEvent.preventDefault();
}
}
this.window.off(currentOptions.closeEvents);
this.element.undelegate(currentOptions.closeLinkSelector,currentOptions.closeLinkEvents);
if(jqmAllowPopUpClosing){
this._close(immediate);
}},
_bindContainerClose:function(){
this.window
.on(this.options.closeEvents,$.proxy(this,"_closePopup")
);
},
widget:function(){
return this._ui.container;
},
open:function(options){
var url,hashkey,activePage,currentIsDialog,hasHash,urlHistory,
self=this,
currentOptions=this.options;
if($.mobile.popup.active||currentOptions.disabled){
return this;
}
$.mobile.popup.active=this;
this._scrollTop=this.window.scrollTop();
if(!(currentOptions.history)){
self._open(options);
self._bindContainerClose();
self.element
.delegate(currentOptions.closeLinkSelector,currentOptions.closeLinkEvents,function(theEvent){
self.close();
theEvent.preventDefault();
});
return this;
}
urlHistory=$.mobile.navigate.history;
hashkey=$.mobile.dialogHashKey;
activePage=$.mobile.activePage;
currentIsDialog=(activePage?activePage.hasClass("ui-dialog"):false);
this._myUrl=url=urlHistory.getActive().url;
hasHash=(url.indexOf(hashkey)>-1)&&!currentIsDialog&&(urlHistory.activeIndex>0);
if(hasHash){
self._open(options);
self._bindContainerClose();
return this;
}
if(url.indexOf(hashkey)===-1&&!currentIsDialog){
url=url+(url.indexOf("#")>-1?hashkey:"#"+hashkey);
}else{
url=$.mobile.path.parseLocation().hash+hashkey;
}
if(urlHistory.activeIndex===0&&url===urlHistory.initialDst){
url+=hashkey;
}
this.window.one("beforenavigate",function(theEvent){
theEvent.preventDefault();
self._open(options);
self._bindContainerClose();
});
this.urlAltered=true;
$.mobile.navigate(url,{role:"dialog"});
return this;
},
close:function(){
if($.mobile.popup.active!==this){
return this;
}
this._scrollTop=this.window.scrollTop();
if(this.options.history&&this.urlAltered){
$.mobile.back();
this.urlAltered=false;
}else{
this._closePopup();
}
return this;
}
});
$.mobile.popup.handleLink=function($link){
var offset,
path=$.mobile.path,
popup=$(path.hashToSelector(path.parseUrl($link.attr("href")).hash)).first();
if(popup.length>0&&popup.data("mobile-popup")){
offset=$link.offset();
popup.popup("open",{
x:offset.left+$link.outerWidth()/2,
y:offset.top+$link.outerHeight()/2,
transition:$link.jqmData("transition"),
positionTo:$link.jqmData("position-to")
});
}
setTimeout(function(){
$link.removeClass($.mobile.activeBtnClass);
},300);
};
$.mobile.document.on("pagebeforechange",function(theEvent,data){
if(data.options.role==="popup"){
$.mobile.popup.handleLink(data.options.link);
theEvent.preventDefault();
}
});
})(jQuery);

(function($,undefined){
var unfocusableItemSelector=".ui-disabled,.ui-state-disabled,.ui-li-divider,.ui-screen-hidden,:jqmData(role='placeholder')",
goToAdjacentItem=function(item,target,direction){
var adjacent=item[direction+"All"]()
.not(unfocusableItemSelector)
.first();
if(adjacent.length){
target
.blur()
.attr("tabindex","-1");
adjacent.find("a").first().focus();
}
};
$.widget("mobile.selectmenu",$.mobile.selectmenu,{
_create:function(){
var o=this.options;
o.nativeMenu=o.nativeMenu||(this.element.parents(":jqmData(role='popup'),:mobile-popup").length>0);
return this._super();
},
_handleSelectFocus:function(){
this.element.blur();
this.button.focus();
},
_handleKeydown:function(event){
this._super(event);
this._handleButtonVclickKeydown(event);
},
_handleButtonVclickKeydown:function(event){
if(this.options.disabled||this.isOpen){
return;
}
if(event.type==="vclick"||
event.keyCode&&(event.keyCode===$.mobile.keyCode.ENTER||event.keyCode===$.mobile.keyCode.SPACE)){
this._decideFormat();
if(this.menuType==="overlay"){
this.button.attr("href","#"+this.popupId).attr("data-"+($.mobile.ns||"")+"rel","popup");
}else{
this.button.attr("href","#"+this.dialogId).attr("data-"+($.mobile.ns||"")+"rel","dialog");
}
this.isOpen=true;
}
},
_handleListFocus:function(e){
var params=(e.type==="focusin")?
{tabindex:"0",event:"vmouseover"}:
{tabindex:"-1",event:"vmouseout"};
$(e.target)
.attr("tabindex",params.tabindex)
.trigger(params.event);
},
_handleListKeydown:function(event){
var target=$(event.target),
li=target.closest("li");
switch(event.keyCode){
case 38:
goToAdjacentItem(li,target,"prev");
return false;
case 40:
goToAdjacentItem(li,target,"next");
return false;
case 13:
case 32:
target.trigger("click");
return false;
}
},
_handleMenuPageHide:function(){
this.thisPage.page("bindRemove");
},
_handleHeaderCloseClick:function(){
if(this.menuType==="overlay"){
this.close();
return false;
}
},
build:function(){
var selectId,popupId,dialogId,label,thisPage,isMultiple,menuId,
themeAttr,overlayTheme,overlayThemeAttr,dividerThemeAttr,
menuPage,listbox,list,header,headerTitle,menuPageContent,
menuPageClose,headerClose,self,
o=this.options;
if(o.nativeMenu){
return this._super();
}
self=this;
selectId=this.selectId;
popupId=selectId+"-listbox";
dialogId=selectId+"-dialog";
label=this.label;
thisPage=this.element.closest(".ui-page");
isMultiple=this.element[0].multiple;
menuId=selectId+"-menu";
themeAttr=o.theme?(" data-"+$.mobile.ns+"theme='"+o.theme+"'"):"";
overlayTheme=o.overlayTheme||o.theme||null;
overlayThemeAttr=overlayTheme?(" data-"+$.mobile.ns+
"overlay-theme='"+overlayTheme+"'"):"";
dividerThemeAttr=(o.dividerTheme&&isMultiple)?(" data-"+$.mobile.ns+"divider-theme='"+o.dividerTheme+"'"):"";
menuPage=$("<div data-"+$.mobile.ns+"role='dialog' class='ui-selectmenu' id='"+dialogId+"'"+themeAttr+overlayThemeAttr+">"+
"<div data-"+$.mobile.ns+"role='header'>"+
"<div class='ui-title'>"+label.getEncodedText()+"</div>"+
"</div>"+
"<div data-"+$.mobile.ns+"role='content'></div>"+
"</div>");
listbox=$("<div id='"+popupId+"' class='ui-selectmenu'></div>").insertAfter(this.select).popup({theme:o.overlayTheme});
list=$("<ul class='ui-selectmenu-list' id='"+menuId+"' role='listbox' aria-labelledby='"+this.buttonId+"'"+themeAttr+dividerThemeAttr+"></ul>").appendTo(listbox);
header=$("<div class='ui-header ui-bar-"+(o.theme?o.theme:"inherit")+"'></div>").prependTo(listbox);
headerTitle=$("<h1 class='ui-title'></h1>").appendTo(header);
if(this.isMultiple){
headerClose=$("<a>",{
"role":"button",
"text":o.closeText,
"href":"#",
"class":"ui-btn ui-corner-all ui-btn-left ui-btn-icon-notext ui-icon-delete"
}).appendTo(header);
}
$.extend(this,{
selectId:selectId,
menuId:menuId,
popupId:popupId,
dialogId:dialogId,
thisPage:thisPage,
menuPage:menuPage,
label:label,
isMultiple:isMultiple,
theme:o.theme,
listbox:listbox,
list:list,
header:header,
headerTitle:headerTitle,
headerClose:headerClose,
menuPageContent:menuPageContent,
menuPageClose:menuPageClose,
placeholder:""
});
this.refresh();
if(this._origTabIndex===undefined){
this._origTabIndex=(this.select[0].getAttribute("tabindex")===null)?false:this.select.attr("tabindex");
}
this.select.attr("tabindex","-1");
this._on(this.select,{focus:"_handleSelectFocus"});
this._on(this.button,{
vclick:"_handleButtonVclickKeydown"
});
this.list.attr("role","listbox");
this._on(this.list,{
focusin:"_handleListFocus",
focusout:"_handleListFocus",
keydown:"_handleListKeydown"
});
this.list
.delegate("li:not(.ui-disabled,.ui-state-disabled,.ui-li-divider)","click",function(event){
var oldIndex=self.select[0].selectedIndex,
newIndex=$.mobile.getAttribute(this,"option-index"),
option=self._selectOptions().eq(newIndex)[0];
option.selected=self.isMultiple?!option.selected:true;
if(self.isMultiple){
$(this).find("a")
.toggleClass("ui-checkbox-on",option.selected)
.toggleClass("ui-checkbox-off",!option.selected);
}
if(self.isMultiple||oldIndex!==newIndex){
self.select.trigger("change");
}
if(self.isMultiple){
self.list.find("li:not(.ui-li-divider)").eq(newIndex)
.find("a").first().focus();
}
else{
self.close();
}
event.preventDefault();
});
this._on(this.menuPage,{pagehide:"_handleMenuPageHide"});
this._on(this.listbox,{popupafterclose:"close"});
if(this.isMultiple){
this._on(this.headerClose,{click:"_handleHeaderCloseClick"});
}
return this;
},
_isRebuildRequired:function(){
var list=this.list.find("li"),
options=this._selectOptions().not(".ui-screen-hidden");
return options.text()!==list.text();
},
selected:function(){
return this._selectOptions().filter(":selected:not( :jqmData(placeholder='true') )");
},
refresh:function(force){
var self,indices;
if(this.options.nativeMenu){
return this._super(force);
}
self=this;
if(force||this._isRebuildRequired()){
self._buildList();
}
indices=this.selectedIndices();
self.setButtonText();
self.setButtonCount();
self.list.find("li:not(.ui-li-divider)")
.find("a").removeClass($.mobile.activeBtnClass).end()
.attr("aria-selected",false)
.each(function(i){
if($.inArray(i,indices)>-1){
var item=$(this);
item.attr("aria-selected",true);
if(self.isMultiple){
item.find("a").removeClass("ui-checkbox-off").addClass("ui-checkbox-on");
}else{
if(item.hasClass("ui-screen-hidden")){
item.next().find("a").addClass($.mobile.activeBtnClass);
}else{
item.find("a").addClass($.mobile.activeBtnClass);
}
}
}
});
},
close:function(){
if(this.options.disabled||!this.isOpen){
return;
}
var self=this;
if(self.menuType==="page"){
self.menuPage.dialog("close");
self.list.appendTo(self.listbox);
}else{
self.listbox.popup("close");
}
self._focusButton();
self.isOpen=false;
},
open:function(){
this.button.click();
},
_focusMenuItem:function(){
var selector=this.list.find("a."+$.mobile.activeBtnClass);
if(selector.length===0){
selector=this.list.find("li:not("+unfocusableItemSelector+") a.ui-btn");
}
selector.first().focus();
},
_decideFormat:function(){
var self=this,
$window=this.window,
selfListParent=self.list.parent(),
menuHeight=selfListParent.outerHeight(),
scrollTop=$window.scrollTop(),
btnOffset=self.button.offset().top,
screenHeight=$window.height();
if(menuHeight>screenHeight-80||!$.support.scrollTop){
self.menuPage.appendTo($.mobile.pageContainer).page();
self.menuPageContent=self.menuPage.find(".ui-content");
self.menuPageClose=self.menuPage.find(".ui-header a");
self.thisPage.unbind("pagehide.remove");
if(scrollTop===0&&btnOffset>screenHeight){
self.thisPage.one("pagehide",function(){
$(this).jqmData("lastScroll",btnOffset);
});
}
self.menuPage.one({
pageshow:$.proxy(this,"_focusMenuItem"),
pagehide:$.proxy(this,"close")
});
self.menuType="page";
self.menuPageContent.append(self.list);
self.menuPage.find("div .ui-title").text(self.label.text());
}else{
self.menuType="overlay";
self.listbox.one({popupafteropen:$.proxy(this,"_focusMenuItem")});
}
},
_buildList:function(){
var self=this,
o=this.options,
placeholder=this.placeholder,
needPlaceholder=true,
dataIcon="false",
$options,numOptions,select,
dataPrefix="data-"+$.mobile.ns,
dataIndexAttr=dataPrefix+"option-index",
dataIconAttr=dataPrefix+"icon",
dataRoleAttr=dataPrefix+"role",
dataPlaceholderAttr=dataPrefix+"placeholder",
fragment=document.createDocumentFragment(),
isPlaceholderItem=false,
optGroup,
i,
option,$option,parent,text,anchor,classes,
optLabel,divider,item;
self.list.empty().filter(".ui-listview").listview("destroy");
$options=this._selectOptions();
numOptions=$options.length;
select=this.select[0];
for(i=0;i<numOptions;i++,isPlaceholderItem=false){
option=$options[i];
$option=$(option);
if($option.hasClass("ui-screen-hidden")){
continue;
}
parent=option.parentNode;
text=$option.text();
anchor=document.createElement("a");
classes=[];
anchor.setAttribute("href","#");
anchor.appendChild(document.createTextNode(text));
if(parent!==select&&parent.nodeName.toLowerCase()==="optgroup"){
optLabel=parent.getAttribute("label");
if(optLabel!==optGroup){
divider=document.createElement("li");
divider.setAttribute(dataRoleAttr,"list-divider");
divider.setAttribute("role","option");
divider.setAttribute("tabindex","-1");
divider.appendChild(document.createTextNode(optLabel));
fragment.appendChild(divider);
optGroup=optLabel;
}
}
if(needPlaceholder&&(!option.getAttribute("value")||text.length===0||$option.jqmData("placeholder"))){
needPlaceholder=false;
isPlaceholderItem=true;
if(null===option.getAttribute(dataPlaceholderAttr)){
this._removePlaceholderAttr=true;
}
option.setAttribute(dataPlaceholderAttr,true);
if(o.hidePlaceholderMenuItems){
classes.push("ui-screen-hidden");
}
if(placeholder!==text){
placeholder=self.placeholder=text;
}
}
item=document.createElement("li");
if(option.disabled){
classes.push("ui-state-disabled");
item.setAttribute("aria-disabled",true);
}
item.setAttribute(dataIndexAttr,i);
item.setAttribute(dataIconAttr,dataIcon);
if(isPlaceholderItem){
item.setAttribute(dataPlaceholderAttr,true);
}
item.className=classes.join(" ");
item.setAttribute("role","option");
anchor.setAttribute("tabindex","-1");
if(this.isMultiple){
$(anchor).addClass("ui-btn ui-checkbox-off ui-btn-icon-right");
}
item.appendChild(anchor);
fragment.appendChild(item);
}
self.list[0].appendChild(fragment);
if(!this.isMultiple&&!placeholder.length){
this.header.addClass("ui-screen-hidden");
}else{
this.headerTitle.text(this.placeholder);
}
self.list.listview();
},
_button:function(){
return this.options.nativeMenu?
this._super():
$("<a>",{
"href":"#",
"role":"button",
"id":this.buttonId,
"aria-haspopup":"true",
"aria-owns":this.menuId
});
},
_destroy:function(){
if(!this.options.nativeMenu){
this.close();
if(this._origTabIndex!==undefined){
if(this._origTabIndex!==false){
this.select.attr("tabindex",this._origTabIndex);
}else{
this.select.removeAttr("tabindex");
}
}
if(this._removePlaceholderAttr){
this._selectOptions().removeAttr("data-"+$.mobile.ns+"placeholder");
}
this.listbox.remove();
this.menuPage.remove();
}
this._super();
}
});
})(jQuery);
(function($,undefined){
var reverseBoolOptionMap={
"ui-shadow":"shadow",
"ui-corner-all":"corners",
"ui-btn-inline":"inline",
"ui-shadow-icon":"iconshadow",
"ui-mini":"mini"
},
getAttrFixed=function(){
var ret=$.mobile.getAttribute.apply(this,arguments);
return(ret==null?undefined:ret);
},
capitalLettersRE=/[A-Z]/g;
function optionsToClasses(options,existingClasses){
var classes=existingClasses?existingClasses:[];
classes.push("ui-btn");
if(options.theme){
classes.push("ui-btn-"+options.theme);
}
if(options.icon){
classes=classes.concat([
"ui-icon-"+options.icon,
"ui-btn-icon-"+options.iconpos
]);
if(options.iconshadow){
classes.push("ui-shadow-icon");
}
}
if(options.inline){
classes.push("ui-btn-inline");
}
if(options.shadow){
classes.push("ui-shadow");
}
if(options.corners){
classes.push("ui-corner-all");
}
if(options.mini){
classes.push("ui-mini");
}
return classes;
}
function classNameToOptions(classes){
var idx,map,unknownClass,
alreadyEnhanced=false,
noIcon=true,
o={
icon:"",
inline:false,
shadow:false,
corners:false,
iconshadow:false,
mini:false
},
unknownClasses=[];
classes=classes.split(" ");
for(idx=0;idx<classes.length;idx++){
unknownClass=true;
map=reverseBoolOptionMap[classes[idx]];
if(map!==undefined){
unknownClass=false;
o[map]=true;
}else if(classes[idx].indexOf("ui-btn-icon-")===0){
unknownClass=false;
noIcon=false;
o.iconpos=classes[idx].substring(12);
}else if(classes[idx].indexOf("ui-icon-")===0){
unknownClass=false;
o.icon=classes[idx].substring(8);
}else if(classes[idx].indexOf("ui-btn-")===0&&classes[idx].length===8){
unknownClass=false;
o.theme=classes[idx].substring(7);
}else if(classes[idx]==="ui-btn"){
unknownClass=false;
alreadyEnhanced=true;
}
if(unknownClass){
unknownClasses.push(classes[idx]);
}
}
if(noIcon){
o.icon="";
}
return{
options:o,
unknownClasses:unknownClasses,
alreadyEnhanced:alreadyEnhanced
};
}
function camelCase2Hyphenated(c){
return"-"+c.toLowerCase();
}
$.fn.buttonMarkup=function(options,overwriteClasses){
var idx,data,el,retrievedOptions,optionKey,
defaults=$.fn.buttonMarkup.defaults;
for(idx=0;idx<this.length;idx++){
el=this[idx];
data=overwriteClasses?
{alreadyEnhanced:false,unknownClasses:[]}:
classNameToOptions(el.className);
retrievedOptions=$.extend({},
(data.alreadyEnhanced?data.options:{}),
options);
if(!data.alreadyEnhanced){
for(optionKey in defaults){
if(retrievedOptions[optionKey]===undefined){
retrievedOptions[optionKey]=getAttrFixed(el,
optionKey.replace(capitalLettersRE,camelCase2Hyphenated)
);
}
}
}
el.className=optionsToClasses(
$.extend({},
defaults,
retrievedOptions
),
data.unknownClasses).join(" ");
if(el.tagName.toLowerCase()!=="button"){
el.setAttribute("role","button");
}
}
return this;
};
$.fn.buttonMarkup.defaults={
icon:"",
iconpos:"left",
theme:null,
inline:false,
shadow:true,
corners:true,
iconshadow:false,
mini:false
};
$.extend($.fn.buttonMarkup,{
initSelector:"a:jqmData(role='button'), .ui-bar > a, .ui-bar > :jqmData(role='controlgroup') > a, button"
});
})(jQuery);
(function($,undefined){
$.widget("mobile.controlgroup",$.extend({
options:{
enhanced:false,
theme:null,
shadow:false,
corners:true,
excludeInvisible:true,
type:"vertical",
mini:false
},
_create:function(){
var elem=this.element,
opts=this.options;
if($.fn.buttonMarkup){
this.element.find($.fn.buttonMarkup.initSelector).buttonMarkup();
}
$.each(this._childWidgets,$.proxy(function(number,widgetName){
if($.mobile[widgetName]){
this.element.find($.mobile[widgetName].initSelector).not($.mobile.page.prototype.keepNativeSelector())[widgetName]();
}
},this));
$.extend(this,{
_ui:null,
_initialRefresh:true
});
if(opts.enhanced){
this._ui={
groupLegend:elem.children(".ui-controlgroup-label").children(),
childWrapper:elem.children(".ui-controlgroup-controls")
};
}else{
this._ui=this._enhance();
}
},
_childWidgets:["checkboxradio","selectmenu","button"],
_themeClassFromOption:function(value){
return(value?(value==="none"?"":"ui-group-theme-"+value):"");
},
_enhance:function(){
var elem=this.element,
opts=this.options,
ui={
groupLegend:elem.children("legend"),
childWrapper:elem
.addClass("ui-controlgroup "+
"ui-controlgroup-"+
(opts.type==="horizontal"?"horizontal":"vertical")+" "+
this._themeClassFromOption(opts.theme)+" "+
(opts.corners?"ui-corner-all ":"")+
(opts.mini?"ui-mini ":""))
.wrapInner("<div "+
"class='ui-controlgroup-controls "+
(opts.shadow===true?"ui-shadow":"")+"'></div>")
.children()
};
if(ui.groupLegend.length>0){
$("<div role='heading' class='ui-controlgroup-label'></div>")
.append(ui.groupLegend)
.prependTo(elem);
}
return ui;
},
_init:function(){
this.refresh();
},
_setOptions:function(options){
var callRefresh,returnValue,
elem=this.element;
if(options.type!==undefined){
elem
.removeClass("ui-controlgroup-horizontal ui-controlgroup-vertical")
.addClass("ui-controlgroup-"+(options.type==="horizontal"?"horizontal":"vertical"));
callRefresh=true;
}
if(options.theme!==undefined){
elem
.removeClass(this._themeClassFromOption(this.options.theme))
.addClass(this._themeClassFromOption(options.theme));
}
if(options.corners!==undefined){
elem.toggleClass("ui-corner-all",options.corners);
}
if(options.mini!==undefined){
elem.toggleClass("ui-mini",options.mini);
}
if(options.shadow!==undefined){
this._ui.childWrapper.toggleClass("ui-shadow",options.shadow);
}
if(options.excludeInvisible!==undefined){
this.options.excludeInvisible=options.excludeInvisible;
callRefresh=true;
}
returnValue=this._super(options);
if(callRefresh){
this.refresh();
}
return returnValue;
},
container:function(){
return this._ui.childWrapper;
},
refresh:function(){
var $el=this.container(),
els=$el.find(".ui-btn").not(".ui-slider-handle"),
create=this._initialRefresh;
if($.mobile.checkboxradio){
$el.find(":mobile-checkboxradio").checkboxradio("refresh");
}
this._addFirstLastClasses(els,
this.options.excludeInvisible?this._getVisibles(els,create):els,
create);
this._initialRefresh=false;
},
_destroy:function(){
var ui,buttons,
opts=this.options;
if(opts.enhanced){
return this;
}
ui=this._ui;
buttons=this.element
.removeClass("ui-controlgroup "+
"ui-controlgroup-horizontal ui-controlgroup-vertical ui-corner-all ui-mini "+
this._themeClassFromOption(opts.theme))
.find(".ui-btn")
.not(".ui-slider-handle");
this._removeFirstLastClasses(buttons);
ui.groupLegend.unwrap();
ui.childWrapper.children().unwrap();
}
},$.mobile.behaviors.addFirstLastClasses));
})(jQuery);
(function($,undefined){
$.widget("mobile.toolbar",{
initSelector:":jqmData(role='footer'), :jqmData(role='header')",
options:{
theme:null,
addBackBtn:false,
backBtnTheme:null,
backBtnText:"Back"
},
_create:function(){
var leftbtn,rightbtn,
role=this.element.is(":jqmData(role='header')")?"header":"footer",
page=this.element.closest(".ui-page");
if(page.length===0){
page=false;
this._on(this.document,{
"pageshow":"refresh"
});
}
$.extend(this,{
role:role,
page:page,
leftbtn:leftbtn,
rightbtn:rightbtn
});
this.element.attr("role",role==="header"?"banner":"contentinfo").addClass("ui-"+role);
this.refresh();
this._setOptions(this.options);
},
_setOptions:function(o){
if(o.addBackBtn!==undefined){
if(this.options.addBackBtn&&
this.role==="header"&&
$(".ui-page").length>1&&
this.page[0].getAttribute("data-"+$.mobile.ns+"url")!==$.mobile.path.stripHash(location.hash)&&
!this.leftbtn){
this._addBackButton();
}else{
this.element.find(".ui-toolbar-back-btn").remove();
}
}
if(o.backBtnTheme!=null){
this.element
.find(".ui-toolbar-back-btn")
.addClass("ui-btn ui-btn-"+o.backBtnTheme);
}
if(o.backBtnText!==undefined){
this.element.find(".ui-toolbar-back-btn .ui-btn-text").text(o.backBtnText);
}
if(o.theme!==undefined){
var currentTheme=this.options.theme?this.options.theme:"inherit",
newTheme=o.theme?o.theme:"inherit";
this.element.removeClass("ui-bar-"+currentTheme).addClass("ui-bar-"+newTheme);
}
this._super(o);
},
refresh:function(){
if(this.role==="header"){
this._addHeaderButtonClasses();
}
if(!this.page){
this._setRelative();
if(this.role==="footer"){
this.element.appendTo("body");
}
}
this._addHeadingClasses();
this._btnMarkup();
},
_setRelative:function(){
$("[data-"+$.mobile.ns+"role='page']").css({"position":"relative"});
},
_btnMarkup:function(){
this.element
.children("a")
.filter(":not([data-"+$.mobile.ns+"role='none'])")
.attr("data-"+$.mobile.ns+"role","button");
this.element.trigger("create");
},
_addHeaderButtonClasses:function(){
var $headeranchors=this.element.children("a, button");
this.leftbtn=$headeranchors.hasClass("ui-btn-left");
this.rightbtn=$headeranchors.hasClass("ui-btn-right");
this.leftbtn=this.leftbtn||$headeranchors.eq(0).not(".ui-btn-right").addClass("ui-btn-left").length;
this.rightbtn=this.rightbtn||$headeranchors.eq(1).addClass("ui-btn-right").length;
},
_addBackButton:function(){
var options=this.options,
theme=options.backBtnTheme||options.theme;
$("<a role='button' href='javascript:void(0);' "+
"class='ui-btn ui-corner-all ui-shadow ui-btn-left "+
(theme?"ui-btn-"+theme+" ":"")+
"ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' "+
"data-"+$.mobile.ns+"rel='back'>"+options.backBtnText+"</a>")
.prependTo(this.element);
},
_addHeadingClasses:function(){
this.element.children("h1, h2, h3, h4, h5, h6")
.addClass("ui-title")
.attr({
"role":"heading",
"aria-level":"1"
});
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.toolbar",$.mobile.toolbar,{
options:{
position:null,
visibleOnPageShow:true,
disablePageZoom:true,
transition:"slide",fullscreen:false,
tapToggle:true,
tapToggleBlacklist:"a, button, input, select, textarea, .ui-header-fixed, .ui-footer-fixed, .ui-flipswitch, .ui-popup, .ui-panel, .ui-panel-dismiss-open",
hideDuringFocus:"input, textarea, select",
updatePagePadding:true,
trackPersistentToolbars:true,
supportBlacklist:function(){
return!$.support.fixedPosition;
}
},
_create:function(){
this._super();
if(this.options.position==="fixed"&&!this.options.supportBlacklist()){
this._makeFixed();
}
},
_makeFixed:function(){
this.element.addClass("ui-"+this.role+"-fixed");
this.updatePagePadding();
this._addTransitionClass();
this._bindPageEvents();
this._bindToggleHandlers();
},
_setOptions:function(o){
if(o.position==="fixed"&&this.options.position!=="fixed"){
this._makeFixed();
}
if(this.options.position==="fixed"&&!this.options.supportBlacklist()){
var $page=(!!this.page)?this.page:($(".ui-page-active").length>0)?$(".ui-page-active"):$(".ui-page").eq(0);
if(o.fullscreen!==undefined){
if(o.fullscreen){
this.element.addClass("ui-"+this.role+"-fullscreen");
$page.addClass("ui-page-"+this.role+"-fullscreen");
}
else{
this.element.removeClass("ui-"+this.role+"-fullscreen");
$page.removeClass("ui-page-"+this.role+"-fullscreen").addClass("ui-page-"+this.role+"-fixed");
}
}
}
this._super(o);
},
_addTransitionClass:function(){
var tclass=this.options.transition;
if(tclass&&tclass!=="none"){
if(tclass==="slide"){
tclass=this.element.hasClass("ui-header")?"slidedown":"slideup";
}
this.element.addClass(tclass);
}
},
_bindPageEvents:function(){
var page=(!!this.page)?this.element.closest(".ui-page"):this.document;
this._on(page,{
"pagebeforeshow":"_handlePageBeforeShow",
"webkitAnimationStart":"_handleAnimationStart",
"animationstart":"_handleAnimationStart",
"updatelayout":"_handleAnimationStart",
"pageshow":"_handlePageShow",
"pagebeforehide":"_handlePageBeforeHide"
});
},
_handlePageBeforeShow:function(){
var o=this.options;
if(o.disablePageZoom){
$.mobile.zoom.disable(true);
}
if(!o.visibleOnPageShow){
this.hide(true);
}
},
_handleAnimationStart:function(){
if(this.options.updatePagePadding){
this.updatePagePadding((!!this.page)?this.page:".ui-page-active");
}
},
_handlePageShow:function(){
this.updatePagePadding((!!this.page)?this.page:".ui-page-active");
if(this.options.updatePagePadding){
this._on(this.window,{"throttledresize":"updatePagePadding"});
}
},
_handlePageBeforeHide:function(e,ui){
var o=this.options,
thisFooter,thisHeader,nextFooter,nextHeader;
if(o.disablePageZoom){
$.mobile.zoom.enable(true);
}
if(o.updatePagePadding){
this._off(this.window,"throttledresize");
}
if(o.trackPersistentToolbars){
thisFooter=$(".ui-footer-fixed:jqmData(id)",this.page);
thisHeader=$(".ui-header-fixed:jqmData(id)",this.page);
nextFooter=thisFooter.length&&ui.nextPage&&$(".ui-footer-fixed:jqmData(id='"+thisFooter.jqmData("id")+"')",ui.nextPage)||$();
nextHeader=thisHeader.length&&ui.nextPage&&$(".ui-header-fixed:jqmData(id='"+thisHeader.jqmData("id")+"')",ui.nextPage)||$();
if(nextFooter.length||nextHeader.length){
nextFooter.add(nextHeader).appendTo($.mobile.pageContainer);
ui.nextPage.one("pageshow",function(){
nextHeader.prependTo(this);
nextFooter.appendTo(this);
});
}
}
},
_visible:true,
updatePagePadding:function(tbPage){
var $el=this.element,
header=(this.role==="header"),
pos=parseFloat($el.css(header?"top":"bottom"));
if(this.options.fullscreen){return}
tbPage=(tbPage&&tbPage.type===undefined&&tbPage)||this.page||$el.closest(".ui-page");
tbPage=(!!this.page)?this.page:".ui-page-active";
$(tbPage).css("padding-"+(header?"top":"bottom"),$el.outerHeight()+pos);
},
_useTransition:function(notransition){
var $win=this.window,
$el=this.element,
scroll=$win.scrollTop(),
elHeight=$el.height(),
pHeight=(!!this.page)?$el.closest(".ui-page").height():$(".ui-page-active").height(),
viewportHeight=$.mobile.getScreenHeight();
return!notransition&&
(this.options.transition&&this.options.transition!=="none"&&
(
(this.role==="header"&&!this.options.fullscreen&&scroll>elHeight)||
(this.role==="footer"&&!this.options.fullscreen&&scroll+viewportHeight<pHeight-elHeight)
)||this.options.fullscreen
);
},
show:function(notransition){
var hideClass="ui-fixed-hidden",
$el=this.element;
if(this._useTransition(notransition)){
$el
.removeClass("out "+hideClass)
.addClass("in")
.animationComplete(function(){
$el.removeClass("in");
});
}
else{
$el.removeClass(hideClass);
}
this._visible=true;
},
hide:function(notransition){
var hideClass="ui-fixed-hidden",
$el=this.element,
outclass="out"+(this.options.transition==="slide"?" reverse":"");
if(this._useTransition(notransition)){
$el
.addClass(outclass)
.removeClass("in")
.animationComplete(function(){
$el.addClass(hideClass).removeClass(outclass);
});
}
else{
$el.addClass(hideClass).removeClass(outclass);
}
this._visible=false;
},
toggle:function(){
this[this._visible?"hide":"show"]();
},
_bindToggleHandlers:function(){
var self=this,
o=self.options,
delayShow,delayHide,
isVisible=true,
page=(!!this.page)?this.page:$(".ui-page");
page
.bind("vclick",function(e){
if(o.tapToggle&&!$(e.target).closest(o.tapToggleBlacklist).length){
self.toggle();
}
})
.bind("focusin focusout",function(e){
if(screen.width<1025&&$(e.target).is(o.hideDuringFocus)&&!$(e.target).closest(".ui-header-fixed, .ui-footer-fixed").length){
if(e.type==="focusout"&&!isVisible){
isVisible=true;
clearTimeout(delayHide);
delayShow=setTimeout(function(){
self.show();
},0);
}else if(e.type==="focusin"&&!!isVisible){
clearTimeout(delayShow);
isVisible=false;
delayHide=setTimeout(function(){
self.hide();
},0);
}
}
});
},
_setRelative:function(){
if(this.options.position!=="fixed"){
$("[data-"+$.mobile.ns+"role='page']").css({"position":"relative"});
}
},
_destroy:function(){
var $el=this.element,
header=$el.hasClass("ui-header");
$el.closest(".ui-page").css("padding-"+(header?"top":"bottom"),"");
$el.removeClass("ui-header-fixed ui-footer-fixed ui-header-fullscreen ui-footer-fullscreen in out fade slidedown slideup ui-fixed-hidden");
$el.closest(".ui-page").removeClass("ui-page-header-fixed ui-page-footer-fixed ui-page-header-fullscreen ui-page-footer-fullscreen");
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.toolbar",$.mobile.toolbar,{
_makeFixed:function(){
this._super();
this._workarounds();
},
_workarounds:function(){
var ua=navigator.userAgent,
platform=navigator.platform,
wkmatch=ua.match(/AppleWebKit\/([0-9]+)/),
wkversion=!!wkmatch&&wkmatch[1],
os=null,
self=this;
if(platform.indexOf("iPhone")>-1||platform.indexOf("iPad")>-1||platform.indexOf("iPod")>-1){
os="ios";
}else if(ua.indexOf("Android")>-1){
os="android";
}else{
return;
}
if(os==="ios"){
self._bindScrollWorkaround();
}else if(os==="android"&&wkversion&&wkversion<534){
self._bindScrollWorkaround();
self._bindListThumbWorkaround();
}else{
return;
}
},
_viewportOffset:function(){
var $el=this.element,
header=$el.hasClass("ui-header"),
offset=Math.abs($el.offset().top-this.window.scrollTop());
if(!header){
offset=Math.round(offset-this.window.height()+$el.outerHeight())-60;
}
return offset;
},
_bindScrollWorkaround:function(){
var self=this;
this._on(this.window,{scrollstop:function(){
var viewportOffset=self._viewportOffset();
if(viewportOffset>2&&self._visible){
self._triggerRedraw();
}
}});
},
_bindListThumbWorkaround:function(){
this.element.closest(".ui-page").addClass("ui-android-2x-fixed");
},
_triggerRedraw:function(){
var paddingBottom=parseFloat($(".ui-page-active").css("padding-bottom"));
$(".ui-page-active").css("padding-bottom",(paddingBottom+1)+"px");
setTimeout(function(){
$(".ui-page-active").css("padding-bottom",paddingBottom+"px");
},0);
},
destroy:function(){
this._super();
this.element.closest(".ui-page-active").removeClass("ui-android-2x-fix");
}
});
})(jQuery);
(function($,undefined){
var ieHack=($.mobile.browser.oldIE&&$.mobile.browser.oldIE<=8),
uiTemplate=$(
"<div class='ui-popup-arrow-guide'></div>"+
"<div class='ui-popup-arrow-container"+(ieHack?" ie":"")+"'>"+
"<div class='ui-popup-arrow'></div>"+
"</div>"
);
function getArrow(){
var clone=uiTemplate.clone(),
gd=clone.eq(0),
ct=clone.eq(1),
ar=ct.children();
return{arEls:ct.add(gd),gd:gd,ct:ct,ar:ar};
}
$.widget("mobile.popup",$.mobile.popup,{
options:{
arrow:""
},
_create:function(){
var ar,
ret=this._super();
if(this.options.arrow){
this._ui.arrow=ar=this._addArrow();
}
return ret;
},
_addArrow:function(){
var theme,
opts=this.options,
ar=getArrow();
theme=this._themeClassFromOption("ui-body-",opts.theme);
ar.ar.addClass(theme+(opts.shadow?" ui-overlay-shadow":""));
ar.arEls.hide().appendTo(this.element);
return ar;
},
_unenhance:function(){
var ar=this._ui.arrow;
if(ar){
ar.arEls.remove();
}
return this._super();
},
_tryAnArrow:function(p,dir,desired,s,best){
var result,r,diff,desiredForArrow={},tip={};
if(s.arFull[p.dimKey]>s.guideDims[p.dimKey]){
return best;
}
desiredForArrow[p.fst]=desired[p.fst]+
(s.arHalf[p.oDimKey]+s.menuHalf[p.oDimKey])*p.offsetFactor-
s.contentBox[p.fst]+(s.clampInfo.menuSize[p.oDimKey]-s.contentBox[p.oDimKey])*p.arrowOffsetFactor;
desiredForArrow[p.snd]=desired[p.snd];
result=s.result||this._calculateFinalLocation(desiredForArrow,s.clampInfo);
r={x:result.left,y:result.top};
tip[p.fst]=r[p.fst]+s.contentBox[p.fst]+p.tipOffset;
tip[p.snd]=Math.max(result[p.prop]+s.guideOffset[p.prop]+s.arHalf[p.dimKey],
Math.min(result[p.prop]+s.guideOffset[p.prop]+s.guideDims[p.dimKey]-s.arHalf[p.dimKey],
desired[p.snd]));
diff=Math.abs(desired.x-tip.x)+Math.abs(desired.y-tip.y);
if(!best||diff<best.diff){
tip[p.snd]-=s.arHalf[p.dimKey]+result[p.prop]+s.contentBox[p.snd];
best={dir:dir,diff:diff,result:result,posProp:p.prop,posVal:tip[p.snd]};
}
return best;
},
_getPlacementState:function(clamp){
var offset,gdOffset,
ar=this._ui.arrow,
state={
clampInfo:this._clampPopupWidth(!clamp),
arFull:{cx:ar.ct.width(),cy:ar.ct.height()},
guideDims:{cx:ar.gd.width(),cy:ar.gd.height()},
guideOffset:ar.gd.offset()
};
offset=this.element.offset();
ar.gd.css({left:0,top:0,right:0,bottom:0});
gdOffset=ar.gd.offset();
state.contentBox={
x:gdOffset.left-offset.left,
y:gdOffset.top-offset.top,
cx:ar.gd.width(),
cy:ar.gd.height()
};
ar.gd.removeAttr("style");
state.guideOffset={left:state.guideOffset.left-offset.left,top:state.guideOffset.top-offset.top};
state.arHalf={cx:state.arFull.cx/2,cy:state.arFull.cy/2};
state.menuHalf={cx:state.clampInfo.menuSize.cx/2,cy:state.clampInfo.menuSize.cy/2};
return state;
},
_placementCoords:function(desired){
var state,best,params,elOffset,bgRef,
optionValue=this.options.arrow,
ar=this._ui.arrow;
if(!ar){
return this._super(desired);
}
ar.arEls.show();
bgRef={};
state=this._getPlacementState(true);
params={
"l":{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:1,tipOffset:-state.arHalf.cx,arrowOffsetFactor:0},
"r":{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:-1,tipOffset:state.arHalf.cx+state.contentBox.cx,arrowOffsetFactor:1},
"b":{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:-1,tipOffset:state.arHalf.cy+state.contentBox.cy,arrowOffsetFactor:1},
"t":{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:1,tipOffset:-state.arHalf.cy,arrowOffsetFactor:0}
};
$.each((optionValue===true?"l,t,r,b":optionValue).split(","),
$.proxy(function(key,value){
best=this._tryAnArrow(params[value],value,desired,state,best);
},this));
if(!best){
ar.arEls.hide();
return this._super(desired);
}
ar.ct
.removeClass("ui-popup-arrow-l ui-popup-arrow-t ui-popup-arrow-r ui-popup-arrow-b")
.addClass("ui-popup-arrow-"+best.dir)
.removeAttr("style").css(best.posProp,best.posVal)
.show();
if(!ieHack){
elOffset=this.element.offset();
bgRef[params[best.dir].fst]=ar.ct.offset();
bgRef[params[best.dir].snd]={
left:elOffset.left+state.contentBox.x,
top:elOffset.top+state.contentBox.y
};
}
return best.result;
},
_setOptions:function(opts){
var newTheme,
oldTheme=this.options.theme,
ar=this._ui.arrow,
ret=this._super(opts);
if(opts.arrow!==undefined){
if(!ar&&opts.arrow){
this._ui.arrow=this._addArrow();
return;
}else if(ar&&!opts.arrow){
ar.arEls.remove();
this._ui.arrow=null;
}
}
ar=this._ui.arrow;
if(ar){
if(opts.theme!==undefined){
oldTheme=this._themeClassFromOption("ui-body-",oldTheme);
newTheme=this._themeClassFromOption("ui-body-",opts.theme);
ar.ar.removeClass(oldTheme).addClass(newTheme);
}
if(opts.shadow!==undefined){
ar.ar.toggleClass("ui-overlay-shadow",opts.shadow);
}
}
return ret;
},
_destroy:function(){
var ar=this._ui.arrow;
if(ar){
ar.arEls.remove();
}
return this._super();
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.panel",{
options:{
classes:{
panel:"ui-panel",
panelOpen:"ui-panel-open",
panelClosed:"ui-panel-closed",
panelFixed:"ui-panel-fixed",
panelInner:"ui-panel-inner",
modal:"ui-panel-dismiss",
modalOpen:"ui-panel-dismiss-open",
pageContainer:"ui-panel-page-container",
pageWrapper:"ui-panel-wrapper",
pageFixedToolbar:"ui-panel-fixed-toolbar",
pageContentPrefix:"ui-panel-page-content",
animate:"ui-panel-animate"
},
animate:true,
theme:null,
position:"left",
dismissible:true,
display:"reveal",swipeClose:true,
positionFixed:false
},
_closeLink:null,
_parentPage:null,
_page:null,
_modal:null,
_panelInner:null,
_wrapper:null,
_fixedToolbars:null,
_create:function(){
var el=this.element,
parentPage=el.closest(".ui-page, :jqmData(role='page')");
$.extend(this,{
_closeLink:el.find(":jqmData(rel='close')"),
_parentPage:(parentPage.length>0)?parentPage:false,
_openedPage:null,
_page:this._getPage,
_panelInner:this._getPanelInner(),
_fixedToolbars:this._getFixedToolbars
});
if(this.options.display!=="overlay"){
this._getWrapper();
}
this._addPanelClasses();
if($.support.cssTransform3d&&!!this.options.animate){
this.element.addClass(this.options.classes.animate);
}
this._bindUpdateLayout();
this._bindCloseEvents();
this._bindLinkListeners();
this._bindPageEvents();
if(!!this.options.dismissible){
this._createModal();
}
this._bindSwipeEvents();
},
_getPanelInner:function(){
var panelInner=this.element.find("."+this.options.classes.panelInner);
if(panelInner.length===0){
panelInner=this.element.children().wrapAll("<div class='"+this.options.classes.panelInner+"' />").parent();
}
return panelInner;
},
_createModal:function(){
var self=this,
target=self._parentPage?self._parentPage.parent():self.element.parent();
self._modal=$("<div class='"+self.options.classes.modal+"'></div>")
.on("mousedown",function(){
self.close();
})
.appendTo(target);
},
_getPage:function(){
var page=this._openedPage||this._parentPage||$("."+$.mobile.activePageClass);
return page;
},
_getWrapper:function(){
var wrapper=this._page().find("."+this.options.classes.pageWrapper);
if(wrapper.length===0){
wrapper=this._page().children(".ui-header:not(.ui-header-fixed), .ui-content:not(.ui-popup), .ui-footer:not(.ui-footer-fixed)")
.wrapAll("<div class='"+this.options.classes.pageWrapper+"'></div>")
.parent();
}
this._wrapper=wrapper;
},
_getFixedToolbars:function(){
var extFixedToolbars=$("body").children(".ui-header-fixed, .ui-footer-fixed"),
intFixedToolbars=this._page().find(".ui-header-fixed, .ui-footer-fixed"),
fixedToolbars=extFixedToolbars.add(intFixedToolbars).addClass(this.options.classes.pageFixedToolbar);
return fixedToolbars;
},
_getPosDisplayClasses:function(prefix){
return prefix+"-position-"+this.options.position+" "+prefix+"-display-"+this.options.display;
},
_getPanelClasses:function(){
var panelClasses=this.options.classes.panel+
" "+this._getPosDisplayClasses(this.options.classes.panel)+
" "+this.options.classes.panelClosed+
" "+"ui-body-"+(this.options.theme?this.options.theme:"inherit");
if(!!this.options.positionFixed){
panelClasses+=" "+this.options.classes.panelFixed;
}
return panelClasses;
},
_addPanelClasses:function(){
this.element.addClass(this._getPanelClasses());
},
_handleCloseClickAndEatEvent:function(event){
if(!event.isDefaultPrevented()){
event.preventDefault();
this.close();
return false;
}
},
_handleCloseClick:function(event){
if(!event.isDefaultPrevented()){
this.close();
}
},
_bindCloseEvents:function(){
this._on(this._closeLink,{
"click":"_handleCloseClick"
});
this._on({
"click a:jqmData(ajax='false')":"_handleCloseClick"
});
},
_positionPanel:function(scrollToTop){
var self=this,
panelInnerHeight=self._panelInner.outerHeight(),
expand=panelInnerHeight>$.mobile.getScreenHeight();
if(expand||!self.options.positionFixed){
if(expand){
self._unfixPanel();
$.mobile.resetActivePageHeight(panelInnerHeight);
}
if(scrollToTop){
this.window[0].scrollTo(0,$.mobile.defaultHomeScroll);
}
}else{
self._fixPanel();
}
},
_bindFixListener:function(){
this._on($(window),{"throttledresize":"_positionPanel"});
},
_unbindFixListener:function(){
this._off($(window),"throttledresize");
},
_unfixPanel:function(){
if(!!this.options.positionFixed&&$.support.fixedPosition){
this.element.removeClass(this.options.classes.panelFixed);
}
},
_fixPanel:function(){
if(!!this.options.positionFixed&&$.support.fixedPosition){
this.element.addClass(this.options.classes.panelFixed);
}
},
_bindUpdateLayout:function(){
var self=this;
self.element.on("updatelayout",function(){
if(self._open){
self._positionPanel();
}
});
},
_bindLinkListeners:function(){
this._on("body",{
"click a":"_handleClick"
});
},
_handleClick:function(e){
var link,
panelId=this.element.attr("id");
if(e.currentTarget.href.split("#")[1]===panelId&&panelId!==undefined){
e.preventDefault();
link=$(e.target);
if(link.hasClass("ui-btn")){
link.addClass($.mobile.activeBtnClass);
this.element.one("panelopen panelclose",function(){
link.removeClass($.mobile.activeBtnClass);
});
}
this.toggle();
return false;
}
},
_bindSwipeEvents:function(){
var self=this,
area=self._modal?self.element.add(self._modal):self.element;
if(!!self.options.swipeClose){
if(self.options.position==="left"){
area.on("swipeleft.panel",function(){
self.close();
});
}else{
area.on("swiperight.panel",function(){
self.close();
});
}
}
},
_bindPageEvents:function(){
var self=this;
this.document
.on("panelbeforeopen",function(e){
if(self._open&&e.target!==self.element[0]){
self.close();
}
})
.on("keyup.panel",function(e){
if(e.keyCode===27&&self._open){
self.close();
}
});
if(!this._parentPage&&this.options.display!=="overlay"){
this._on(this.document,{
"pageshow":"_getWrapper"
});
}
if(self._parentPage){
this.document.on("pagehide",":jqmData(role='page')",function(){
if(self._open){
self.close(true);
}
});
}else{
this.document.on("pagebeforehide",function(){
if(self._open){
self.close(true);
}
});
}
},
_open:false,
_pageContentOpenClasses:null,
_modalOpenClasses:null,
open:function(immediate){
if(!this._open){
var self=this,
o=self.options,
_openPanel=function(){
self.document.off("panelclose");
self._page().jqmData("panel","open");
if($.support.cssTransform3d&&!!o.animate&&o.display!=="overlay"){
self._wrapper.addClass(o.classes.animate);
self._fixedToolbars().addClass(o.classes.animate);
}
if(!immediate&&$.support.cssTransform3d&&!!o.animate){
self.element.animationComplete(complete,"transition");
}else{
setTimeout(complete,0);
}
if(o.theme&&o.display!=="overlay"){
self._page().parent()
.addClass(o.classes.pageContainer+"-themed "+o.classes.pageContainer+"-"+o.theme);
}
self.element
.removeClass(o.classes.panelClosed)
.addClass(o.classes.panelOpen);
self._positionPanel(true);
self._pageContentOpenClasses=self._getPosDisplayClasses(o.classes.pageContentPrefix);
if(o.display!=="overlay"){
self._page().parent().addClass(o.classes.pageContainer);
self._wrapper.addClass(self._pageContentOpenClasses);
self._fixedToolbars().addClass(self._pageContentOpenClasses);
}
self._modalOpenClasses=self._getPosDisplayClasses(o.classes.modal)+" "+o.classes.modalOpen;
if(self._modal){
self._modal
.addClass(self._modalOpenClasses)
.height(Math.max(self._modal.height(),self.document.height()));
}
},
complete=function(){
if(o.display!=="overlay"){
self._wrapper.addClass(o.classes.pageContentPrefix+"-open");
self._fixedToolbars().addClass(o.classes.pageContentPrefix+"-open");
}
self._bindFixListener();
self._trigger("open");
self._openedPage=self._page();
};
self._trigger("beforeopen");
if(self._page().jqmData("panel")==="open"){
self.document.on("panelclose",function(){
_openPanel();
});
}else{
_openPanel();
}
self._open=true;
}
},
close:function(immediate){
if(this._open){
var self=this,
o=this.options,
_closePanel=function(){
self.element.removeClass(o.classes.panelOpen);
if(o.display!=="overlay"){
self._wrapper.removeClass(self._pageContentOpenClasses);
self._fixedToolbars().removeClass(self._pageContentOpenClasses);
}
if(!immediate&&$.support.cssTransform3d&&!!o.animate){
self.element.animationComplete(complete,"transition");
}else{
setTimeout(complete,0);
}
if(self._modal){
self._modal.removeClass(self._modalOpenClasses);
}
},
complete=function(){
if(o.theme&&o.display!=="overlay"){
self._page().parent().removeClass(o.classes.pageContainer+"-themed "+o.classes.pageContainer+"-"+o.theme);
}
self.element.addClass(o.classes.panelClosed);
if(o.display!=="overlay"){
self._page().parent().removeClass(o.classes.pageContainer);
self._wrapper.removeClass(o.classes.pageContentPrefix+"-open");
self._fixedToolbars().removeClass(o.classes.pageContentPrefix+"-open");
}
if($.support.cssTransform3d&&!!o.animate&&o.display!=="overlay"){
self._wrapper.removeClass(o.classes.animate);
self._fixedToolbars().removeClass(o.classes.animate);
}
self._fixPanel();
self._unbindFixListener();
$.mobile.resetActivePageHeight();
self._page().jqmRemoveData("panel");
self._trigger("close");
self._openedPage=null;
};
self._trigger("beforeclose");
_closePanel();
self._open=false;
}
},
toggle:function(){
this[this._open?"close":"open"]();
},
_destroy:function(){
var otherPanels,
o=this.options,
multiplePanels=($("body > :mobile-panel").length+$.mobile.activePage.find(":mobile-panel").length)>1;
if(o.display!=="overlay"){
otherPanels=$("body > :mobile-panel").add($.mobile.activePage.find(":mobile-panel"));
if(otherPanels.not(".ui-panel-display-overlay").not(this.element).length===0){
this._wrapper.children().unwrap();
}
if(this._open){
this._fixedToolbars().removeClass(o.classes.pageContentPrefix+"-open");
if($.support.cssTransform3d&&!!o.animate){
this._fixedToolbars().removeClass(o.classes.animate);
}
this._page().parent().removeClass(o.classes.pageContainer);
if(o.theme){
this._page().parent().removeClass(o.classes.pageContainer+"-themed "+o.classes.pageContainer+"-"+o.theme);
}
}
}
if(!multiplePanels){
this.document.off("panelopen panelclose");
}
if(this._open){
this._page().jqmRemoveData("panel");
}
this._panelInner.children().unwrap();
this.element
.removeClass([this._getPanelClasses(),o.classes.panelOpen,o.classes.animate].join(" "))
.off("swipeleft.panel swiperight.panel")
.off("panelbeforeopen")
.off("panelhide")
.off("keyup.panel")
.off("updatelayout");
if(this._modal){
this._modal.remove();
}
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.table",{
options:{
classes:{
table:"ui-table"
},
enhanced:false
},
_create:function(){
if(!this.options.enhanced){
this.element.addClass(this.options.classes.table);
}
$.extend(this,{
headers:undefined,
allHeaders:undefined
});
this._refresh(true);
},
_setHeaders:function(){
var trs=this.element.find("thead tr");
this.headers=this.element.find("tr:eq(0)").children();
this.allHeaders=this.headers.add(trs.children());
},
refresh:function(){
this._refresh();
},
rebuild:$.noop,
_refresh:function(){
var table=this.element,
trs=table.find("thead tr");
this._setHeaders();
trs.each(function(){
var columnCount=0;
$(this).children().each(function(){
var span=parseInt(this.getAttribute("colspan"),10),
selector=":nth-child("+(columnCount+1)+")",
j;
this.setAttribute("data-"+$.mobile.ns+"colstart",columnCount+1);
if(span){
for(j=0;j<span-1;j++){
columnCount++;
selector+=", :nth-child("+(columnCount+1)+")";
}
}
$(this).jqmData("cells",table.find("tr").not(trs.eq(0)).not(this).children(selector));
columnCount++;
});
});
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.table",$.mobile.table,{
options:{
mode:"columntoggle",
columnBtnTheme:null,
columnPopupTheme:null,
columnBtnText:"Columns...",
classes:$.extend($.mobile.table.prototype.options.classes,{
popup:"ui-table-columntoggle-popup",
columnBtn:"ui-table-columntoggle-btn",
priorityPrefix:"ui-table-priority-",
columnToggleTable:"ui-table-columntoggle"
})
},
_create:function(){
this._super();
if(this.options.mode!=="columntoggle"){
return;
}
$.extend(this,{
_menu:null
});
if(this.options.enhanced){
this._menu=$(this.document[0].getElementById(this._id()+"-popup")).children().first();
this._addToggles(this._menu,true);
}else{
this._menu=this._enhanceColToggle();
this.element.addClass(this.options.classes.columnToggleTable);
}
this._setupEvents();
this._setToggleState();
},
_id:function(){
return(this.element.attr("id")||(this.widgetName+this.uuid));
},
_setupEvents:function(){
this._on(this.window,{
throttledresize:"_setToggleState"
});
this._on(this._menu,{
"change input":"_menuInputChange"
});
},
_addToggles:function(menu,keep){
var inputs,
checkboxIndex=0,
opts=this.options,
container=menu.controlgroup("container");
if(keep){
inputs=menu.find("input");
}else{
container.empty();
}
this.headers.not("td").each(function(){
var header=$(this),
priority=$.mobile.getAttribute(this,"priority"),
cells=header.add(header.jqmData("cells"));
if(priority){
cells.addClass(opts.classes.priorityPrefix+priority);
(keep?inputs.eq(checkboxIndex++):
$("<label><input type='checkbox' checked />"+
(header.children("abbr").first().attr("title")||
header.text())+
"</label>")
.appendTo(container)
.children(0)
.checkboxradio({
theme:opts.columnPopupTheme
}))
.jqmData("cells",cells);
}
});
if(!keep){
menu.controlgroup("refresh");
}
},
_menuInputChange:function(evt){
var input=$(evt.target),
checked=input[0].checked;
input.jqmData("cells")
.toggleClass("ui-table-cell-hidden",!checked)
.toggleClass("ui-table-cell-visible",checked);
if(input[0].getAttribute("locked")){
input.removeAttr("locked");
this._unlockCells(input.jqmData("cells"));
}else{
input.attr("locked",true);
}
},
_unlockCells:function(cells){
cells.removeClass("ui-table-cell-hidden ui-table-cell-visible");
},
_enhanceColToggle:function(){
var id,menuButton,popup,menu,
table=this.element,
opts=this.options,
ns=$.mobile.ns,
fragment=this.document[0].createDocumentFragment();
id=this._id()+"-popup";
menuButton=$("<a href='#"+id+"' "+
"class='"+opts.classes.columnBtn+" ui-btn "+
"ui-btn-"+(opts.columnBtnTheme||"a")+
" ui-corner-all ui-shadow ui-mini' "+
"data-"+ns+"rel='popup'>"+opts.columnBtnText+"</a>");
popup=$("<div class='"+opts.classes.popup+"' id='"+id+"'></div>");
menu=$("<fieldset></fieldset>").controlgroup();
this._addToggles(menu,false);
menu.appendTo(popup);
fragment.appendChild(popup[0]);
fragment.appendChild(menuButton[0]);
table.before(fragment);
popup.popup();
return menu;
},
rebuild:function(){
this._super();
if(this.options.mode==="columntoggle"){
this._refresh(false);
}
},
_refresh:function(create){
this._super(create);
if(!create&&this.options.mode==="columntoggle"){
this._unlockCells(this.element.find(".ui-table-cell-hidden, "+
".ui-table-cell-visible"));
this._addToggles(this._menu,create);
this._setToggleState();
}
},
_setToggleState:function(){
this._menu.find("input").each(function(){
var checkbox=$(this);
this.checked=checkbox.jqmData("cells").eq(0).css("display")==="table-cell";
checkbox.checkboxradio("refresh");
});
},
_destroy:function(){
this._super();
}
});
})(jQuery);
(function($,undefined){
$.widget("mobile.table",$.mobile.table,{
options:{
mode:"reflow",
classes:$.extend($.mobile.table.prototype.options.classes,{
reflowTable:"ui-table-reflow",
cellLabels:"ui-table-cell-label"
})
},
_create:function(){
this._super();
if(this.options.mode!=="reflow"){
return;
}
if(!this.options.enhanced){
this.element.addClass(this.options.classes.reflowTable);
this._updateReflow();
}
},
rebuild:function(){
this._super();
if(this.options.mode==="reflow"){
this._refresh(false);
}
},
_refresh:function(create){
this._super(create);
if(!create&&this.options.mode==="reflow"){
this._updateReflow();
}
},
_updateReflow:function(){
var table=this,
opts=this.options;
$(table.allHeaders.get().reverse()).each(function(){
var cells=$(this).jqmData("cells"),
colstart=$.mobile.getAttribute(this,"colstart"),
hierarchyClass=cells.not(this).filter("thead th").length&&" ui-table-cell-label-top",
text=$(this).text(),
iteration,filter;
if(text!==""){
if(hierarchyClass){
iteration=parseInt(this.getAttribute("colspan"),10);
filter="";
if(iteration){
filter="td:nth-child("+iteration+"n + "+(colstart)+")";
}
table._addLabels(cells.filter(filter),opts.classes.cellLabels+hierarchyClass,text);
}else{
table._addLabels(cells,opts.classes.cellLabels,text);
}
}
});
},
_addLabels:function(cells,label,text){
cells.not(":has(b."+label+")").prepend("<b class='"+label+"'>"+text+"</b>");
}
});
})(jQuery);
(function($,undefined){
var defaultFilterCallback=function(index,searchValue){
return((""+($.mobile.getAttribute(this,"filtertext")||$(this).text()))
.toLowerCase().indexOf(searchValue)===-1);
};
$.widget("mobile.filterable",{
initSelector:":jqmData(filter='true')",
options:{
filterReveal:false,
filterCallback:defaultFilterCallback,
enhanced:false,
input:null,
children:"> li, > option, > optgroup option, > tbody tr, > .ui-controlgroup-controls > .ui-btn, > .ui-controlgroup-controls > .ui-checkbox, > .ui-controlgroup-controls > .ui-radio"
},
_create:function(){
var opts=this.options;
$.extend(this,{
_search:null,
_timer:0
});
this._setInput(opts.input);
if(!opts.enhanced){
this._filterItems(((this._search&&this._search.val())||"").toLowerCase());
}
},
_onKeyUp:function(){
var val,lastval,
search=this._search;
if(search){
val=search.val().toLowerCase(),
lastval=$.mobile.getAttribute(search[0],"lastval")+"";
if(lastval&&lastval===val){
return;
}
if(this._timer){
window.clearTimeout(this._timer);
this._timer=0;
}
this._timer=this._delay(function(){
this._trigger("beforefilter",null,{input:search});
search[0].setAttribute("data-"+$.mobile.ns+"lastval",val);
this._filterItems(val);
this._timer=0;
},250);
}
},
_getFilterableItems:function(){
var elem=this.element,
children=this.options.children,
items=!children?{length:0}:
$.isFunction(children)?children():
children.nodeName?$(children):
children.jquery?children:
this.element.find(children);
if(items.length===0){
items=elem.children();
}
return items;
},
_filterItems:function(val){
var idx,callback,length,dst,
show=[],
hide=[],
opts=this.options,
filterItems=this._getFilterableItems();
if(val!=null){
callback=opts.filterCallback||defaultFilterCallback;
length=filterItems.length;
for(idx=0;idx<length;idx++){
dst=(callback.call(filterItems[idx],idx,val))?hide:show;
dst.push(filterItems[idx]);
}
}
if(hide.length===0){
filterItems[opts.filterReveal?"addClass":"removeClass"]("ui-screen-hidden");
}else{
$(hide).addClass("ui-screen-hidden");
$(show).removeClass("ui-screen-hidden");
}
this._refreshChildWidget();
this._trigger("filter",null,{
items:filterItems
});
},
_refreshChildWidget:function(){
var widget,idx,
recognizedWidgets=["collapsibleset","selectmenu","controlgroup","listview"];
for(idx=recognizedWidgets.length-1;idx>-1;idx--){
widget=recognizedWidgets[idx];
if($.mobile[widget]){
widget=this.element.data("mobile-"+widget);
if(widget&&$.isFunction(widget.refresh)){
widget.refresh();
}
}
}
},
_setInput:function(selector){
var search=this._search;
if(this._timer){
window.clearTimeout(this._timer);
this._timer=0;
}
if(search){
this._off(search,"keyup change input");
search=null;
}
if(selector){
search=selector.jquery?selector:
selector.nodeName?$(selector):
this.document.find(selector);
this._on(search,{
keyup:"_onKeyUp",
change:"_onKeyUp",
input:"_onKeyUp"
});
}
this._search=search;
},
_setOptions:function(options){
var refilter=!((options.filterReveal===undefined)&&
(options.filterCallback===undefined)&&
(options.children===undefined));
this._super(options);
if(options.input!==undefined){
this._setInput(options.input);
refilter=true;
}
if(refilter){
this.refresh();
}
},
_destroy:function(){
var opts=this.options,
items=this._getFilterableItems();
if(opts.enhanced){
items.toggleClass("ui-screen-hidden",opts.filterReveal);
}else{
items.removeClass("ui-screen-hidden");
}
},
refresh:function(){
if(this._timer){
window.clearTimeout(this._timer);
this._timer=0;
}
this._filterItems(((this._search&&this._search.val())||"").toLowerCase());
}
});
})(jQuery);
(function($,undefined){
var replaceSetOptions=function(self,orig){
return function(options){
orig.call(this,options);
self._syncTextInputOptions(options);
};
},
rDividerListItem=/(^|\s)ui-li-divider(\s|$)/,
origDefaultFilterCallback=$.mobile.filterable.prototype.options.filterCallback;
$.mobile.filterable.prototype.options.filterCallback=function(index,searchValue){
return!this.className.match(rDividerListItem)&&
origDefaultFilterCallback.call(this,index,searchValue);
};
$.widget("mobile.filterable",$.mobile.filterable,{
options:{
filterPlaceholder:"Filter items...",
filterTheme:null
},
_create:function(){
var idx,widgetName,
elem=this.element,
recognizedWidgets=["collapsibleset","selectmenu","controlgroup","listview"],
createHandlers={};
this._super();
$.extend(this,{
_widget:null
});
for(idx=recognizedWidgets.length-1;idx>-1;idx--){
widgetName=recognizedWidgets[idx];
if($.mobile[widgetName]){
if(this._setWidget(elem.data("mobile-"+widgetName))){
break;
}else{
createHandlers[widgetName+"create"]="_handleCreate";
}
}
}
if(!this._widget){
this._on(elem,createHandlers);
}
},
_handleCreate:function(evt){
this._setWidget(this.element.data("mobile-"+evt.type.substring(0,evt.type.length-6)));
},
_trigger:function(type,event,data){
if(this._widget&&this._widget.widgetFullName==="mobile-listview"&&
type==="beforefilter"){
this._widget._trigger("beforefilter",event,data);
}
this._super(type,event,data);
},
_setWidget:function(widget){
if(!this._widget&&widget){
this._widget=widget;
this._widget._setOptions=replaceSetOptions(this,this._widget._setOptions);
}
if(!!this._widget){
this._syncTextInputOptions(this._widget.options);
if(this._widget.widgetName==="listview"){
this._widget.options.hideDividers=true;
this._widget.element.listview("refresh");
}
}
return!!this._widget;
},
_isSearchInternal:function(){
return(this._search&&this._search.jqmData("ui-filterable-"+this.uuid+"-internal"));
},
_setInput:function(selector){
var opts=this.options,
updatePlaceholder=true,
textinputOpts={};
if(!selector){
if(this._isSearchInternal()){
return;
}else{
updatePlaceholder=false;
selector=$("<input "+
"data-"+$.mobile.ns+"type='search' "+
"placeholder='"+opts.filterPlaceholder+"'></input>")
.jqmData("ui-filterable-"+this.uuid+"-internal",true);
$("<form class='ui-filterable'></form>")
.append(selector)
.submit(function(evt){
evt.preventDefault();
selector.blur();
})
.insertBefore(this.element);
if($.mobile.textinput){
if(this.options.filterTheme!=null){
textinputOpts["theme"]=opts.filterTheme;
}
selector.textinput(textinputOpts);
}
}
}
this._super(selector);
if(this._isSearchInternal()&&updatePlaceholder){
this._search.attr("placeholder",this.options.filterPlaceholder);
}
},
_setOptions:function(options){
var ret=this._super(options);
if(options.filterPlaceholder!==undefined){
if(this._isSearchInternal()){
this._search.attr("placeholder",options.filterPlaceholder);
}
}
if(options.filterTheme!==undefined&&this._search&&$.mobile.textinput){
this._search.textinput("option","theme",options.filterTheme);
}
return ret;
},
_destroy:function(){
if(this._isSearchInternal()){
this._search.remove();
}
this._super();
},
_syncTextInputOptions:function(options){
var idx,
textinputOptions={};
if(this._isSearchInternal()&&$.mobile.textinput){
for(idx in $.mobile.textinput.prototype.options){
if(options[idx]!==undefined){
if(idx==="theme"&&this.options.filterTheme!=null){
textinputOptions[idx]=this.options.filterTheme;
}else{
textinputOptions[idx]=options[idx];
}
}
}
this._search.textinput("option",textinputOptions);
}
}
});
})(jQuery);

(function($,undefined){
var tabId=0,
rhash=/#.*$/;
function getNextTabId(){
return++tabId;
}
function isLocal(anchor){
return anchor.hash.length>1&&
decodeURIComponent(anchor.href.replace(rhash,""))===
decodeURIComponent(location.href.replace(rhash,""));
}
$.widget("ui.tabs",{
version:"fadf2b312a05040436451c64bbfaf4814bc62c56",
delay:300,
options:{
active:null,
collapsible:false,
event:"click",
heightStyle:"content",
hide:null,
show:null,
activate:null,
beforeActivate:null,
beforeLoad:null,
load:null
},
_create:function(){
var that=this,
options=this.options;
this.running=false;
this.element
.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all")
.toggleClass("ui-tabs-collapsible",options.collapsible)
.delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(event){
if($(this).is(".ui-state-disabled")){
event.preventDefault();
}
})
.delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){
if($(this).closest("li").is(".ui-state-disabled")){
this.blur();
}
});
this._processTabs();
options.active=this._initialActive();
if($.isArray(options.disabled)){
options.disabled=$.unique(options.disabled.concat(
$.map(this.tabs.filter(".ui-state-disabled"),function(li){
return that.tabs.index(li);
})
)).sort();
}
if(this.options.active!==false&&this.anchors.length){
this.active=this._findActive(options.active);
}else{
this.active=$();
}
this._refresh();
if(this.active.length){
this.load(options.active);
}
},
_initialActive:function(){
var active=this.options.active,
collapsible=this.options.collapsible,
locationHash=location.hash.substring(1);
if(active===null){
if(locationHash){
this.tabs.each(function(i,tab){
if($(tab).attr("aria-controls")===locationHash){
active=i;
return false;
}
});
}
if(active===null){
active=this.tabs.index(this.tabs.filter(".ui-tabs-active"));
}
if(active===null||active===-1){
active=this.tabs.length?0:false;
}
}
if(active!==false){
active=this.tabs.index(this.tabs.eq(active));
if(active===-1){
active=collapsible?false:0;
}
}
if(!collapsible&&active===false&&this.anchors.length){
active=0;
}
return active;
},
_getCreateEventData:function(){
return{
tab:this.active,
panel:!this.active.length?$():this._getPanelForTab(this.active)
};
},
_tabKeydown:function(event){
var focusedTab=$(this.document[0].activeElement).closest("li"),
selectedIndex=this.tabs.index(focusedTab),
goingForward=true;
if(this._handlePageNav(event)){
return;
}
switch(event.keyCode){
case $.ui.keyCode.RIGHT:
case $.ui.keyCode.DOWN:
selectedIndex++;
break;
case $.ui.keyCode.UP:
case $.ui.keyCode.LEFT:
goingForward=false;
selectedIndex--;
break;
case $.ui.keyCode.END:
selectedIndex=this.anchors.length-1;
break;
case $.ui.keyCode.HOME:
selectedIndex=0;
break;
case $.ui.keyCode.SPACE:
event.preventDefault();
clearTimeout(this.activating);
this._activate(selectedIndex);
return;
case $.ui.keyCode.ENTER:
event.preventDefault();
clearTimeout(this.activating);
this._activate(selectedIndex===this.options.active?false:selectedIndex);
return;
default:
return;
}
event.preventDefault();
clearTimeout(this.activating);
selectedIndex=this._focusNextTab(selectedIndex,goingForward);
if(!event.ctrlKey){
focusedTab.attr("aria-selected","false");
this.tabs.eq(selectedIndex).attr("aria-selected","true");
this.activating=this._delay(function(){
this.option("active",selectedIndex);
},this.delay);
}
},
_panelKeydown:function(event){
if(this._handlePageNav(event)){
return;
}
if(event.ctrlKey&&event.keyCode===$.ui.keyCode.UP){
event.preventDefault();
this.active.focus();
}
},
_handlePageNav:function(event){
if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP){
this._activate(this._focusNextTab(this.options.active-1,false));
return true;
}
if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN){
this._activate(this._focusNextTab(this.options.active+1,true));
return true;
}
},
_findNextTab:function(index,goingForward){
var lastTabIndex=this.tabs.length-1;
function constrain(){
if(index>lastTabIndex){
index=0;
}
if(index<0){
index=lastTabIndex;
}
return index;
}
while($.inArray(constrain(),this.options.disabled)!==-1){
index=goingForward?index+1:index-1;
}
return index;
},
_focusNextTab:function(index,goingForward){
index=this._findNextTab(index,goingForward);
this.tabs.eq(index).focus();
return index;
},
_setOption:function(key,value){
if(key==="active"){
this._activate(value);
return;
}
if(key==="disabled"){
this._setupDisabled(value);
return;
}
this._super(key,value);
if(key==="collapsible"){
this.element.toggleClass("ui-tabs-collapsible",value);
if(!value&&this.options.active===false){
this._activate(0);
}
}
if(key==="event"){
this._setupEvents(value);
}
if(key==="heightStyle"){
this._setupHeightStyle(value);
}
},
_tabId:function(tab){
return tab.attr("aria-controls")||"ui-tabs-"+getNextTabId();
},
_sanitizeSelector:function(hash){
return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):"";
},
refresh:function(){
var options=this.options,
lis=this.tablist.children(":has(a[href])");
options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){
return lis.index(tab);
});
this._processTabs();
if(options.active===false||!this.anchors.length){
options.active=false;
this.active=$();
}else if(this.active.length&&!$.contains(this.tablist[0],this.active[0])){
if(this.tabs.length===options.disabled.length){
options.active=false;
this.active=$();
}else{
this._activate(this._findNextTab(Math.max(0,options.active-1),false));
}
}else{
options.active=this.tabs.index(this.active);
}
this._refresh();
},
_refresh:function(){
this._setupDisabled(this.options.disabled);
this._setupEvents(this.options.event);
this._setupHeightStyle(this.options.heightStyle);
this.tabs.not(this.active).attr({
"aria-selected":"false",
tabIndex:-1
});
this.panels.not(this._getPanelForTab(this.active))
.hide()
.attr({
"aria-expanded":"false",
"aria-hidden":"true"
});
if(!this.active.length){
this.tabs.eq(0).attr("tabIndex",0);
}else{
this.active
.addClass("ui-tabs-active ui-state-active")
.attr({
"aria-selected":"true",
tabIndex:0
});
this._getPanelForTab(this.active)
.show()
.attr({
"aria-expanded":"true",
"aria-hidden":"false"
});
}
},
_processTabs:function(){
var that=this;
this.tablist=this._getList()
.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all")
.attr("role","tablist");
this.tabs=this.tablist.find("> li:has(a[href])")
.addClass("ui-state-default ui-corner-top")
.attr({
role:"tab",
tabIndex:-1
});
this.anchors=this.tabs.map(function(){
return $("a",this)[0];
})
.addClass("ui-tabs-anchor")
.attr({
role:"presentation",
tabIndex:-1
});
this.panels=$();
this.anchors.each(function(i,anchor){
var selector,panel,panelId,
anchorId=$(anchor).uniqueId().attr("id"),
tab=$(anchor).closest("li"),
originalAriaControls=tab.attr("aria-controls");
if(isLocal(anchor)){
selector=anchor.hash;
panel=that.element.find(that._sanitizeSelector(selector));
}else{
panelId=that._tabId(tab);
selector="#"+panelId;
panel=that.element.find(selector);
if(!panel.length){
panel=that._createPanel(panelId);
panel.insertAfter(that.panels[i-1]||that.tablist);
}
panel.attr("aria-live","polite");
}
if(panel.length){
that.panels=that.panels.add(panel);
}
if(originalAriaControls){
tab.data("ui-tabs-aria-controls",originalAriaControls);
}
tab.attr({
"aria-controls":selector.substring(1),
"aria-labelledby":anchorId
});
panel.attr("aria-labelledby",anchorId);
});
this.panels
.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom")
.attr("role","tabpanel");
},
_getList:function(){
return this.element.find("ol,ul").eq(0);
},
_createPanel:function(id){
return $("<div>")
.attr("id",id)
.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom")
.data("ui-tabs-destroy",true);
},
_setupDisabled:function(disabled){
if($.isArray(disabled)){
if(!disabled.length){
disabled=false;
}else if(disabled.length===this.anchors.length){
disabled=true;
}
}
for(var i=0,li;(li=this.tabs[i]);i++){
if(disabled===true||$.inArray(i,disabled)!==-1){
$(li)
.addClass("ui-state-disabled")
.attr("aria-disabled","true");
}else{
$(li)
.removeClass("ui-state-disabled")
.removeAttr("aria-disabled");
}
}
this.options.disabled=disabled;
},
_setupEvents:function(event){
var events={
click:function(event){
event.preventDefault();
}
};
if(event){
$.each(event.split(" "),function(index,eventName){
events[eventName]="_eventHandler";
});
}
this._off(this.anchors.add(this.tabs).add(this.panels));
this._on(this.anchors,events);
this._on(this.tabs,{keydown:"_tabKeydown"});
this._on(this.panels,{keydown:"_panelKeydown"});
this._focusable(this.tabs);
this._hoverable(this.tabs);
},
_setupHeightStyle:function(heightStyle){
var maxHeight,
parent=this.element.parent();
if(heightStyle==="fill"){
maxHeight=parent.height();
maxHeight-=this.element.outerHeight()-this.element.height();
this.element.siblings(":visible").each(function(){
var elem=$(this),
position=elem.css("position");
if(position==="absolute"||position==="fixed"){
return;
}
maxHeight-=elem.outerHeight(true);
});
this.element.children().not(this.panels).each(function(){
maxHeight-=$(this).outerHeight(true);
});
this.panels.each(function(){
$(this).height(Math.max(0,maxHeight-
$(this).innerHeight()+$(this).height()));
})
.css("overflow","auto");
}else if(heightStyle==="auto"){
maxHeight=0;
this.panels.each(function(){
maxHeight=Math.max(maxHeight,$(this).height("").height());
}).height(maxHeight);
}
},
_eventHandler:function(event){
var options=this.options,
active=this.active,
anchor=$(event.currentTarget),
tab=anchor.closest("li"),
clickedIsActive=tab[0]===active[0],
collapsing=clickedIsActive&&options.collapsible,
toShow=collapsing?$():this._getPanelForTab(tab),
toHide=!active.length?$():this._getPanelForTab(active),
eventData={
oldTab:active,
oldPanel:toHide,
newTab:collapsing?$():tab,
newPanel:toShow
};
event.preventDefault();
if(tab.hasClass("ui-state-disabled")||
tab.hasClass("ui-tabs-loading")||
this.running||
(clickedIsActive&&!options.collapsible)||
(this._trigger("beforeActivate",event,eventData)===false)){
return;
}
options.active=collapsing?false:this.tabs.index(tab);
this.active=clickedIsActive?$():tab;
if(this.xhr){
this.xhr.abort();
}
if(!toHide.length&&!toShow.length){
$.error("jQuery UI Tabs: Mismatching fragment identifier.");
}
if(toShow.length){
this.load(this.tabs.index(tab),event);
}
this._toggle(event,eventData);
},
_toggle:function(event,eventData){
var that=this,
toShow=eventData.newPanel,
toHide=eventData.oldPanel;
this.running=true;
function complete(){
that.running=false;
that._trigger("activate",event,eventData);
}
function show(){
eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active");
if(toShow.length&&that.options.show){
that._show(toShow,that.options.show,complete);
}else{
toShow.show();
complete();
}
}
if(toHide.length&&this.options.hide){
this._hide(toHide,this.options.hide,function(){
eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");
show();
});
}else{
eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");
toHide.hide();
show();
}
toHide.attr({
"aria-expanded":"false",
"aria-hidden":"true"
});
eventData.oldTab.attr("aria-selected","false");
if(toShow.length&&toHide.length){
eventData.oldTab.attr("tabIndex",-1);
}else if(toShow.length){
this.tabs.filter(function(){
return $(this).attr("tabIndex")===0;
})
.attr("tabIndex",-1);
}
toShow.attr({
"aria-expanded":"true",
"aria-hidden":"false"
});
eventData.newTab.attr({
"aria-selected":"true",
tabIndex:0
});
},
_activate:function(index){
var anchor,
active=this._findActive(index);
if(active[0]===this.active[0]){
return;
}
if(!active.length){
active=this.active;
}
anchor=active.find(".ui-tabs-anchor")[0];
this._eventHandler({
target:anchor,
currentTarget:anchor,
preventDefault:$.noop
});
},
_findActive:function(index){
return index===false?$():this.tabs.eq(index);
},
_getIndex:function(index){
if(typeof index==="string"){
index=this.anchors.index(this.anchors.filter("[href$='"+index+"']"));
}
return index;
},
_destroy:function(){
if(this.xhr){
this.xhr.abort();
}
this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");
this.tablist
.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all")
.removeAttr("role");
this.anchors
.removeClass("ui-tabs-anchor")
.removeAttr("role")
.removeAttr("tabIndex")
.removeUniqueId();
this.tabs.add(this.panels).each(function(){
if($.data(this,"ui-tabs-destroy")){
$(this).remove();
}else{
$(this)
.removeClass("ui-state-default ui-state-active ui-state-disabled "+
"ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel")
.removeAttr("tabIndex")
.removeAttr("aria-live")
.removeAttr("aria-busy")
.removeAttr("aria-selected")
.removeAttr("aria-labelledby")
.removeAttr("aria-hidden")
.removeAttr("aria-expanded")
.removeAttr("role");
}
});
this.tabs.each(function(){
var li=$(this),
prev=li.data("ui-tabs-aria-controls");
if(prev){
li
.attr("aria-controls",prev)
.removeData("ui-tabs-aria-controls");
}else{
li.removeAttr("aria-controls");
}
});
this.panels.show();
if(this.options.heightStyle!=="content"){
this.panels.css("height","");
}
},
enable:function(index){
var disabled=this.options.disabled;
if(disabled===false){
return;
}
if(index===undefined){
disabled=false;
}else{
index=this._getIndex(index);
if($.isArray(disabled)){
disabled=$.map(disabled,function(num){
return num!==index?num:null;
});
}else{
disabled=$.map(this.tabs,function(li,num){
return num!==index?num:null;
});
}
}
this._setupDisabled(disabled);
},
disable:function(index){
var disabled=this.options.disabled;
if(disabled===true){
return;
}
if(index===undefined){
disabled=true;
}else{
index=this._getIndex(index);
if($.inArray(index,disabled)!==-1){
return;
}
if($.isArray(disabled)){
disabled=$.merge([index],disabled).sort();
}else{
disabled=[index];
}
}
this._setupDisabled(disabled);
},
load:function(index,event){
index=this._getIndex(index);
var that=this,
tab=this.tabs.eq(index),
anchor=tab.find(".ui-tabs-anchor"),
panel=this._getPanelForTab(tab),
eventData={
tab:tab,
panel:panel
};
if(isLocal(anchor[0])){
return;
}
this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData));
if(this.xhr&&this.xhr.statusText!=="canceled"){
tab.addClass("ui-tabs-loading");
panel.attr("aria-busy","true");
this.xhr
.success(function(response){
setTimeout(function(){
panel.html(response);
that._trigger("load",event,eventData);
},1);
})
.complete(function(jqXHR,status){
setTimeout(function(){
if(status==="abort"){
that.panels.stop(false,true);
}
tab.removeClass("ui-tabs-loading");
panel.removeAttr("aria-busy");
if(jqXHR===that.xhr){
delete that.xhr;
}
},1);
});
}
},
_ajaxSettings:function(anchor,event,eventData){
var that=this;
return{
url:anchor.attr("href"),
beforeSend:function(jqXHR,settings){
return that._trigger("beforeLoad",event,
$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData));
}
};
},
_getPanelForTab:function(tab){
var id=$(tab).attr("aria-controls");
return this.element.find(this._sanitizeSelector("#"+id));
}
});
})(jQuery);
(function($,undefined){
})(jQuery);
(function($,window){
$.mobile.iosorientationfixEnabled=true;
var ua=navigator.userAgent,
zoom,
evt,x,y,z,aig;
if(!(/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(ua)&&ua.indexOf("AppleWebKit")>-1)){
$.mobile.iosorientationfixEnabled=false;
return;
}
zoom=$.mobile.zoom;
function checkTilt(e){
evt=e.originalEvent;
aig=evt.accelerationIncludingGravity;
x=Math.abs(aig.x);
y=Math.abs(aig.y);
z=Math.abs(aig.z);
if(!window.orientation&&(x>7||((z>6&&y<8||z<8&&y>6)&&x>5))){
if(zoom.enabled){
zoom.disable();
}
}else if(!zoom.enabled){
zoom.enable();
}
}
$.mobile.document.on("mobileinit",function(){
if($.mobile.iosorientationfixEnabled){
$.mobile.window
.bind("orientationchange.iosorientationfix",zoom.enable)
.bind("devicemotion.iosorientationfix",checkTilt);
}
});
}(jQuery,this));
(function($,window,undefined){
var $html=$("html"),
$window=$.mobile.window;
function hideRenderingClass(){
$html.removeClass("ui-mobile-rendering");
}
$(window.document).trigger("mobileinit");
if(!$.mobile.gradeA()){
return;
}
if($.mobile.ajaxBlacklist){
$.mobile.ajaxEnabled=false;
}
$html.addClass("ui-mobile ui-mobile-rendering");
setTimeout(hideRenderingClass,5000);
$.extend($.mobile,{
initializePage:function(){
var path=$.mobile.path,
$pages=$(":jqmData(role='page'), :jqmData(role='dialog')"),
hash=path.stripHash(path.stripQueryParams(path.parseLocation().hash)),
hashPage=document.getElementById(hash);
if(!$pages.length){
$pages=$("body").wrapInner("<div data-"+$.mobile.ns+"role='page'></div>").children(0);
}
$pages.each(function(){
var $this=$(this);
if(!$this[0].getAttribute("data-"+$.mobile.ns+"url")){
$this.attr("data-"+$.mobile.ns+"url",$this.attr("id")||location.pathname+location.search);
}
});
$.mobile.firstPage=$pages.first();
$.mobile.pageContainer=$.mobile.firstPage
.parent()
.addClass("ui-mobile-viewport")
.pagecontainer();
$.mobile.navreadyDeferred.resolve();
$window.trigger("pagecontainercreate");
$.mobile.loading("show");
hideRenderingClass();
if(!($.mobile.hashListeningEnabled&&
$.mobile.path.isHashValid(location.hash)&&
($(hashPage).is(":jqmData(role='page')")||
$.mobile.path.isPath(hash)||
hash===$.mobile.dialogHashKey))){
if($.mobile.path.isHashValid(location.hash)){
$.mobile.navigate.history.initialDst=hash.replace("#","");
}
if($.event.special.navigate.isPushStateEnabled()){
$.mobile.navigate.navigator.squash(path.parseLocation().href);
}
$.mobile.changePage($.mobile.firstPage,{
transition:"none",
reverse:true,
changeHash:false,
fromHashChange:true
});
}else{
if(!$.event.special.navigate.isPushStateEnabled()){
$window.trigger("hashchange",[true]);
}else{
$.mobile.navigate.history.stack=[];
$.mobile.navigate($.mobile.path.isPath(location.hash)?location.hash:location.href);
}
}
}
});
$(function(){
$.support.inlineSVG();
if($.mobile.hideUrlBar){
window.scrollTo(0,1);
}
$.mobile.defaultHomeScroll=(!$.support.scrollTop||$.mobile.window.scrollTop()===1)?0:1;
if($.mobile.autoInitializePage){
$.mobile.initializePage();
}
if($.mobile.hideUrlBar){
$window.load($.mobile.silentScroll);
}
if(!$.support.cssPointerEvents){
$.mobile.document.delegate(".ui-state-disabled,.ui-disabled","vclick",
function(e){
e.preventDefault();
e.stopImmediatePropagation();
}
);
}
});
}(jQuery,this));
}));
;

;
(function(global,factory){
if(typeof module==="object"&&typeof module.exports==="object"){
module.exports=global.document?
factory(global,true):
function(w){
if(!w.document){
throw new Error("jQuery requires a window with a document");
}
return factory(w);
};
}else{
factory(global);
}
}(typeof window!=="undefined"?window:this,function(window,noGlobal){
var deletedIds=[];
var slice=deletedIds.slice;
var concat=deletedIds.concat;
var push=deletedIds.push;
var indexOf=deletedIds.indexOf;
var class2type={};
var toString=class2type.toString;
var hasOwn=class2type.hasOwnProperty;
var trim="".trim;
var support={};
var
version="1.11.0",
jQuery=function(selector,context){
return new jQuery.fn.init(selector,context);
},
rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
rmsPrefix=/^-ms-/,
rdashAlpha=/-([\da-z])/gi,
fcamelCase=function(all,letter){
return letter.toUpperCase();
};
jQuery.fn=jQuery.prototype={
jquery:version,
constructor:jQuery,
selector:"",
length:0,
toArray:function(){
return slice.call(this);
},
get:function(num){
return num!=null?
(num<0?this[num+this.length]:this[num]):
slice.call(this);
},
pushStack:function(elems){
var ret=jQuery.merge(this.constructor(),elems);
ret.prevObject=this;
ret.context=this.context;
return ret;
},
each:function(callback,args){
return jQuery.each(this,callback,args);
},
map:function(callback){
return this.pushStack(jQuery.map(this,function(elem,i){
return callback.call(elem,i,elem);
}));
},
slice:function(){
return this.pushStack(slice.apply(this,arguments));
},
first:function(){
return this.eq(0);
},
last:function(){
return this.eq(-1);
},
eq:function(i){
var len=this.length,
j=+i+(i<0?len:0);
return this.pushStack(j>=0&&j<len?[this[j]]:[]);
},
end:function(){
return this.prevObject||this.constructor(null);
},
push:push,
sort:deletedIds.sort,
splice:deletedIds.splice
};
jQuery.extend=jQuery.fn.extend=function(){
var src,copyIsArray,copy,name,options,clone,
target=arguments[0]||{},
i=1,
length=arguments.length,
deep=false;
if(typeof target==="boolean"){
deep=target;
target=arguments[i]||{};
i++;
}
if(typeof target!=="object"&&!jQuery.isFunction(target)){
target={};
}
if(i===length){
target=this;
i--;
}
for(;i<length;i++){
if((options=arguments[i])!=null){
for(name in options){
src=target[name];
copy=options[name];
if(target===copy){
continue;
}
if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){
if(copyIsArray){
copyIsArray=false;
clone=src&&jQuery.isArray(src)?src:[];
}else{
clone=src&&jQuery.isPlainObject(src)?src:{};
}
target[name]=jQuery.extend(deep,clone,copy);
}else if(copy!==undefined){
target[name]=copy;
}
}
}
}
return target;
};
jQuery.extend({
expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),
isReady:true,
error:function(msg){
throw new Error(msg);
},
noop:function(){},
isFunction:function(obj){
return jQuery.type(obj)==="function";
},
isArray:Array.isArray||function(obj){
return jQuery.type(obj)==="array";
},
isWindow:function(obj){

return obj!=null&&obj==obj.window;
},
isNumeric:function(obj){
return obj-parseFloat(obj)>=0;
},
isEmptyObject:function(obj){
var name;
for(name in obj){
return false;
}
return true;
},
isPlainObject:function(obj){
var key;
if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){
return false;
}
try{
if(obj.constructor&&
!hasOwn.call(obj,"constructor")&&
!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){
return false;
}
}catch(e){
return false;
}
if(support.ownLast){
for(key in obj){
return hasOwn.call(obj,key);
}
}
for(key in obj){}
return key===undefined||hasOwn.call(obj,key);
},
type:function(obj){
if(obj==null){
return obj+"";
}
return typeof obj==="object"||typeof obj==="function"?
class2type[toString.call(obj)]||"object":
typeof obj;
},
globalEval:function(data){
if(data&&jQuery.trim(data)){
(window.execScript||function(data){
window["eval"].call(window,data);
})(data);
}
},
camelCase:function(string){
return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase);
},
nodeName:function(elem,name){
return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase();
},
each:function(obj,callback,args){
var value,
i=0,
length=obj.length,
isArray=isArraylike(obj);
if(args){
if(isArray){
for(;i<length;i++){
value=callback.apply(obj[i],args);
if(value===false){
break;
}
}
}else{
for(i in obj){
value=callback.apply(obj[i],args);
if(value===false){
break;
}
}
}
}else{
if(isArray){
for(;i<length;i++){
value=callback.call(obj[i],i,obj[i]);
if(value===false){
break;
}
}
}else{
for(i in obj){
value=callback.call(obj[i],i,obj[i]);
if(value===false){
break;
}
}
}
}
return obj;
},
trim:trim&&!trim.call("\uFEFF\xA0")?
function(text){
return text==null?
"":
trim.call(text);
}:
function(text){
return text==null?
"":
(text+"").replace(rtrim,"");
},
makeArray:function(arr,results){
var ret=results||[];
if(arr!=null){
if(isArraylike(Object(arr))){
jQuery.merge(ret,
typeof arr==="string"?
[arr]:arr
);
}else{
push.call(ret,arr);
}
}
return ret;
},
inArray:function(elem,arr,i){
var len;
if(arr){
if(indexOf){
return indexOf.call(arr,elem,i);
}
len=arr.length;
i=i?i<0?Math.max(0,len+i):i:0;
for(;i<len;i++){
if(i in arr&&arr[i]===elem){
return i;
}
}
}
return-1;
},
merge:function(first,second){
var len=+second.length,
j=0,
i=first.length;
while(j<len){
first[i++]=second[j++];
}
if(len!==len){
while(second[j]!==undefined){
first[i++]=second[j++];
}
}
first.length=i;
return first;
},
grep:function(elems,callback,invert){
var callbackInverse,
matches=[],
i=0,
length=elems.length,
callbackExpect=!invert;
for(;i<length;i++){
callbackInverse=!callback(elems[i],i);
if(callbackInverse!==callbackExpect){
matches.push(elems[i]);
}
}
return matches;
},
map:function(elems,callback,arg){
var value,
i=0,
length=elems.length,
isArray=isArraylike(elems),
ret=[];
if(isArray){
for(;i<length;i++){
value=callback(elems[i],i,arg);
if(value!=null){
ret.push(value);
}
}
}else{
for(i in elems){
value=callback(elems[i],i,arg);
if(value!=null){
ret.push(value);
}
}
}
return concat.apply([],ret);
},
guid:1,
proxy:function(fn,context){
var args,proxy,tmp;
if(typeof context==="string"){
tmp=fn[context];
context=fn;
fn=tmp;
}
if(!jQuery.isFunction(fn)){
return undefined;
}
args=slice.call(arguments,2);
proxy=function(){
return fn.apply(context||this,args.concat(slice.call(arguments)));
};
proxy.guid=fn.guid=fn.guid||jQuery.guid++;
return proxy;
},
now:function(){
return+(new Date());
},
support:support
});
jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){
class2type["[object "+name+"]"]=name.toLowerCase();
});
function isArraylike(obj){
var length=obj.length,
type=jQuery.type(obj);
if(type==="function"||jQuery.isWindow(obj)){
return false;
}
if(obj.nodeType===1&&length){
return true;
}
return type==="array"||length===0||
typeof length==="number"&&length>0&&(length-1)in obj;
}
var Sizzle=

(function(window){
var i,
support,
Expr,
getText,
isXML,
compile,
outermostContext,
sortInput,
hasDuplicate,
setDocument,
document,
docElem,
documentIsHTML,
rbuggyQSA,
rbuggyMatches,
matches,
contains,
expando="sizzle"+ -(new Date()),
preferredDoc=window.document,
dirruns=0,
done=0,
classCache=createCache(),
tokenCache=createCache(),
compilerCache=createCache(),
sortOrder=function(a,b){
if(a===b){
hasDuplicate=true;
}
return 0;
},
strundefined=typeof undefined,
MAX_NEGATIVE=1<<31,
hasOwn=({}).hasOwnProperty,
arr=[],
pop=arr.pop,
push_native=arr.push,
push=arr.push,
slice=arr.slice,
indexOf=arr.indexOf||function(elem){
var i=0,
len=this.length;
for(;i<len;i++){
if(this[i]===elem){
return i;
}
}
return-1;
},
booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
whitespace="[\\x20\\t\\r\\n\\f]",
characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
identifier=characterEncoding.replace("w","w#"),
attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+
"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",
pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",
rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),
rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),
rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),
rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),
rpseudo=new RegExp(pseudos),
ridentifier=new RegExp("^"+identifier+"$"),
matchExpr={
"ID":new RegExp("^#("+characterEncoding+")"),
"CLASS":new RegExp("^\\.("+characterEncoding+")"),
"TAG":new RegExp("^("+characterEncoding.replace("w","w*")+")"),
"ATTR":new RegExp("^"+attributes),
"PSEUDO":new RegExp("^"+pseudos),
"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+
"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+
"*(\\d+)|))"+whitespace+"*\\)|)","i"),
"bool":new RegExp("^(?:"+booleans+")$","i"),
"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+
whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")
},
rinputs=/^(?:input|select|textarea|button)$/i,
rheader=/^h\d$/i,
rnative=/^[^{]+\{\s*\[native \w/,
rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
rsibling=/[+~]/,
rescape=/'|\\/g,
runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),
funescape=function(_,escaped,escapedWhitespace){
var high="0x"+escaped-0x10000;
return high!==high||escapedWhitespace?
escaped:
high<0?
String.fromCharCode(high+0x10000):
String.fromCharCode(high>>10|0xD800,high&0x3FF|0xDC00);
};
try{
push.apply(
(arr=slice.call(preferredDoc.childNodes)),
preferredDoc.childNodes
);
arr[preferredDoc.childNodes.length].nodeType;
}catch(e){
push={apply:arr.length?
function(target,els){
push_native.apply(target,slice.call(els));
}:
function(target,els){
var j=target.length,
i=0;
while((target[j++]=els[i++])){}
target.length=j-1;
}
};
}
function Sizzle(selector,context,results,seed){
var match,elem,m,nodeType,
i,groups,old,nid,newContext,newSelector;
if((context?context.ownerDocument||context:preferredDoc)!==document){
setDocument(context);
}
context=context||document;
results=results||[];
if(!selector||typeof selector!=="string"){
return results;
}
if((nodeType=context.nodeType)!==1&&nodeType!==9){
return[];
}
if(documentIsHTML&&!seed){
if((match=rquickExpr.exec(selector))){
if((m=match[1])){
if(nodeType===9){
elem=context.getElementById(m);
if(elem&&elem.parentNode){
if(elem.id===m){
results.push(elem);
return results;
}
}else{
return results;
}
}else{
if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&
contains(context,elem)&&elem.id===m){
results.push(elem);
return results;
}
}
}else if(match[2]){
push.apply(results,context.getElementsByTagName(selector));
return results;
}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){
push.apply(results,context.getElementsByClassName(m));
return results;
}
}
if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){
nid=old=expando;
newContext=context;
newSelector=nodeType===9&&selector;
if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){
groups=tokenize(selector);
if((old=context.getAttribute("id"))){
nid=old.replace(rescape,"\\$&");
}else{
context.setAttribute("id",nid);
}
nid="[id='"+nid+"'] ";
i=groups.length;
while(i--){
groups[i]=nid+toSelector(groups[i]);
}
newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;
newSelector=groups.join(",");
}
if(newSelector){
try{
push.apply(results,
newContext.querySelectorAll(newSelector)
);
return results;
}catch(qsaError){
}finally{
if(!old){
context.removeAttribute("id");
}
}
}
}
}
return select(selector.replace(rtrim,"$1"),context,results,seed);
}

function createCache(){
var keys=[];
function cache(key,value){
if(keys.push(key+" ")>Expr.cacheLength){
delete cache[keys.shift()];
}
return(cache[key+" "]=value);
}
return cache;
}

function markFunction(fn){
fn[expando]=true;
return fn;
}

function assert(fn){
var div=document.createElement("div");
try{
return!!fn(div);
}catch(e){
return false;
}finally{
if(div.parentNode){
div.parentNode.removeChild(div);
}
div=null;
}
}

function addHandle(attrs,handler){
var arr=attrs.split("|"),
i=attrs.length;
while(i--){
Expr.attrHandle[arr[i]]=handler;
}
}

function siblingCheck(a,b){
var cur=b&&a,
diff=cur&&a.nodeType===1&&b.nodeType===1&&
(~b.sourceIndex||MAX_NEGATIVE)-
(~a.sourceIndex||MAX_NEGATIVE);
if(diff){
return diff;
}
if(cur){
while((cur=cur.nextSibling)){
if(cur===b){
return-1;
}
}
}
return a?1:-1;
}

function createInputPseudo(type){
return function(elem){
var name=elem.nodeName.toLowerCase();
return name==="input"&&elem.type===type;
};
}

function createButtonPseudo(type){
return function(elem){
var name=elem.nodeName.toLowerCase();
return(name==="input"||name==="button")&&elem.type===type;
};
}

function createPositionalPseudo(fn){
return markFunction(function(argument){
argument=+argument;
return markFunction(function(seed,matches){
var j,
matchIndexes=fn([],seed.length,argument),
i=matchIndexes.length;
while(i--){
if(seed[(j=matchIndexes[i])]){
seed[j]=!(matches[j]=seed[j]);
}
}
});
});
}

function testContext(context){
return context&&typeof context.getElementsByTagName!==strundefined&&context;
}
support=Sizzle.support={};

isXML=Sizzle.isXML=function(elem){
var documentElement=elem&&(elem.ownerDocument||elem).documentElement;
return documentElement?documentElement.nodeName!=="HTML":false;
};

setDocument=Sizzle.setDocument=function(node){
var hasCompare,
doc=node?node.ownerDocument||node:preferredDoc,
parent=doc.defaultView;
if(doc===document||doc.nodeType!==9||!doc.documentElement){
return document;
}
document=doc;
docElem=doc.documentElement;
documentIsHTML=!isXML(doc);
if(parent&&parent!==parent.top){
if(parent.addEventListener){
parent.addEventListener("unload",function(){
setDocument();
},false);
}else if(parent.attachEvent){
parent.attachEvent("onunload",function(){
setDocument();
});
}
}

support.attributes=assert(function(div){
div.className="i";
return!div.getAttribute("className");
});

support.getElementsByTagName=assert(function(div){
div.appendChild(doc.createComment(""));
return!div.getElementsByTagName("*").length;
});
support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){
div.innerHTML="<div class='a'></div><div class='a i'></div>";
div.firstChild.className="i";
return div.getElementsByClassName("i").length===2;
});
support.getById=assert(function(div){
docElem.appendChild(div).id=expando;
return!doc.getElementsByName||!doc.getElementsByName(expando).length;
});
if(support.getById){
Expr.find["ID"]=function(id,context){
if(typeof context.getElementById!==strundefined&&documentIsHTML){
var m=context.getElementById(id);
return m&&m.parentNode?[m]:[];
}
};
Expr.filter["ID"]=function(id){
var attrId=id.replace(runescape,funescape);
return function(elem){
return elem.getAttribute("id")===attrId;
};
};
}else{
delete Expr.find["ID"];
Expr.filter["ID"]=function(id){
var attrId=id.replace(runescape,funescape);
return function(elem){
var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");
return node&&node.value===attrId;
};
};
}
Expr.find["TAG"]=support.getElementsByTagName?
function(tag,context){
if(typeof context.getElementsByTagName!==strundefined){
return context.getElementsByTagName(tag);
}
}:
function(tag,context){
var elem,
tmp=[],
i=0,
results=context.getElementsByTagName(tag);
if(tag==="*"){
while((elem=results[i++])){
if(elem.nodeType===1){
tmp.push(elem);
}
}
return tmp;
}
return results;
};
Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){
if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){
return context.getElementsByClassName(className);
}
};

rbuggyMatches=[];
rbuggyQSA=[];
if((support.qsa=rnative.test(doc.querySelectorAll))){
assert(function(div){
div.innerHTML="<select t=''><option selected=''></option></select>";
if(div.querySelectorAll("[t^='']").length){
rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")");
}
if(!div.querySelectorAll("[selected]").length){
rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")");
}
if(!div.querySelectorAll(":checked").length){
rbuggyQSA.push(":checked");
}
});
assert(function(div){
var input=doc.createElement("input");
input.setAttribute("type","hidden");
div.appendChild(input).setAttribute("name","D");
if(div.querySelectorAll("[name=d]").length){
rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=");
}
if(!div.querySelectorAll(":enabled").length){
rbuggyQSA.push(":enabled",":disabled");
}
div.querySelectorAll("*,:x");
rbuggyQSA.push(",.*:");
});
}
if((support.matchesSelector=rnative.test((matches=docElem.webkitMatchesSelector||
docElem.mozMatchesSelector||
docElem.oMatchesSelector||
docElem.msMatchesSelector)))){
assert(function(div){
support.disconnectedMatch=matches.call(div,"div");
matches.call(div,"[s!='']:x");
rbuggyMatches.push("!=",pseudos);
});
}
rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));
rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));

hasCompare=rnative.test(docElem.compareDocumentPosition);
contains=hasCompare||rnative.test(docElem.contains)?
function(a,b){
var adown=a.nodeType===9?a.documentElement:a,
bup=b&&b.parentNode;
return a===bup||!!(bup&&bup.nodeType===1&&(
adown.contains?
adown.contains(bup):
a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16
));
}:
function(a,b){
if(b){
while((b=b.parentNode)){
if(b===a){
return true;
}
}
}
return false;
};

sortOrder=hasCompare?
function(a,b){
if(a===b){
hasDuplicate=true;
return 0;
}
var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;
if(compare){
return compare;
}
compare=(a.ownerDocument||a)===(b.ownerDocument||b)?
a.compareDocumentPosition(b):
1;
if(compare&1||
(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){
if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){
return-1;
}
if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){
return 1;
}
return sortInput?
(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):
0;
}
return compare&4?-1:1;
}:
function(a,b){
if(a===b){
hasDuplicate=true;
return 0;
}
var cur,
i=0,
aup=a.parentNode,
bup=b.parentNode,
ap=[a],
bp=[b];
if(!aup||!bup){
return a===doc?-1:
b===doc?1:
aup?-1:
bup?1:
sortInput?
(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):
0;
}else if(aup===bup){
return siblingCheck(a,b);
}
cur=a;
while((cur=cur.parentNode)){
ap.unshift(cur);
}
cur=b;
while((cur=cur.parentNode)){
bp.unshift(cur);
}
while(ap[i]===bp[i]){
i++;
}
return i?
siblingCheck(ap[i],bp[i]):
ap[i]===preferredDoc?-1:
bp[i]===preferredDoc?1:
0;
};
return doc;
};
Sizzle.matches=function(expr,elements){
return Sizzle(expr,null,null,elements);
};
Sizzle.matchesSelector=function(elem,expr){
if((elem.ownerDocument||elem)!==document){
setDocument(elem);
}
expr=expr.replace(rattributeQuotes,"='$1']");
if(support.matchesSelector&&documentIsHTML&&
(!rbuggyMatches||!rbuggyMatches.test(expr))&&
(!rbuggyQSA||!rbuggyQSA.test(expr))){
try{
var ret=matches.call(elem,expr);
if(ret||support.disconnectedMatch||
elem.document&&elem.document.nodeType!==11){
return ret;
}
}catch(e){}
}
return Sizzle(expr,document,null,[elem]).length>0;
};
Sizzle.contains=function(context,elem){
if((context.ownerDocument||context)!==document){
setDocument(context);
}
return contains(context,elem);
};
Sizzle.attr=function(elem,name){
if((elem.ownerDocument||elem)!==document){
setDocument(elem);
}
var fn=Expr.attrHandle[name.toLowerCase()],
val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?
fn(elem,name,!documentIsHTML):
undefined;
return val!==undefined?
val:
support.attributes||!documentIsHTML?
elem.getAttribute(name):
(val=elem.getAttributeNode(name))&&val.specified?
val.value:
null;
};
Sizzle.error=function(msg){
throw new Error("Syntax error, unrecognized expression: "+msg);
};

Sizzle.uniqueSort=function(results){
var elem,
duplicates=[],
j=0,
i=0;
hasDuplicate=!support.detectDuplicates;
sortInput=!support.sortStable&&results.slice(0);
results.sort(sortOrder);
if(hasDuplicate){
while((elem=results[i++])){
if(elem===results[i]){
j=duplicates.push(i);
}
}
while(j--){
results.splice(duplicates[j],1);
}
}
sortInput=null;
return results;
};

getText=Sizzle.getText=function(elem){
var node,
ret="",
i=0,
nodeType=elem.nodeType;
if(!nodeType){
while((node=elem[i++])){
ret+=getText(node);
}
}else if(nodeType===1||nodeType===9||nodeType===11){
if(typeof elem.textContent==="string"){
return elem.textContent;
}else{
for(elem=elem.firstChild;elem;elem=elem.nextSibling){
ret+=getText(elem);
}
}
}else if(nodeType===3||nodeType===4){
return elem.nodeValue;
}
return ret;
};
Expr=Sizzle.selectors={
cacheLength:50,
createPseudo:markFunction,
match:matchExpr,
attrHandle:{},
find:{},
relative:{
">":{dir:"parentNode",first:true},
" ":{dir:"parentNode"},
"+":{dir:"previousSibling",first:true},
"~":{dir:"previousSibling"}
},
preFilter:{
"ATTR":function(match){
match[1]=match[1].replace(runescape,funescape);
match[3]=(match[4]||match[5]||"").replace(runescape,funescape);
if(match[2]==="~="){
match[3]=" "+match[3]+" ";
}
return match.slice(0,4);
},
"CHILD":function(match){

match[1]=match[1].toLowerCase();
if(match[1].slice(0,3)==="nth"){
if(!match[3]){
Sizzle.error(match[0]);
}
match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));
match[5]=+((match[7]+match[8])||match[3]==="odd");
}else if(match[3]){
Sizzle.error(match[0]);
}
return match;
},
"PSEUDO":function(match){
var excess,
unquoted=!match[5]&&match[2];
if(matchExpr["CHILD"].test(match[0])){
return null;
}
if(match[3]&&match[4]!==undefined){
match[2]=match[4];
}else if(unquoted&&rpseudo.test(unquoted)&&
(excess=tokenize(unquoted,true))&&
(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){
match[0]=match[0].slice(0,excess);
match[2]=unquoted.slice(0,excess);
}
return match.slice(0,3);
}
},
filter:{
"TAG":function(nodeNameSelector){
var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();
return nodeNameSelector==="*"?
function(){return true}:
function(elem){
return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;
};
},
"CLASS":function(className){
var pattern=classCache[className+" "];
return pattern||
(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&
classCache(className,function(elem){
return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"");
});
},
"ATTR":function(name,operator,check){
return function(elem){
var result=Sizzle.attr(elem,name);
if(result==null){
return operator==="!=";
}
if(!operator){
return true;
}
result+="";
return operator==="="?result===check:
operator==="!="?result!==check:
operator==="^="?check&&result.indexOf(check)===0:
operator==="*="?check&&result.indexOf(check)>-1:
operator==="$="?check&&result.slice(-check.length)===check:
operator==="~="?(" "+result+" ").indexOf(check)>-1:
operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":
false;
};
},
"CHILD":function(type,what,argument,first,last){
var simple=type.slice(0,3)!=="nth",
forward=type.slice(-4)!=="last",
ofType=what==="of-type";
return first===1&&last===0?
function(elem){
return!!elem.parentNode;
}:
function(elem,context,xml){
var cache,outerCache,node,diff,nodeIndex,start,
dir=simple!==forward?"nextSibling":"previousSibling",
parent=elem.parentNode,
name=ofType&&elem.nodeName.toLowerCase(),
useCache=!xml&&!ofType;
if(parent){
if(simple){
while(dir){
node=elem;
while((node=node[dir])){
if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){
return false;
}
}
start=dir=type==="only"&&!start&&"nextSibling";
}
return true;
}
start=[forward?parent.firstChild:parent.lastChild];
if(forward&&useCache){
outerCache=parent[expando]||(parent[expando]={});
cache=outerCache[type]||[];
nodeIndex=cache[0]===dirruns&&cache[1];
diff=cache[0]===dirruns&&cache[2];
node=nodeIndex&&parent.childNodes[nodeIndex];
while((node=++nodeIndex&&node&&node[dir]||
(diff=nodeIndex=0)||start.pop())){
if(node.nodeType===1&&++diff&&node===elem){
outerCache[type]=[dirruns,nodeIndex,diff];
break;
}
}
}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){
diff=cache[1];
}else{
while((node=++nodeIndex&&node&&node[dir]||
(diff=nodeIndex=0)||start.pop())){
if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){
if(useCache){
(node[expando]||(node[expando]={}))[type]=[dirruns,diff];
}
if(node===elem){
break;
}
}
}
}
diff-=last;
return diff===first||(diff%first===0&&diff/first>=0);
}
};
},
"PSEUDO":function(pseudo,argument){
var args,
fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||
Sizzle.error("unsupported pseudo: "+pseudo);
if(fn[expando]){
return fn(argument);
}
if(fn.length>1){
args=[pseudo,pseudo,"",argument];
return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?
markFunction(function(seed,matches){
var idx,
matched=fn(seed,argument),
i=matched.length;
while(i--){
idx=indexOf.call(seed,matched[i]);
seed[idx]=!(matches[idx]=matched[i]);
}
}):
function(elem){
return fn(elem,0,args);
};
}
return fn;
}
},
pseudos:{
"not":markFunction(function(selector){
var input=[],
results=[],
matcher=compile(selector.replace(rtrim,"$1"));
return matcher[expando]?
markFunction(function(seed,matches,context,xml){
var elem,
unmatched=matcher(seed,null,xml,[]),
i=seed.length;
while(i--){
if((elem=unmatched[i])){
seed[i]=!(matches[i]=elem);
}
}
}):
function(elem,context,xml){
input[0]=elem;
matcher(input,null,xml,results);
return!results.pop();
};
}),
"has":markFunction(function(selector){
return function(elem){
return Sizzle(selector,elem).length>0;
};
}),
"contains":markFunction(function(text){
return function(elem){
return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1;
};
}),
"lang":markFunction(function(lang){
if(!ridentifier.test(lang||"")){
Sizzle.error("unsupported lang: "+lang);
}
lang=lang.replace(runescape,funescape).toLowerCase();
return function(elem){
var elemLang;
do{
if((elemLang=documentIsHTML?
elem.lang:
elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){
elemLang=elemLang.toLowerCase();
return elemLang===lang||elemLang.indexOf(lang+"-")===0;
}
}while((elem=elem.parentNode)&&elem.nodeType===1);
return false;
};
}),
"target":function(elem){
var hash=window.location&&window.location.hash;
return hash&&hash.slice(1)===elem.id;
},
"root":function(elem){
return elem===docElem;
},
"focus":function(elem){
return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);
},
"enabled":function(elem){
return elem.disabled===false;
},
"disabled":function(elem){
return elem.disabled===true;
},
"checked":function(elem){
var nodeName=elem.nodeName.toLowerCase();
return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected);
},
"selected":function(elem){
if(elem.parentNode){
elem.parentNode.selectedIndex;
}
return elem.selected===true;
},
"empty":function(elem){
for(elem=elem.firstChild;elem;elem=elem.nextSibling){
if(elem.nodeType<6){
return false;
}
}
return true;
},
"parent":function(elem){
return!Expr.pseudos["empty"](elem);
},
"header":function(elem){
return rheader.test(elem.nodeName);
},
"input":function(elem){
return rinputs.test(elem.nodeName);
},
"button":function(elem){
var name=elem.nodeName.toLowerCase();
return name==="input"&&elem.type==="button"||name==="button";
},
"text":function(elem){
var attr;
return elem.nodeName.toLowerCase()==="input"&&
elem.type==="text"&&
((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text");
},
"first":createPositionalPseudo(function(){
return[0];
}),
"last":createPositionalPseudo(function(matchIndexes,length){
return[length-1];
}),
"eq":createPositionalPseudo(function(matchIndexes,length,argument){
return[argument<0?argument+length:argument];
}),
"even":createPositionalPseudo(function(matchIndexes,length){
var i=0;
for(;i<length;i+=2){
matchIndexes.push(i);
}
return matchIndexes;
}),
"odd":createPositionalPseudo(function(matchIndexes,length){
var i=1;
for(;i<length;i+=2){
matchIndexes.push(i);
}
return matchIndexes;
}),
"lt":createPositionalPseudo(function(matchIndexes,length,argument){
var i=argument<0?argument+length:argument;
for(;--i>=0;){
matchIndexes.push(i);
}
return matchIndexes;
}),
"gt":createPositionalPseudo(function(matchIndexes,length,argument){
var i=argument<0?argument+length:argument;
for(;++i<length;){
matchIndexes.push(i);
}
return matchIndexes;
})
}
};
Expr.pseudos["nth"]=Expr.pseudos["eq"];
for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){
Expr.pseudos[i]=createInputPseudo(i);
}
for(i in{submit:true,reset:true}){
Expr.pseudos[i]=createButtonPseudo(i);
}
function setFilters(){}
setFilters.prototype=Expr.filters=Expr.pseudos;
Expr.setFilters=new setFilters();
function tokenize(selector,parseOnly){
var matched,match,tokens,type,
soFar,groups,preFilters,
cached=tokenCache[selector+" "];
if(cached){
return parseOnly?0:cached.slice(0);
}
soFar=selector;
groups=[];
preFilters=Expr.preFilter;
while(soFar){
if(!matched||(match=rcomma.exec(soFar))){
if(match){
soFar=soFar.slice(match[0].length)||soFar;
}
groups.push((tokens=[]));
}
matched=false;
if((match=rcombinators.exec(soFar))){
matched=match.shift();
tokens.push({
value:matched,
type:match[0].replace(rtrim," ")
});
soFar=soFar.slice(matched.length);
}
for(type in Expr.filter){
if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||
(match=preFilters[type](match)))){
matched=match.shift();
tokens.push({
value:matched,
type:type,
matches:match
});
soFar=soFar.slice(matched.length);
}
}
if(!matched){
break;
}
}
return parseOnly?
soFar.length:
soFar?
Sizzle.error(selector):
tokenCache(selector,groups).slice(0);
}
function toSelector(tokens){
var i=0,
len=tokens.length,
selector="";
for(;i<len;i++){
selector+=tokens[i].value;
}
return selector;
}
function addCombinator(matcher,combinator,base){
var dir=combinator.dir,
checkNonElements=base&&dir==="parentNode",
doneName=done++;
return combinator.first?
function(elem,context,xml){
while((elem=elem[dir])){
if(elem.nodeType===1||checkNonElements){
return matcher(elem,context,xml);
}
}
}:
function(elem,context,xml){
var oldCache,outerCache,
newCache=[dirruns,doneName];
if(xml){
while((elem=elem[dir])){
if(elem.nodeType===1||checkNonElements){
if(matcher(elem,context,xml)){
return true;
}
}
}
}else{
while((elem=elem[dir])){
if(elem.nodeType===1||checkNonElements){
outerCache=elem[expando]||(elem[expando]={});
if((oldCache=outerCache[dir])&&
oldCache[0]===dirruns&&oldCache[1]===doneName){
return(newCache[2]=oldCache[2]);
}else{
outerCache[dir]=newCache;
if((newCache[2]=matcher(elem,context,xml))){
return true;
}
}
}
}
}
};
}
function elementMatcher(matchers){
return matchers.length>1?
function(elem,context,xml){
var i=matchers.length;
while(i--){
if(!matchers[i](elem,context,xml)){
return false;
}
}
return true;
}:
matchers[0];
}
function condense(unmatched,map,filter,context,xml){
var elem,
newUnmatched=[],
i=0,
len=unmatched.length,
mapped=map!=null;
for(;i<len;i++){
if((elem=unmatched[i])){
if(!filter||filter(elem,context,xml)){
newUnmatched.push(elem);
if(mapped){
map.push(i);
}
}
}
}
return newUnmatched;
}
function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){
if(postFilter&&!postFilter[expando]){
postFilter=setMatcher(postFilter);
}
if(postFinder&&!postFinder[expando]){
postFinder=setMatcher(postFinder,postSelector);
}
return markFunction(function(seed,results,context,xml){
var temp,i,elem,
preMap=[],
postMap=[],
preexisting=results.length,
elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),
matcherIn=preFilter&&(seed||!selector)?
condense(elems,preMap,preFilter,context,xml):
elems,
matcherOut=matcher?
postFinder||(seed?preFilter:preexisting||postFilter)?
[]:
results:
matcherIn;
if(matcher){
matcher(matcherIn,matcherOut,context,xml);
}
if(postFilter){
temp=condense(matcherOut,postMap);
postFilter(temp,[],context,xml);
i=temp.length;
while(i--){
if((elem=temp[i])){
matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem);
}
}
}
if(seed){
if(postFinder||preFilter){
if(postFinder){
temp=[];
i=matcherOut.length;
while(i--){
if((elem=matcherOut[i])){
temp.push((matcherIn[i]=elem));
}
}
postFinder(null,(matcherOut=[]),temp,xml);
}
i=matcherOut.length;
while(i--){
if((elem=matcherOut[i])&&
(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){
seed[temp]=!(results[temp]=elem);
}
}
}
}else{
matcherOut=condense(
matcherOut===results?
matcherOut.splice(preexisting,matcherOut.length):
matcherOut
);
if(postFinder){
postFinder(null,results,matcherOut,xml);
}else{
push.apply(results,matcherOut);
}
}
});
}
function matcherFromTokens(tokens){
var checkContext,matcher,j,
len=tokens.length,
leadingRelative=Expr.relative[tokens[0].type],
implicitRelative=leadingRelative||Expr.relative[" "],
i=leadingRelative?1:0,
matchContext=addCombinator(function(elem){
return elem===checkContext;
},implicitRelative,true),
matchAnyContext=addCombinator(function(elem){
return indexOf.call(checkContext,elem)>-1;
},implicitRelative,true),
matchers=[function(elem,context,xml){
return(!leadingRelative&&(xml||context!==outermostContext))||(
(checkContext=context).nodeType?
matchContext(elem,context,xml):
matchAnyContext(elem,context,xml));
}];
for(;i<len;i++){
if((matcher=Expr.relative[tokens[i].type])){
matchers=[addCombinator(elementMatcher(matchers),matcher)];
}else{
matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);
if(matcher[expando]){
j=++i;
for(;j<len;j++){
if(Expr.relative[tokens[j].type]){
break;
}
}
return setMatcher(
i>1&&elementMatcher(matchers),
i>1&&toSelector(
tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})
).replace(rtrim,"$1"),
matcher,
i<j&&matcherFromTokens(tokens.slice(i,j)),
j<len&&matcherFromTokens((tokens=tokens.slice(j))),
j<len&&toSelector(tokens)
);
}
matchers.push(matcher);
}
}
return elementMatcher(matchers);
}
function matcherFromGroupMatchers(elementMatchers,setMatchers){
var bySet=setMatchers.length>0,
byElement=elementMatchers.length>0,
superMatcher=function(seed,context,xml,results,outermost){
var elem,j,matcher,
matchedCount=0,
i="0",
unmatched=seed&&[],
setMatched=[],
contextBackup=outermostContext,
elems=seed||byElement&&Expr.find["TAG"]("*",outermost),
dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1),
len=elems.length;
if(outermost){
outermostContext=context!==document&&context;
}
for(;i!==len&&(elem=elems[i])!=null;i++){
if(byElement&&elem){
j=0;
while((matcher=elementMatchers[j++])){
if(matcher(elem,context,xml)){
results.push(elem);
break;
}
}
if(outermost){
dirruns=dirrunsUnique;
}
}
if(bySet){
if((elem=!matcher&&elem)){
matchedCount--;
}
if(seed){
unmatched.push(elem);
}
}
}
matchedCount+=i;
if(bySet&&i!==matchedCount){
j=0;
while((matcher=setMatchers[j++])){
matcher(unmatched,setMatched,context,xml);
}
if(seed){
if(matchedCount>0){
while(i--){
if(!(unmatched[i]||setMatched[i])){
setMatched[i]=pop.call(results);
}
}
}
setMatched=condense(setMatched);
}
push.apply(results,setMatched);
if(outermost&&!seed&&setMatched.length>0&&
(matchedCount+setMatchers.length)>1){
Sizzle.uniqueSort(results);
}
}
if(outermost){
dirruns=dirrunsUnique;
outermostContext=contextBackup;
}
return unmatched;
};
return bySet?
markFunction(superMatcher):
superMatcher;
}
compile=Sizzle.compile=function(selector,group){
var i,
setMatchers=[],
elementMatchers=[],
cached=compilerCache[selector+" "];
if(!cached){
if(!group){
group=tokenize(selector);
}
i=group.length;
while(i--){
cached=matcherFromTokens(group[i]);
if(cached[expando]){
setMatchers.push(cached);
}else{
elementMatchers.push(cached);
}
}
cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));
}
return cached;
};
function multipleContexts(selector,contexts,results){
var i=0,
len=contexts.length;
for(;i<len;i++){
Sizzle(selector,contexts[i],results);
}
return results;
}
function select(selector,context,results,seed){
var i,tokens,token,type,find,
match=tokenize(selector);
if(!seed){
if(match.length===1){
tokens=match[0]=match[0].slice(0);
if(tokens.length>2&&(token=tokens[0]).type==="ID"&&
support.getById&&context.nodeType===9&&documentIsHTML&&
Expr.relative[tokens[1].type]){
context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];
if(!context){
return results;
}
selector=selector.slice(tokens.shift().value.length);
}
i=matchExpr["needsContext"].test(selector)?0:tokens.length;
while(i--){
token=tokens[i];
if(Expr.relative[(type=token.type)]){
break;
}
if((find=Expr.find[type])){
if((seed=find(
token.matches[0].replace(runescape,funescape),
rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context
))){
tokens.splice(i,1);
selector=seed.length&&toSelector(tokens);
if(!selector){
push.apply(results,seed);
return results;
}
break;
}
}
}
}
}
compile(selector,match)(
seed,
context,
!documentIsHTML,
results,
rsibling.test(selector)&&testContext(context.parentNode)||context
);
return results;
}
support.sortStable=expando.split("").sort(sortOrder).join("")===expando;
support.detectDuplicates=!!hasDuplicate;
setDocument();
support.sortDetached=assert(function(div1){
return div1.compareDocumentPosition(document.createElement("div"))&1;
});
if(!assert(function(div){
div.innerHTML="<a href='#'></a>";
return div.firstChild.getAttribute("href")==="#";
})){
addHandle("type|href|height|width",function(elem,name,isXML){
if(!isXML){
return elem.getAttribute(name,name.toLowerCase()==="type"?1:2);
}
});
}
if(!support.attributes||!assert(function(div){
div.innerHTML="<input/>";
div.firstChild.setAttribute("value","");
return div.firstChild.getAttribute("value")==="";
})){
addHandle("value",function(elem,name,isXML){
if(!isXML&&elem.nodeName.toLowerCase()==="input"){
return elem.defaultValue;
}
});
}
if(!assert(function(div){
return div.getAttribute("disabled")==null;
})){
addHandle(booleans,function(elem,name,isXML){
var val;
if(!isXML){
return elem[name]===true?name.toLowerCase():
(val=elem.getAttributeNode(name))&&val.specified?
val.value:
null;
}
});
}
return Sizzle;
})(window);
jQuery.find=Sizzle;
jQuery.expr=Sizzle.selectors;
jQuery.expr[":"]=jQuery.expr.pseudos;
jQuery.unique=Sizzle.uniqueSort;
jQuery.text=Sizzle.getText;
jQuery.isXMLDoc=Sizzle.isXML;
jQuery.contains=Sizzle.contains;
var rneedsContext=jQuery.expr.match.needsContext;
var rsingleTag=(/^<(\w+)\s*\/?>(?:<\/\1>|)$/);
var risSimple=/^.[^:#\[\.,]*$/;
function winnow(elements,qualifier,not){
if(jQuery.isFunction(qualifier)){
return jQuery.grep(elements,function(elem,i){

return!!qualifier.call(elem,i,elem)!==not;
});
}
if(qualifier.nodeType){
return jQuery.grep(elements,function(elem){
return(elem===qualifier)!==not;
});
}
if(typeof qualifier==="string"){
if(risSimple.test(qualifier)){
return jQuery.filter(qualifier,elements,not);
}
qualifier=jQuery.filter(qualifier,elements);
}
return jQuery.grep(elements,function(elem){
return(jQuery.inArray(elem,qualifier)>=0)!==not;
});
}
jQuery.filter=function(expr,elems,not){
var elem=elems[0];
if(not){
expr=":not("+expr+")";
}
return elems.length===1&&elem.nodeType===1?
jQuery.find.matchesSelector(elem,expr)?[elem]:[]:
jQuery.find.matches(expr,jQuery.grep(elems,function(elem){
return elem.nodeType===1;
}));
};
jQuery.fn.extend({
find:function(selector){
var i,
ret=[],
self=this,
len=self.length;
if(typeof selector!=="string"){
return this.pushStack(jQuery(selector).filter(function(){
for(i=0;i<len;i++){
if(jQuery.contains(self[i],this)){
return true;
}
}
}));
}
for(i=0;i<len;i++){
jQuery.find(selector,self[i],ret);
}
ret=this.pushStack(len>1?jQuery.unique(ret):ret);
ret.selector=this.selector?this.selector+" "+selector:selector;
return ret;
},
filter:function(selector){
return this.pushStack(winnow(this,selector||[],false));
},
not:function(selector){
return this.pushStack(winnow(this,selector||[],true));
},
is:function(selector){
return!!winnow(
this,
typeof selector==="string"&&rneedsContext.test(selector)?
jQuery(selector):
selector||[],
false
).length;
}
});
var rootjQuery,
document=window.document,
rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
init=jQuery.fn.init=function(selector,context){
var match,elem;
if(!selector){
return this;
}
if(typeof selector==="string"){
if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){
match=[null,selector,null];
}else{
match=rquickExpr.exec(selector);
}
if(match&&(match[1]||!context)){
if(match[1]){
context=context instanceof jQuery?context[0]:context;
jQuery.merge(this,jQuery.parseHTML(
match[1],
context&&context.nodeType?context.ownerDocument||context:document,
true
));
if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){
for(match in context){
if(jQuery.isFunction(this[match])){
this[match](context[match]);
}else{
this.attr(match,context[match]);
}
}
}
return this;
}else{
elem=document.getElementById(match[2]);
if(elem&&elem.parentNode){
if(elem.id!==match[2]){
return rootjQuery.find(selector);
}
this.length=1;
this[0]=elem;
}
this.context=document;
this.selector=selector;
return this;
}
}else if(!context||context.jquery){
return(context||rootjQuery).find(selector);
}else{
return this.constructor(context).find(selector);
}
}else if(selector.nodeType){
this.context=this[0]=selector;
this.length=1;
return this;
}else if(jQuery.isFunction(selector)){
return typeof rootjQuery.ready!=="undefined"?
rootjQuery.ready(selector):
selector(jQuery);
}
if(selector.selector!==undefined){
this.selector=selector.selector;
this.context=selector.context;
}
return jQuery.makeArray(selector,this);
};
init.prototype=jQuery.fn;
rootjQuery=jQuery(document);
var rparentsprev=/^(?:parents|prev(?:Until|All))/,
guaranteedUnique={
children:true,
contents:true,
next:true,
prev:true
};
jQuery.extend({
dir:function(elem,dir,until){
var matched=[],
cur=elem[dir];
while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){
if(cur.nodeType===1){
matched.push(cur);
}
cur=cur[dir];
}
return matched;
},
sibling:function(n,elem){
var r=[];
for(;n;n=n.nextSibling){
if(n.nodeType===1&&n!==elem){
r.push(n);
}
}
return r;
}
});
jQuery.fn.extend({
has:function(target){
var i,
targets=jQuery(target,this),
len=targets.length;
return this.filter(function(){
for(i=0;i<len;i++){
if(jQuery.contains(this,targets[i])){
return true;
}
}
});
},
closest:function(selectors,context){
var cur,
i=0,
l=this.length,
matched=[],
pos=rneedsContext.test(selectors)||typeof selectors!=="string"?
jQuery(selectors,context||this.context):
0;
for(;i<l;i++){
for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){
if(cur.nodeType<11&&(pos?
pos.index(cur)>-1:
cur.nodeType===1&&
jQuery.find.matchesSelector(cur,selectors))){
matched.push(cur);
break;
}
}
}
return this.pushStack(matched.length>1?jQuery.unique(matched):matched);
},
index:function(elem){
if(!elem){
return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1;
}
if(typeof elem==="string"){
return jQuery.inArray(this[0],jQuery(elem));
}
return jQuery.inArray(
elem.jquery?elem[0]:elem,this);
},
add:function(selector,context){
return this.pushStack(
jQuery.unique(
jQuery.merge(this.get(),jQuery(selector,context))
)
);
},
addBack:function(selector){
return this.add(selector==null?
this.prevObject:this.prevObject.filter(selector)
);
}
});
function sibling(cur,dir){
do{
cur=cur[dir];
}while(cur&&cur.nodeType!==1);
return cur;
}
jQuery.each({
parent:function(elem){
var parent=elem.parentNode;
return parent&&parent.nodeType!==11?parent:null;
},
parents:function(elem){
return jQuery.dir(elem,"parentNode");
},
parentsUntil:function(elem,i,until){
return jQuery.dir(elem,"parentNode",until);
},
next:function(elem){
return sibling(elem,"nextSibling");
},
prev:function(elem){
return sibling(elem,"previousSibling");
},
nextAll:function(elem){
return jQuery.dir(elem,"nextSibling");
},
prevAll:function(elem){
return jQuery.dir(elem,"previousSibling");
},
nextUntil:function(elem,i,until){
return jQuery.dir(elem,"nextSibling",until);
},
prevUntil:function(elem,i,until){
return jQuery.dir(elem,"previousSibling",until);
},
siblings:function(elem){
return jQuery.sibling((elem.parentNode||{}).firstChild,elem);
},
children:function(elem){
return jQuery.sibling(elem.firstChild);
},
contents:function(elem){
return jQuery.nodeName(elem,"iframe")?
elem.contentDocument||elem.contentWindow.document:
jQuery.merge([],elem.childNodes);
}
},function(name,fn){
jQuery.fn[name]=function(until,selector){
var ret=jQuery.map(this,fn,until);
if(name.slice(-5)!=="Until"){
selector=until;
}
if(selector&&typeof selector==="string"){
ret=jQuery.filter(selector,ret);
}
if(this.length>1){
if(!guaranteedUnique[name]){
ret=jQuery.unique(ret);
}
if(rparentsprev.test(name)){
ret=ret.reverse();
}
}
return this.pushStack(ret);
};
});
var rnotwhite=(/\S+/g);
var optionsCache={};
function createOptions(options){
var object=optionsCache[options]={};
jQuery.each(options.match(rnotwhite)||[],function(_,flag){
object[flag]=true;
});
return object;
}

jQuery.Callbacks=function(options){
options=typeof options==="string"?
(optionsCache[options]||createOptions(options)):
jQuery.extend({},options);
var firing,
memory,
fired,
firingLength,
firingIndex,
firingStart,
list=[],
stack=!options.once&&[],
fire=function(data){
memory=options.memory&&data;
fired=true;
firingIndex=firingStart||0;
firingStart=0;
firingLength=list.length;
firing=true;
for(;list&&firingIndex<firingLength;firingIndex++){
if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){
memory=false;break;
}
}
firing=false;
if(list){
if(stack){
if(stack.length){
fire(stack.shift());
}
}else if(memory){
list=[];
}else{
self.disable();
}
}
},
self={
add:function(){
if(list){
var start=list.length;
(function add(args){
jQuery.each(args,function(_,arg){
var type=jQuery.type(arg);
if(type==="function"){
if(!options.unique||!self.has(arg)){
list.push(arg);
}
}else if(arg&&arg.length&&type!=="string"){
add(arg);
}
});
})(arguments);
if(firing){
firingLength=list.length;
}else if(memory){
firingStart=start;
fire(memory);
}
}
return this;
},
remove:function(){
if(list){
jQuery.each(arguments,function(_,arg){
var index;
while((index=jQuery.inArray(arg,list,index))>-1){
list.splice(index,1);
if(firing){
if(index<=firingLength){
firingLength--;
}
if(index<=firingIndex){
firingIndex--;
}
}
}
});
}
return this;
},
has:function(fn){
return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length);
},
empty:function(){
list=[];
firingLength=0;
return this;
},
disable:function(){
list=stack=memory=undefined;
return this;
},
disabled:function(){
return!list;
},
lock:function(){
stack=undefined;
if(!memory){
self.disable();
}
return this;
},
locked:function(){
return!stack;
},
fireWith:function(context,args){
if(list&&(!fired||stack)){
args=args||[];
args=[context,args.slice?args.slice():args];
if(firing){
stack.push(args);
}else{
fire(args);
}
}
return this;
},
fire:function(){
self.fireWith(this,arguments);
return this;
},
fired:function(){
return!!fired;
}
};
return self;
};
jQuery.extend({
Deferred:function(func){
var tuples=[
["resolve","done",jQuery.Callbacks("once memory"),"resolved"],
["reject","fail",jQuery.Callbacks("once memory"),"rejected"],
["notify","progress",jQuery.Callbacks("memory")]
],
state="pending",
promise={
state:function(){
return state;
},
always:function(){
deferred.done(arguments).fail(arguments);
return this;
},
then:function(){
var fns=arguments;
return jQuery.Deferred(function(newDefer){
jQuery.each(tuples,function(i,tuple){
var fn=jQuery.isFunction(fns[i])&&fns[i];
deferred[tuple[1]](function(){
var returned=fn&&fn.apply(this,arguments);
if(returned&&jQuery.isFunction(returned.promise)){
returned.promise()
.done(newDefer.resolve)
.fail(newDefer.reject)
.progress(newDefer.notify);
}else{
newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments);
}
});
});
fns=null;
}).promise();
},
promise:function(obj){
return obj!=null?jQuery.extend(obj,promise):promise;
}
},
deferred={};
promise.pipe=promise.then;
jQuery.each(tuples,function(i,tuple){
var list=tuple[2],
stateString=tuple[3];
promise[tuple[1]]=list.add;
if(stateString){
list.add(function(){
state=stateString;
},tuples[i^1][2].disable,tuples[2][2].lock);
}
deferred[tuple[0]]=function(){
deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);
return this;
};
deferred[tuple[0]+"With"]=list.fireWith;
});
promise.promise(deferred);
if(func){
func.call(deferred,deferred);
}
return deferred;
},
when:function(subordinate){
var i=0,
resolveValues=slice.call(arguments),
length=resolveValues.length,
remaining=length!==1||(subordinate&&jQuery.isFunction(subordinate.promise))?length:0,
deferred=remaining===1?subordinate:jQuery.Deferred(),
updateFunc=function(i,contexts,values){
return function(value){
contexts[i]=this;
values[i]=arguments.length>1?slice.call(arguments):value;
if(values===progressValues){
deferred.notifyWith(contexts,values);
}else if(!(--remaining)){
deferred.resolveWith(contexts,values);
}
};
},
progressValues,progressContexts,resolveContexts;
if(length>1){
progressValues=new Array(length);
progressContexts=new Array(length);
resolveContexts=new Array(length);
for(;i<length;i++){
if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){
resolveValues[i].promise()
.done(updateFunc(i,resolveContexts,resolveValues))
.fail(deferred.reject)
.progress(updateFunc(i,progressContexts,progressValues));
}else{
--remaining;
}
}
}
if(!remaining){
deferred.resolveWith(resolveContexts,resolveValues);
}
return deferred.promise();
}
});
var readyList;
jQuery.fn.ready=function(fn){
jQuery.ready.promise().done(fn);
return this;
};
jQuery.extend({
isReady:false,
readyWait:1,
holdReady:function(hold){
if(hold){
jQuery.readyWait++;
}else{
jQuery.ready(true);
}
},
ready:function(wait){
if(wait===true?--jQuery.readyWait:jQuery.isReady){
return;
}
if(!document.body){
return setTimeout(jQuery.ready);
}
jQuery.isReady=true;
if(wait!==true&&--jQuery.readyWait>0){
return;
}
readyList.resolveWith(document,[jQuery]);
if(jQuery.fn.trigger){
jQuery(document).trigger("ready").off("ready");
}
}
});

function detach(){
if(document.addEventListener){
document.removeEventListener("DOMContentLoaded",completed,false);
window.removeEventListener("load",completed,false);
}else{
document.detachEvent("onreadystatechange",completed);
window.detachEvent("onload",completed);
}
}

function completed(){
if(document.addEventListener||event.type==="load"||document.readyState==="complete"){
detach();
jQuery.ready();
}
}
jQuery.ready.promise=function(obj){
if(!readyList){
readyList=jQuery.Deferred();
if(document.readyState==="complete"){
setTimeout(jQuery.ready);
}else if(document.addEventListener){
document.addEventListener("DOMContentLoaded",completed,false);
window.addEventListener("load",completed,false);
}else{
document.attachEvent("onreadystatechange",completed);
window.attachEvent("onload",completed);
var top=false;
try{
top=window.frameElement==null&&document.documentElement;
}catch(e){}
if(top&&top.doScroll){
(function doScrollCheck(){
if(!jQuery.isReady){
try{
top.doScroll("left");
}catch(e){
return setTimeout(doScrollCheck,50);
}
detach();
jQuery.ready();
}
})();
}
}
}
return readyList.promise(obj);
};
var strundefined=typeof undefined;
var i;
for(i in jQuery(support)){
break;
}
support.ownLast=i!=="0";
support.inlineBlockNeedsLayout=false;
jQuery(function(){
var container,div,
body=document.getElementsByTagName("body")[0];
if(!body){
return;
}
container=document.createElement("div");
container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";
div=document.createElement("div");
body.appendChild(container).appendChild(div);
if(typeof div.style.zoom!==strundefined){
div.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1";
if((support.inlineBlockNeedsLayout=(div.offsetWidth===3))){
body.style.zoom=1;
}
}
body.removeChild(container);
container=div=null;
});
(function(){
var div=document.createElement("div");
if(support.deleteExpando==null){
support.deleteExpando=true;
try{
delete div.test;
}catch(e){
support.deleteExpando=false;
}
}
div=null;
})();

jQuery.acceptData=function(elem){
var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],
nodeType=+elem.nodeType||1;
return nodeType!==1&&nodeType!==9?
false:
!noData||noData!==true&&elem.getAttribute("classid")===noData;
};
var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
rmultiDash=/([A-Z])/g;
function dataAttr(elem,key,data){
if(data===undefined&&elem.nodeType===1){
var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();
data=elem.getAttribute(name);
if(typeof data==="string"){
try{
data=data==="true"?true:
data==="false"?false:
data==="null"?null:
+data+""===data?+data:
rbrace.test(data)?jQuery.parseJSON(data):
data;
}catch(e){}
jQuery.data(elem,key,data);
}else{
data=undefined;
}
}
return data;
}
function isEmptyDataObject(obj){
var name;
for(name in obj){
if(name==="data"&&jQuery.isEmptyObject(obj[name])){
continue;
}
if(name!=="toJSON"){
return false;
}
}
return true;
}
function internalData(elem,name,data,pvt){
if(!jQuery.acceptData(elem)){
return;
}
var ret,thisCache,
internalKey=jQuery.expando,
isNode=elem.nodeType,
cache=isNode?jQuery.cache:elem,
id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;
if((!id||!cache[id]||(!pvt&&!cache[id].data))&&data===undefined&&typeof name==="string"){
return;
}
if(!id){
if(isNode){
id=elem[internalKey]=deletedIds.pop()||jQuery.guid++;
}else{
id=internalKey;
}
}
if(!cache[id]){
cache[id]=isNode?{}:{toJSON:jQuery.noop};
}
if(typeof name==="object"||typeof name==="function"){
if(pvt){
cache[id]=jQuery.extend(cache[id],name);
}else{
cache[id].data=jQuery.extend(cache[id].data,name);
}
}
thisCache=cache[id];
if(!pvt){
if(!thisCache.data){
thisCache.data={};
}
thisCache=thisCache.data;
}
if(data!==undefined){
thisCache[jQuery.camelCase(name)]=data;
}
if(typeof name==="string"){
ret=thisCache[name];
if(ret==null){
ret=thisCache[jQuery.camelCase(name)];
}
}else{
ret=thisCache;
}
return ret;
}
function internalRemoveData(elem,name,pvt){
if(!jQuery.acceptData(elem)){
return;
}
var thisCache,i,
isNode=elem.nodeType,
cache=isNode?jQuery.cache:elem,
id=isNode?elem[jQuery.expando]:jQuery.expando;
if(!cache[id]){
return;
}
if(name){
thisCache=pvt?cache[id]:cache[id].data;
if(thisCache){
if(!jQuery.isArray(name)){
if(name in thisCache){
name=[name];
}else{
name=jQuery.camelCase(name);
if(name in thisCache){
name=[name];
}else{
name=name.split(" ");
}
}
}else{
name=name.concat(jQuery.map(name,jQuery.camelCase));
}
i=name.length;
while(i--){
delete thisCache[name[i]];
}
if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache)){
return;
}
}
}
if(!pvt){
delete cache[id].data;
if(!isEmptyDataObject(cache[id])){
return;
}
}
if(isNode){
jQuery.cleanData([elem],true);

}else if(support.deleteExpando||cache!=cache.window){

delete cache[id];
}else{
cache[id]=null;
}
}
jQuery.extend({
cache:{},
noData:{
"applet ":true,
"embed ":true,
"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
},
hasData:function(elem){
elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];
return!!elem&&!isEmptyDataObject(elem);
},
data:function(elem,name,data){
return internalData(elem,name,data);
},
removeData:function(elem,name){
return internalRemoveData(elem,name);
},
_data:function(elem,name,data){
return internalData(elem,name,data,true);
},
_removeData:function(elem,name){
return internalRemoveData(elem,name,true);
}
});
jQuery.fn.extend({
data:function(key,value){
var i,name,data,
elem=this[0],
attrs=elem&&elem.attributes;
if(key===undefined){
if(this.length){
data=jQuery.data(elem);
if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){
i=attrs.length;
while(i--){
name=attrs[i].name;
if(name.indexOf("data-")===0){
name=jQuery.camelCase(name.slice(5));
dataAttr(elem,name,data[name]);
}
}
jQuery._data(elem,"parsedAttrs",true);
}
}
return data;
}
if(typeof key==="object"){
return this.each(function(){
jQuery.data(this,key);
});
}
return arguments.length>1?
this.each(function(){
jQuery.data(this,key,value);
}):
elem?dataAttr(elem,key,jQuery.data(elem,key)):undefined;
},
removeData:function(key){
return this.each(function(){
jQuery.removeData(this,key);
});
}
});
jQuery.extend({
queue:function(elem,type,data){
var queue;
if(elem){
type=(type||"fx")+"queue";
queue=jQuery._data(elem,type);
if(data){
if(!queue||jQuery.isArray(data)){
queue=jQuery._data(elem,type,jQuery.makeArray(data));
}else{
queue.push(data);
}
}
return queue||[];
}
},
dequeue:function(elem,type){
type=type||"fx";
var queue=jQuery.queue(elem,type),
startLength=queue.length,
fn=queue.shift(),
hooks=jQuery._queueHooks(elem,type),
next=function(){
jQuery.dequeue(elem,type);
};
if(fn==="inprogress"){
fn=queue.shift();
startLength--;
}
if(fn){
if(type==="fx"){
queue.unshift("inprogress");
}
delete hooks.stop;
fn.call(elem,next,hooks);
}
if(!startLength&&hooks){
hooks.empty.fire();
}
},
_queueHooks:function(elem,type){
var key=type+"queueHooks";
return jQuery._data(elem,key)||jQuery._data(elem,key,{
empty:jQuery.Callbacks("once memory").add(function(){
jQuery._removeData(elem,type+"queue");
jQuery._removeData(elem,key);
})
});
}
});
jQuery.fn.extend({
queue:function(type,data){
var setter=2;
if(typeof type!=="string"){
data=type;
type="fx";
setter--;
}
if(arguments.length<setter){
return jQuery.queue(this[0],type);
}
return data===undefined?
this:
this.each(function(){
var queue=jQuery.queue(this,type,data);
jQuery._queueHooks(this,type);
if(type==="fx"&&queue[0]!=="inprogress"){
jQuery.dequeue(this,type);
}
});
},
dequeue:function(type){
return this.each(function(){
jQuery.dequeue(this,type);
});
},
clearQueue:function(type){
return this.queue(type||"fx",[]);
},
promise:function(type,obj){
var tmp,
count=1,
defer=jQuery.Deferred(),
elements=this,
i=this.length,
resolve=function(){
if(!(--count)){
defer.resolveWith(elements,[elements]);
}
};
if(typeof type!=="string"){
obj=type;
type=undefined;
}
type=type||"fx";
while(i--){
tmp=jQuery._data(elements[i],type+"queueHooks");
if(tmp&&tmp.empty){
count++;
tmp.empty.add(resolve);
}
}
resolve();
return defer.promise(obj);
}
});
var pnum=(/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;
var cssExpand=["Top","Right","Bottom","Left"];
var isHidden=function(elem,el){
elem=el||elem;
return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem);
};
var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){
var i=0,
length=elems.length,
bulk=key==null;
if(jQuery.type(key)==="object"){
chainable=true;
for(i in key){
jQuery.access(elems,fn,i,key[i],true,emptyGet,raw);
}
}else if(value!==undefined){
chainable=true;
if(!jQuery.isFunction(value)){
raw=true;
}
if(bulk){
if(raw){
fn.call(elems,value);
fn=null;
}else{
bulk=fn;
fn=function(elem,key,value){
return bulk.call(jQuery(elem),value);
};
}
}
if(fn){
for(;i<length;i++){
fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));
}
}
}
return chainable?
elems:
bulk?
fn.call(elems):
length?fn(elems[0],key):emptyGet;
};
var rcheckableType=(/^(?:checkbox|radio)$/i);
(function(){
var fragment=document.createDocumentFragment(),
div=document.createElement("div"),
input=document.createElement("input");
div.setAttribute("className","t");
div.innerHTML="  <link/><table></table><a href='/a'>a</a>";
support.leadingWhitespace=div.firstChild.nodeType===3;
support.tbody=!div.getElementsByTagName("tbody").length;
support.htmlSerialize=!!div.getElementsByTagName("link").length;
support.html5Clone=
document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";
input.type="checkbox";
input.checked=true;
fragment.appendChild(input);
support.appendChecked=input.checked;
div.innerHTML="<textarea>x</textarea>";
support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue;
fragment.appendChild(div);
div.innerHTML="<input type='radio' checked='checked' name='t'/>";
support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;
support.noCloneEvent=true;
if(div.attachEvent){
div.attachEvent("onclick",function(){
support.noCloneEvent=false;
});
div.cloneNode(true).click();
}
if(support.deleteExpando==null){
support.deleteExpando=true;
try{
delete div.test;
}catch(e){
support.deleteExpando=false;
}
}
fragment=div=input=null;
})();
(function(){
var i,eventName,
div=document.createElement("div");
for(i in{submit:true,change:true,focusin:true}){
eventName="on"+i;
if(!(support[i+"Bubbles"]=eventName in window)){
div.setAttribute(eventName,"t");
support[i+"Bubbles"]=div.attributes[eventName].expando===false;
}
}
div=null;
})();
var rformElems=/^(?:input|select|textarea)$/i,
rkeyEvent=/^key/,
rmouseEvent=/^(?:mouse|contextmenu)|click/,
rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,
rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;
function returnTrue(){
return true;
}
function returnFalse(){
return false;
}
function safeActiveElement(){
try{
return document.activeElement;
}catch(err){}
}

jQuery.event={
global:{},
add:function(elem,types,handler,data,selector){
var tmp,events,t,handleObjIn,
special,eventHandle,handleObj,
handlers,type,namespaces,origType,
elemData=jQuery._data(elem);
if(!elemData){
return;
}
if(handler.handler){
handleObjIn=handler;
handler=handleObjIn.handler;
selector=handleObjIn.selector;
}
if(!handler.guid){
handler.guid=jQuery.guid++;
}
if(!(events=elemData.events)){
events=elemData.events={};
}
if(!(eventHandle=elemData.handle)){
eventHandle=elemData.handle=function(e){
return typeof jQuery!==strundefined&&(!e||jQuery.event.triggered!==e.type)?
jQuery.event.dispatch.apply(eventHandle.elem,arguments):
undefined;
};
eventHandle.elem=elem;
}
types=(types||"").match(rnotwhite)||[""];
t=types.length;
while(t--){
tmp=rtypenamespace.exec(types[t])||[];
type=origType=tmp[1];
namespaces=(tmp[2]||"").split(".").sort();
if(!type){
continue;
}
special=jQuery.event.special[type]||{};
type=(selector?special.delegateType:special.bindType)||type;
special=jQuery.event.special[type]||{};
handleObj=jQuery.extend({
type:type,
origType:origType,
data:data,
handler:handler,
guid:handler.guid,
selector:selector,
needsContext:selector&&jQuery.expr.match.needsContext.test(selector),
namespace:namespaces.join(".")
},handleObjIn);
if(!(handlers=events[type])){
handlers=events[type]=[];
handlers.delegateCount=0;
if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){
if(elem.addEventListener){
elem.addEventListener(type,eventHandle,false);
}else if(elem.attachEvent){
elem.attachEvent("on"+type,eventHandle);
}
}
}
if(special.add){
special.add.call(elem,handleObj);
if(!handleObj.handler.guid){
handleObj.handler.guid=handler.guid;
}
}
if(selector){
handlers.splice(handlers.delegateCount++,0,handleObj);
}else{
handlers.push(handleObj);
}
jQuery.event.global[type]=true;
}
elem=null;
},
remove:function(elem,types,handler,selector,mappedTypes){
var j,handleObj,tmp,
origCount,t,events,
special,handlers,type,
namespaces,origType,
elemData=jQuery.hasData(elem)&&jQuery._data(elem);
if(!elemData||!(events=elemData.events)){
return;
}
types=(types||"").match(rnotwhite)||[""];
t=types.length;
while(t--){
tmp=rtypenamespace.exec(types[t])||[];
type=origType=tmp[1];
namespaces=(tmp[2]||"").split(".").sort();
if(!type){
for(type in events){
jQuery.event.remove(elem,type+types[t],handler,selector,true);
}
continue;
}
special=jQuery.event.special[type]||{};
type=(selector?special.delegateType:special.bindType)||type;
handlers=events[type]||[];
tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");
origCount=j=handlers.length;
while(j--){
handleObj=handlers[j];
if((mappedTypes||origType===handleObj.origType)&&
(!handler||handler.guid===handleObj.guid)&&
(!tmp||tmp.test(handleObj.namespace))&&
(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){
handlers.splice(j,1);
if(handleObj.selector){
handlers.delegateCount--;
}
if(special.remove){
special.remove.call(elem,handleObj);
}
}
}
if(origCount&&!handlers.length){
if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){
jQuery.removeEvent(elem,type,elemData.handle);
}
delete events[type];
}
}
if(jQuery.isEmptyObject(events)){
delete elemData.handle;
jQuery._removeData(elem,"events");
}
},
trigger:function(event,data,elem,onlyHandlers){
var handle,ontype,cur,
bubbleType,special,tmp,i,
eventPath=[elem||document],
type=hasOwn.call(event,"type")?event.type:event,
namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];
cur=tmp=elem=elem||document;
if(elem.nodeType===3||elem.nodeType===8){
return;
}
if(rfocusMorph.test(type+jQuery.event.triggered)){
return;
}
if(type.indexOf(".")>=0){
namespaces=type.split(".");
type=namespaces.shift();
namespaces.sort();
}
ontype=type.indexOf(":")<0&&"on"+type;
event=event[jQuery.expando]?
event:
new jQuery.Event(type,typeof event==="object"&&event);
event.isTrigger=onlyHandlers?2:3;
event.namespace=namespaces.join(".");
event.namespace_re=event.namespace?
new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):
null;
event.result=undefined;
if(!event.target){
event.target=elem;
}
data=data==null?
[event]:
jQuery.makeArray(data,[event]);
special=jQuery.event.special[type]||{};
if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){
return;
}
if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){
bubbleType=special.delegateType||type;
if(!rfocusMorph.test(bubbleType+type)){
cur=cur.parentNode;
}
for(;cur;cur=cur.parentNode){
eventPath.push(cur);
tmp=cur;
}
if(tmp===(elem.ownerDocument||document)){
eventPath.push(tmp.defaultView||tmp.parentWindow||window);
}
}
i=0;
while((cur=eventPath[i++])&&!event.isPropagationStopped()){
event.type=i>1?
bubbleType:
special.bindType||type;
handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");
if(handle){
handle.apply(cur,data);
}
handle=ontype&&cur[ontype];
if(handle&&handle.apply&&jQuery.acceptData(cur)){
event.result=handle.apply(cur,data);
if(event.result===false){
event.preventDefault();
}
}
}
event.type=type;
if(!onlyHandlers&&!event.isDefaultPrevented()){
if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&
jQuery.acceptData(elem)){
if(ontype&&elem[type]&&!jQuery.isWindow(elem)){
tmp=elem[ontype];
if(tmp){
elem[ontype]=null;
}
jQuery.event.triggered=type;
try{
elem[type]();
}catch(e){
}
jQuery.event.triggered=undefined;
if(tmp){
elem[ontype]=tmp;
}
}
}
}
return event.result;
},
dispatch:function(event){
event=jQuery.event.fix(event);
var i,ret,handleObj,matched,j,
handlerQueue=[],
args=slice.call(arguments),
handlers=(jQuery._data(this,"events")||{})[event.type]||[],
special=jQuery.event.special[event.type]||{};
args[0]=event;
event.delegateTarget=this;
if(special.preDispatch&&special.preDispatch.call(this,event)===false){
return;
}
handlerQueue=jQuery.event.handlers.call(this,event,handlers);
i=0;
while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){
event.currentTarget=matched.elem;
j=0;
while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){
if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){
event.handleObj=handleObj;
event.data=handleObj.data;
ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler)
.apply(matched.elem,args);
if(ret!==undefined){
if((event.result=ret)===false){
event.preventDefault();
event.stopPropagation();
}
}
}
}
}
if(special.postDispatch){
special.postDispatch.call(this,event);
}
return event.result;
},
handlers:function(event,handlers){
var sel,handleObj,matches,i,
handlerQueue=[],
delegateCount=handlers.delegateCount,
cur=event.target;
if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){

for(;cur!=this;cur=cur.parentNode||this){

if(cur.nodeType===1&&(cur.disabled!==true||event.type!=="click")){
matches=[];
for(i=0;i<delegateCount;i++){
handleObj=handlers[i];
sel=handleObj.selector+" ";
if(matches[sel]===undefined){
matches[sel]=handleObj.needsContext?
jQuery(sel,this).index(cur)>=0:
jQuery.find(sel,this,null,[cur]).length;
}
if(matches[sel]){
matches.push(handleObj);
}
}
if(matches.length){
handlerQueue.push({elem:cur,handlers:matches});
}
}
}
}
if(delegateCount<handlers.length){
handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)});
}
return handlerQueue;
},
fix:function(event){
if(event[jQuery.expando]){
return event;
}
var i,prop,copy,
type=event.type,
originalEvent=event,
fixHook=this.fixHooks[type];
if(!fixHook){
this.fixHooks[type]=fixHook=
rmouseEvent.test(type)?this.mouseHooks:
rkeyEvent.test(type)?this.keyHooks:
{};
}
copy=fixHook.props?this.props.concat(fixHook.props):this.props;
event=new jQuery.Event(originalEvent);
i=copy.length;
while(i--){
prop=copy[i];
event[prop]=originalEvent[prop];
}
if(!event.target){
event.target=originalEvent.srcElement||document;
}
if(event.target.nodeType===3){
event.target=event.target.parentNode;
}
event.metaKey=!!event.metaKey;
return fixHook.filter?fixHook.filter(event,originalEvent):event;
},
props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},
keyHooks:{
props:"char charCode key keyCode".split(" "),
filter:function(event,original){
if(event.which==null){
event.which=original.charCode!=null?original.charCode:original.keyCode;
}
return event;
}
},
mouseHooks:{
props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(event,original){
var body,eventDoc,doc,
button=original.button,
fromElement=original.fromElement;
if(event.pageX==null&&original.clientX!=null){
eventDoc=event.target.ownerDocument||document;
doc=eventDoc.documentElement;
body=eventDoc.body;
event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);
event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);
}
if(!event.relatedTarget&&fromElement){
event.relatedTarget=fromElement===event.target?original.toElement:fromElement;
}
if(!event.which&&button!==undefined){
event.which=(button&1?1:(button&2?3:(button&4?2:0)));
}
return event;
}
},
special:{
load:{
noBubble:true
},
focus:{
trigger:function(){
if(this!==safeActiveElement()&&this.focus){
try{
this.focus();
return false;
}catch(e){
}
}
},
delegateType:"focusin"
},
blur:{
trigger:function(){
if(this===safeActiveElement()&&this.blur){
this.blur();
return false;
}
},
delegateType:"focusout"
},
click:{
trigger:function(){
if(jQuery.nodeName(this,"input")&&this.type==="checkbox"&&this.click){
this.click();
return false;
}
},
_default:function(event){
return jQuery.nodeName(event.target,"a");
}
},
beforeunload:{
postDispatch:function(event){
if(event.result!==undefined){
event.originalEvent.returnValue=event.result;
}
}
}
},
simulate:function(type,elem,event,bubble){
var e=jQuery.extend(
new jQuery.Event(),
event,
{
type:type,
isSimulated:true,
originalEvent:{}
}
);
if(bubble){
jQuery.event.trigger(e,null,elem);
}else{
jQuery.event.dispatch.call(elem,e);
}
if(e.isDefaultPrevented()){
event.preventDefault();
}
}
};
jQuery.removeEvent=document.removeEventListener?
function(elem,type,handle){
if(elem.removeEventListener){
elem.removeEventListener(type,handle,false);
}
}:
function(elem,type,handle){
var name="on"+type;
if(elem.detachEvent){
if(typeof elem[name]===strundefined){
elem[name]=null;
}
elem.detachEvent(name,handle);
}
};
jQuery.Event=function(src,props){
if(!(this instanceof jQuery.Event)){
return new jQuery.Event(src,props);
}
if(src&&src.type){
this.originalEvent=src;
this.type=src.type;
this.isDefaultPrevented=src.defaultPrevented||
src.defaultPrevented===undefined&&(
src.returnValue===false||
src.getPreventDefault&&src.getPreventDefault())?
returnTrue:
returnFalse;
}else{
this.type=src;
}
if(props){
jQuery.extend(this,props);
}
this.timeStamp=src&&src.timeStamp||jQuery.now();
this[jQuery.expando]=true;
};
jQuery.Event.prototype={
isDefaultPrevented:returnFalse,
isPropagationStopped:returnFalse,
isImmediatePropagationStopped:returnFalse,
preventDefault:function(){
var e=this.originalEvent;
this.isDefaultPrevented=returnTrue;
if(!e){
return;
}
if(e.preventDefault){
e.preventDefault();
}else{
e.returnValue=false;
}
},
stopPropagation:function(){
var e=this.originalEvent;
this.isPropagationStopped=returnTrue;
if(!e){
return;
}
if(e.stopPropagation){
e.stopPropagation();
}
e.cancelBubble=true;
},
stopImmediatePropagation:function(){
this.isImmediatePropagationStopped=returnTrue;
this.stopPropagation();
}
};
jQuery.each({
mouseenter:"mouseover",
mouseleave:"mouseout"
},function(orig,fix){
jQuery.event.special[orig]={
delegateType:fix,
bindType:fix,
handle:function(event){
var ret,
target=this,
related=event.relatedTarget,
handleObj=event.handleObj;
if(!related||(related!==target&&!jQuery.contains(target,related))){
event.type=handleObj.origType;
ret=handleObj.handler.apply(this,arguments);
event.type=fix;
}
return ret;
}
};
});
if(!support.submitBubbles){
jQuery.event.special.submit={
setup:function(){
if(jQuery.nodeName(this,"form")){
return false;
}
jQuery.event.add(this,"click._submit keypress._submit",function(e){
var elem=e.target,
form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;
if(form&&!jQuery._data(form,"submitBubbles")){
jQuery.event.add(form,"submit._submit",function(event){
event._submit_bubble=true;
});
jQuery._data(form,"submitBubbles",true);
}
});
},
postDispatch:function(event){
if(event._submit_bubble){
delete event._submit_bubble;
if(this.parentNode&&!event.isTrigger){
jQuery.event.simulate("submit",this.parentNode,event,true);
}
}
},
teardown:function(){
if(jQuery.nodeName(this,"form")){
return false;
}
jQuery.event.remove(this,"._submit");
}
};
}
if(!support.changeBubbles){
jQuery.event.special.change={
setup:function(){
if(rformElems.test(this.nodeName)){
if(this.type==="checkbox"||this.type==="radio"){
jQuery.event.add(this,"propertychange._change",function(event){
if(event.originalEvent.propertyName==="checked"){
this._just_changed=true;
}
});
jQuery.event.add(this,"click._change",function(event){
if(this._just_changed&&!event.isTrigger){
this._just_changed=false;
}
jQuery.event.simulate("change",this,event,true);
});
}
return false;
}
jQuery.event.add(this,"beforeactivate._change",function(e){
var elem=e.target;
if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")){
jQuery.event.add(elem,"change._change",function(event){
if(this.parentNode&&!event.isSimulated&&!event.isTrigger){
jQuery.event.simulate("change",this.parentNode,event,true);
}
});
jQuery._data(elem,"changeBubbles",true);
}
});
},
handle:function(event){
var elem=event.target;
if(this!==elem||event.isSimulated||event.isTrigger||(elem.type!=="radio"&&elem.type!=="checkbox")){
return event.handleObj.handler.apply(this,arguments);
}
},
teardown:function(){
jQuery.event.remove(this,"._change");
return!rformElems.test(this.nodeName);
}
};
}
if(!support.focusinBubbles){
jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){
var handler=function(event){
jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true);
};
jQuery.event.special[fix]={
setup:function(){
var doc=this.ownerDocument||this,
attaches=jQuery._data(doc,fix);
if(!attaches){
doc.addEventListener(orig,handler,true);
}
jQuery._data(doc,fix,(attaches||0)+1);
},
teardown:function(){
var doc=this.ownerDocument||this,
attaches=jQuery._data(doc,fix)-1;
if(!attaches){
doc.removeEventListener(orig,handler,true);
jQuery._removeData(doc,fix);
}else{
jQuery._data(doc,fix,attaches);
}
}
};
});
}
jQuery.fn.extend({
on:function(types,selector,data,fn,one){
var type,origFn;
if(typeof types==="object"){
if(typeof selector!=="string"){
data=data||selector;
selector=undefined;
}
for(type in types){
this.on(type,selector,data,types[type],one);
}
return this;
}
if(data==null&&fn==null){
fn=selector;
data=selector=undefined;
}else if(fn==null){
if(typeof selector==="string"){
fn=data;
data=undefined;
}else{
fn=data;
data=selector;
selector=undefined;
}
}
if(fn===false){
fn=returnFalse;
}else if(!fn){
return this;
}
if(one===1){
origFn=fn;
fn=function(event){
jQuery().off(event);
return origFn.apply(this,arguments);
};
fn.guid=origFn.guid||(origFn.guid=jQuery.guid++);
}
return this.each(function(){
jQuery.event.add(this,types,fn,data,selector);
});
},
one:function(types,selector,data,fn){
return this.on(types,selector,data,fn,1);
},
off:function(types,selector,fn){
var handleObj,type;
if(types&&types.preventDefault&&types.handleObj){
handleObj=types.handleObj;
jQuery(types.delegateTarget).off(
handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,
handleObj.selector,
handleObj.handler
);
return this;
}
if(typeof types==="object"){
for(type in types){
this.off(type,selector,types[type]);
}
return this;
}
if(selector===false||typeof selector==="function"){
fn=selector;
selector=undefined;
}
if(fn===false){
fn=returnFalse;
}
return this.each(function(){
jQuery.event.remove(this,types,fn,selector);
});
},
trigger:function(type,data){
return this.each(function(){
jQuery.event.trigger(type,data,this);
});
},
triggerHandler:function(type,data){
var elem=this[0];
if(elem){
return jQuery.event.trigger(type,data,elem,true);
}
}
});
function createSafeFragment(document){
var list=nodeNames.split("|"),
safeFrag=document.createDocumentFragment();
if(safeFrag.createElement){
while(list.length){
safeFrag.createElement(
list.pop()
);
}
}
return safeFrag;
}
var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+
"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,
rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),
rleadingWhitespace=/^\s+/,
rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
rtagName=/<([\w:]+)/,
rtbody=/<tbody/i,
rhtml=/<|&#?\w+;/,
rnoInnerhtml=/<(?:script|style|link)/i,
rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,
rscriptType=/^$|\/(?:java|ecma)script/i,
rscriptTypeMasked=/^true\/(.*)/,
rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
wrapMap={
option:[1,"<select multiple='multiple'>","</select>"],
legend:[1,"<fieldset>","</fieldset>"],
area:[1,"<map>","</map>"],
param:[1,"<object>","</object>"],
thead:[1,"<table>","</table>"],
tr:[2,"<table><tbody>","</tbody></table>"],
col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],
td:[3,"<table><tbody><tr>","</tr></tbody></table>"],
_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]
},
safeFragment=createSafeFragment(document),
fragmentDiv=safeFragment.appendChild(document.createElement("div"));
wrapMap.optgroup=wrapMap.option;
wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;
wrapMap.th=wrapMap.td;
function getAll(context,tag){
var elems,elem,
i=0,
found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):
typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):
undefined;
if(!found){
for(found=[],elems=context.childNodes||context;(elem=elems[i])!=null;i++){
if(!tag||jQuery.nodeName(elem,tag)){
found.push(elem);
}else{
jQuery.merge(found,getAll(elem,tag));
}
}
}
return tag===undefined||tag&&jQuery.nodeName(context,tag)?
jQuery.merge([context],found):
found;
}
function fixDefaultChecked(elem){
if(rcheckableType.test(elem.type)){
elem.defaultChecked=elem.checked;
}
}
function manipulationTarget(elem,content){
return jQuery.nodeName(elem,"table")&&
jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?
elem.getElementsByTagName("tbody")[0]||
elem.appendChild(elem.ownerDocument.createElement("tbody")):
elem;
}
function disableScript(elem){
elem.type=(jQuery.find.attr(elem,"type")!==null)+"/"+elem.type;
return elem;
}
function restoreScript(elem){
var match=rscriptTypeMasked.exec(elem.type);
if(match){
elem.type=match[1];
}else{
elem.removeAttribute("type");
}
return elem;
}
function setGlobalEval(elems,refElements){
var elem,
i=0;
for(;(elem=elems[i])!=null;i++){
jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"));
}
}
function cloneCopyEvent(src,dest){
if(dest.nodeType!==1||!jQuery.hasData(src)){
return;
}
var type,i,l,
oldData=jQuery._data(src),
curData=jQuery._data(dest,oldData),
events=oldData.events;
if(events){
delete curData.handle;
curData.events={};
for(type in events){
for(i=0,l=events[type].length;i<l;i++){
jQuery.event.add(dest,type,events[type][i]);
}
}
}
if(curData.data){
curData.data=jQuery.extend({},curData.data);
}
}
function fixCloneNodeIssues(src,dest){
var nodeName,e,data;
if(dest.nodeType!==1){
return;
}
nodeName=dest.nodeName.toLowerCase();
if(!support.noCloneEvent&&dest[jQuery.expando]){
data=jQuery._data(dest);
for(e in data.events){
jQuery.removeEvent(dest,e,data.handle);
}
dest.removeAttribute(jQuery.expando);
}
if(nodeName==="script"&&dest.text!==src.text){
disableScript(dest).text=src.text;
restoreScript(dest);
}else if(nodeName==="object"){
if(dest.parentNode){
dest.outerHTML=src.outerHTML;
}
if(support.html5Clone&&(src.innerHTML&&!jQuery.trim(dest.innerHTML))){
dest.innerHTML=src.innerHTML;
}
}else if(nodeName==="input"&&rcheckableType.test(src.type)){
dest.defaultChecked=dest.checked=src.checked;
if(dest.value!==src.value){
dest.value=src.value;
}
}else if(nodeName==="option"){
dest.defaultSelected=dest.selected=src.defaultSelected;
}else if(nodeName==="input"||nodeName==="textarea"){
dest.defaultValue=src.defaultValue;
}
}
jQuery.extend({
clone:function(elem,dataAndEvents,deepDataAndEvents){
var destElements,node,clone,i,srcElements,
inPage=jQuery.contains(elem.ownerDocument,elem);
if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){
clone=elem.cloneNode(true);
}else{
fragmentDiv.innerHTML=elem.outerHTML;
fragmentDiv.removeChild(clone=fragmentDiv.firstChild);
}
if((!support.noCloneEvent||!support.noCloneChecked)&&
(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){
destElements=getAll(clone);
srcElements=getAll(elem);
for(i=0;(node=srcElements[i])!=null;++i){
if(destElements[i]){
fixCloneNodeIssues(node,destElements[i]);
}
}
}
if(dataAndEvents){
if(deepDataAndEvents){
srcElements=srcElements||getAll(elem);
destElements=destElements||getAll(clone);
for(i=0;(node=srcElements[i])!=null;i++){
cloneCopyEvent(node,destElements[i]);
}
}else{
cloneCopyEvent(elem,clone);
}
}
destElements=getAll(clone,"script");
if(destElements.length>0){
setGlobalEval(destElements,!inPage&&getAll(elem,"script"));
}
destElements=srcElements=node=null;
return clone;
},
buildFragment:function(elems,context,scripts,selection){
var j,elem,contains,
tmp,tag,tbody,wrap,
l=elems.length,
safe=createSafeFragment(context),
nodes=[],
i=0;
for(;i<l;i++){
elem=elems[i];
if(elem||elem===0){
if(jQuery.type(elem)==="object"){
jQuery.merge(nodes,elem.nodeType?[elem]:elem);
}else if(!rhtml.test(elem)){
nodes.push(context.createTextNode(elem));
}else{
tmp=tmp||safe.appendChild(context.createElement("div"));
tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();
wrap=wrapMap[tag]||wrapMap._default;
tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];
j=wrap[0];
while(j--){
tmp=tmp.lastChild;
}
if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)){
nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0]));
}
if(!support.tbody){
elem=tag==="table"&&!rtbody.test(elem)?
tmp.firstChild:
wrap[1]==="<table>"&&!rtbody.test(elem)?
tmp:
0;
j=elem&&elem.childNodes.length;
while(j--){
if(jQuery.nodeName((tbody=elem.childNodes[j]),"tbody")&&!tbody.childNodes.length){
elem.removeChild(tbody);
}
}
}
jQuery.merge(nodes,tmp.childNodes);
tmp.textContent="";
while(tmp.firstChild){
tmp.removeChild(tmp.firstChild);
}
tmp=safe.lastChild;
}
}
}
if(tmp){
safe.removeChild(tmp);
}
if(!support.appendChecked){
jQuery.grep(getAll(nodes,"input"),fixDefaultChecked);
}
i=0;
while((elem=nodes[i++])){
if(selection&&jQuery.inArray(elem,selection)!==-1){
continue;
}
contains=jQuery.contains(elem.ownerDocument,elem);
tmp=getAll(safe.appendChild(elem),"script");
if(contains){
setGlobalEval(tmp);
}
if(scripts){
j=0;
while((elem=tmp[j++])){
if(rscriptType.test(elem.type||"")){
scripts.push(elem);
}
}
}
}
tmp=null;
return safe;
},
cleanData:function(elems,acceptData){
var elem,type,id,data,
i=0,
internalKey=jQuery.expando,
cache=jQuery.cache,
deleteExpando=support.deleteExpando,
special=jQuery.event.special;
for(;(elem=elems[i])!=null;i++){
if(acceptData||jQuery.acceptData(elem)){
id=elem[internalKey];
data=id&&cache[id];
if(data){
if(data.events){
for(type in data.events){
if(special[type]){
jQuery.event.remove(elem,type);
}else{
jQuery.removeEvent(elem,type,data.handle);
}
}
}
if(cache[id]){
delete cache[id];
if(deleteExpando){
delete elem[internalKey];
}else if(typeof elem.removeAttribute!==strundefined){
elem.removeAttribute(internalKey);
}else{
elem[internalKey]=null;
}
deletedIds.push(id);
}
}
}
}
}
});
jQuery.fn.extend({
text:function(value){
return access(this,function(value){
return value===undefined?
jQuery.text(this):
this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value));
},null,value,arguments.length);
},
append:function(){
return this.domManip(arguments,function(elem){
if(this.nodeType===1||this.nodeType===11||this.nodeType===9){
var target=manipulationTarget(this,elem);
target.appendChild(elem);
}
});
},
prepend:function(){
return this.domManip(arguments,function(elem){
if(this.nodeType===1||this.nodeType===11||this.nodeType===9){
var target=manipulationTarget(this,elem);
target.insertBefore(elem,target.firstChild);
}
});
},
before:function(){
return this.domManip(arguments,function(elem){
if(this.parentNode){
this.parentNode.insertBefore(elem,this);
}
});
},
after:function(){
return this.domManip(arguments,function(elem){
if(this.parentNode){
this.parentNode.insertBefore(elem,this.nextSibling);
}
});
},
remove:function(selector,keepData){
var elem,
elems=selector?jQuery.filter(selector,this):this,
i=0;
for(;(elem=elems[i])!=null;i++){
if(!keepData&&elem.nodeType===1){
jQuery.cleanData(getAll(elem));
}
if(elem.parentNode){
if(keepData&&jQuery.contains(elem.ownerDocument,elem)){
setGlobalEval(getAll(elem,"script"));
}
elem.parentNode.removeChild(elem);
}
}
return this;
},
empty:function(){
var elem,
i=0;
for(;(elem=this[i])!=null;i++){
if(elem.nodeType===1){
jQuery.cleanData(getAll(elem,false));
}
while(elem.firstChild){
elem.removeChild(elem.firstChild);
}
if(elem.options&&jQuery.nodeName(elem,"select")){
elem.options.length=0;
}
}
return this;
},
clone:function(dataAndEvents,deepDataAndEvents){
dataAndEvents=dataAndEvents==null?false:dataAndEvents;
deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;
return this.map(function(){
return jQuery.clone(this,dataAndEvents,deepDataAndEvents);
});
},
html:function(value){
return access(this,function(value){
var elem=this[0]||{},
i=0,
l=this.length;
if(value===undefined){
return elem.nodeType===1?
elem.innerHTML.replace(rinlinejQuery,""):
undefined;
}
if(typeof value==="string"&&!rnoInnerhtml.test(value)&&
(support.htmlSerialize||!rnoshimcache.test(value))&&
(support.leadingWhitespace||!rleadingWhitespace.test(value))&&
!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){
value=value.replace(rxhtmlTag,"<$1></$2>");
try{
for(;i<l;i++){
elem=this[i]||{};
if(elem.nodeType===1){
jQuery.cleanData(getAll(elem,false));
elem.innerHTML=value;
}
}
elem=0;
}catch(e){}
}
if(elem){
this.empty().append(value);
}
},null,value,arguments.length);
},
replaceWith:function(){
var arg=arguments[0];
this.domManip(arguments,function(elem){
arg=this.parentNode;
jQuery.cleanData(getAll(this));
if(arg){
arg.replaceChild(elem,this);
}
});
return arg&&(arg.length||arg.nodeType)?this:this.remove();
},
detach:function(selector){
return this.remove(selector,true);
},
domManip:function(args,callback){
args=concat.apply([],args);
var first,node,hasScripts,
scripts,doc,fragment,
i=0,
l=this.length,
set=this,
iNoClone=l-1,
value=args[0],
isFunction=jQuery.isFunction(value);
if(isFunction||
(l>1&&typeof value==="string"&&
!support.checkClone&&rchecked.test(value))){
return this.each(function(index){
var self=set.eq(index);
if(isFunction){
args[0]=value.call(this,index,self.html());
}
self.domManip(args,callback);
});
}
if(l){
fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,this);
first=fragment.firstChild;
if(fragment.childNodes.length===1){
fragment=first;
}
if(first){
scripts=jQuery.map(getAll(fragment,"script"),disableScript);
hasScripts=scripts.length;
for(;i<l;i++){
node=fragment;
if(i!==iNoClone){
node=jQuery.clone(node,true,true);
if(hasScripts){
jQuery.merge(scripts,getAll(node,"script"));
}
}
callback.call(this[i],node,i);
}
if(hasScripts){
doc=scripts[scripts.length-1].ownerDocument;
jQuery.map(scripts,restoreScript);
for(i=0;i<hasScripts;i++){
node=scripts[i];
if(rscriptType.test(node.type||"")&&
!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)){
if(node.src){
if(jQuery._evalUrl){
jQuery._evalUrl(node.src);
}
}else{
jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,""));
}
}
}
}
fragment=first=null;
}
}
return this;
}
});
jQuery.each({
appendTo:"append",
prependTo:"prepend",
insertBefore:"before",
insertAfter:"after",
replaceAll:"replaceWith"
},function(name,original){
jQuery.fn[name]=function(selector){
var elems,
i=0,
ret=[],
insert=jQuery(selector),
last=insert.length-1;
for(;i<=last;i++){
elems=i===last?this:this.clone(true);
jQuery(insert[i])[original](elems);
push.apply(ret,elems.get());
}
return this.pushStack(ret);
};
});
var iframe,
elemdisplay={};

function actualDisplay(name,doc){
var elem=jQuery(doc.createElement(name)).appendTo(doc.body),
display=window.getDefaultComputedStyle?
window.getDefaultComputedStyle(elem[0]).display:jQuery.css(elem[0],"display");
elem.detach();
return display;
}

function defaultDisplay(nodeName){
var doc=document,
display=elemdisplay[nodeName];
if(!display){
display=actualDisplay(nodeName,doc);
if(display==="none"||!display){
iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);
doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;
doc.write();
doc.close();
display=actualDisplay(nodeName,doc);
iframe.detach();
}
elemdisplay[nodeName]=display;
}
return display;
}
(function(){
var a,shrinkWrapBlocksVal,
div=document.createElement("div"),
divReset=
"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;"+
"display:block;padding:0;margin:0;border:0";
div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
a=div.getElementsByTagName("a")[0];
a.style.cssText="float:left;opacity:.5";
support.opacity=/^0.5/.test(a.style.opacity);
support.cssFloat=!!a.style.cssFloat;
div.style.backgroundClip="content-box";
div.cloneNode(true).style.backgroundClip="";
support.clearCloneStyle=div.style.backgroundClip==="content-box";
a=div=null;
support.shrinkWrapBlocks=function(){
var body,container,div,containerStyles;
if(shrinkWrapBlocksVal==null){
body=document.getElementsByTagName("body")[0];
if(!body){
return;
}
containerStyles="border:0;width:0;height:0;position:absolute;top:0;left:-9999px";
container=document.createElement("div");
div=document.createElement("div");
body.appendChild(container).appendChild(div);
shrinkWrapBlocksVal=false;
if(typeof div.style.zoom!==strundefined){
div.style.cssText=divReset+";width:1px;padding:1px;zoom:1";
div.innerHTML="<div></div>";
div.firstChild.style.width="5px";
shrinkWrapBlocksVal=div.offsetWidth!==3;
}
body.removeChild(container);
body=container=div=null;
}
return shrinkWrapBlocksVal;
};
})();
var rmargin=(/^margin/);
var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");
var getStyles,curCSS,
rposition=/^(top|right|bottom|left)$/;
if(window.getComputedStyle){
getStyles=function(elem){
return elem.ownerDocument.defaultView.getComputedStyle(elem,null);
};
curCSS=function(elem,name,computed){
var width,minWidth,maxWidth,ret,
style=elem.style;
computed=computed||getStyles(elem);
ret=computed?computed.getPropertyValue(name)||computed[name]:undefined;
if(computed){
if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){
ret=jQuery.style(elem,name);
}
if(rnumnonpx.test(ret)&&rmargin.test(name)){
width=style.width;
minWidth=style.minWidth;
maxWidth=style.maxWidth;
style.minWidth=style.maxWidth=style.width=ret;
ret=computed.width;
style.width=width;
style.minWidth=minWidth;
style.maxWidth=maxWidth;
}
}
return ret===undefined?
ret:
ret+"";
};
}else if(document.documentElement.currentStyle){
getStyles=function(elem){
return elem.currentStyle;
};
curCSS=function(elem,name,computed){
var left,rs,rsLeft,ret,
style=elem.style;
computed=computed||getStyles(elem);
ret=computed?computed[name]:undefined;
if(ret==null&&style&&style[name]){
ret=style[name];
}
if(rnumnonpx.test(ret)&&!rposition.test(name)){
left=style.left;
rs=elem.runtimeStyle;
rsLeft=rs&&rs.left;
if(rsLeft){
rs.left=elem.currentStyle.left;
}
style.left=name==="fontSize"?"1em":ret;
ret=style.pixelLeft+"px";
style.left=left;
if(rsLeft){
rs.left=rsLeft;
}
}
return ret===undefined?
ret:
ret+""||"auto";
};
}
function addGetHookIf(conditionFn,hookFn){
return{
get:function(){
var condition=conditionFn();
if(condition==null){
return;
}
if(condition){
delete this.get;
return;
}
return(this.get=hookFn).apply(this,arguments);
}
};
}
(function(){
var a,reliableHiddenOffsetsVal,boxSizingVal,boxSizingReliableVal,
pixelPositionVal,reliableMarginRightVal,
div=document.createElement("div"),
containerStyles="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",
divReset=
"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;"+
"display:block;padding:0;margin:0;border:0";
div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
a=div.getElementsByTagName("a")[0];
a.style.cssText="float:left;opacity:.5";
support.opacity=/^0.5/.test(a.style.opacity);
support.cssFloat=!!a.style.cssFloat;
div.style.backgroundClip="content-box";
div.cloneNode(true).style.backgroundClip="";
support.clearCloneStyle=div.style.backgroundClip==="content-box";
a=div=null;
jQuery.extend(support,{
reliableHiddenOffsets:function(){
if(reliableHiddenOffsetsVal!=null){
return reliableHiddenOffsetsVal;
}
var container,tds,isSupported,
div=document.createElement("div"),
body=document.getElementsByTagName("body")[0];
if(!body){
return;
}
div.setAttribute("className","t");
div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
container=document.createElement("div");
container.style.cssText=containerStyles;
body.appendChild(container).appendChild(div);
div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";
tds=div.getElementsByTagName("td");
tds[0].style.cssText="padding:0;margin:0;border:0;display:none";
isSupported=(tds[0].offsetHeight===0);
tds[0].style.display="";
tds[1].style.display="none";
reliableHiddenOffsetsVal=isSupported&&(tds[0].offsetHeight===0);
body.removeChild(container);
div=body=null;
return reliableHiddenOffsetsVal;
},
boxSizing:function(){
if(boxSizingVal==null){
computeStyleTests();
}
return boxSizingVal;
},
boxSizingReliable:function(){
if(boxSizingReliableVal==null){
computeStyleTests();
}
return boxSizingReliableVal;
},
pixelPosition:function(){
if(pixelPositionVal==null){
computeStyleTests();
}
return pixelPositionVal;
},
reliableMarginRight:function(){
var body,container,div,marginDiv;
if(reliableMarginRightVal==null&&window.getComputedStyle){
body=document.getElementsByTagName("body")[0];
if(!body){
return;
}
container=document.createElement("div");
div=document.createElement("div");
container.style.cssText=containerStyles;
body.appendChild(container).appendChild(div);
marginDiv=div.appendChild(document.createElement("div"));
marginDiv.style.cssText=div.style.cssText=divReset;
marginDiv.style.marginRight=marginDiv.style.width="0";
div.style.width="1px";
reliableMarginRightVal=
!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight);
body.removeChild(container);
}
return reliableMarginRightVal;
}
});
function computeStyleTests(){
var container,div,
body=document.getElementsByTagName("body")[0];
if(!body){
return;
}
container=document.createElement("div");
div=document.createElement("div");
container.style.cssText=containerStyles;
body.appendChild(container).appendChild(div);
div.style.cssText=
"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;"+
"position:absolute;display:block;padding:1px;border:1px;width:4px;"+
"margin-top:1%;top:1%";
jQuery.swap(body,body.style.zoom!=null?{zoom:1}:{},function(){
boxSizingVal=div.offsetWidth===4;
});
boxSizingReliableVal=true;
pixelPositionVal=false;
reliableMarginRightVal=true;
if(window.getComputedStyle){
pixelPositionVal=(window.getComputedStyle(div,null)||{}).top!=="1%";
boxSizingReliableVal=
(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px";
}
body.removeChild(container);
div=body=null;
}
})();
jQuery.swap=function(elem,options,callback,args){
var ret,name,
old={};
for(name in options){
old[name]=elem.style[name];
elem.style[name]=options[name];
}
ret=callback.apply(elem,args||[]);
for(name in options){
elem.style[name]=old[name];
}
return ret;
};
var
ralpha=/alpha\([^)]*\)/i,
ropacity=/opacity\s*=\s*([^)]*)/,
rdisplayswap=/^(none|table(?!-c[ea]).+)/,
rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),
rrelNum=new RegExp("^([+-])=("+pnum+")","i"),
cssShow={position:"absolute",visibility:"hidden",display:"block"},
cssNormalTransform={
letterSpacing:0,
fontWeight:400
},
cssPrefixes=["Webkit","O","Moz","ms"];
function vendorPropName(style,name){
if(name in style){
return name;
}
var capName=name.charAt(0).toUpperCase()+name.slice(1),
origName=name,
i=cssPrefixes.length;
while(i--){
name=cssPrefixes[i]+capName;
if(name in style){
return name;
}
}
return origName;
}
function showHide(elements,show){
var display,elem,hidden,
values=[],
index=0,
length=elements.length;
for(;index<length;index++){
elem=elements[index];
if(!elem.style){
continue;
}
values[index]=jQuery._data(elem,"olddisplay");
display=elem.style.display;
if(show){
if(!values[index]&&display==="none"){
elem.style.display="";
}
if(elem.style.display===""&&isHidden(elem)){
values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName));
}
}else{
if(!values[index]){
hidden=isHidden(elem);
if(display&&display!=="none"||!hidden){
jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"));
}
}
}
}
for(index=0;index<length;index++){
elem=elements[index];
if(!elem.style){
continue;
}
if(!show||elem.style.display==="none"||elem.style.display===""){
elem.style.display=show?values[index]||"":"none";
}
}
return elements;
}
function setPositiveNumber(elem,value,subtract){
var matches=rnumsplit.exec(value);
return matches?
Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):
value;
}
function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){
var i=extra===(isBorderBox?"border":"content")?
4:
name==="width"?1:0,
val=0;
for(;i<4;i+=2){
if(extra==="margin"){
val+=jQuery.css(elem,extra+cssExpand[i],true,styles);
}
if(isBorderBox){
if(extra==="content"){
val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles);
}
if(extra!=="margin"){
val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);
}
}else{
val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);
if(extra!=="padding"){
val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);
}
}
}
return val;
}
function getWidthOrHeight(elem,name,extra){
var valueIsBorderBox=true,
val=name==="width"?elem.offsetWidth:elem.offsetHeight,
styles=getStyles(elem),
isBorderBox=support.boxSizing()&&jQuery.css(elem,"boxSizing",false,styles)==="border-box";
if(val<=0||val==null){
val=curCSS(elem,name,styles);
if(val<0||val==null){
val=elem.style[name];
}
if(rnumnonpx.test(val)){
return val;
}
valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);
val=parseFloat(val)||0;
}
return(val+
augmentWidthOrHeight(
elem,
name,
extra||(isBorderBox?"border":"content"),
valueIsBorderBox,
styles
)
)+"px";
}
jQuery.extend({
cssHooks:{
opacity:{
get:function(elem,computed){
if(computed){
var ret=curCSS(elem,"opacity");
return ret===""?"1":ret;
}
}
}
},
cssNumber:{
"columnCount":true,
"fillOpacity":true,
"fontWeight":true,
"lineHeight":true,
"opacity":true,
"order":true,
"orphans":true,
"widows":true,
"zIndex":true,
"zoom":true
},
cssProps:{
"float":support.cssFloat?"cssFloat":"styleFloat"
},
style:function(elem,name,value,extra){
if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){
return;
}
var ret,type,hooks,
origName=jQuery.camelCase(name),
style=elem.style;
name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));
hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];
if(value!==undefined){
type=typeof value;
if(type==="string"&&(ret=rrelNum.exec(value))){
value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));
type="number";
}
if(value==null||value!==value){
return;
}
if(type==="number"&&!jQuery.cssNumber[origName]){
value+="px";
}
if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){
style[name]="inherit";
}
if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){
try{
style[name]="";
style[name]=value;
}catch(e){}
}
}else{
if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){
return ret;
}
return style[name];
}
},
css:function(elem,name,extra,styles){
var num,val,hooks,
origName=jQuery.camelCase(name);
name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));
hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];
if(hooks&&"get"in hooks){
val=hooks.get(elem,true,extra);
}
if(val===undefined){
val=curCSS(elem,name,styles);
}
if(val==="normal"&&name in cssNormalTransform){
val=cssNormalTransform[name];
}
if(extra===""||extra){
num=parseFloat(val);
return extra===true||jQuery.isNumeric(num)?num||0:val;
}
return val;
}
});
jQuery.each(["height","width"],function(i,name){
jQuery.cssHooks[name]={
get:function(elem,computed,extra){
if(computed){
return elem.offsetWidth===0&&rdisplayswap.test(jQuery.css(elem,"display"))?
jQuery.swap(elem,cssShow,function(){
return getWidthOrHeight(elem,name,extra);
}):
getWidthOrHeight(elem,name,extra);
}
},
set:function(elem,value,extra){
var styles=extra&&getStyles(elem);
return setPositiveNumber(elem,value,extra?
augmentWidthOrHeight(
elem,
name,
extra,
support.boxSizing()&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",
styles
):0
);
}
};
});
if(!support.opacity){
jQuery.cssHooks.opacity={
get:function(elem,computed){
return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?
(0.01*parseFloat(RegExp.$1))+"":
computed?"1":"";
},
set:function(elem,value){
var style=elem.style,
currentStyle=elem.currentStyle,
opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",
filter=currentStyle&&currentStyle.filter||style.filter||"";
style.zoom=1;
if((value>=1||value==="")&&
jQuery.trim(filter.replace(ralpha,""))===""&&
style.removeAttribute){
style.removeAttribute("filter");
if(value===""||currentStyle&&!currentStyle.filter){
return;
}
}
style.filter=ralpha.test(filter)?
filter.replace(ralpha,opacity):
filter+" "+opacity;
}
};
}
jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,
function(elem,computed){
if(computed){
return jQuery.swap(elem,{"display":"inline-block"},
curCSS,[elem,"marginRight"]);
}
}
);
jQuery.each({
margin:"",
padding:"",
border:"Width"
},function(prefix,suffix){
jQuery.cssHooks[prefix+suffix]={
expand:function(value){
var i=0,
expanded={},
parts=typeof value==="string"?value.split(" "):[value];
for(;i<4;i++){
expanded[prefix+cssExpand[i]+suffix]=
parts[i]||parts[i-2]||parts[0];
}
return expanded;
}
};
if(!rmargin.test(prefix)){
jQuery.cssHooks[prefix+suffix].set=setPositiveNumber;
}
});
jQuery.fn.extend({
css:function(name,value){
return access(this,function(elem,name,value){
var styles,len,
map={},
i=0;
if(jQuery.isArray(name)){
styles=getStyles(elem);
len=name.length;
for(;i<len;i++){
map[name[i]]=jQuery.css(elem,name[i],false,styles);
}
return map;
}
return value!==undefined?
jQuery.style(elem,name,value):
jQuery.css(elem,name);
},name,value,arguments.length>1);
},
show:function(){
return showHide(this,true);
},
hide:function(){
return showHide(this);
},
toggle:function(state){
if(typeof state==="boolean"){
return state?this.show():this.hide();
}
return this.each(function(){
if(isHidden(this)){
jQuery(this).show();
}else{
jQuery(this).hide();
}
});
}
});
function Tween(elem,options,prop,end,easing){
return new Tween.prototype.init(elem,options,prop,end,easing);
}
jQuery.Tween=Tween;
Tween.prototype={
constructor:Tween,
init:function(elem,options,prop,end,easing,unit){
this.elem=elem;
this.prop=prop;
this.easing=easing||"swing";
this.options=options;
this.start=this.now=this.cur();
this.end=end;
this.unit=unit||(jQuery.cssNumber[prop]?"":"px");
},
cur:function(){
var hooks=Tween.propHooks[this.prop];
return hooks&&hooks.get?
hooks.get(this):
Tween.propHooks._default.get(this);
},
run:function(percent){
var eased,
hooks=Tween.propHooks[this.prop];
if(this.options.duration){
this.pos=eased=jQuery.easing[this.easing](
percent,this.options.duration*percent,0,1,this.options.duration
);
}else{
this.pos=eased=percent;
}
this.now=(this.end-this.start)*eased+this.start;
if(this.options.step){
this.options.step.call(this.elem,this.now,this);
}
if(hooks&&hooks.set){
hooks.set(this);
}else{
Tween.propHooks._default.set(this);
}
return this;
}
};
Tween.prototype.init.prototype=Tween.prototype;
Tween.propHooks={
_default:{
get:function(tween){
var result;
if(tween.elem[tween.prop]!=null&&
(!tween.elem.style||tween.elem.style[tween.prop]==null)){
return tween.elem[tween.prop];
}
result=jQuery.css(tween.elem,tween.prop,"");
return!result||result==="auto"?0:result;
},
set:function(tween){
if(jQuery.fx.step[tween.prop]){
jQuery.fx.step[tween.prop](tween);
}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){
jQuery.style(tween.elem,tween.prop,tween.now+tween.unit);
}else{
tween.elem[tween.prop]=tween.now;
}
}
}
};
Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={
set:function(tween){
if(tween.elem.nodeType&&tween.elem.parentNode){
tween.elem[tween.prop]=tween.now;
}
}
};
jQuery.easing={
linear:function(p){
return p;
},
swing:function(p){
return 0.5-Math.cos(p*Math.PI)/2;
}
};
jQuery.fx=Tween.prototype.init;
jQuery.fx.step={};
var
fxNow,timerId,
rfxtypes=/^(?:toggle|show|hide)$/,
rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),
rrun=/queueHooks$/,
animationPrefilters=[defaultPrefilter],
tweeners={
"*":[function(prop,value){
var tween=this.createTween(prop,value),
target=tween.cur(),
parts=rfxnum.exec(value),
unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),
start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&
rfxnum.exec(jQuery.css(tween.elem,prop)),
scale=1,
maxIterations=20;
if(start&&start[3]!==unit){
unit=unit||start[3];
parts=parts||[];
start=+target||1;
do{
scale=scale||".5";
start=start/scale;
jQuery.style(tween.elem,prop,start+unit);
}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations);
}
if(parts){
start=tween.start=+start||+target||0;
tween.unit=unit;
tween.end=parts[1]?
start+(parts[1]+1)*parts[2]:
+parts[2];
}
return tween;
}]
};
function createFxNow(){
setTimeout(function(){
fxNow=undefined;
});
return(fxNow=jQuery.now());
}
function genFx(type,includeWidth){
var which,
attrs={height:type},
i=0;
includeWidth=includeWidth?1:0;
for(;i<4;i+=2-includeWidth){
which=cssExpand[i];
attrs["margin"+which]=attrs["padding"+which]=type;
}
if(includeWidth){
attrs.opacity=attrs.width=type;
}
return attrs;
}
function createTween(value,prop,animation){
var tween,
collection=(tweeners[prop]||[]).concat(tweeners["*"]),
index=0,
length=collection.length;
for(;index<length;index++){
if((tween=collection[index].call(animation,prop,value))){
return tween;
}
}
}
function defaultPrefilter(elem,props,opts){

var prop,value,toggle,tween,hooks,oldfire,display,dDisplay,
anim=this,
orig={},
style=elem.style,
hidden=elem.nodeType&&isHidden(elem),
dataShow=jQuery._data(elem,"fxshow");
if(!opts.queue){
hooks=jQuery._queueHooks(elem,"fx");
if(hooks.unqueued==null){
hooks.unqueued=0;
oldfire=hooks.empty.fire;
hooks.empty.fire=function(){
if(!hooks.unqueued){
oldfire();
}
};
}
hooks.unqueued++;
anim.always(function(){
anim.always(function(){
hooks.unqueued--;
if(!jQuery.queue(elem,"fx").length){
hooks.empty.fire();
}
});
});
}
if(elem.nodeType===1&&("height"in props||"width"in props)){
opts.overflow=[style.overflow,style.overflowX,style.overflowY];
display=jQuery.css(elem,"display");
dDisplay=defaultDisplay(elem.nodeName);
if(display==="none"){
display=dDisplay;
}
if(display==="inline"&&
jQuery.css(elem,"float")==="none"){
if(!support.inlineBlockNeedsLayout||dDisplay==="inline"){
style.display="inline-block";
}else{
style.zoom=1;
}
}
}
if(opts.overflow){
style.overflow="hidden";
if(!support.shrinkWrapBlocks()){
anim.always(function(){
style.overflow=opts.overflow[0];
style.overflowX=opts.overflow[1];
style.overflowY=opts.overflow[2];
});
}
}
for(prop in props){
value=props[prop];
if(rfxtypes.exec(value)){
delete props[prop];
toggle=toggle||value==="toggle";
if(value===(hidden?"hide":"show")){
if(value==="show"&&dataShow&&dataShow[prop]!==undefined){
hidden=true;
}else{
continue;
}
}
orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop);
}
}
if(!jQuery.isEmptyObject(orig)){
if(dataShow){
if("hidden"in dataShow){
hidden=dataShow.hidden;
}
}else{
dataShow=jQuery._data(elem,"fxshow",{});
}
if(toggle){
dataShow.hidden=!hidden;
}
if(hidden){
jQuery(elem).show();
}else{
anim.done(function(){
jQuery(elem).hide();
});
}
anim.done(function(){
var prop;
jQuery._removeData(elem,"fxshow");
for(prop in orig){
jQuery.style(elem,prop,orig[prop]);
}
});
for(prop in orig){
tween=createTween(hidden?dataShow[prop]:0,prop,anim);
if(!(prop in dataShow)){
dataShow[prop]=tween.start;
if(hidden){
tween.end=tween.start;
tween.start=prop==="width"||prop==="height"?1:0;
}
}
}
}
}
function propFilter(props,specialEasing){
var index,name,easing,value,hooks;
for(index in props){
name=jQuery.camelCase(index);
easing=specialEasing[name];
value=props[index];
if(jQuery.isArray(value)){
easing=value[1];
value=props[index]=value[0];
}
if(index!==name){
props[name]=value;
delete props[index];
}
hooks=jQuery.cssHooks[name];
if(hooks&&"expand"in hooks){
value=hooks.expand(value);
delete props[name];
for(index in value){
if(!(index in props)){
props[index]=value[index];
specialEasing[index]=easing;
}
}
}else{
specialEasing[name]=easing;
}
}
}
function Animation(elem,properties,options){
var result,
stopped,
index=0,
length=animationPrefilters.length,
deferred=jQuery.Deferred().always(function(){
delete tick.elem;
}),
tick=function(){
if(stopped){
return false;
}
var currentTime=fxNow||createFxNow(),
remaining=Math.max(0,animation.startTime+animation.duration-currentTime),
temp=remaining/animation.duration||0,
percent=1-temp,
index=0,
length=animation.tweens.length;
for(;index<length;index++){
animation.tweens[index].run(percent);
}
deferred.notifyWith(elem,[animation,percent,remaining]);
if(percent<1&&length){
return remaining;
}else{
deferred.resolveWith(elem,[animation]);
return false;
}
},
animation=deferred.promise({
elem:elem,
props:jQuery.extend({},properties),
opts:jQuery.extend(true,{specialEasing:{}},options),
originalProperties:properties,
originalOptions:options,
startTime:fxNow||createFxNow(),
duration:options.duration,
tweens:[],
createTween:function(prop,end){
var tween=jQuery.Tween(elem,animation.opts,prop,end,
animation.opts.specialEasing[prop]||animation.opts.easing);
animation.tweens.push(tween);
return tween;
},
stop:function(gotoEnd){
var index=0,
length=gotoEnd?animation.tweens.length:0;
if(stopped){
return this;
}
stopped=true;
for(;index<length;index++){
animation.tweens[index].run(1);
}
if(gotoEnd){
deferred.resolveWith(elem,[animation,gotoEnd]);
}else{
deferred.rejectWith(elem,[animation,gotoEnd]);
}
return this;
}
}),
props=animation.props;
propFilter(props,animation.opts.specialEasing);
for(;index<length;index++){
result=animationPrefilters[index].call(animation,elem,props,animation.opts);
if(result){
return result;
}
}
jQuery.map(props,createTween,animation);
if(jQuery.isFunction(animation.opts.start)){
animation.opts.start.call(elem,animation);
}
jQuery.fx.timer(
jQuery.extend(tick,{
elem:elem,
anim:animation,
queue:animation.opts.queue
})
);
return animation.progress(animation.opts.progress)
.done(animation.opts.done,animation.opts.complete)
.fail(animation.opts.fail)
.always(animation.opts.always);
}
jQuery.Animation=jQuery.extend(Animation,{
tweener:function(props,callback){
if(jQuery.isFunction(props)){
callback=props;
props=["*"];
}else{
props=props.split(" ");
}
var prop,
index=0,
length=props.length;
for(;index<length;index++){
prop=props[index];
tweeners[prop]=tweeners[prop]||[];
tweeners[prop].unshift(callback);
}
},
prefilter:function(callback,prepend){
if(prepend){
animationPrefilters.unshift(callback);
}else{
animationPrefilters.push(callback);
}
}
});
jQuery.speed=function(speed,easing,fn){
var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{
complete:fn||!fn&&easing||
jQuery.isFunction(speed)&&speed,
duration:speed,
easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing
};
opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:
opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;
if(opt.queue==null||opt.queue===true){
opt.queue="fx";
}
opt.old=opt.complete;
opt.complete=function(){
if(jQuery.isFunction(opt.old)){
opt.old.call(this);
}
if(opt.queue){
jQuery.dequeue(this,opt.queue);
}
};
return opt;
};
jQuery.fn.extend({
fadeTo:function(speed,to,easing,callback){
return this.filter(isHidden).css("opacity",0).show()
.end().animate({opacity:to},speed,easing,callback);
},
animate:function(prop,speed,easing,callback){
var empty=jQuery.isEmptyObject(prop),
optall=jQuery.speed(speed,easing,callback),
doAnimation=function(){
var anim=Animation(this,jQuery.extend({},prop),optall);
if(empty||jQuery._data(this,"finish")){
anim.stop(true);
}
};
doAnimation.finish=doAnimation;
return empty||optall.queue===false?
this.each(doAnimation):
this.queue(optall.queue,doAnimation);
},
stop:function(type,clearQueue,gotoEnd){
var stopQueue=function(hooks){
var stop=hooks.stop;
delete hooks.stop;
stop(gotoEnd);
};
if(typeof type!=="string"){
gotoEnd=clearQueue;
clearQueue=type;
type=undefined;
}
if(clearQueue&&type!==false){
this.queue(type||"fx",[]);
}
return this.each(function(){
var dequeue=true,
index=type!=null&&type+"queueHooks",
timers=jQuery.timers,
data=jQuery._data(this);
if(index){
if(data[index]&&data[index].stop){
stopQueue(data[index]);
}
}else{
for(index in data){
if(data[index]&&data[index].stop&&rrun.test(index)){
stopQueue(data[index]);
}
}
}
for(index=timers.length;index--;){
if(timers[index].elem===this&&(type==null||timers[index].queue===type)){
timers[index].anim.stop(gotoEnd);
dequeue=false;
timers.splice(index,1);
}
}
if(dequeue||!gotoEnd){
jQuery.dequeue(this,type);
}
});
},
finish:function(type){
if(type!==false){
type=type||"fx";
}
return this.each(function(){
var index,
data=jQuery._data(this),
queue=data[type+"queue"],
hooks=data[type+"queueHooks"],
timers=jQuery.timers,
length=queue?queue.length:0;
data.finish=true;
jQuery.queue(this,type,[]);
if(hooks&&hooks.stop){
hooks.stop.call(this,true);
}
for(index=timers.length;index--;){
if(timers[index].elem===this&&timers[index].queue===type){
timers[index].anim.stop(true);
timers.splice(index,1);
}
}
for(index=0;index<length;index++){
if(queue[index]&&queue[index].finish){
queue[index].finish.call(this);
}
}
delete data.finish;
});
}
});
jQuery.each(["toggle","show","hide"],function(i,name){
var cssFn=jQuery.fn[name];
jQuery.fn[name]=function(speed,easing,callback){
return speed==null||typeof speed==="boolean"?
cssFn.apply(this,arguments):
this.animate(genFx(name,true),speed,easing,callback);
};
});
jQuery.each({
slideDown:genFx("show"),
slideUp:genFx("hide"),
slideToggle:genFx("toggle"),
fadeIn:{opacity:"show"},
fadeOut:{opacity:"hide"},
fadeToggle:{opacity:"toggle"}
},function(name,props){
jQuery.fn[name]=function(speed,easing,callback){
return this.animate(props,speed,easing,callback);
};
});
jQuery.timers=[];
jQuery.fx.tick=function(){
var timer,
timers=jQuery.timers,
i=0;
fxNow=jQuery.now();
for(;i<timers.length;i++){
timer=timers[i];
if(!timer()&&timers[i]===timer){
timers.splice(i--,1);
}
}
if(!timers.length){
jQuery.fx.stop();
}
fxNow=undefined;
};
jQuery.fx.timer=function(timer){
jQuery.timers.push(timer);
if(timer()){
jQuery.fx.start();
}else{
jQuery.timers.pop();
}
};
jQuery.fx.interval=13;
jQuery.fx.start=function(){
if(!timerId){
timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval);
}
};
jQuery.fx.stop=function(){
clearInterval(timerId);
timerId=null;
};
jQuery.fx.speeds={
slow:600,
fast:200,
_default:400
};
jQuery.fn.delay=function(time,type){
time=jQuery.fx?jQuery.fx.speeds[time]||time:time;
type=type||"fx";
return this.queue(type,function(next,hooks){
var timeout=setTimeout(next,time);
hooks.stop=function(){
clearTimeout(timeout);
};
});
};
(function(){
var a,input,select,opt,
div=document.createElement("div");
div.setAttribute("className","t");
div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
a=div.getElementsByTagName("a")[0];
select=document.createElement("select");
opt=select.appendChild(document.createElement("option"));
input=div.getElementsByTagName("input")[0];
a.style.cssText="top:1px";
support.getSetAttribute=div.className!=="t";
support.style=/top/.test(a.getAttribute("style"));
support.hrefNormalized=a.getAttribute("href")==="/a";
support.checkOn=!!input.value;
support.optSelected=opt.selected;
support.enctype=!!document.createElement("form").enctype;
select.disabled=true;
support.optDisabled=!opt.disabled;
input=document.createElement("input");
input.setAttribute("value","");
support.input=input.getAttribute("value")==="";
input.value="t";
input.setAttribute("type","radio");
support.radioValue=input.value==="t";
a=input=select=opt=div=null;
})();
var rreturn=/\r/g;
jQuery.fn.extend({
val:function(value){
var hooks,ret,isFunction,
elem=this[0];
if(!arguments.length){
if(elem){
hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];
if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){
return ret;
}
ret=elem.value;
return typeof ret==="string"?
ret.replace(rreturn,""):
ret==null?"":ret;
}
return;
}
isFunction=jQuery.isFunction(value);
return this.each(function(i){
var val;
if(this.nodeType!==1){
return;
}
if(isFunction){
val=value.call(this,i,jQuery(this).val());
}else{
val=value;
}
if(val==null){
val="";
}else if(typeof val==="number"){
val+="";
}else if(jQuery.isArray(val)){
val=jQuery.map(val,function(value){
return value==null?"":value+"";
});
}
hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];
if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){
this.value=val;
}
});
}
});
jQuery.extend({
valHooks:{
option:{
get:function(elem){
var val=jQuery.find.attr(elem,"value");
return val!=null?
val:
jQuery.text(elem);
}
},
select:{
get:function(elem){
var value,option,
options=elem.options,
index=elem.selectedIndex,
one=elem.type==="select-one"||index<0,
values=one?null:[],
max=one?index+1:options.length,
i=index<0?
max:
one?index:0;
for(;i<max;i++){
option=options[i];
if((option.selected||i===index)&&
(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&
(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){
value=jQuery(option).val();
if(one){
return value;
}
values.push(value);
}
}
return values;
},
set:function(elem,value){
var optionSet,option,
options=elem.options,
values=jQuery.makeArray(value),
i=options.length;
while(i--){
option=options[i];
if(jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0){
try{
option.selected=optionSet=true;
}catch(_){
option.scrollHeight;
}
}else{
option.selected=false;
}
}
if(!optionSet){
elem.selectedIndex=-1;
}
return options;
}
}
}
});
jQuery.each(["radio","checkbox"],function(){
jQuery.valHooks[this]={
set:function(elem,value){
if(jQuery.isArray(value)){
return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0);
}
}
};
if(!support.checkOn){
jQuery.valHooks[this].get=function(elem){
return elem.getAttribute("value")===null?"on":elem.value;
};
}
});
var nodeHook,boolHook,
attrHandle=jQuery.expr.attrHandle,
ruseDefault=/^(?:checked|selected)$/i,
getSetAttribute=support.getSetAttribute,
getSetInput=support.input;
jQuery.fn.extend({
attr:function(name,value){
return access(this,jQuery.attr,name,value,arguments.length>1);
},
removeAttr:function(name){
return this.each(function(){
jQuery.removeAttr(this,name);
});
}
});
jQuery.extend({
attr:function(elem,name,value){
var hooks,ret,
nType=elem.nodeType;
if(!elem||nType===3||nType===8||nType===2){
return;
}
if(typeof elem.getAttribute===strundefined){
return jQuery.prop(elem,name,value);
}
if(nType!==1||!jQuery.isXMLDoc(elem)){
name=name.toLowerCase();
hooks=jQuery.attrHooks[name]||
(jQuery.expr.match.bool.test(name)?boolHook:nodeHook);
}
if(value!==undefined){
if(value===null){
jQuery.removeAttr(elem,name);
}else if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){
return ret;
}else{
elem.setAttribute(name,value+"");
return value;
}
}else if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){
return ret;
}else{
ret=jQuery.find.attr(elem,name);
return ret==null?
undefined:
ret;
}
},
removeAttr:function(elem,value){
var name,propName,
i=0,
attrNames=value&&value.match(rnotwhite);
if(attrNames&&elem.nodeType===1){
while((name=attrNames[i++])){
propName=jQuery.propFix[name]||name;
if(jQuery.expr.match.bool.test(name)){
if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){
elem[propName]=false;
}else{
elem[jQuery.camelCase("default-"+name)]=
elem[propName]=false;
}
}else{
jQuery.attr(elem,name,"");
}
elem.removeAttribute(getSetAttribute?name:propName);
}
}
},
attrHooks:{
type:{
set:function(elem,value){
if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){
var val=elem.value;
elem.setAttribute("type",value);
if(val){
elem.value=val;
}
return value;
}
}
}
}
});
boolHook={
set:function(elem,value,name){
if(value===false){
jQuery.removeAttr(elem,name);
}else if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){
elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name);
}else{
elem[jQuery.camelCase("default-"+name)]=elem[name]=true;
}
return name;
}
};
jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){
var getter=attrHandle[name]||jQuery.find.attr;
attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?
function(elem,name,isXML){
var ret,handle;
if(!isXML){
handle=attrHandle[name];
attrHandle[name]=ret;
ret=getter(elem,name,isXML)!=null?
name.toLowerCase():
null;
attrHandle[name]=handle;
}
return ret;
}:
function(elem,name,isXML){
if(!isXML){
return elem[jQuery.camelCase("default-"+name)]?
name.toLowerCase():
null;
}
};
});
if(!getSetInput||!getSetAttribute){
jQuery.attrHooks.value={
set:function(elem,value,name){
if(jQuery.nodeName(elem,"input")){
elem.defaultValue=value;
}else{
return nodeHook&&nodeHook.set(elem,value,name);
}
}
};
}
if(!getSetAttribute){
nodeHook={
set:function(elem,value,name){
var ret=elem.getAttributeNode(name);
if(!ret){
elem.setAttributeNode(
(ret=elem.ownerDocument.createAttribute(name))
);
}
ret.value=value+="";
if(name==="value"||value===elem.getAttribute(name)){
return value;
}
}
};
attrHandle.id=attrHandle.name=attrHandle.coords=
function(elem,name,isXML){
var ret;
if(!isXML){
return(ret=elem.getAttributeNode(name))&&ret.value!==""?
ret.value:
null;
}
};
jQuery.valHooks.button={
get:function(elem,name){
var ret=elem.getAttributeNode(name);
if(ret&&ret.specified){
return ret.value;
}
},
set:nodeHook.set
};
jQuery.attrHooks.contenteditable={
set:function(elem,value,name){
nodeHook.set(elem,value===""?false:value,name);
}
};
jQuery.each(["width","height"],function(i,name){
jQuery.attrHooks[name]={
set:function(elem,value){
if(value===""){
elem.setAttribute(name,"auto");
return value;
}
}
};
});
}
if(!support.style){
jQuery.attrHooks.style={
get:function(elem){
return elem.style.cssText||undefined;
},
set:function(elem,value){
return(elem.style.cssText=value+"");
}
};
}
var rfocusable=/^(?:input|select|textarea|button|object)$/i,
rclickable=/^(?:a|area)$/i;
jQuery.fn.extend({
prop:function(name,value){
return access(this,jQuery.prop,name,value,arguments.length>1);
},
removeProp:function(name){
name=jQuery.propFix[name]||name;
return this.each(function(){
try{
this[name]=undefined;
delete this[name];
}catch(e){}
});
}
});
jQuery.extend({
propFix:{
"for":"htmlFor",
"class":"className"
},
prop:function(elem,name,value){
var ret,hooks,notxml,
nType=elem.nodeType;
if(!elem||nType===3||nType===8||nType===2){
return;
}
notxml=nType!==1||!jQuery.isXMLDoc(elem);
if(notxml){
name=jQuery.propFix[name]||name;
hooks=jQuery.propHooks[name];
}
if(value!==undefined){
return hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?
ret:
(elem[name]=value);
}else{
return hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null?
ret:
elem[name];
}
},
propHooks:{
tabIndex:{
get:function(elem){
var tabindex=jQuery.find.attr(elem,"tabindex");
return tabindex?
parseInt(tabindex,10):
rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?
0:
-1;
}
}
}
});
if(!support.hrefNormalized){
jQuery.each(["href","src"],function(i,name){
jQuery.propHooks[name]={
get:function(elem){
return elem.getAttribute(name,4);
}
};
});
}
if(!support.optSelected){
jQuery.propHooks.selected={
get:function(elem){
var parent=elem.parentNode;
if(parent){
parent.selectedIndex;
if(parent.parentNode){
parent.parentNode.selectedIndex;
}
}
return null;
}
};
}
jQuery.each([
"tabIndex",
"readOnly",
"maxLength",
"cellSpacing",
"cellPadding",
"rowSpan",
"colSpan",
"useMap",
"frameBorder",
"contentEditable"
],function(){
jQuery.propFix[this.toLowerCase()]=this;
});
if(!support.enctype){
jQuery.propFix.enctype="encoding";
}
var rclass=/[\t\r\n\f]/g;
jQuery.fn.extend({
addClass:function(value){
var classes,elem,cur,clazz,j,finalValue,
i=0,
len=this.length,
proceed=typeof value==="string"&&value;
if(jQuery.isFunction(value)){
return this.each(function(j){
jQuery(this).addClass(value.call(this,j,this.className));
});
}
if(proceed){
classes=(value||"").match(rnotwhite)||[];
for(;i<len;i++){
elem=this[i];
cur=elem.nodeType===1&&(elem.className?
(" "+elem.className+" ").replace(rclass," "):
" "
);
if(cur){
j=0;
while((clazz=classes[j++])){
if(cur.indexOf(" "+clazz+" ")<0){
cur+=clazz+" ";
}
}
finalValue=jQuery.trim(cur);
if(elem.className!==finalValue){
elem.className=finalValue;
}
}
}
}
return this;
},
removeClass:function(value){
var classes,elem,cur,clazz,j,finalValue,
i=0,
len=this.length,
proceed=arguments.length===0||typeof value==="string"&&value;
if(jQuery.isFunction(value)){
return this.each(function(j){
jQuery(this).removeClass(value.call(this,j,this.className));
});
}
if(proceed){
classes=(value||"").match(rnotwhite)||[];
for(;i<len;i++){
elem=this[i];
cur=elem.nodeType===1&&(elem.className?
(" "+elem.className+" ").replace(rclass," "):
""
);
if(cur){
j=0;
while((clazz=classes[j++])){
while(cur.indexOf(" "+clazz+" ")>=0){
cur=cur.replace(" "+clazz+" "," ");
}
}
finalValue=value?jQuery.trim(cur):"";
if(elem.className!==finalValue){
elem.className=finalValue;
}
}
}
}
return this;
},
toggleClass:function(value,stateVal){
var type=typeof value;
if(typeof stateVal==="boolean"&&type==="string"){
return stateVal?this.addClass(value):this.removeClass(value);
}
if(jQuery.isFunction(value)){
return this.each(function(i){
jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal);
});
}
return this.each(function(){
if(type==="string"){
var className,
i=0,
self=jQuery(this),
classNames=value.match(rnotwhite)||[];
while((className=classNames[i++])){
if(self.hasClass(className)){
self.removeClass(className);
}else{
self.addClass(className);
}
}
}else if(type===strundefined||type==="boolean"){
if(this.className){
jQuery._data(this,"__className__",this.className);
}
this.className=this.className||value===false?"":jQuery._data(this,"__className__")||"";
}
});
},
hasClass:function(selector){
var className=" "+selector+" ",
i=0,
l=this.length;
for(;i<l;i++){
if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){
return true;
}
}
return false;
}
});
jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+
"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+
"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){
jQuery.fn[name]=function(data,fn){
return arguments.length>0?
this.on(name,null,data,fn):
this.trigger(name);
};
});
jQuery.fn.extend({
hover:function(fnOver,fnOut){
return this.mouseenter(fnOver).mouseleave(fnOut||fnOver);
},
bind:function(types,data,fn){
return this.on(types,null,data,fn);
},
unbind:function(types,fn){
return this.off(types,null,fn);
},
delegate:function(selector,types,data,fn){
return this.on(types,selector,data,fn);
},
undelegate:function(selector,types,fn){
return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn);
}
});
var nonce=jQuery.now();
var rquery=(/\?/);
var rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;
jQuery.parseJSON=function(data){
if(window.JSON&&window.JSON.parse){
return window.JSON.parse(data+"");
}
var requireNonComma,
depth=null,
str=jQuery.trim(data+"");
return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){
if(requireNonComma&&comma){
depth=0;
}
if(depth===0){
return token;
}
requireNonComma=open||comma;
depth+=!close-!open;
return"";
}))?
(Function("return "+str))():
jQuery.error("Invalid JSON: "+data);
};
jQuery.parseXML=function(data){
var xml,tmp;
if(!data||typeof data!=="string"){
return null;
}
try{
if(window.DOMParser){tmp=new DOMParser();
xml=tmp.parseFromString(data,"text/xml");
}else{xml=new ActiveXObject("Microsoft.XMLDOM");
xml.async="false";
xml.loadXML(data);
}
}catch(e){
xml=undefined;
}
if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){
jQuery.error("Invalid XML: "+data);
}
return xml;
};
var
ajaxLocParts,
ajaxLocation,
rhash=/#.*$/,
rts=/([?&])_=[^&]*/,
rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
rnoContent=/^(?:GET|HEAD)$/,
rprotocol=/^\/\//,
rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,

prefilters={},

transports={},
allTypes="*/".concat("*");
try{
ajaxLocation=location.href;
}catch(e){
ajaxLocation=document.createElement("a");
ajaxLocation.href="";
ajaxLocation=ajaxLocation.href;
}
ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];
function addToPrefiltersOrTransports(structure){
return function(dataTypeExpression,func){
if(typeof dataTypeExpression!=="string"){
func=dataTypeExpression;
dataTypeExpression="*";
}
var dataType,
i=0,
dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];
if(jQuery.isFunction(func)){
while((dataType=dataTypes[i++])){
if(dataType.charAt(0)==="+"){
dataType=dataType.slice(1)||"*";
(structure[dataType]=structure[dataType]||[]).unshift(func);
}else{
(structure[dataType]=structure[dataType]||[]).push(func);
}
}
}
};
}
function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){
var inspected={},
seekingTransport=(structure===transports);
function inspect(dataType){
var selected;
inspected[dataType]=true;
jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){
var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);
if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){
options.dataTypes.unshift(dataTypeOrTransport);
inspect(dataTypeOrTransport);
return false;
}else if(seekingTransport){
return!(selected=dataTypeOrTransport);
}
});
return selected;
}
return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*");
}
function ajaxExtend(target,src){
var deep,key,
flatOptions=jQuery.ajaxSettings.flatOptions||{};
for(key in src){
if(src[key]!==undefined){
(flatOptions[key]?target:(deep||(deep={})))[key]=src[key];
}
}
if(deep){
jQuery.extend(true,target,deep);
}
return target;
}

function ajaxHandleResponses(s,jqXHR,responses){
var firstDataType,ct,finalDataType,type,
contents=s.contents,
dataTypes=s.dataTypes;
while(dataTypes[0]==="*"){
dataTypes.shift();
if(ct===undefined){
ct=s.mimeType||jqXHR.getResponseHeader("Content-Type");
}
}
if(ct){
for(type in contents){
if(contents[type]&&contents[type].test(ct)){
dataTypes.unshift(type);
break;
}
}
}
if(dataTypes[0]in responses){
finalDataType=dataTypes[0];
}else{
for(type in responses){
if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){
finalDataType=type;
break;
}
if(!firstDataType){
firstDataType=type;
}
}
finalDataType=finalDataType||firstDataType;
}
if(finalDataType){
if(finalDataType!==dataTypes[0]){
dataTypes.unshift(finalDataType);
}
return responses[finalDataType];
}
}

function ajaxConvert(s,response,jqXHR,isSuccess){
var conv2,current,conv,tmp,prev,
converters={},
dataTypes=s.dataTypes.slice();
if(dataTypes[1]){
for(conv in s.converters){
converters[conv.toLowerCase()]=s.converters[conv];
}
}
current=dataTypes.shift();
while(current){
if(s.responseFields[current]){
jqXHR[s.responseFields[current]]=response;
}
if(!prev&&isSuccess&&s.dataFilter){
response=s.dataFilter(response,s.dataType);
}
prev=current;
current=dataTypes.shift();
if(current){
if(current==="*"){
current=prev;
}else if(prev!=="*"&&prev!==current){
conv=converters[prev+" "+current]||converters["* "+current];
if(!conv){
for(conv2 in converters){
tmp=conv2.split(" ");
if(tmp[1]===current){
conv=converters[prev+" "+tmp[0]]||
converters["* "+tmp[0]];
if(conv){
if(conv===true){
conv=converters[conv2];
}else if(converters[conv2]!==true){
current=tmp[0];
dataTypes.unshift(tmp[1]);
}
break;
}
}
}
}
if(conv!==true){
if(conv&&s["throws"]){
response=conv(response);
}else{
try{
response=conv(response);
}catch(e){
return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current};
}
}
}
}
}
}
return{state:"success",data:response};
}
jQuery.extend({
active:0,
lastModified:{},
etag:{},
ajaxSettings:{
url:ajaxLocation,
type:"GET",
isLocal:rlocalProtocol.test(ajaxLocParts[1]),
global:true,
processData:true,
async:true,
contentType:"application/x-www-form-urlencoded; charset=UTF-8",

accepts:{
"*":allTypes,
text:"text/plain",
html:"text/html",
xml:"application/xml, text/xml",
json:"application/json, text/javascript"
},
contents:{
xml:/xml/,
html:/html/,
json:/json/
},
responseFields:{
xml:"responseXML",
text:"responseText",
json:"responseJSON"
},
converters:{
"* text":String,
"text html":true,
"text json":jQuery.parseJSON,
"text xml":jQuery.parseXML
},
flatOptions:{
url:true,
context:true
}
},
ajaxSetup:function(target,settings){
return settings?
ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):
ajaxExtend(jQuery.ajaxSettings,target);
},
ajaxPrefilter:addToPrefiltersOrTransports(prefilters),
ajaxTransport:addToPrefiltersOrTransports(transports),
ajax:function(url,options){
if(typeof url==="object"){
options=url;
url=undefined;
}
options=options||{};
var parts,
i,
cacheURL,
responseHeadersString,
timeoutTimer,
fireGlobals,
transport,
responseHeaders,
s=jQuery.ajaxSetup({},options),
callbackContext=s.context||s,
globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?
jQuery(callbackContext):
jQuery.event,
deferred=jQuery.Deferred(),
completeDeferred=jQuery.Callbacks("once memory"),
statusCode=s.statusCode||{},
requestHeaders={},
requestHeadersNames={},
state=0,
strAbort="canceled",
jqXHR={
readyState:0,
getResponseHeader:function(key){
var match;
if(state===2){
if(!responseHeaders){
responseHeaders={};
while((match=rheaders.exec(responseHeadersString))){
responseHeaders[match[1].toLowerCase()]=match[2];
}
}
match=responseHeaders[key.toLowerCase()];
}
return match==null?null:match;
},
getAllResponseHeaders:function(){
return state===2?responseHeadersString:null;
},
setRequestHeader:function(name,value){
var lname=name.toLowerCase();
if(!state){
name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;
requestHeaders[name]=value;
}
return this;
},
overrideMimeType:function(type){
if(!state){
s.mimeType=type;
}
return this;
},
statusCode:function(map){
var code;
if(map){
if(state<2){
for(code in map){
statusCode[code]=[statusCode[code],map[code]];
}
}else{
jqXHR.always(map[jqXHR.status]);
}
}
return this;
},
abort:function(statusText){
var finalText=statusText||strAbort;
if(transport){
transport.abort(finalText);
}
done(0,finalText);
return this;
}
};
deferred.promise(jqXHR).complete=completeDeferred.add;
jqXHR.success=jqXHR.done;
jqXHR.error=jqXHR.fail;
s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");
s.type=options.method||options.type||s.method||s.type;
s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];
if(s.crossDomain==null){
parts=rurl.exec(s.url.toLowerCase());
s.crossDomain=!!(parts&&
(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||
(parts[3]||(parts[1]==="http:"?"80":"443"))!==
(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443")))
);
}
if(s.data&&s.processData&&typeof s.data!=="string"){
s.data=jQuery.param(s.data,s.traditional);
}
inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);
if(state===2){
return jqXHR;
}
fireGlobals=s.global;
if(fireGlobals&&jQuery.active++===0){
jQuery.event.trigger("ajaxStart");
}
s.type=s.type.toUpperCase();
s.hasContent=!rnoContent.test(s.type);
cacheURL=s.url;
if(!s.hasContent){
if(s.data){
cacheURL=(s.url+=(rquery.test(cacheURL)?"&":"?")+s.data);
delete s.data;
}
if(s.cache===false){
s.url=rts.test(cacheURL)?
cacheURL.replace(rts,"$1_="+nonce++):
cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++;
}
}
if(s.ifModified){
if(jQuery.lastModified[cacheURL]){
jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]);
}
if(jQuery.etag[cacheURL]){
jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL]);
}
}
if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){
jqXHR.setRequestHeader("Content-Type",s.contentType);
}
jqXHR.setRequestHeader(
"Accept",
s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?
s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):
s.accepts["*"]
);
for(i in s.headers){
jqXHR.setRequestHeader(i,s.headers[i]);
}
if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){
return jqXHR.abort();
}
strAbort="abort";
for(i in{success:1,error:1,complete:1}){
jqXHR[i](s[i]);
}
transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);
if(!transport){
done(-1,"No Transport");
}else{
jqXHR.readyState=1;
if(fireGlobals){
globalEventContext.trigger("ajaxSend",[jqXHR,s]);
}
if(s.async&&s.timeout>0){
timeoutTimer=setTimeout(function(){
jqXHR.abort("timeout");
},s.timeout);
}
try{
state=1;
transport.send(requestHeaders,done);
}catch(e){
if(state<2){
done(-1,e);
}else{
throw e;
}
}
}
function done(status,nativeStatusText,responses,headers){
var isSuccess,success,error,response,modified,
statusText=nativeStatusText;
if(state===2){
return;
}
state=2;
if(timeoutTimer){
clearTimeout(timeoutTimer);
}
transport=undefined;
responseHeadersString=headers||"";
jqXHR.readyState=status>0?4:0;
isSuccess=status>=200&&status<300||status===304;
if(responses){
response=ajaxHandleResponses(s,jqXHR,responses);
}
response=ajaxConvert(s,response,jqXHR,isSuccess);
if(isSuccess){
if(s.ifModified){
modified=jqXHR.getResponseHeader("Last-Modified");
if(modified){
jQuery.lastModified[cacheURL]=modified;
}
modified=jqXHR.getResponseHeader("etag");
if(modified){
jQuery.etag[cacheURL]=modified;
}
}
if(status===204||s.type==="HEAD"){
statusText="nocontent";
}else if(status===304){
statusText="notmodified";
}else{
statusText=response.state;
success=response.data;
error=response.error;
isSuccess=!error;
}
}else{
error=statusText;
if(status||!statusText){
statusText="error";
if(status<0){
status=0;
}
}
}
jqXHR.status=status;
jqXHR.statusText=(nativeStatusText||statusText)+"";
if(isSuccess){
deferred.resolveWith(callbackContext,[success,statusText,jqXHR]);
}else{
deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);
}
jqXHR.statusCode(statusCode);
statusCode=undefined;
if(fireGlobals){
globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",
[jqXHR,s,isSuccess?success:error]);
}
completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);
if(fireGlobals){
globalEventContext.trigger("ajaxComplete",[jqXHR,s]);
if(!(--jQuery.active)){
jQuery.event.trigger("ajaxStop");
}
}
}
return jqXHR;
},
getJSON:function(url,data,callback){
return jQuery.get(url,data,callback,"json");
},
getScript:function(url,callback){
return jQuery.get(url,undefined,callback,"script");
}
});
jQuery.each(["get","post"],function(i,method){
jQuery[method]=function(url,data,callback,type){
if(jQuery.isFunction(data)){
type=type||callback;
callback=data;
data=undefined;
}
return jQuery.ajax({
url:url,
type:method,
dataType:type,
data:data,
success:callback
});
};
});
jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){
jQuery.fn[type]=function(fn){
return this.on(type,fn);
};
});
jQuery._evalUrl=function(url){
return jQuery.ajax({
url:url,
type:"GET",
dataType:"script",
async:false,
global:false,
"throws":true
});
};
jQuery.fn.extend({
wrapAll:function(html){
if(jQuery.isFunction(html)){
return this.each(function(i){
jQuery(this).wrapAll(html.call(this,i));
});
}
if(this[0]){
var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);
if(this[0].parentNode){
wrap.insertBefore(this[0]);
}
wrap.map(function(){
var elem=this;
while(elem.firstChild&&elem.firstChild.nodeType===1){
elem=elem.firstChild;
}
return elem;
}).append(this);
}
return this;
},
wrapInner:function(html){
if(jQuery.isFunction(html)){
return this.each(function(i){
jQuery(this).wrapInner(html.call(this,i));
});
}
return this.each(function(){
var self=jQuery(this),
contents=self.contents();
if(contents.length){
contents.wrapAll(html);
}else{
self.append(html);
}
});
},
wrap:function(html){
var isFunction=jQuery.isFunction(html);
return this.each(function(i){
jQuery(this).wrapAll(isFunction?html.call(this,i):html);
});
},
unwrap:function(){
return this.parent().each(function(){
if(!jQuery.nodeName(this,"body")){
jQuery(this).replaceWith(this.childNodes);
}
}).end();
}
});
jQuery.expr.filters.hidden=function(elem){
return elem.offsetWidth<=0&&elem.offsetHeight<=0||
(!support.reliableHiddenOffsets()&&
((elem.style&&elem.style.display)||jQuery.css(elem,"display"))==="none");
};
jQuery.expr.filters.visible=function(elem){
return!jQuery.expr.filters.hidden(elem);
};
var r20=/%20/g,
rbracket=/\[\]$/,
rCRLF=/\r?\n/g,
rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,
rsubmittable=/^(?:input|select|textarea|keygen)/i;
function buildParams(prefix,obj,traditional,add){
var name;
if(jQuery.isArray(obj)){
jQuery.each(obj,function(i,v){
if(traditional||rbracket.test(prefix)){
add(prefix,v);
}else{
buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add);
}
});
}else if(!traditional&&jQuery.type(obj)==="object"){
for(name in obj){
buildParams(prefix+"["+name+"]",obj[name],traditional,add);
}
}else{
add(prefix,obj);
}
}
jQuery.param=function(a,traditional){
var prefix,
s=[],
add=function(key,value){
value=jQuery.isFunction(value)?value():(value==null?"":value);
s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value);
};
if(traditional===undefined){
traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional;
}
if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){
jQuery.each(a,function(){
add(this.name,this.value);
});
}else{
for(prefix in a){
buildParams(prefix,a[prefix],traditional,add);
}
}
return s.join("&").replace(r20,"+");
};
jQuery.fn.extend({
serialize:function(){
return jQuery.param(this.serializeArray());
},
serializeArray:function(){
return this.map(function(){
var elements=jQuery.prop(this,"elements");
return elements?jQuery.makeArray(elements):this;
})
.filter(function(){
var type=this.type;
return this.name&&!jQuery(this).is(":disabled")&&
rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&
(this.checked||!rcheckableType.test(type));
})
.map(function(i,elem){
var val=jQuery(this).val();
return val==null?
null:
jQuery.isArray(val)?
jQuery.map(val,function(val){
return{name:elem.name,value:val.replace(rCRLF,"\r\n")};
}):
{name:elem.name,value:val.replace(rCRLF,"\r\n")};
}).get();
}
});
jQuery.ajaxSettings.xhr=window.ActiveXObject!==undefined?
function(){
return!this.isLocal&&
/^(get|post|head|put|delete|options)$/i.test(this.type)&&
createStandardXHR()||createActiveXHR();
}:
createStandardXHR;
var xhrId=0,
xhrCallbacks={},
xhrSupported=jQuery.ajaxSettings.xhr();
if(window.ActiveXObject){
jQuery(window).on("unload",function(){
for(var key in xhrCallbacks){
xhrCallbacks[key](undefined,true);
}
});
}
support.cors=!!xhrSupported&&("withCredentials"in xhrSupported);
xhrSupported=support.ajax=!!xhrSupported;
if(xhrSupported){
jQuery.ajaxTransport(function(options){
if(!options.crossDomain||support.cors){
var callback;
return{
send:function(headers,complete){
var i,
xhr=options.xhr(),
id=++xhrId;
xhr.open(options.type,options.url,options.async,options.username,options.password);
if(options.xhrFields){
for(i in options.xhrFields){
xhr[i]=options.xhrFields[i];
}
}
if(options.mimeType&&xhr.overrideMimeType){
xhr.overrideMimeType(options.mimeType);
}
if(!options.crossDomain&&!headers["X-Requested-With"]){
headers["X-Requested-With"]="XMLHttpRequest";
}
for(i in headers){
if(headers[i]!==undefined){
xhr.setRequestHeader(i,headers[i]+"");
}
}
xhr.send((options.hasContent&&options.data)||null);
callback=function(_,isAbort){
var status,statusText,responses;
if(callback&&(isAbort||xhr.readyState===4)){
delete xhrCallbacks[id];
callback=undefined;
xhr.onreadystatechange=jQuery.noop;
if(isAbort){
if(xhr.readyState!==4){
xhr.abort();
}
}else{
responses={};
status=xhr.status;
if(typeof xhr.responseText==="string"){
responses.text=xhr.responseText;
}
try{
statusText=xhr.statusText;
}catch(e){
statusText="";
}
if(!status&&options.isLocal&&!options.crossDomain){
status=responses.text?200:404;
}else if(status===1223){
status=204;
}
}
}
if(responses){
complete(status,statusText,responses,xhr.getAllResponseHeaders());
}
};
if(!options.async){
callback();
}else if(xhr.readyState===4){
setTimeout(callback);
}else{
xhr.onreadystatechange=xhrCallbacks[id]=callback;
}
},
abort:function(){
if(callback){
callback(undefined,true);
}
}
};
}
});
}
function createStandardXHR(){
try{
return new window.XMLHttpRequest();
}catch(e){}
}
function createActiveXHR(){
try{
return new window.ActiveXObject("Microsoft.XMLHTTP");
}catch(e){}
}
jQuery.ajaxSetup({
accepts:{
script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
},
contents:{
script:/(?:java|ecma)script/
},
converters:{
"text script":function(text){
jQuery.globalEval(text);
return text;
}
}
});
jQuery.ajaxPrefilter("script",function(s){
if(s.cache===undefined){
s.cache=false;
}
if(s.crossDomain){
s.type="GET";
s.global=false;
}
});
jQuery.ajaxTransport("script",function(s){
if(s.crossDomain){
var script,
head=document.head||jQuery("head")[0]||document.documentElement;
return{
send:function(_,callback){
script=document.createElement("script");
script.async=true;
if(s.scriptCharset){
script.charset=s.scriptCharset;
}
script.src=s.url;
script.onload=script.onreadystatechange=function(_,isAbort){
if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){
script.onload=script.onreadystatechange=null;
if(script.parentNode){
script.parentNode.removeChild(script);
}
script=null;
if(!isAbort){
callback(200,"success");
}
}
};
head.insertBefore(script,head.firstChild);
},
abort:function(){
if(script){
script.onload(undefined,true);
}
}
};
}
});
var oldCallbacks=[],
rjsonp=/(=)\?(?=&|$)|\?\?/;
jQuery.ajaxSetup({
jsonp:"callback",
jsonpCallback:function(){
var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(nonce++));
this[callback]=true;
return callback;
}
});
jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){
var callbackName,overwritten,responseContainer,
jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?
"url":
typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data"
);
if(jsonProp||s.dataTypes[0]==="jsonp"){
callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?
s.jsonpCallback():
s.jsonpCallback;
if(jsonProp){
s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName);
}else if(s.jsonp!==false){
s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName;
}
s.converters["script json"]=function(){
if(!responseContainer){
jQuery.error(callbackName+" was not called");
}
return responseContainer[0];
};
s.dataTypes[0]="json";
overwritten=window[callbackName];
window[callbackName]=function(){
responseContainer=arguments;
};
jqXHR.always(function(){
window[callbackName]=overwritten;
if(s[callbackName]){
s.jsonpCallback=originalSettings.jsonpCallback;
oldCallbacks.push(callbackName);
}
if(responseContainer&&jQuery.isFunction(overwritten)){
overwritten(responseContainer[0]);
}
responseContainer=overwritten=undefined;
});
return"script";
}
});
jQuery.parseHTML=function(data,context,keepScripts){
if(!data||typeof data!=="string"){
return null;
}
if(typeof context==="boolean"){
keepScripts=context;
context=false;
}
context=context||document;
var parsed=rsingleTag.exec(data),
scripts=!keepScripts&&[];
if(parsed){
return[context.createElement(parsed[1])];
}
parsed=jQuery.buildFragment([data],context,scripts);
if(scripts&&scripts.length){
jQuery(scripts).remove();
}
return jQuery.merge([],parsed.childNodes);
};
var _load=jQuery.fn.load;

jQuery.fn.load=function(url,params,callback){
if(typeof url!=="string"&&_load){
return _load.apply(this,arguments);
}
var selector,response,type,
self=this,
off=url.indexOf(" ");
if(off>=0){
selector=url.slice(off,url.length);
url=url.slice(0,off);
}
if(jQuery.isFunction(params)){
callback=params;
params=undefined;
}else if(params&&typeof params==="object"){
type="POST";
}
if(self.length>0){
jQuery.ajax({
url:url,
type:type,
dataType:"html",
data:params
}).done(function(responseText){
response=arguments;
self.html(selector?
jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):
responseText);
}).complete(callback&&function(jqXHR,status){
self.each(callback,response||[jqXHR.responseText,status,jqXHR]);
});
}
return this;
};
jQuery.expr.filters.animated=function(elem){
return jQuery.grep(jQuery.timers,function(fn){
return elem===fn.elem;
}).length;
};
var docElem=window.document.documentElement;

function getWindow(elem){
return jQuery.isWindow(elem)?
elem:
elem.nodeType===9?
elem.defaultView||elem.parentWindow:
false;
}
jQuery.offset={
setOffset:function(elem,options,i){
var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,
position=jQuery.css(elem,"position"),
curElem=jQuery(elem),
props={};
if(position==="static"){
elem.style.position="relative";
}
curOffset=curElem.offset();
curCSSTop=jQuery.css(elem,"top");
curCSSLeft=jQuery.css(elem,"left");
calculatePosition=(position==="absolute"||position==="fixed")&&
jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1;
if(calculatePosition){
curPosition=curElem.position();
curTop=curPosition.top;
curLeft=curPosition.left;
}else{
curTop=parseFloat(curCSSTop)||0;
curLeft=parseFloat(curCSSLeft)||0;
}
if(jQuery.isFunction(options)){
options=options.call(elem,i,curOffset);
}
if(options.top!=null){
props.top=(options.top-curOffset.top)+curTop;
}
if(options.left!=null){
props.left=(options.left-curOffset.left)+curLeft;
}
if("using"in options){
options.using.call(elem,props);
}else{
curElem.css(props);
}
}
};
jQuery.fn.extend({
offset:function(options){
if(arguments.length){
return options===undefined?
this:
this.each(function(i){
jQuery.offset.setOffset(this,options,i);
});
}
var docElem,win,
box={top:0,left:0},
elem=this[0],
doc=elem&&elem.ownerDocument;
if(!doc){
return;
}
docElem=doc.documentElement;
if(!jQuery.contains(docElem,elem)){
return box;
}
if(typeof elem.getBoundingClientRect!==strundefined){
box=elem.getBoundingClientRect();
}
win=getWindow(doc);
return{
top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),
left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)
};
},
position:function(){
if(!this[0]){
return;
}
var offsetParent,offset,
parentOffset={top:0,left:0},
elem=this[0];
if(jQuery.css(elem,"position")==="fixed"){
offset=elem.getBoundingClientRect();
}else{
offsetParent=this.offsetParent();
offset=this.offset();
if(!jQuery.nodeName(offsetParent[0],"html")){
parentOffset=offsetParent.offset();
}
parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);
parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true);
}
return{
top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),
left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)
};
},
offsetParent:function(){
return this.map(function(){
var offsetParent=this.offsetParent||docElem;
while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){
offsetParent=offsetParent.offsetParent;
}
return offsetParent||docElem;
});
}
});
jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){
var top=/Y/.test(prop);
jQuery.fn[method]=function(val){
return access(this,function(elem,method,val){
var win=getWindow(elem);
if(val===undefined){
return win?(prop in win)?win[prop]:
win.document.documentElement[method]:
elem[method];
}
if(win){
win.scrollTo(
!top?val:jQuery(win).scrollLeft(),
top?val:jQuery(win).scrollTop()
);
}else{
elem[method]=val;
}
},method,val,arguments.length,null);
};
});
jQuery.each(["top","left"],function(i,prop){
jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,
function(elem,computed){
if(computed){
computed=curCSS(elem,prop);
return rnumnonpx.test(computed)?
jQuery(elem).position()[prop]+"px":
computed;
}
}
);
});
jQuery.each({Height:"height",Width:"width"},function(name,type){
jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){
jQuery.fn[funcName]=function(margin,value){
var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),
extra=defaultExtra||(margin===true||value===true?"margin":"border");
return access(this,function(elem,type,value){
var doc;
if(jQuery.isWindow(elem)){
return elem.document.documentElement["client"+name];
}
if(elem.nodeType===9){
doc=elem.documentElement;
return Math.max(
elem.body["scroll"+name],doc["scroll"+name],
elem.body["offset"+name],doc["offset"+name],
doc["client"+name]
);
}
return value===undefined?
jQuery.css(elem,type,extra):
jQuery.style(elem,type,value,extra);
},type,chainable?margin:undefined,chainable,null);
};
});
});
jQuery.fn.size=function(){
return this.length;
};
jQuery.fn.andSelf=jQuery.fn.addBack;
if(typeof define==="function"&&define.amd){
define("jquery",[],function(){
return jQuery;
});
}
var
_jQuery=window.jQuery,
_$=window.$;
jQuery.noConflict=function(deep){
if(window.$===jQuery){
window.$=_$;
}
if(deep&&window.jQuery===jQuery){
window.jQuery=_jQuery;
}
return jQuery;
};
if(typeof noGlobal===strundefined){
window.jQuery=window.$=jQuery;
}
return jQuery;
}));
;

;
(function($,undefined){
var uuid=0,
runiqueId=/^ui-id-\d+$/;
$.ui=$.ui||{};
$.extend($.ui,{
version:"1.10.4",
keyCode:{
BACKSPACE:8,
COMMA:188,
DELETE:46,
DOWN:40,
END:35,
ENTER:13,
ESCAPE:27,
HOME:36,
LEFT:37,
NUMPAD_ADD:107,
NUMPAD_DECIMAL:110,
NUMPAD_DIVIDE:111,
NUMPAD_ENTER:108,
NUMPAD_MULTIPLY:106,
NUMPAD_SUBTRACT:109,
PAGE_DOWN:34,
PAGE_UP:33,
PERIOD:190,
RIGHT:39,
SPACE:32,
TAB:9,
UP:38
}
});
$.fn.extend({
focus:(function(orig){
return function(delay,fn){
return typeof delay==="number"?
this.each(function(){
var elem=this;
setTimeout(function(){
$(elem).focus();
if(fn){
fn.call(elem);
}
},delay);
}):
orig.apply(this,arguments);
};
})($.fn.focus),
scrollParent:function(){
var scrollParent;
if(($.ui.ie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){
scrollParent=this.parents().filter(function(){
return(/(relative|absolute|fixed)/).test($.css(this,"position"))&&(/(auto|scroll)/).test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"));
}).eq(0);
}else{
scrollParent=this.parents().filter(function(){
return(/(auto|scroll)/).test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"));
}).eq(0);
}
return(/fixed/).test(this.css("position"))||!scrollParent.length?$(document):scrollParent;
},
zIndex:function(zIndex){
if(zIndex!==undefined){
return this.css("zIndex",zIndex);
}
if(this.length){
var elem=$(this[0]),position,value;
while(elem.length&&elem[0]!==document){
position=elem.css("position");
if(position==="absolute"||position==="relative"||position==="fixed"){
value=parseInt(elem.css("zIndex"),10);
if(!isNaN(value)&&value!==0){
return value;
}
}
elem=elem.parent();
}
}
return 0;
},
uniqueId:function(){
return this.each(function(){
if(!this.id){
this.id="ui-id-"+(++uuid);
}
});
},
removeUniqueId:function(){
return this.each(function(){
if(runiqueId.test(this.id)){
$(this).removeAttr("id");
}
});
}
});
function focusable(element,isTabIndexNotNaN){
var map,mapName,img,
nodeName=element.nodeName.toLowerCase();
if("area"===nodeName){
map=element.parentNode;
mapName=map.name;
if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){
return false;
}
img=$("img[usemap=#"+mapName+"]")[0];
return!!img&&visible(img);
}
return(/input|select|textarea|button|object/.test(nodeName)?
!element.disabled:
"a"===nodeName?
element.href||isTabIndexNotNaN:
isTabIndexNotNaN)&&
visible(element);
}
function visible(element){
return $.expr.filters.visible(element)&&
!$(element).parents().addBack().filter(function(){
return $.css(this,"visibility")==="hidden";
}).length;
}
$.extend($.expr[":"],{
data:$.expr.createPseudo?
$.expr.createPseudo(function(dataName){
return function(elem){
return!!$.data(elem,dataName);
};
}):
function(elem,i,match){
return!!$.data(elem,match[3]);
},
focusable:function(element){
return focusable(element,!isNaN($.attr(element,"tabindex")));
},
tabbable:function(element){
var tabIndex=$.attr(element,"tabindex"),
isTabIndexNaN=isNaN(tabIndex);
return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN);
}
});
if(!$("<a>").outerWidth(1).jquery){
$.each(["Width","Height"],function(i,name){
var side=name==="Width"?["Left","Right"]:["Top","Bottom"],
type=name.toLowerCase(),
orig={
innerWidth:$.fn.innerWidth,
innerHeight:$.fn.innerHeight,
outerWidth:$.fn.outerWidth,
outerHeight:$.fn.outerHeight
};
function reduce(elem,size,border,margin){
$.each(side,function(){
size-=parseFloat($.css(elem,"padding"+this))||0;
if(border){
size-=parseFloat($.css(elem,"border"+this+"Width"))||0;
}
if(margin){
size-=parseFloat($.css(elem,"margin"+this))||0;
}
});
return size;
}
$.fn["inner"+name]=function(size){
if(size===undefined){
return orig["inner"+name].call(this);
}
return this.each(function(){
$(this).css(type,reduce(this,size)+"px");
});
};
$.fn["outer"+name]=function(size,margin){
if(typeof size!=="number"){
return orig["outer"+name].call(this,size);
}
return this.each(function(){
$(this).css(type,reduce(this,size,true,margin)+"px");
});
};
});
}
if(!$.fn.addBack){
$.fn.addBack=function(selector){
return this.add(selector==null?
this.prevObject:this.prevObject.filter(selector)
);
};
}
if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){
$.fn.removeData=(function(removeData){
return function(key){
if(arguments.length){
return removeData.call(this,$.camelCase(key));
}else{
return removeData.call(this);
}
};
})($.fn.removeData);
}
$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());
$.support.selectstart="onselectstart"in document.createElement("div");
$.fn.extend({
disableSelection:function(){
return this.bind(($.support.selectstart?"selectstart":"mousedown")+
".ui-disableSelection",function(event){
event.preventDefault();
});
},
enableSelection:function(){
return this.unbind(".ui-disableSelection");
}
});
$.extend($.ui,{
plugin:{
add:function(module,option,set){
var i,
proto=$.ui[module].prototype;
for(i in set){
proto.plugins[i]=proto.plugins[i]||[];
proto.plugins[i].push([option,set[i]]);
}
},
call:function(instance,name,args){
var i,
set=instance.plugins[name];
if(!set||!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11){
return;
}
for(i=0;i<set.length;i++){
if(instance.options[set[i][0]]){
set[i][1].apply(instance.element,args);
}
}
}
},
hasScroll:function(el,a){
if($(el).css("overflow")==="hidden"){
return false;
}
var scroll=(a&&a==="left")?"scrollLeft":"scrollTop",
has=false;
if(el[scroll]>0){
return true;
}
el[scroll]=1;
has=(el[scroll]>0);
el[scroll]=0;
return has;
}
});
})(jQuery);
(function($,undefined){
var uuid=0,
slice=Array.prototype.slice,
_cleanData=$.cleanData;
$.cleanData=function(elems){
for(var i=0,elem;(elem=elems[i])!=null;i++){
try{
$(elem).triggerHandler("remove");
}catch(e){}
}
_cleanData(elems);
};
$.widget=function(name,base,prototype){
var fullName,existingConstructor,constructor,basePrototype,
proxiedPrototype={},
namespace=name.split(".")[0];
name=name.split(".")[1];
fullName=namespace+"-"+name;
if(!prototype){
prototype=base;
base=$.Widget;
}
$.expr[":"][fullName.toLowerCase()]=function(elem){
return!!$.data(elem,fullName);
};
$[namespace]=$[namespace]||{};
existingConstructor=$[namespace][name];
constructor=$[namespace][name]=function(options,element){
if(!this._createWidget){
return new constructor(options,element);
}
if(arguments.length){
this._createWidget(options,element);
}
};
$.extend(constructor,existingConstructor,{
version:prototype.version,
_proto:$.extend({},prototype),
_childConstructors:[]
});
basePrototype=new base();
basePrototype.options=$.widget.extend({},basePrototype.options);
$.each(prototype,function(prop,value){
if(!$.isFunction(value)){
proxiedPrototype[prop]=value;
return;
}
proxiedPrototype[prop]=(function(){
var _super=function(){
return base.prototype[prop].apply(this,arguments);
},
_superApply=function(args){
return base.prototype[prop].apply(this,args);
};
return function(){
var __super=this._super,
__superApply=this._superApply,
returnValue;
this._super=_super;
this._superApply=_superApply;
returnValue=value.apply(this,arguments);
this._super=__super;
this._superApply=__superApply;
return returnValue;
};
})();
});
constructor.prototype=$.widget.extend(basePrototype,{
widgetEventPrefix:existingConstructor?(basePrototype.widgetEventPrefix||name):name
},proxiedPrototype,{
constructor:constructor,
namespace:namespace,
widgetName:name,
widgetFullName:fullName
});
if(existingConstructor){
$.each(existingConstructor._childConstructors,function(i,child){
var childPrototype=child.prototype;
$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);
});
delete existingConstructor._childConstructors;
}else{
base._childConstructors.push(constructor);
}
$.widget.bridge(name,constructor);
};
$.widget.extend=function(target){
var input=slice.call(arguments,1),
inputIndex=0,
inputLength=input.length,
key,
value;
for(;inputIndex<inputLength;inputIndex++){
for(key in input[inputIndex]){
value=input[inputIndex][key];
if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){
if($.isPlainObject(value)){
target[key]=$.isPlainObject(target[key])?
$.widget.extend({},target[key],value):
$.widget.extend({},value);
}else{
target[key]=value;
}
}
}
}
return target;
};
$.widget.bridge=function(name,object){
var fullName=object.prototype.widgetFullName||name;
$.fn[name]=function(options){
var isMethodCall=typeof options==="string",
args=slice.call(arguments,1),
returnValue=this;
options=!isMethodCall&&args.length?
$.widget.extend.apply(null,[options].concat(args)):
options;
if(isMethodCall){
this.each(function(){
var methodValue,
instance=$.data(this,fullName);
if(!instance){
return $.error("cannot call methods on "+name+" prior to initialization; "+
"attempted to call method '"+options+"'");
}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){
return $.error("no such method '"+options+"' for "+name+" widget instance");
}
methodValue=instance[options].apply(instance,args);
if(methodValue!==instance&&methodValue!==undefined){
returnValue=methodValue&&methodValue.jquery?
returnValue.pushStack(methodValue.get()):
methodValue;
return false;
}
});
}else{
this.each(function(){
var instance=$.data(this,fullName);
if(instance){
instance.option(options||{})._init();
}else{
$.data(this,fullName,new object(options,this));
}
});
}
return returnValue;
};
};
$.Widget=function(){};
$.Widget._childConstructors=[];
$.Widget.prototype={
widgetName:"widget",
widgetEventPrefix:"",
defaultElement:"<div>",
options:{
disabled:false,
create:null
},
_createWidget:function(options,element){
element=$(element||this.defaultElement||this)[0];
this.element=$(element);
this.uuid=uuid++;
this.eventNamespace="."+this.widgetName+this.uuid;
this.options=$.widget.extend({},
this.options,
this._getCreateOptions(),
options);
this.bindings=$();
this.hoverable=$();
this.focusable=$();
if(element!==this){
$.data(element,this.widgetFullName,this);
this._on(true,this.element,{
remove:function(event){
if(event.target===element){
this.destroy();
}
}
});
this.document=$(element.style?
element.ownerDocument:
element.document||element);
this.window=$(this.document[0].defaultView||this.document[0].parentWindow);
}
this._create();
this._trigger("create",null,this._getCreateEventData());
this._init();
},
_getCreateOptions:$.noop,
_getCreateEventData:$.noop,
_create:$.noop,
_init:$.noop,
destroy:function(){
this._destroy();
this.element
.unbind(this.eventNamespace)
.removeData(this.widgetName)
.removeData(this.widgetFullName)
.removeData($.camelCase(this.widgetFullName));
this.widget()
.unbind(this.eventNamespace)
.removeAttr("aria-disabled")
.removeClass(
this.widgetFullName+"-disabled "+
"ui-state-disabled");
this.bindings.unbind(this.eventNamespace);
this.hoverable.removeClass("ui-state-hover");
this.focusable.removeClass("ui-state-focus");
},
_destroy:$.noop,
widget:function(){
return this.element;
},
option:function(key,value){
var options=key,
parts,
curOption,
i;
if(arguments.length===0){
return $.widget.extend({},this.options);
}
if(typeof key==="string"){
options={};
parts=key.split(".");
key=parts.shift();
if(parts.length){
curOption=options[key]=$.widget.extend({},this.options[key]);
for(i=0;i<parts.length-1;i++){
curOption[parts[i]]=curOption[parts[i]]||{};
curOption=curOption[parts[i]];
}
key=parts.pop();
if(arguments.length===1){
return curOption[key]===undefined?null:curOption[key];
}
curOption[key]=value;
}else{
if(arguments.length===1){
return this.options[key]===undefined?null:this.options[key];
}
options[key]=value;
}
}
this._setOptions(options);
return this;
},
_setOptions:function(options){
var key;
for(key in options){
this._setOption(key,options[key]);
}
return this;
},
_setOption:function(key,value){
this.options[key]=value;
if(key==="disabled"){
this.widget()
.toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!value)
.attr("aria-disabled",value);
this.hoverable.removeClass("ui-state-hover");
this.focusable.removeClass("ui-state-focus");
}
return this;
},
enable:function(){
return this._setOption("disabled",false);
},
disable:function(){
return this._setOption("disabled",true);
},
_on:function(suppressDisabledCheck,element,handlers){
var delegateElement,
instance=this;
if(typeof suppressDisabledCheck!=="boolean"){
handlers=element;
element=suppressDisabledCheck;
suppressDisabledCheck=false;
}
if(!handlers){
handlers=element;
element=this.element;
delegateElement=this.widget();
}else{
element=delegateElement=$(element);
this.bindings=this.bindings.add(element);
}
$.each(handlers,function(event,handler){
function handlerProxy(){
if(!suppressDisabledCheck&&
(instance.options.disabled===true||
$(this).hasClass("ui-state-disabled"))){
return;
}
return(typeof handler==="string"?instance[handler]:handler)
.apply(instance,arguments);
}
if(typeof handler!=="string"){
handlerProxy.guid=handler.guid=
handler.guid||handlerProxy.guid||$.guid++;
}
var match=event.match(/^(\w+)\s*(.*)$/),
eventName=match[1]+instance.eventNamespace,
selector=match[2];
if(selector){
delegateElement.delegate(selector,eventName,handlerProxy);
}else{
element.bind(eventName,handlerProxy);
}
});
},
_off:function(element,eventName){
eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;
element.unbind(eventName).undelegate(eventName);
},
_delay:function(handler,delay){
function handlerProxy(){
return(typeof handler==="string"?instance[handler]:handler)
.apply(instance,arguments);
}
var instance=this;
return setTimeout(handlerProxy,delay||0);
},
_hoverable:function(element){
this.hoverable=this.hoverable.add(element);
this._on(element,{
mouseenter:function(event){
$(event.currentTarget).addClass("ui-state-hover");
},
mouseleave:function(event){
$(event.currentTarget).removeClass("ui-state-hover");
}
});
},
_focusable:function(element){
this.focusable=this.focusable.add(element);
this._on(element,{
focusin:function(event){
$(event.currentTarget).addClass("ui-state-focus");
},
focusout:function(event){
$(event.currentTarget).removeClass("ui-state-focus");
}
});
},
_trigger:function(type,event,data){
var prop,orig,
callback=this.options[type];
data=data||{};
event=$.Event(event);
event.type=(type===this.widgetEventPrefix?
type:
this.widgetEventPrefix+type).toLowerCase();
event.target=this.element[0];
orig=event.originalEvent;
if(orig){
for(prop in orig){
if(!(prop in event)){
event[prop]=orig[prop];
}
}
}
this.element.trigger(event,data);
return!($.isFunction(callback)&&
callback.apply(this.element[0],[event].concat(data))===false||
event.isDefaultPrevented());
}
};
$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){
$.Widget.prototype["_"+method]=function(element,options,callback){
if(typeof options==="string"){
options={effect:options};
}
var hasOptions,
effectName=!options?
method:
options===true||typeof options==="number"?
defaultEffect:
options.effect||defaultEffect;
options=options||{};
if(typeof options==="number"){
options={duration:options};
}
hasOptions=!$.isEmptyObject(options);
options.complete=callback;
if(options.delay){
element.delay(options.delay);
}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){
element[method](options);
}else if(effectName!==method&&element[effectName]){
element[effectName](options.duration,options.easing,callback);
}else{
element.queue(function(next){
$(this)[method]();
if(callback){
callback.call(element[0]);
}
next();
});
}
};
});
})(jQuery);
(function($,undefined){
var mouseHandled=false;
$(document).mouseup(function(){
mouseHandled=false;
});
$.widget("ui.mouse",{
version:"1.10.4",
options:{
cancel:"input,textarea,button,select,option",
distance:1,
delay:0
},
_mouseInit:function(){
var that=this;
this.element
.bind("mousedown."+this.widgetName,function(event){
return that._mouseDown(event);
})
.bind("click."+this.widgetName,function(event){
if(true===$.data(event.target,that.widgetName+".preventClickEvent")){
$.removeData(event.target,that.widgetName+".preventClickEvent");
event.stopImmediatePropagation();
return false;
}
});
this.started=false;
},
_mouseDestroy:function(){
this.element.unbind("."+this.widgetName);
if(this._mouseMoveDelegate){
$(document)
.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate)
.unbind("mouseup."+this.widgetName,this._mouseUpDelegate);
}
},
_mouseDown:function(event){
if(mouseHandled){return}
(this._mouseStarted&&this._mouseUp(event));
this._mouseDownEvent=event;
var that=this,
btnIsLeft=(event.which===1),
elIsCancel=(typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false);
if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){
return true;
}
this.mouseDelayMet=!this.options.delay;
if(!this.mouseDelayMet){
this._mouseDelayTimer=setTimeout(function(){
that.mouseDelayMet=true;
},this.options.delay);
}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){
this._mouseStarted=(this._mouseStart(event)!==false);
if(!this._mouseStarted){
event.preventDefault();
return true;
}
}
if(true===$.data(event.target,this.widgetName+".preventClickEvent")){
$.removeData(event.target,this.widgetName+".preventClickEvent");
}
this._mouseMoveDelegate=function(event){
return that._mouseMove(event);
};
this._mouseUpDelegate=function(event){
return that._mouseUp(event);
};
$(document)
.bind("mousemove."+this.widgetName,this._mouseMoveDelegate)
.bind("mouseup."+this.widgetName,this._mouseUpDelegate);
event.preventDefault();
mouseHandled=true;
return true;
},
_mouseMove:function(event){
if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){
return this._mouseUp(event);
}
if(this._mouseStarted){
this._mouseDrag(event);
return event.preventDefault();
}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){
this._mouseStarted=
(this._mouseStart(this._mouseDownEvent,event)!==false);
(this._mouseStarted?this._mouseDrag(event):this._mouseUp(event));
}
return!this._mouseStarted;
},
_mouseUp:function(event){
$(document)
.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate)
.unbind("mouseup."+this.widgetName,this._mouseUpDelegate);
if(this._mouseStarted){
this._mouseStarted=false;
if(event.target===this._mouseDownEvent.target){
$.data(event.target,this.widgetName+".preventClickEvent",true);
}
this._mouseStop(event);
}
return false;
},
_mouseDistanceMet:function(event){
return(Math.max(
Math.abs(this._mouseDownEvent.pageX-event.pageX),
Math.abs(this._mouseDownEvent.pageY-event.pageY)
)>=this.options.distance
);
},
_mouseDelayMet:function(){
return this.mouseDelayMet;
},
_mouseStart:function(){},
_mouseDrag:function(){},
_mouseStop:function(){},
_mouseCapture:function(){return true}
});
})(jQuery);
(function($,undefined){
$.ui=$.ui||{};
var cachedScrollbarWidth,
max=Math.max,
abs=Math.abs,
round=Math.round,
rhorizontal=/left|center|right/,
rvertical=/top|center|bottom/,
roffset=/[\+\-]\d+(\.[\d]+)?%?/,
rposition=/^\w+/,
rpercent=/%$/,
_position=$.fn.position;
function getOffsets(offsets,width,height){
return[
parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),
parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)
];
}
function parseCss(element,property){
return parseInt($.css(element,property),10)||0;
}
function getDimensions(elem){
var raw=elem[0];
if(raw.nodeType===9){
return{
width:elem.width(),
height:elem.height(),
offset:{top:0,left:0}
};
}
if($.isWindow(raw)){
return{
width:elem.width(),
height:elem.height(),
offset:{top:elem.scrollTop(),left:elem.scrollLeft()}
};
}
if(raw.preventDefault){
return{
width:0,
height:0,
offset:{top:raw.pageY,left:raw.pageX}
};
}
return{
width:elem.outerWidth(),
height:elem.outerHeight(),
offset:elem.offset()
};
}
$.position={
scrollbarWidth:function(){
if(cachedScrollbarWidth!==undefined){
return cachedScrollbarWidth;
}
var w1,w2,
div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),
innerDiv=div.children()[0];
$("body").append(div);
w1=innerDiv.offsetWidth;
div.css("overflow","scroll");
w2=innerDiv.offsetWidth;
if(w1===w2){
w2=div[0].clientWidth;
}
div.remove();
return(cachedScrollbarWidth=w1-w2);
},
getScrollInfo:function(within){
var overflowX=within.isWindow||within.isDocument?"":
within.element.css("overflow-x"),
overflowY=within.isWindow||within.isDocument?"":
within.element.css("overflow-y"),
hasOverflowX=overflowX==="scroll"||
(overflowX==="auto"&&within.width<within.element[0].scrollWidth),
hasOverflowY=overflowY==="scroll"||
(overflowY==="auto"&&within.height<within.element[0].scrollHeight);
return{
width:hasOverflowY?$.position.scrollbarWidth():0,
height:hasOverflowX?$.position.scrollbarWidth():0
};
},
getWithinInfo:function(element){
var withinElement=$(element||window),
isWindow=$.isWindow(withinElement[0]),
isDocument=!!withinElement[0]&&withinElement[0].nodeType===9;
return{
element:withinElement,
isWindow:isWindow,
isDocument:isDocument,
offset:withinElement.offset()||{left:0,top:0},
scrollLeft:withinElement.scrollLeft(),
scrollTop:withinElement.scrollTop(),
width:isWindow?withinElement.width():withinElement.outerWidth(),
height:isWindow?withinElement.height():withinElement.outerHeight()
};
}
};
$.fn.position=function(options){
if(!options||!options.of){
return _position.apply(this,arguments);
}
options=$.extend({},options);
var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,
target=$(options.of),
within=$.position.getWithinInfo(options.within),
scrollInfo=$.position.getScrollInfo(within),
collision=(options.collision||"flip").split(" "),
offsets={};
dimensions=getDimensions(target);
if(target[0].preventDefault){
options.at="left top";
}
targetWidth=dimensions.width;
targetHeight=dimensions.height;
targetOffset=dimensions.offset;
basePosition=$.extend({},targetOffset);
$.each(["my","at"],function(){
var pos=(options[this]||"").split(" "),
horizontalOffset,
verticalOffset;
if(pos.length===1){
pos=rhorizontal.test(pos[0])?
pos.concat(["center"]):
rvertical.test(pos[0])?
["center"].concat(pos):
["center","center"];
}
pos[0]=rhorizontal.test(pos[0])?pos[0]:"center";
pos[1]=rvertical.test(pos[1])?pos[1]:"center";
horizontalOffset=roffset.exec(pos[0]);
verticalOffset=roffset.exec(pos[1]);
offsets[this]=[
horizontalOffset?horizontalOffset[0]:0,
verticalOffset?verticalOffset[0]:0
];
options[this]=[
rposition.exec(pos[0])[0],
rposition.exec(pos[1])[0]
];
});
if(collision.length===1){
collision[1]=collision[0];
}
if(options.at[0]==="right"){
basePosition.left+=targetWidth;
}else if(options.at[0]==="center"){
basePosition.left+=targetWidth/2;
}
if(options.at[1]==="bottom"){
basePosition.top+=targetHeight;
}else if(options.at[1]==="center"){
basePosition.top+=targetHeight/2;
}
atOffset=getOffsets(offsets.at,targetWidth,targetHeight);
basePosition.left+=atOffset[0];
basePosition.top+=atOffset[1];
return this.each(function(){
var collisionPosition,using,
elem=$(this),
elemWidth=elem.outerWidth(),
elemHeight=elem.outerHeight(),
marginLeft=parseCss(this,"marginLeft"),
marginTop=parseCss(this,"marginTop"),
collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,
collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,
position=$.extend({},basePosition),
myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());
if(options.my[0]==="right"){
position.left-=elemWidth;
}else if(options.my[0]==="center"){
position.left-=elemWidth/2;
}
if(options.my[1]==="bottom"){
position.top-=elemHeight;
}else if(options.my[1]==="center"){
position.top-=elemHeight/2;
}
position.left+=myOffset[0];
position.top+=myOffset[1];
if(!$.support.offsetFractions){
position.left=round(position.left);
position.top=round(position.top);
}
collisionPosition={
marginLeft:marginLeft,
marginTop:marginTop
};
$.each(["left","top"],function(i,dir){
if($.ui.position[collision[i]]){
$.ui.position[collision[i]][dir](position,{
targetWidth:targetWidth,
targetHeight:targetHeight,
elemWidth:elemWidth,
elemHeight:elemHeight,
collisionPosition:collisionPosition,
collisionWidth:collisionWidth,
collisionHeight:collisionHeight,
offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],
my:options.my,
at:options.at,
within:within,
elem:elem
});
}
});
if(options.using){
using=function(props){
var left=targetOffset.left-position.left,
right=left+targetWidth-elemWidth,
top=targetOffset.top-position.top,
bottom=top+targetHeight-elemHeight,
feedback={
target:{
element:target,
left:targetOffset.left,
top:targetOffset.top,
width:targetWidth,
height:targetHeight
},
element:{
element:elem,
left:position.left,
top:position.top,
width:elemWidth,
height:elemHeight
},
horizontal:right<0?"left":left>0?"right":"center",
vertical:bottom<0?"top":top>0?"bottom":"middle"
};
if(targetWidth<elemWidth&&abs(left+right)<targetWidth){
feedback.horizontal="center";
}
if(targetHeight<elemHeight&&abs(top+bottom)<targetHeight){
feedback.vertical="middle";
}
if(max(abs(left),abs(right))>max(abs(top),abs(bottom))){
feedback.important="horizontal";
}else{
feedback.important="vertical";
}
options.using.call(this,props,feedback);
};
}
elem.offset($.extend(position,{using:using}));
});
};
$.ui.position={
fit:{
left:function(position,data){
var within=data.within,
withinOffset=within.isWindow?within.scrollLeft:within.offset.left,
outerWidth=within.width,
collisionPosLeft=position.left-data.collisionPosition.marginLeft,
overLeft=withinOffset-collisionPosLeft,
overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset,
newOverRight;
if(data.collisionWidth>outerWidth){
if(overLeft>0&&overRight<=0){
newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset;
position.left+=overLeft-newOverRight;
}else if(overRight>0&&overLeft<=0){
position.left=withinOffset;
}else{
if(overLeft>overRight){
position.left=withinOffset+outerWidth-data.collisionWidth;
}else{
position.left=withinOffset;
}
}
}else if(overLeft>0){
position.left+=overLeft;
}else if(overRight>0){
position.left-=overRight;
}else{
position.left=max(position.left-collisionPosLeft,position.left);
}
},
top:function(position,data){
var within=data.within,
withinOffset=within.isWindow?within.scrollTop:within.offset.top,
outerHeight=data.within.height,
collisionPosTop=position.top-data.collisionPosition.marginTop,
overTop=withinOffset-collisionPosTop,
overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset,
newOverBottom;
if(data.collisionHeight>outerHeight){
if(overTop>0&&overBottom<=0){
newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset;
position.top+=overTop-newOverBottom;
}else if(overBottom>0&&overTop<=0){
position.top=withinOffset;
}else{
if(overTop>overBottom){
position.top=withinOffset+outerHeight-data.collisionHeight;
}else{
position.top=withinOffset;
}
}
}else if(overTop>0){
position.top+=overTop;
}else if(overBottom>0){
position.top-=overBottom;
}else{
position.top=max(position.top-collisionPosTop,position.top);
}
}
},
flip:{
left:function(position,data){
var within=data.within,
withinOffset=within.offset.left+within.scrollLeft,
outerWidth=within.width,
offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,
collisionPosLeft=position.left-data.collisionPosition.marginLeft,
overLeft=collisionPosLeft-offsetLeft,
overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,
myOffset=data.my[0]==="left"?
-data.elemWidth:
data.my[0]==="right"?
data.elemWidth:
0,
atOffset=data.at[0]==="left"?
data.targetWidth:
data.at[0]==="right"?
-data.targetWidth:
0,
offset=-2*data.offset[0],
newOverRight,
newOverLeft;
if(overLeft<0){
newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset;
if(newOverRight<0||newOverRight<abs(overLeft)){
position.left+=myOffset+atOffset+offset;
}
}
else if(overRight>0){
newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft;
if(newOverLeft>0||abs(newOverLeft)<overRight){
position.left+=myOffset+atOffset+offset;
}
}
},
top:function(position,data){
var within=data.within,
withinOffset=within.offset.top+within.scrollTop,
outerHeight=within.height,
offsetTop=within.isWindow?within.scrollTop:within.offset.top,
collisionPosTop=position.top-data.collisionPosition.marginTop,
overTop=collisionPosTop-offsetTop,
overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,
top=data.my[1]==="top",
myOffset=top?
-data.elemHeight:
data.my[1]==="bottom"?
data.elemHeight:
0,
atOffset=data.at[1]==="top"?
data.targetHeight:
data.at[1]==="bottom"?
-data.targetHeight:
0,
offset=-2*data.offset[1],
newOverTop,
newOverBottom;
if(overTop<0){
newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset;
if((position.top+myOffset+atOffset+offset)>overTop&&(newOverBottom<0||newOverBottom<abs(overTop))){
position.top+=myOffset+atOffset+offset;
}
}
else if(overBottom>0){
newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop;
if((position.top+myOffset+atOffset+offset)>overBottom&&(newOverTop>0||abs(newOverTop)<overBottom)){
position.top+=myOffset+atOffset+offset;
}
}
}
},
flipfit:{
left:function(){
$.ui.position.flip.left.apply(this,arguments);
$.ui.position.fit.left.apply(this,arguments);
},
top:function(){
$.ui.position.flip.top.apply(this,arguments);
$.ui.position.fit.top.apply(this,arguments);
}
}
};
(function(){
var testElement,testElementParent,testElementStyle,offsetLeft,i,
body=document.getElementsByTagName("body")[0],
div=document.createElement("div");
testElement=document.createElement(body?"div":"body");
testElementStyle={
visibility:"hidden",
width:0,
height:0,
border:0,
margin:0,
background:"none"
};
if(body){
$.extend(testElementStyle,{
position:"absolute",
left:"-1000px",
top:"-1000px"
});
}
for(i in testElementStyle){
testElement.style[i]=testElementStyle[i];
}
testElement.appendChild(div);
testElementParent=body||document.documentElement;
testElementParent.insertBefore(testElement,testElementParent.firstChild);
div.style.cssText="position: absolute; left: 10.7432222px;";
offsetLeft=$(div).offset().left;
$.support.offsetFractions=offsetLeft>10&&offsetLeft<11;
testElement.innerHTML="";
testElementParent.removeChild(testElement);
})();
}(jQuery));
(function($,undefined){
var uid=0,
hideProps={},
showProps={};
hideProps.height=hideProps.paddingTop=hideProps.paddingBottom=
hideProps.borderTopWidth=hideProps.borderBottomWidth="hide";
showProps.height=showProps.paddingTop=showProps.paddingBottom=
showProps.borderTopWidth=showProps.borderBottomWidth="show";
$.widget("ui.accordion",{
version:"1.10.4",
options:{
active:0,
animate:{},
collapsible:false,
event:"click",
header:"> li > :first-child,> :not(li):even",
heightStyle:"auto",
icons:{
activeHeader:"ui-icon-triangle-1-s",
header:"ui-icon-triangle-1-e"
},
activate:null,
beforeActivate:null
},
_create:function(){
var options=this.options;
this.prevShow=this.prevHide=$();
this.element.addClass("ui-accordion ui-widget ui-helper-reset")
.attr("role","tablist");
if(!options.collapsible&&(options.active===false||options.active==null)){
options.active=0;
}
this._processPanels();
if(options.active<0){
options.active+=this.headers.length;
}
this._refresh();
},
_getCreateEventData:function(){
return{
header:this.active,
panel:!this.active.length?$():this.active.next(),
content:!this.active.length?$():this.active.next()
};
},
_createIcons:function(){
var icons=this.options.icons;
if(icons){
$("<span>")
.addClass("ui-accordion-header-icon ui-icon "+icons.header)
.prependTo(this.headers);
this.active.children(".ui-accordion-header-icon")
.removeClass(icons.header)
.addClass(icons.activeHeader);
this.headers.addClass("ui-accordion-icons");
}
},
_destroyIcons:function(){
this.headers
.removeClass("ui-accordion-icons")
.children(".ui-accordion-header-icon")
.remove();
},
_destroy:function(){
var contents;
this.element
.removeClass("ui-accordion ui-widget ui-helper-reset")
.removeAttr("role");
this.headers
.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top")
.removeAttr("role")
.removeAttr("aria-expanded")
.removeAttr("aria-selected")
.removeAttr("aria-controls")
.removeAttr("tabIndex")
.each(function(){
if(/^ui-accordion/.test(this.id)){
this.removeAttribute("id");
}
});
this._destroyIcons();
contents=this.headers.next()
.css("display","")
.removeAttr("role")
.removeAttr("aria-hidden")
.removeAttr("aria-labelledby")
.removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled")
.each(function(){
if(/^ui-accordion/.test(this.id)){
this.removeAttribute("id");
}
});
if(this.options.heightStyle!=="content"){
contents.css("height","");
}
},
_setOption:function(key,value){
if(key==="active"){
this._activate(value);
return;
}
if(key==="event"){
if(this.options.event){
this._off(this.headers,this.options.event);
}
this._setupEvents(value);
}
this._super(key,value);
if(key==="collapsible"&&!value&&this.options.active===false){
this._activate(0);
}
if(key==="icons"){
this._destroyIcons();
if(value){
this._createIcons();
}
}
if(key==="disabled"){
this.headers.add(this.headers.next())
.toggleClass("ui-state-disabled",!!value);
}
},
_keydown:function(event){
if(event.altKey||event.ctrlKey){
return;
}
var keyCode=$.ui.keyCode,
length=this.headers.length,
currentIndex=this.headers.index(event.target),
toFocus=false;
switch(event.keyCode){
case keyCode.RIGHT:
case keyCode.DOWN:
toFocus=this.headers[(currentIndex+1)%length];
break;
case keyCode.LEFT:
case keyCode.UP:
toFocus=this.headers[(currentIndex-1+length)%length];
break;
case keyCode.SPACE:
case keyCode.ENTER:
this._eventHandler(event);
break;
case keyCode.HOME:
toFocus=this.headers[0];
break;
case keyCode.END:
toFocus=this.headers[length-1];
break;
}
if(toFocus){
$(event.target).attr("tabIndex",-1);
$(toFocus).attr("tabIndex",0);
toFocus.focus();
event.preventDefault();
}
},
_panelKeyDown:function(event){
if(event.keyCode===$.ui.keyCode.UP&&event.ctrlKey){
$(event.currentTarget).prev().focus();
}
},
refresh:function(){
var options=this.options;
this._processPanels();
if((options.active===false&&options.collapsible===true)||!this.headers.length){
options.active=false;
this.active=$();
}else if(options.active===false){
this._activate(0);
}else if(this.active.length&&!$.contains(this.element[0],this.active[0])){
if(this.headers.length===this.headers.find(".ui-state-disabled").length){
options.active=false;
this.active=$();
}else{
this._activate(Math.max(0,options.active-1));
}
}else{
options.active=this.headers.index(this.active);
}
this._destroyIcons();
this._refresh();
},
_processPanels:function(){
this.headers=this.element.find(this.options.header)
.addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");
this.headers.next()
.addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom")
.filter(":not(.ui-accordion-content-active)")
.hide();
},
_refresh:function(){
var maxHeight,
options=this.options,
heightStyle=options.heightStyle,
parent=this.element.parent(),
accordionId=this.accordionId="ui-accordion-"+
(this.element.attr("id")||++uid);
this.active=this._findActive(options.active)
.addClass("ui-accordion-header-active ui-state-active ui-corner-top")
.removeClass("ui-corner-all");
this.active.next()
.addClass("ui-accordion-content-active")
.show();
this.headers
.attr("role","tab")
.each(function(i){
var header=$(this),
headerId=header.attr("id"),
panel=header.next(),
panelId=panel.attr("id");
if(!headerId){
headerId=accordionId+"-header-"+i;
header.attr("id",headerId);
}
if(!panelId){
panelId=accordionId+"-panel-"+i;
panel.attr("id",panelId);
}
header.attr("aria-controls",panelId);
panel.attr("aria-labelledby",headerId);
})
.next()
.attr("role","tabpanel");
this.headers
.not(this.active)
.attr({
"aria-selected":"false",
"aria-expanded":"false",
tabIndex:-1
})
.next()
.attr({
"aria-hidden":"true"
})
.hide();
if(!this.active.length){
this.headers.eq(0).attr("tabIndex",0);
}else{
this.active.attr({
"aria-selected":"true",
"aria-expanded":"true",
tabIndex:0
})
.next()
.attr({
"aria-hidden":"false"
});
}
this._createIcons();
this._setupEvents(options.event);
if(heightStyle==="fill"){
maxHeight=parent.height();
this.element.siblings(":visible").each(function(){
var elem=$(this),
position=elem.css("position");
if(position==="absolute"||position==="fixed"){
return;
}
maxHeight-=elem.outerHeight(true);
});
this.headers.each(function(){
maxHeight-=$(this).outerHeight(true);
});
this.headers.next()
.each(function(){
$(this).height(Math.max(0,maxHeight-
$(this).innerHeight()+$(this).height()));
})
.css("overflow","auto");
}else if(heightStyle==="auto"){
maxHeight=0;
this.headers.next()
.each(function(){
maxHeight=Math.max(maxHeight,$(this).css("height","").height());
})
.height(maxHeight);
}
},
_activate:function(index){
var active=this._findActive(index)[0];
if(active===this.active[0]){
return;
}
active=active||this.active[0];
this._eventHandler({
target:active,
currentTarget:active,
preventDefault:$.noop
});
},
_findActive:function(selector){
return typeof selector==="number"?this.headers.eq(selector):$();
},
_setupEvents:function(event){
var events={
keydown:"_keydown"
};
if(event){
$.each(event.split(" "),function(index,eventName){
events[eventName]="_eventHandler";
});
}
this._off(this.headers.add(this.headers.next()));
this._on(this.headers,events);
this._on(this.headers.next(),{keydown:"_panelKeyDown"});
this._hoverable(this.headers);
this._focusable(this.headers);
},
_eventHandler:function(event){
var options=this.options,
active=this.active,
clicked=$(event.currentTarget),
clickedIsActive=clicked[0]===active[0],
collapsing=clickedIsActive&&options.collapsible,
toShow=collapsing?$():clicked.next(),
toHide=active.next(),
eventData={
oldHeader:active,
oldPanel:toHide,
newHeader:collapsing?$():clicked,
newPanel:toShow
};
event.preventDefault();
if(
(clickedIsActive&&!options.collapsible)||
(this._trigger("beforeActivate",event,eventData)===false)){
return;
}
options.active=collapsing?false:this.headers.index(clicked);
this.active=clickedIsActive?$():clicked;
this._toggle(eventData);
active.removeClass("ui-accordion-header-active ui-state-active");
if(options.icons){
active.children(".ui-accordion-header-icon")
.removeClass(options.icons.activeHeader)
.addClass(options.icons.header);
}
if(!clickedIsActive){
clicked
.removeClass("ui-corner-all")
.addClass("ui-accordion-header-active ui-state-active ui-corner-top");
if(options.icons){
clicked.children(".ui-accordion-header-icon")
.removeClass(options.icons.header)
.addClass(options.icons.activeHeader);
}
clicked
.next()
.addClass("ui-accordion-content-active");
}
},
_toggle:function(data){
var toShow=data.newPanel,
toHide=this.prevShow.length?this.prevShow:data.oldPanel;
this.prevShow.add(this.prevHide).stop(true,true);
this.prevShow=toShow;
this.prevHide=toHide;
if(this.options.animate){
this._animate(toShow,toHide,data);
}else{
toHide.hide();
toShow.show();
this._toggleComplete(data);
}
toHide.attr({
"aria-hidden":"true"
});
toHide.prev().attr("aria-selected","false");
if(toShow.length&&toHide.length){
toHide.prev().attr({
"tabIndex":-1,
"aria-expanded":"false"
});
}else if(toShow.length){
this.headers.filter(function(){
return $(this).attr("tabIndex")===0;
})
.attr("tabIndex",-1);
}
toShow
.attr("aria-hidden","false")
.prev()
.attr({
"aria-selected":"true",
tabIndex:0,
"aria-expanded":"true"
});
},
_animate:function(toShow,toHide,data){
var total,easing,duration,
that=this,
adjust=0,
down=toShow.length&&
(!toHide.length||(toShow.index()<toHide.index())),
animate=this.options.animate||{},
options=down&&animate.down||animate,
complete=function(){
that._toggleComplete(data);
};
if(typeof options==="number"){
duration=options;
}
if(typeof options==="string"){
easing=options;
}
easing=easing||options.easing||animate.easing;
duration=duration||options.duration||animate.duration;
if(!toHide.length){
return toShow.animate(showProps,duration,easing,complete);
}
if(!toShow.length){
return toHide.animate(hideProps,duration,easing,complete);
}
total=toShow.show().outerHeight();
toHide.animate(hideProps,{
duration:duration,
easing:easing,
step:function(now,fx){
fx.now=Math.round(now);
}
});
toShow
.hide()
.animate(showProps,{
duration:duration,
easing:easing,
complete:complete,
step:function(now,fx){
fx.now=Math.round(now);
if(fx.prop!=="height"){
adjust+=fx.now;
}else if(that.options.heightStyle!=="content"){
fx.now=Math.round(total-toHide.outerHeight()-adjust);
adjust=0;
}
}
});
},
_toggleComplete:function(data){
var toHide=data.oldPanel;
toHide
.removeClass("ui-accordion-content-active")
.prev()
.removeClass("ui-corner-top")
.addClass("ui-corner-all");
if(toHide.length){
toHide.parent()[0].className=toHide.parent()[0].className;
}
this._trigger("activate",null,data);
}
});
})(jQuery);
(function($,undefined){
$.widget("ui.autocomplete",{
version:"1.10.4",
defaultElement:"<input>",
options:{
appendTo:null,
autoFocus:false,
delay:300,
minLength:1,
position:{
my:"left top",
at:"left bottom",
collision:"none"
},
source:null,
change:null,
close:null,
focus:null,
open:null,
response:null,
search:null,
select:null
},
requestIndex:0,
pending:0,
_create:function(){
var suppressKeyPress,suppressKeyPressRepeat,suppressInput,
nodeName=this.element[0].nodeName.toLowerCase(),
isTextarea=nodeName==="textarea",
isInput=nodeName==="input";
this.isMultiLine=
isTextarea?true:
isInput?false:
this.element.prop("isContentEditable");
this.valueMethod=this.element[isTextarea||isInput?"val":"text"];
this.isNewMenu=true;
this.element
.addClass("ui-autocomplete-input")
.attr("autocomplete","off");
this._on(this.element,{
keydown:function(event){
if(this.element.prop("readOnly")){
suppressKeyPress=true;
suppressInput=true;
suppressKeyPressRepeat=true;
return;
}
suppressKeyPress=false;
suppressInput=false;
suppressKeyPressRepeat=false;
var keyCode=$.ui.keyCode;
switch(event.keyCode){
case keyCode.PAGE_UP:
suppressKeyPress=true;
this._move("previousPage",event);
break;
case keyCode.PAGE_DOWN:
suppressKeyPress=true;
this._move("nextPage",event);
break;
case keyCode.UP:
suppressKeyPress=true;
this._keyEvent("previous",event);
break;
case keyCode.DOWN:
suppressKeyPress=true;
this._keyEvent("next",event);
break;
case keyCode.ENTER:
case keyCode.NUMPAD_ENTER:
if(this.menu.active){
suppressKeyPress=true;
event.preventDefault();
this.menu.select(event);
}
break;
case keyCode.TAB:
if(this.menu.active){
this.menu.select(event);
}
break;
case keyCode.ESCAPE:
if(this.menu.element.is(":visible")){
this._value(this.term);
this.close(event);
event.preventDefault();
}
break;
default:
suppressKeyPressRepeat=true;
this._searchTimeout(event);
break;
}
},
keypress:function(event){
if(suppressKeyPress){
suppressKeyPress=false;
if(!this.isMultiLine||this.menu.element.is(":visible")){
event.preventDefault();
}
return;
}
if(suppressKeyPressRepeat){
return;
}
var keyCode=$.ui.keyCode;
switch(event.keyCode){
case keyCode.PAGE_UP:
this._move("previousPage",event);
break;
case keyCode.PAGE_DOWN:
this._move("nextPage",event);
break;
case keyCode.UP:
this._keyEvent("previous",event);
break;
case keyCode.DOWN:
this._keyEvent("next",event);
break;
}
},
input:function(event){
if(suppressInput){
suppressInput=false;
event.preventDefault();
return;
}
this._searchTimeout(event);
},
focus:function(){
this.selectedItem=null;
this.previous=this._value();
},
blur:function(event){
if(this.cancelBlur){
delete this.cancelBlur;
return;
}
clearTimeout(this.searching);
this.close(event);
this._change(event);
}
});
this._initSource();
this.menu=$("<ul>")
.addClass("ui-autocomplete ui-front")
.appendTo(this._appendTo())
.menu({
role:null
})
.hide()
.data("ui-menu");
this._on(this.menu.element,{
mousedown:function(event){
event.preventDefault();
this.cancelBlur=true;
this._delay(function(){
delete this.cancelBlur;
});
var menuElement=this.menu.element[0];
if(!$(event.target).closest(".ui-menu-item").length){
this._delay(function(){
var that=this;
this.document.one("mousedown",function(event){
if(event.target!==that.element[0]&&
event.target!==menuElement&&
!$.contains(menuElement,event.target)){
that.close();
}
});
});
}
},
menufocus:function(event,ui){
if(this.isNewMenu){
this.isNewMenu=false;
if(event.originalEvent&&/^mouse/.test(event.originalEvent.type)){
this.menu.blur();
this.document.one("mousemove",function(){
$(event.target).trigger(event.originalEvent);
});
return;
}
}
var item=ui.item.data("ui-autocomplete-item");
if(false!==this._trigger("focus",event,{item:item})){
if(event.originalEvent&&/^key/.test(event.originalEvent.type)){
this._value(item.value);
}
}else{
this.liveRegion.text(item.value);
}
},
menuselect:function(event,ui){
var item=ui.item.data("ui-autocomplete-item"),
previous=this.previous;
if(this.element[0]!==this.document[0].activeElement){
this.element.focus();
this.previous=previous;
this._delay(function(){
this.previous=previous;
this.selectedItem=item;
});
}
if(false!==this._trigger("select",event,{item:item})){
this._value(item.value);
}
this.term=this._value();
this.close(event);
this.selectedItem=item;
}
});
this.liveRegion=$("<span>",{
role:"status",
"aria-live":"polite"
})
.addClass("ui-helper-hidden-accessible")
.insertBefore(this.element);
this._on(this.window,{
beforeunload:function(){
this.element.removeAttr("autocomplete");
}
});
},
_destroy:function(){
clearTimeout(this.searching);
this.element
.removeClass("ui-autocomplete-input")
.removeAttr("autocomplete");
this.menu.element.remove();
this.liveRegion.remove();
},
_setOption:function(key,value){
this._super(key,value);
if(key==="source"){
this._initSource();
}
if(key==="appendTo"){
this.menu.element.appendTo(this._appendTo());
}
if(key==="disabled"&&value&&this.xhr){
this.xhr.abort();
}
},
_appendTo:function(){
var element=this.options.appendTo;
if(element){
element=element.jquery||element.nodeType?
$(element):
this.document.find(element).eq(0);
}
if(!element){
element=this.element.closest(".ui-front");
}
if(!element.length){
element=this.document[0].body;
}
return element;
},
_initSource:function(){
var array,url,
that=this;
if($.isArray(this.options.source)){
array=this.options.source;
this.source=function(request,response){
response($.ui.autocomplete.filter(array,request.term));
};
}else if(typeof this.options.source==="string"){
url=this.options.source;
this.source=function(request,response){
if(that.xhr){
that.xhr.abort();
}
that.xhr=$.ajax({
url:url,
data:request,
dataType:"json",
success:function(data){
response(data);
},
error:function(){
response([]);
}
});
};
}else{
this.source=this.options.source;
}
},
_searchTimeout:function(event){
clearTimeout(this.searching);
this.searching=this._delay(function(){
if(this.term!==this._value()){
this.selectedItem=null;
this.search(null,event);
}
},this.options.delay);
},
search:function(value,event){
value=value!=null?value:this._value();
this.term=this._value();
if(value.length<this.options.minLength){
return this.close(event);
}
if(this._trigger("search",event)===false){
return;
}
return this._search(value);
},
_search:function(value){
this.pending++;
this.element.addClass("ui-autocomplete-loading");
this.cancelSearch=false;
this.source({term:value},this._response());
},
_response:function(){
var index=++this.requestIndex;
return $.proxy(function(content){
if(index===this.requestIndex){
this.__response(content);
}
this.pending--;
if(!this.pending){
this.element.removeClass("ui-autocomplete-loading");
}
},this);
},
__response:function(content){
if(content){
content=this._normalize(content);
}
this._trigger("response",null,{content:content});
if(!this.options.disabled&&content&&content.length&&!this.cancelSearch){
this._suggest(content);
this._trigger("open");
}else{
this._close();
}
},
close:function(event){
this.cancelSearch=true;
this._close(event);
},
_close:function(event){
if(this.menu.element.is(":visible")){
this.menu.element.hide();
this.menu.blur();
this.isNewMenu=true;
this._trigger("close",event);
}
},
_change:function(event){
if(this.previous!==this._value()){
this._trigger("change",event,{item:this.selectedItem});
}
},
_normalize:function(items){
if(items.length&&items[0].label&&items[0].value){
return items;
}
return $.map(items,function(item){
if(typeof item==="string"){
return{
label:item,
value:item
};
}
return $.extend({
label:item.label||item.value,
value:item.value||item.label
},item);
});
},
_suggest:function(items){
var ul=this.menu.element.empty();
this._renderMenu(ul,items);
this.isNewMenu=true;
this.menu.refresh();
ul.show();
this._resizeMenu();
ul.position($.extend({
of:this.element
},this.options.position));
if(this.options.autoFocus){
this.menu.next();
}
},
_resizeMenu:function(){
var ul=this.menu.element;
ul.outerWidth(Math.max(
ul.width("").outerWidth()+1,
this.element.outerWidth()
));
},
_renderMenu:function(ul,items){
var that=this;
$.each(items,function(index,item){
that._renderItemData(ul,item);
});
},
_renderItemData:function(ul,item){
return this._renderItem(ul,item).data("ui-autocomplete-item",item);
},
_renderItem:function(ul,item){
return $("<li>")
.append($("<a>").text(item.label))
.appendTo(ul);
},
_move:function(direction,event){
if(!this.menu.element.is(":visible")){
this.search(null,event);
return;
}
if(this.menu.isFirstItem()&&/^previous/.test(direction)||
this.menu.isLastItem()&&/^next/.test(direction)){
this._value(this.term);
this.menu.blur();
return;
}
this.menu[direction](event);
},
widget:function(){
return this.menu.element;
},
_value:function(){
return this.valueMethod.apply(this.element,arguments);
},
_keyEvent:function(keyEvent,event){
if(!this.isMultiLine||this.menu.element.is(":visible")){
this._move(keyEvent,event);
event.preventDefault();
}
}
});
$.extend($.ui.autocomplete,{
escapeRegex:function(value){
return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");
},
filter:function(array,term){
var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");
return $.grep(array,function(value){
return matcher.test(value.label||value.value||value);
});
}
});
$.widget("ui.autocomplete",$.ui.autocomplete,{
options:{
messages:{
noResults:"No search results.",
results:function(amount){
return amount+(amount>1?" results are":" result is")+
" available, use up and down arrow keys to navigate.";
}
}
},
__response:function(content){
var message;
this._superApply(arguments);
if(this.options.disabled||this.cancelSearch){
return;
}
if(content&&content.length){
message=this.options.messages.results(content.length);
}else{
message=this.options.messages.noResults;
}
this.liveRegion.text(message);
}
});
}(jQuery));
(function($,undefined){
var lastActive,
baseClasses="ui-button ui-widget ui-state-default ui-corner-all",
typeClasses="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",
formResetHandler=function(){
var form=$(this);
setTimeout(function(){
form.find(":ui-button").button("refresh");
},1);
},
radioGroup=function(radio){
var name=radio.name,
form=radio.form,
radios=$([]);
if(name){
name=name.replace(/'/g,"\\'");
if(form){
radios=$(form).find("[name='"+name+"']");
}else{
radios=$("[name='"+name+"']",radio.ownerDocument)
.filter(function(){
return!this.form;
});
}
}
return radios;
};
$.widget("ui.button",{
version:"1.10.4",
defaultElement:"<button>",
options:{
disabled:null,
text:true,
label:null,
icons:{
primary:null,
secondary:null
}
},
_create:function(){
this.element.closest("form")
.unbind("reset"+this.eventNamespace)
.bind("reset"+this.eventNamespace,formResetHandler);
if(typeof this.options.disabled!=="boolean"){
this.options.disabled=!!this.element.prop("disabled");
}else{
this.element.prop("disabled",this.options.disabled);
}
this._determineButtonType();
this.hasTitle=!!this.buttonElement.attr("title");
var that=this,
options=this.options,
toggleButton=this.type==="checkbox"||this.type==="radio",
activeClass=!toggleButton?"ui-state-active":"";
if(options.label===null){
options.label=(this.type==="input"?this.buttonElement.val():this.buttonElement.html());
}
this._hoverable(this.buttonElement);
this.buttonElement
.addClass(baseClasses)
.attr("role","button")
.bind("mouseenter"+this.eventNamespace,function(){
if(options.disabled){
return;
}
if(this===lastActive){
$(this).addClass("ui-state-active");
}
})
.bind("mouseleave"+this.eventNamespace,function(){
if(options.disabled){
return;
}
$(this).removeClass(activeClass);
})
.bind("click"+this.eventNamespace,function(event){
if(options.disabled){
event.preventDefault();
event.stopImmediatePropagation();
}
});
this._on({
focus:function(){
this.buttonElement.addClass("ui-state-focus");
},
blur:function(){
this.buttonElement.removeClass("ui-state-focus");
}
});
if(toggleButton){
this.element.bind("change"+this.eventNamespace,function(){
that.refresh();
});
}
if(this.type==="checkbox"){
this.buttonElement.bind("click"+this.eventNamespace,function(){
if(options.disabled){
return false;
}
});
}else if(this.type==="radio"){
this.buttonElement.bind("click"+this.eventNamespace,function(){
if(options.disabled){
return false;
}
$(this).addClass("ui-state-active");
that.buttonElement.attr("aria-pressed","true");
var radio=that.element[0];
radioGroup(radio)
.not(radio)
.map(function(){
return $(this).button("widget")[0];
})
.removeClass("ui-state-active")
.attr("aria-pressed","false");
});
}else{
this.buttonElement
.bind("mousedown"+this.eventNamespace,function(){
if(options.disabled){
return false;
}
$(this).addClass("ui-state-active");
lastActive=this;
that.document.one("mouseup",function(){
lastActive=null;
});
})
.bind("mouseup"+this.eventNamespace,function(){
if(options.disabled){
return false;
}
$(this).removeClass("ui-state-active");
})
.bind("keydown"+this.eventNamespace,function(event){
if(options.disabled){
return false;
}
if(event.keyCode===$.ui.keyCode.SPACE||event.keyCode===$.ui.keyCode.ENTER){
$(this).addClass("ui-state-active");
}
})
.bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){
$(this).removeClass("ui-state-active");
});
if(this.buttonElement.is("a")){
this.buttonElement.keyup(function(event){
if(event.keyCode===$.ui.keyCode.SPACE){
$(this).click();
}
});
}
}
this._setOption("disabled",options.disabled);
this._resetButton();
},
_determineButtonType:function(){
var ancestor,labelSelector,checked;
if(this.element.is("[type=checkbox]")){
this.type="checkbox";
}else if(this.element.is("[type=radio]")){
this.type="radio";
}else if(this.element.is("input")){
this.type="input";
}else{
this.type="button";
}
if(this.type==="checkbox"||this.type==="radio"){
ancestor=this.element.parents().last();
labelSelector="label[for='"+this.element.attr("id")+"']";
this.buttonElement=ancestor.find(labelSelector);
if(!this.buttonElement.length){
ancestor=ancestor.length?ancestor.siblings():this.element.siblings();
this.buttonElement=ancestor.filter(labelSelector);
if(!this.buttonElement.length){
this.buttonElement=ancestor.find(labelSelector);
}
}
this.element.addClass("ui-helper-hidden-accessible");
checked=this.element.is(":checked");
if(checked){
this.buttonElement.addClass("ui-state-active");
}
this.buttonElement.prop("aria-pressed",checked);
}else{
this.buttonElement=this.element;
}
},
widget:function(){
return this.buttonElement;
},
_destroy:function(){
this.element
.removeClass("ui-helper-hidden-accessible");
this.buttonElement
.removeClass(baseClasses+" ui-state-active "+typeClasses)
.removeAttr("role")
.removeAttr("aria-pressed")
.html(this.buttonElement.find(".ui-button-text").html());
if(!this.hasTitle){
this.buttonElement.removeAttr("title");
}
},
_setOption:function(key,value){
this._super(key,value);
if(key==="disabled"){
this.element.prop("disabled",!!value);
if(value){
this.buttonElement.removeClass("ui-state-focus");
}
return;
}
this._resetButton();
},
refresh:function(){
var isDisabled=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");
if(isDisabled!==this.options.disabled){
this._setOption("disabled",isDisabled);
}
if(this.type==="radio"){
radioGroup(this.element[0]).each(function(){
if($(this).is(":checked")){
$(this).button("widget")
.addClass("ui-state-active")
.attr("aria-pressed","true");
}else{
$(this).button("widget")
.removeClass("ui-state-active")
.attr("aria-pressed","false");
}
});
}else if(this.type==="checkbox"){
if(this.element.is(":checked")){
this.buttonElement
.addClass("ui-state-active")
.attr("aria-pressed","true");
}else{
this.buttonElement
.removeClass("ui-state-active")
.attr("aria-pressed","false");
}
}
},
_resetButton:function(){
if(this.type==="input"){
if(this.options.label){
this.element.val(this.options.label);
}
return;
}
var buttonElement=this.buttonElement.removeClass(typeClasses),
buttonText=$("<span></span>",this.document[0])
.addClass("ui-button-text")
.html(this.options.label)
.appendTo(buttonElement.empty())
.text(),
icons=this.options.icons,
multipleIcons=icons.primary&&icons.secondary,
buttonClasses=[];
if(icons.primary||icons.secondary){
if(this.options.text){
buttonClasses.push("ui-button-text-icon"+(multipleIcons?"s":(icons.primary?"-primary":"-secondary")));
}
if(icons.primary){
buttonElement.prepend("<span class='ui-button-icon-primary ui-icon "+icons.primary+"'></span>");
}
if(icons.secondary){
buttonElement.append("<span class='ui-button-icon-secondary ui-icon "+icons.secondary+"'></span>");
}
if(!this.options.text){
buttonClasses.push(multipleIcons?"ui-button-icons-only":"ui-button-icon-only");
if(!this.hasTitle){
buttonElement.attr("title",$.trim(buttonText));
}
}
}else{
buttonClasses.push("ui-button-text-only");
}
buttonElement.addClass(buttonClasses.join(" "));
}
});
$.widget("ui.buttonset",{
version:"1.10.4",
options:{
items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"
},
_create:function(){
this.element.addClass("ui-buttonset");
},
_init:function(){
this.refresh();
},
_setOption:function(key,value){
if(key==="disabled"){
this.buttons.button("option",key,value);
}
this._super(key,value);
},
refresh:function(){
var rtl=this.element.css("direction")==="rtl";
this.buttons=this.element.find(this.options.items)
.filter(":ui-button")
.button("refresh")
.end()
.not(":ui-button")
.button()
.end()
.map(function(){
return $(this).button("widget")[0];
})
.removeClass("ui-corner-all ui-corner-left ui-corner-right")
.filter(":first")
.addClass(rtl?"ui-corner-right":"ui-corner-left")
.end()
.filter(":last")
.addClass(rtl?"ui-corner-left":"ui-corner-right")
.end()
.end();
},
_destroy:function(){
this.element.removeClass("ui-buttonset");
this.buttons
.map(function(){
return $(this).button("widget")[0];
})
.removeClass("ui-corner-left ui-corner-right")
.end()
.button("destroy");
}
});
}(jQuery));
(function($,undefined){
$.extend($.ui,{datepicker:{version:"1.10.4"}});
var PROP_NAME="datepicker",
instActive;

function Datepicker(){
this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June",
"July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};
this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};
$.extend(this._defaults,this.regional[""]);
this.dpDiv=bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"));
}
$.extend(Datepicker.prototype,{

markerClassName:"hasDatepicker",
maxRows:4,
_widgetDatepicker:function(){
return this.dpDiv;
},

setDefaults:function(settings){
extendRemove(this._defaults,settings||{});
return this;
},

_attachDatepicker:function(target,settings){
var nodeName,inline,inst;
nodeName=target.nodeName.toLowerCase();
inline=(nodeName==="div"||nodeName==="span");
if(!target.id){
this.uuid+=1;
target.id="dp"+this.uuid;
}
inst=this._newInst($(target),inline);
inst.settings=$.extend({},settings||{});
if(nodeName==="input"){
this._connectDatepicker(target,inst);
}else if(inline){
this._inlineDatepicker(target,inst);
}
},

_newInst:function(target,inline){
var id=target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")))};
},

_connectDatepicker:function(target,inst){
var input=$(target);
inst.append=$([]);
inst.trigger=$([]);
if(input.hasClass(this.markerClassName)){
return;
}
this._attachments(input,inst);
input.addClass(this.markerClassName).keydown(this._doKeyDown).
keypress(this._doKeyPress).keyup(this._doKeyUp);
this._autoSize(inst);
$.data(target,PROP_NAME,inst);
if(inst.settings.disabled){
this._disableDatepicker(target);
}
},

_attachments:function(input,inst){
var showOn,buttonText,buttonImage,
appendText=this._get(inst,"appendText"),
isRTL=this._get(inst,"isRTL");
if(inst.append){
inst.append.remove();
}
if(appendText){
inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>");
input[isRTL?"before":"after"](inst.append);
}
input.unbind("focus",this._showDatepicker);
if(inst.trigger){
inst.trigger.remove();
}
showOn=this._get(inst,"showOn");
if(showOn==="focus"||showOn==="both"){input.focus(this._showDatepicker);
}
if(showOn==="button"||showOn==="both"){buttonText=this._get(inst,"buttonText");
buttonImage=this._get(inst,"buttonImage");
inst.trigger=$(this._get(inst,"buttonImageOnly")?
$("<img/>").addClass(this._triggerClass).
attr({src:buttonImage,alt:buttonText,title:buttonText}):
$("<button type='button'></button>").addClass(this._triggerClass).
html(!buttonImage?buttonText:$("<img/>").attr(
{src:buttonImage,alt:buttonText,title:buttonText})));
input[isRTL?"before":"after"](inst.trigger);
inst.trigger.click(function(){
if($.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]){
$.datepicker._hideDatepicker();
}else if($.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]){
$.datepicker._hideDatepicker();
$.datepicker._showDatepicker(input[0]);
}else{
$.datepicker._showDatepicker(input[0]);
}
return false;
});
}
},

_autoSize:function(inst){
if(this._get(inst,"autoSize")&&!inst.inline){
var findMax,max,maxI,i,
date=new Date(2009,12-1,20),dateFormat=this._get(inst,"dateFormat");
if(dateFormat.match(/[DM]/)){
findMax=function(names){
max=0;
maxI=0;
for(i=0;i<names.length;i++){
if(names[i].length>max){
max=names[i].length;
maxI=i;
}
}
return maxI;
};
date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?
"monthNames":"monthNamesShort"))));
date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?
"dayNames":"dayNamesShort")))+20-date.getDay());
}
inst.input.attr("size",this._formatDate(inst,date).length);
}
},

_inlineDatepicker:function(target,inst){
var divSpan=$(target);
if(divSpan.hasClass(this.markerClassName)){
return;
}
divSpan.addClass(this.markerClassName).append(inst.dpDiv);
$.data(target,PROP_NAME,inst);
this._setDate(inst,this._getDefaultDate(inst),true);
this._updateDatepicker(inst);
this._updateAlternate(inst);
if(inst.settings.disabled){
this._disableDatepicker(target);
}
inst.dpDiv.css("display","block");
},

_dialogDatepicker:function(input,date,onSelect,settings,pos){
var id,browserWidth,browserHeight,scrollX,scrollY,
inst=this._dialogInst;if(!inst){
this.uuid+=1;
id="dp"+this.uuid;
this._dialogInput=$("<input type='text' id='"+id+
"' style='position: absolute; top: -100px; width: 0px;'/>");
this._dialogInput.keydown(this._doKeyDown);
$("body").append(this._dialogInput);
inst=this._dialogInst=this._newInst(this._dialogInput,false);
inst.settings={};
$.data(this._dialogInput[0],PROP_NAME,inst);
}
extendRemove(inst.settings,settings||{});
date=(date&&date.constructor===Date?this._formatDate(inst,date):date);
this._dialogInput.val(date);
this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);
if(!this._pos){
browserWidth=document.documentElement.clientWidth;
browserHeight=document.documentElement.clientHeight;
scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;
scrollY=document.documentElement.scrollTop||document.body.scrollTop;
this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY];
}
this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");
inst.settings.onSelect=onSelect;
this._inDialog=true;
this.dpDiv.addClass(this._dialogClass);
this._showDatepicker(this._dialogInput[0]);
if($.blockUI){
$.blockUI(this.dpDiv);
}
$.data(this._dialogInput[0],PROP_NAME,inst);
return this;
},

_destroyDatepicker:function(target){
var nodeName,
$target=$(target),
inst=$.data(target,PROP_NAME);
if(!$target.hasClass(this.markerClassName)){
return;
}
nodeName=target.nodeName.toLowerCase();
$.removeData(target,PROP_NAME);
if(nodeName==="input"){
inst.append.remove();
inst.trigger.remove();
$target.removeClass(this.markerClassName).
unbind("focus",this._showDatepicker).
unbind("keydown",this._doKeyDown).
unbind("keypress",this._doKeyPress).
unbind("keyup",this._doKeyUp);
}else if(nodeName==="div"||nodeName==="span"){
$target.removeClass(this.markerClassName).empty();
}
},

_enableDatepicker:function(target){
var nodeName,inline,
$target=$(target),
inst=$.data(target,PROP_NAME);
if(!$target.hasClass(this.markerClassName)){
return;
}
nodeName=target.nodeName.toLowerCase();
if(nodeName==="input"){
target.disabled=false;
inst.trigger.filter("button").
each(function(){this.disabled=false}).end().
filter("img").css({opacity:"1.0",cursor:""});
}else if(nodeName==="div"||nodeName==="span"){
inline=$target.children("."+this._inlineClass);
inline.children().removeClass("ui-state-disabled");
inline.find("select.ui-datepicker-month, select.ui-datepicker-year").
prop("disabled",false);
}
this._disabledInputs=$.map(this._disabledInputs,
function(value){return(value===target?null:value)})},

_disableDatepicker:function(target){
var nodeName,inline,
$target=$(target),
inst=$.data(target,PROP_NAME);
if(!$target.hasClass(this.markerClassName)){
return;
}
nodeName=target.nodeName.toLowerCase();
if(nodeName==="input"){
target.disabled=true;
inst.trigger.filter("button").
each(function(){this.disabled=true}).end().
filter("img").css({opacity:"0.5",cursor:"default"});
}else if(nodeName==="div"||nodeName==="span"){
inline=$target.children("."+this._inlineClass);
inline.children().addClass("ui-state-disabled");
inline.find("select.ui-datepicker-month, select.ui-datepicker-year").
prop("disabled",true);
}
this._disabledInputs=$.map(this._disabledInputs,
function(value){return(value===target?null:value)});this._disabledInputs[this._disabledInputs.length]=target;
},

_isDisabledDatepicker:function(target){
if(!target){
return false;
}
for(var i=0;i<this._disabledInputs.length;i++){
if(this._disabledInputs[i]===target){
return true;
}
}
return false;
},

_getInst:function(target){
try{
return $.data(target,PROP_NAME);
}
catch(err){
throw"Missing instance data for this datepicker";
}
},

_optionDatepicker:function(target,name,value){
var settings,date,minDate,maxDate,
inst=this._getInst(target);
if(arguments.length===2&&typeof name==="string"){
return(name==="defaults"?$.extend({},$.datepicker._defaults):
(inst?(name==="all"?$.extend({},inst.settings):
this._get(inst,name)):null));
}
settings=name||{};
if(typeof name==="string"){
settings={};
settings[name]=value;
}
if(inst){
if(this._curInst===inst){
this._hideDatepicker();
}
date=this._getDateDatepicker(target,true);
minDate=this._getMinMaxDate(inst,"min");
maxDate=this._getMinMaxDate(inst,"max");
extendRemove(inst.settings,settings);
if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){
inst.settings.minDate=this._formatDate(inst,minDate);
}
if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){
inst.settings.maxDate=this._formatDate(inst,maxDate);
}
if("disabled"in settings){
if(settings.disabled){
this._disableDatepicker(target);
}else{
this._enableDatepicker(target);
}
}
this._attachments($(target),inst);
this._autoSize(inst);
this._setDate(inst,date);
this._updateAlternate(inst);
this._updateDatepicker(inst);
}
},
_changeDatepicker:function(target,name,value){
this._optionDatepicker(target,name,value);
},

_refreshDatepicker:function(target){
var inst=this._getInst(target);
if(inst){
this._updateDatepicker(inst);
}
},

_setDateDatepicker:function(target,date){
var inst=this._getInst(target);
if(inst){
this._setDate(inst,date);
this._updateDatepicker(inst);
this._updateAlternate(inst);
}
},

_getDateDatepicker:function(target,noDefault){
var inst=this._getInst(target);
if(inst&&!inst.inline){
this._setDateFromField(inst,noDefault);
}
return(inst?this._getDate(inst):null);
},

_doKeyDown:function(event){
var onSelect,dateStr,sel,
inst=$.datepicker._getInst(event.target),
handled=true,
isRTL=inst.dpDiv.is(".ui-datepicker-rtl");
inst._keyEvent=true;
if($.datepicker._datepickerShowing){
switch(event.keyCode){
case 9:$.datepicker._hideDatepicker();
handled=false;
break;case 13:sel=$("td."+$.datepicker._dayOverClass+":not(."+
$.datepicker._currentClass+")",inst.dpDiv);
if(sel[0]){
$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0]);
}
onSelect=$.datepicker._get(inst,"onSelect");
if(onSelect){
dateStr=$.datepicker._formatDate(inst);
onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst]);
}else{
$.datepicker._hideDatepicker();
}
return false;case 27:$.datepicker._hideDatepicker();
break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?
-$.datepicker._get(inst,"stepBigMonths"):
-$.datepicker._get(inst,"stepMonths")),"M");
break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?
+$.datepicker._get(inst,"stepBigMonths"):
+$.datepicker._get(inst,"stepMonths")),"M");
break;case 35:if(event.ctrlKey||event.metaKey){
$.datepicker._clearDate(event.target);
}
handled=event.ctrlKey||event.metaKey;
break;case 36:if(event.ctrlKey||event.metaKey){
$.datepicker._gotoToday(event.target);
}
handled=event.ctrlKey||event.metaKey;
break;case 37:if(event.ctrlKey||event.metaKey){
$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D");
}
handled=event.ctrlKey||event.metaKey;
if(event.originalEvent.altKey){
$.datepicker._adjustDate(event.target,(event.ctrlKey?
-$.datepicker._get(inst,"stepBigMonths"):
-$.datepicker._get(inst,"stepMonths")),"M");
}
break;
case 38:if(event.ctrlKey||event.metaKey){
$.datepicker._adjustDate(event.target,-7,"D");
}
handled=event.ctrlKey||event.metaKey;
break;case 39:if(event.ctrlKey||event.metaKey){
$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D");
}
handled=event.ctrlKey||event.metaKey;
if(event.originalEvent.altKey){
$.datepicker._adjustDate(event.target,(event.ctrlKey?
+$.datepicker._get(inst,"stepBigMonths"):
+$.datepicker._get(inst,"stepMonths")),"M");
}
break;
case 40:if(event.ctrlKey||event.metaKey){
$.datepicker._adjustDate(event.target,+7,"D");
}
handled=event.ctrlKey||event.metaKey;
break;default:handled=false;
}
}else if(event.keyCode===36&&event.ctrlKey){$.datepicker._showDatepicker(this);
}else{
handled=false;
}
if(handled){
event.preventDefault();
event.stopPropagation();
}
},

_doKeyPress:function(event){
var chars,chr,
inst=$.datepicker._getInst(event.target);
if($.datepicker._get(inst,"constrainInput")){
chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));
chr=String.fromCharCode(event.charCode==null?event.keyCode:event.charCode);
return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1);
}
},

_doKeyUp:function(event){
var date,
inst=$.datepicker._getInst(event.target);
if(inst.input.val()!==inst.lastVal){
try{
date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),
(inst.input?inst.input.val():null),
$.datepicker._getFormatConfig(inst));
if(date){$.datepicker._setDateFromField(inst);
$.datepicker._updateAlternate(inst);
$.datepicker._updateDatepicker(inst);
}
}
catch(err){
}
}
return true;
},

_showDatepicker:function(input){
input=input.target||input;
if(input.nodeName.toLowerCase()!=="input"){input=$("input",input.parentNode)[0];
}
if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput===input){return;
}
var inst,beforeShow,beforeShowSettings,isFixed,
offset,showAnim,duration;
inst=$.datepicker._getInst(input);
if($.datepicker._curInst&&$.datepicker._curInst!==inst){
$.datepicker._curInst.dpDiv.stop(true,true);
if(inst&&$.datepicker._datepickerShowing){
$.datepicker._hideDatepicker($.datepicker._curInst.input[0]);
}
}
beforeShow=$.datepicker._get(inst,"beforeShow");
beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};
if(beforeShowSettings===false){
return;
}
extendRemove(inst.settings,beforeShowSettings);
inst.lastVal=null;
$.datepicker._lastInput=input;
$.datepicker._setDateFromField(inst);
if($.datepicker._inDialog){input.value="";
}
if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);
$.datepicker._pos[1]+=input.offsetHeight}
isFixed=false;
$(input).parents().each(function(){
isFixed|=$(this).css("position")==="fixed";
return!isFixed;
});
offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};
$.datepicker._pos=null;
inst.dpDiv.empty();
inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});
$.datepicker._updateDatepicker(inst);
offset=$.datepicker._checkOffset(inst,offset,isFixed);
inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?
"static":(isFixed?"fixed":"absolute")),display:"none",
left:offset.left+"px",top:offset.top+"px"});
if(!inst.inline){
showAnim=$.datepicker._get(inst,"showAnim");
duration=$.datepicker._get(inst,"duration");
inst.dpDiv.zIndex($(input).zIndex()+1);
$.datepicker._datepickerShowing=true;
if($.effects&&$.effects.effect[showAnim]){
inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration);
}else{
inst.dpDiv[showAnim||"show"](showAnim?duration:null);
}
if($.datepicker._shouldFocusInput(inst)){
inst.input.focus();
}
$.datepicker._curInst=inst;
}
},

_updateDatepicker:function(inst){
this.maxRows=4;instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));
this._attachHandlers(inst);
inst.dpDiv.find("."+this._dayOverClass+" a").mouseover();
var origyearshtml,
numMonths=this._getNumberOfMonths(inst),
cols=numMonths[1],
width=17;
inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");
if(cols>1){
inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em");
}
inst.dpDiv[(numMonths[0]!==1||numMonths[1]!==1?"add":"remove")+
"Class"]("ui-datepicker-multi");
inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+
"Class"]("ui-datepicker-rtl");
if(inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)){
inst.input.focus();
}
if(inst.yearshtml){
origyearshtml=inst.yearshtml;
setTimeout(function(){
if(origyearshtml===inst.yearshtml&&inst.yearshtml){
inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml);
}
origyearshtml=inst.yearshtml=null;
},0);
}
},
_shouldFocusInput:function(inst){
return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus");
},

_checkOffset:function(inst,offset,isFixed){
var dpWidth=inst.dpDiv.outerWidth(),
dpHeight=inst.dpDiv.outerHeight(),
inputWidth=inst.input?inst.input.outerWidth():0,
inputHeight=inst.input?inst.input.outerHeight():0,
viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),
viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());
offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);
offset.left-=(isFixed&&offset.left===inst.input.offset().left)?$(document).scrollLeft():0;
offset.top-=(isFixed&&offset.top===(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;
offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?
Math.abs(offset.left+dpWidth-viewWidth):0);
offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?
Math.abs(dpHeight+inputHeight):0);
return offset;
},

_findPos:function(obj){
var position,
inst=this._getInst(obj),
isRTL=this._get(inst,"isRTL");
while(obj&&(obj.type==="hidden"||obj.nodeType!==1||$.expr.filters.hidden(obj))){
obj=obj[isRTL?"previousSibling":"nextSibling"];
}
position=$(obj).offset();
return[position.left,position.top];
},

_hideDatepicker:function(input){
var showAnim,duration,postProcess,onClose,
inst=this._curInst;
if(!inst||(input&&inst!==$.data(input,PROP_NAME))){
return;
}
if(this._datepickerShowing){
showAnim=this._get(inst,"showAnim");
duration=this._get(inst,"duration");
postProcess=function(){
$.datepicker._tidyDialog(inst);
};
if($.effects&&($.effects.effect[showAnim]||$.effects[showAnim])){
inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess);
}else{
inst.dpDiv[(showAnim==="slideDown"?"slideUp":
(showAnim==="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess);
}
if(!showAnim){
postProcess();
}
this._datepickerShowing=false;
onClose=this._get(inst,"onClose");
if(onClose){
onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst]);
}
this._lastInput=null;
if(this._inDialog){
this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});
if($.blockUI){
$.unblockUI();
$("body").append(this.dpDiv);
}
}
this._inDialog=false;
}
},

_tidyDialog:function(inst){
inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar");
},

_checkExternalClick:function(event){
if(!$.datepicker._curInst){
return;
}
var $target=$(event.target),
inst=$.datepicker._getInst($target[0]);
if((($target[0].id!==$.datepicker._mainDivId&&
$target.parents("#"+$.datepicker._mainDivId).length===0&&
!$target.hasClass($.datepicker.markerClassName)&&
!$target.closest("."+$.datepicker._triggerClass).length&&
$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||
($target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==inst)){
$.datepicker._hideDatepicker();
}
},

_adjustDate:function(id,offset,period){
var target=$(id),
inst=this._getInst(target[0]);
if(this._isDisabledDatepicker(target[0])){
return;
}
this._adjustInstDate(inst,offset+
(period==="M"?this._get(inst,"showCurrentAtPos"):0),period);
this._updateDatepicker(inst);
},

_gotoToday:function(id){
var date,
target=$(id),
inst=this._getInst(target[0]);
if(this._get(inst,"gotoCurrent")&&inst.currentDay){
inst.selectedDay=inst.currentDay;
inst.drawMonth=inst.selectedMonth=inst.currentMonth;
inst.drawYear=inst.selectedYear=inst.currentYear;
}else{
date=new Date();
inst.selectedDay=date.getDate();
inst.drawMonth=inst.selectedMonth=date.getMonth();
inst.drawYear=inst.selectedYear=date.getFullYear();
}
this._notifyChange(inst);
this._adjustDate(target);
},

_selectMonthYear:function(id,select,period){
var target=$(id),
inst=this._getInst(target[0]);
inst["selected"+(period==="M"?"Month":"Year")]=
inst["draw"+(period==="M"?"Month":"Year")]=
parseInt(select.options[select.selectedIndex].value,10);
this._notifyChange(inst);
this._adjustDate(target);
},

_selectDay:function(id,month,year,td){
var inst,
target=$(id);
if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){
return;
}
inst=this._getInst(target[0]);
inst.selectedDay=inst.currentDay=$("a",td).html();
inst.selectedMonth=inst.currentMonth=month;
inst.selectedYear=inst.currentYear=year;
this._selectDate(id,this._formatDate(inst,
inst.currentDay,inst.currentMonth,inst.currentYear));
},

_clearDate:function(id){
var target=$(id);
this._selectDate(target,"");
},

_selectDate:function(id,dateStr){
var onSelect,
target=$(id),
inst=this._getInst(target[0]);
dateStr=(dateStr!=null?dateStr:this._formatDate(inst));
if(inst.input){
inst.input.val(dateStr);
}
this._updateAlternate(inst);
onSelect=this._get(inst,"onSelect");
if(onSelect){
onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else if(inst.input){
inst.input.trigger("change")}
if(inst.inline){
this._updateDatepicker(inst);
}else{
this._hideDatepicker();
this._lastInput=inst.input[0];
if(typeof(inst.input[0])!=="object"){
inst.input.focus()}
this._lastInput=null;
}
},

_updateAlternate:function(inst){
var altFormat,date,dateStr,
altField=this._get(inst,"altField");
if(altField){altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");
date=this._getDate(inst);
dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));
$(altField).each(function(){$(this).val(dateStr)});
}
},

noWeekends:function(date){
var day=date.getDay();
return[(day>0&&day<6),""];
},

iso8601Week:function(date){
var time,
checkDate=new Date(date.getTime());
checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));
time=checkDate.getTime();
checkDate.setMonth(0);checkDate.setDate(1);
return Math.floor(Math.round((time-checkDate)/86400000)/7)+1;
},

parseDate:function(format,value,settings){
if(format==null||value==null){
throw"Invalid arguments";
}
value=(typeof value==="object"?value.toString():value+"");
if(value===""){
return null;
}
var iFormat,dim,extra,
iValue=0,
shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,
shortYearCutoff=(typeof shortYearCutoffTemp!=="string"?shortYearCutoffTemp:
new Date().getFullYear()%100+parseInt(shortYearCutoffTemp,10)),
dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,
dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,
monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,
monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,
year=-1,
month=-1,
day=-1,
doy=-1,
literal=false,
date,
lookAhead=function(match){
var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);
if(matches){
iFormat++;
}
return matches;
},
getNumber=function(match){
var isDoubled=lookAhead(match),
size=(match==="@"?14:(match==="!"?20:
(match==="y"&&isDoubled?4:(match==="o"?3:2)))),
digits=new RegExp("^\\d{1,"+size+"}"),
num=value.substring(iValue).match(digits);
if(!num){
throw"Missing number at position "+iValue;
}
iValue+=num[0].length;
return parseInt(num[0],10);
},
getName=function(match,shortNames,longNames){
var index=-1,
names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){
return[[k,v]];
}).sort(function(a,b){
return-(a[1].length-b[1].length);
});
$.each(names,function(i,pair){
var name=pair[1];
if(value.substr(iValue,name.length).toLowerCase()===name.toLowerCase()){
index=pair[0];
iValue+=name.length;
return false;
}
});
if(index!==-1){
return index+1;
}else{
throw"Unknown name at position "+iValue;
}
},
checkLiteral=function(){
if(value.charAt(iValue)!==format.charAt(iFormat)){
throw"Unexpected literal at position "+iValue;
}
iValue++;
};
for(iFormat=0;iFormat<format.length;iFormat++){
if(literal){
if(format.charAt(iFormat)==="'"&&!lookAhead("'")){
literal=false;
}else{
checkLiteral();
}
}else{
switch(format.charAt(iFormat)){
case"d":
day=getNumber("d");
break;
case"D":
getName("D",dayNamesShort,dayNames);
break;
case"o":
doy=getNumber("o");
break;
case"m":
month=getNumber("m");
break;
case"M":
month=getName("M",monthNamesShort,monthNames);
break;
case"y":
year=getNumber("y");
break;
case"@":
date=new Date(getNumber("@"));
year=date.getFullYear();
month=date.getMonth()+1;
day=date.getDate();
break;
case"!":
date=new Date((getNumber("!")-this._ticksTo1970)/10000);
year=date.getFullYear();
month=date.getMonth()+1;
day=date.getDate();
break;
case"'":
if(lookAhead("'")){
checkLiteral();
}else{
literal=true;
}
break;
default:
checkLiteral();
}
}
}
if(iValue<value.length){
extra=value.substr(iValue);
if(!/^\s+/.test(extra)){
throw"Extra/unparsed characters found in date: "+extra;
}
}
if(year===-1){
year=new Date().getFullYear();
}else if(year<100){
year+=new Date().getFullYear()-new Date().getFullYear()%100+
(year<=shortYearCutoff?0:-100);
}
if(doy>-1){
month=1;
day=doy;
do{
dim=this._getDaysInMonth(year,month-1);
if(day<=dim){
break;
}
month++;
day-=dim;
}while(true);
}
date=this._daylightSavingAdjust(new Date(year,month-1,day));
if(date.getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day){
throw"Invalid date";}
return date;
},

ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",
ISO_8601:"yy-mm-dd",
RFC_822:"D, d M y",
RFC_850:"DD, dd-M-y",
RFC_1036:"D, d M y",
RFC_1123:"D, d M yy",
RFC_2822:"D, d M yy",
RSS:"D, d M y",TICKS:"!",
TIMESTAMP:"@",
W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+
Math.floor(1970/400))*24*60*60*10000000),

formatDate:function(format,date,settings){
if(!date){
return"";
}
var iFormat,
dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,
dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,
monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,
monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,
lookAhead=function(match){
var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);
if(matches){
iFormat++;
}
return matches;
},
formatNumber=function(match,value,len){
var num=""+value;
if(lookAhead(match)){
while(num.length<len){
num="0"+num;
}
}
return num;
},
formatName=function(match,value,shortNames,longNames){
return(lookAhead(match)?longNames[value]:shortNames[value]);
},
output="",
literal=false;
if(date){
for(iFormat=0;iFormat<format.length;iFormat++){
if(literal){
if(format.charAt(iFormat)==="'"&&!lookAhead("'")){
literal=false;
}else{
output+=format.charAt(iFormat);
}
}else{
switch(format.charAt(iFormat)){
case"d":
output+=formatNumber("d",date.getDate(),2);
break;
case"D":
output+=formatName("D",date.getDay(),dayNamesShort,dayNames);
break;
case"o":
output+=formatNumber("o",
Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);
break;
case"m":
output+=formatNumber("m",date.getMonth()+1,2);
break;
case"M":
output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);
break;
case"y":
output+=(lookAhead("y")?date.getFullYear():
(date.getYear()%100<10?"0":"")+date.getYear()%100);
break;
case"@":
output+=date.getTime();
break;
case"!":
output+=date.getTime()*10000+this._ticksTo1970;
break;
case"'":
if(lookAhead("'")){
output+="'";
}else{
literal=true;
}
break;
default:
output+=format.charAt(iFormat);
}
}
}
}
return output;
},

_possibleChars:function(format){
var iFormat,
chars="",
literal=false,
lookAhead=function(match){
var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);
if(matches){
iFormat++;
}
return matches;
};
for(iFormat=0;iFormat<format.length;iFormat++){
if(literal){
if(format.charAt(iFormat)==="'"&&!lookAhead("'")){
literal=false;
}else{
chars+=format.charAt(iFormat);
}
}else{
switch(format.charAt(iFormat)){
case"d":case"m":case"y":case"@":
chars+="0123456789";
break;
case"D":case"M":
return null;case"'":
if(lookAhead("'")){
chars+="'";
}else{
literal=true;
}
break;
default:
chars+=format.charAt(iFormat);
}
}
}
return chars;
},

_get:function(inst,name){
return inst.settings[name]!==undefined?
inst.settings[name]:this._defaults[name];
},

_setDateFromField:function(inst,noDefault){
if(inst.input.val()===inst.lastVal){
return;
}
var dateFormat=this._get(inst,"dateFormat"),
dates=inst.lastVal=inst.input?inst.input.val():null,
defaultDate=this._getDefaultDate(inst),
date=defaultDate,
settings=this._getFormatConfig(inst);
try{
date=this.parseDate(dateFormat,dates,settings)||defaultDate;
}catch(event){
dates=(noDefault?"":dates);
}
inst.selectedDay=date.getDate();
inst.drawMonth=inst.selectedMonth=date.getMonth();
inst.drawYear=inst.selectedYear=date.getFullYear();
inst.currentDay=(dates?date.getDate():0);
inst.currentMonth=(dates?date.getMonth():0);
inst.currentYear=(dates?date.getFullYear():0);
this._adjustInstDate(inst);
},

_getDefaultDate:function(inst){
return this._restrictMinMax(inst,
this._determineDate(inst,this._get(inst,"defaultDate"),new Date()));
},

_determineDate:function(inst,date,defaultDate){
var offsetNumeric=function(offset){
var date=new Date();
date.setDate(date.getDate()+offset);
return date;
},
offsetString=function(offset){
try{
return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),
offset,$.datepicker._getFormatConfig(inst));
}
catch(e){
}
var date=(offset.toLowerCase().match(/^c/)?
$.datepicker._getDate(inst):null)||new Date(),
year=date.getFullYear(),
month=date.getMonth(),
day=date.getDate(),
pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,
matches=pattern.exec(offset);
while(matches){
switch(matches[2]||"d"){
case"d":case"D":
day+=parseInt(matches[1],10);break;
case"w":case"W":
day+=parseInt(matches[1],10)*7;break;
case"m":case"M":
month+=parseInt(matches[1],10);
day=Math.min(day,$.datepicker._getDaysInMonth(year,month));
break;
case"y":case"Y":
year+=parseInt(matches[1],10);
day=Math.min(day,$.datepicker._getDaysInMonth(year,month));
break;
}
matches=pattern.exec(offset);
}
return new Date(year,month,day);
},
newDate=(date==null||date===""?defaultDate:(typeof date==="string"?offsetString(date):
(typeof date==="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));
newDate=(newDate&&newDate.toString()==="Invalid Date"?defaultDate:newDate);
if(newDate){
newDate.setHours(0);
newDate.setMinutes(0);
newDate.setSeconds(0);
newDate.setMilliseconds(0);
}
return this._daylightSavingAdjust(newDate);
},

_daylightSavingAdjust:function(date){
if(!date){
return null;
}
date.setHours(date.getHours()>12?date.getHours()+2:0);
return date;
},

_setDate:function(inst,date,noChange){
var clear=!date,
origMonth=inst.selectedMonth,
origYear=inst.selectedYear,
newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));
inst.selectedDay=inst.currentDay=newDate.getDate();
inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();
inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();
if((origMonth!==inst.selectedMonth||origYear!==inst.selectedYear)&&!noChange){
this._notifyChange(inst);
}
this._adjustInstDate(inst);
if(inst.input){
inst.input.val(clear?"":this._formatDate(inst));
}
},

_getDate:function(inst){
var startDate=(!inst.currentYear||(inst.input&&inst.input.val()==="")?null:
this._daylightSavingAdjust(new Date(
inst.currentYear,inst.currentMonth,inst.currentDay)));
return startDate;
},

_attachHandlers:function(inst){
var stepMonths=this._get(inst,"stepMonths"),
id="#"+inst.id.replace(/\\\\/g,"\\");
inst.dpDiv.find("[data-handler]").map(function(){
var handler={
prev:function(){
$.datepicker._adjustDate(id,-stepMonths,"M");
},
next:function(){
$.datepicker._adjustDate(id,+stepMonths,"M");
},
hide:function(){
$.datepicker._hideDatepicker();
},
today:function(){
$.datepicker._gotoToday(id);
},
selectDay:function(){
$.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);
return false;
},
selectMonth:function(){
$.datepicker._selectMonthYear(id,this,"M");
return false;
},
selectYear:function(){
$.datepicker._selectMonthYear(id,this,"Y");
return false;
}
};
$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")]);
});
},

_generateHTML:function(inst){
var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,
controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,
monthNames,monthNamesShort,beforeShowDay,showOtherMonths,
selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,
cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,
printDate,dRow,tbody,daySettings,otherMonth,unselectable,
tempDate=new Date(),
today=this._daylightSavingAdjust(
new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),
showButtonPanel=this._get(inst,"showButtonPanel"),
hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),
navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),
numMonths=this._getNumberOfMonths(inst),
showCurrentAtPos=this._get(inst,"showCurrentAtPos"),
stepMonths=this._get(inst,"stepMonths"),
isMultiMonth=(numMonths[0]!==1||numMonths[1]!==1),
currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):
new Date(inst.currentYear,inst.currentMonth,inst.currentDay))),
minDate=this._getMinMaxDate(inst,"min"),
maxDate=this._getMinMaxDate(inst,"max"),
drawMonth=inst.drawMonth-showCurrentAtPos,
drawYear=inst.drawYear;
if(drawMonth<0){
drawMonth+=12;
drawYear--;
}
if(maxDate){
maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),
maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));
maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);
while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){
drawMonth--;
if(drawMonth<0){
drawMonth=11;
drawYear--;
}
}
}
inst.drawMonth=drawMonth;
inst.drawYear=drawYear;
prevText=this._get(inst,"prevText");
prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,
this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),
this._getFormatConfig(inst)));
prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?
"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click'"+
" title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":
(hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>"));
nextText=this._get(inst,"nextText");
nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,
this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),
this._getFormatConfig(inst)));
next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?
"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click'"+
" title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":
(hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>"));
currentText=this._get(inst,"currentText");
gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);
currentText=(!navigationAsDateFormat?currentText:
this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));
controls=(!inst.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+
this._get(inst,"closeText")+"</button>":"");
buttonPanel=(showButtonPanel)?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+
(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'"+
">"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";
firstDay=parseInt(this._get(inst,"firstDay"),10);
firstDay=(isNaN(firstDay)?0:firstDay);
showWeek=this._get(inst,"showWeek");
dayNames=this._get(inst,"dayNames");
dayNamesMin=this._get(inst,"dayNamesMin");
monthNames=this._get(inst,"monthNames");
monthNamesShort=this._get(inst,"monthNamesShort");
beforeShowDay=this._get(inst,"beforeShowDay");
showOtherMonths=this._get(inst,"showOtherMonths");
selectOtherMonths=this._get(inst,"selectOtherMonths");
defaultDate=this._getDefaultDate(inst);
html="";
dow;
for(row=0;row<numMonths[0];row++){
group="";
this.maxRows=4;
for(col=0;col<numMonths[1];col++){
selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));
cornerClass=" ui-corner-all";
calender="";
if(isMultiMonth){
calender+="<div class='ui-datepicker-group";
if(numMonths[1]>1){
switch(col){
case 0:calender+=" ui-datepicker-group-first";
cornerClass=" ui-corner-"+(isRTL?"right":"left");break;
case numMonths[1]-1:calender+=" ui-datepicker-group-last";
cornerClass=" ui-corner-"+(isRTL?"left":"right");break;
default:calender+=" ui-datepicker-group-middle";cornerClass="";break;
}
}
calender+="'>";
}
calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+
(/all|left/.test(cornerClass)&&row===0?(isRTL?next:prev):"")+
(/all|right/.test(cornerClass)&&row===0?(isRTL?prev:next):"")+
this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,
row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead>"+
"<tr>";
thead=(showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"");
for(dow=0;dow<7;dow++){day=(dow+firstDay)%7;
thead+="<th"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+
"<span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>";
}
calender+=thead+"</tr></thead><tbody>";
daysInMonth=this._getDaysInMonth(drawYear,drawMonth);
if(drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth){
inst.selectedDay=Math.min(inst.selectedDay,daysInMonth);
}
leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;
curRows=Math.ceil((leadDays+daysInMonth)/7);numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;
printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));
for(dRow=0;dRow<numRows;dRow++){calender+="<tr>";
tbody=(!showWeek?"":"<td class='ui-datepicker-week-col'>"+
this._get(inst,"calculateWeek")(printDate)+"</td>");
for(dow=0;dow<7;dow++){daySettings=(beforeShowDay?
beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);
otherMonth=(printDate.getMonth()!==drawMonth);
unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||
(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);
tbody+="<td class='"+
((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+((printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime())?
" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+((!otherMonth||showOtherMonths)&&daySettings[2]?" title='"+daySettings[2].replace(/'/g,"&#39;")+"'":"")+(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+
(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+
(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);
printDate=this._daylightSavingAdjust(printDate);
}
calender+=tbody+"</tr>";
}
drawMonth++;
if(drawMonth>11){
drawMonth=0;
drawYear++;
}
calender+="</tbody></table>"+(isMultiMonth?"</div>"+
((numMonths[0]>0&&col===numMonths[1]-1)?"<div class='ui-datepicker-row-break'></div>":""):"");
group+=calender;
}
html+=group;
}
html+=buttonPanel;
inst._keyEvent=false;
return html;
},

_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,
secondary,monthNames,monthNamesShort){
var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,
changeMonth=this._get(inst,"changeMonth"),
changeYear=this._get(inst,"changeYear"),
showMonthAfterYear=this._get(inst,"showMonthAfterYear"),
html="<div class='ui-datepicker-title'>",
monthHtml="";
if(secondary||!changeMonth){
monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>";
}else{
inMinYear=(minDate&&minDate.getFullYear()===drawYear);
inMaxYear=(maxDate&&maxDate.getFullYear()===drawYear);
monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";
for(month=0;month<12;month++){
if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){
monthHtml+="<option value='"+month+"'"+
(month===drawMonth?" selected='selected'":"")+
">"+monthNamesShort[month]+"</option>";
}
}
monthHtml+="</select>";
}
if(!showMonthAfterYear){
html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"");
}
if(!inst.yearshtml){
inst.yearshtml="";
if(secondary||!changeYear){
html+="<span class='ui-datepicker-year'>"+drawYear+"</span>";
}else{
years=this._get(inst,"yearRange").split(":");
thisYear=new Date().getFullYear();
determineYear=function(value){
var year=(value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):
(value.match(/[+\-].*/)?thisYear+parseInt(value,10):
parseInt(value,10)));
return(isNaN(year)?thisYear:year);
};
year=determineYear(years[0]);
endYear=Math.max(year,determineYear(years[1]||""));
year=(minDate?Math.max(year,minDate.getFullYear()):year);
endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);
inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";
for(;year<=endYear;year++){
inst.yearshtml+="<option value='"+year+"'"+
(year===drawYear?" selected='selected'":"")+
">"+year+"</option>";
}
inst.yearshtml+="</select>";
html+=inst.yearshtml;
inst.yearshtml=null;
}
}
html+=this._get(inst,"yearSuffix");
if(showMonthAfterYear){
html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml;
}
html+="</div>";return html;
},

_adjustInstDate:function(inst,offset,period){
var year=inst.drawYear+(period==="Y"?offset:0),
month=inst.drawMonth+(period==="M"?offset:0),
day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period==="D"?offset:0),
date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));
inst.selectedDay=date.getDate();
inst.drawMonth=inst.selectedMonth=date.getMonth();
inst.drawYear=inst.selectedYear=date.getFullYear();
if(period==="M"||period==="Y"){
this._notifyChange(inst);
}
},

_restrictMinMax:function(inst,date){
var minDate=this._getMinMaxDate(inst,"min"),
maxDate=this._getMinMaxDate(inst,"max"),
newDate=(minDate&&date<minDate?minDate:date);
return(maxDate&&newDate>maxDate?maxDate:newDate);
},

_notifyChange:function(inst){
var onChange=this._get(inst,"onChangeMonthYear");
if(onChange){
onChange.apply((inst.input?inst.input[0]:null),
[inst.selectedYear,inst.selectedMonth+1,inst]);
}
},

_getNumberOfMonths:function(inst){
var numMonths=this._get(inst,"numberOfMonths");
return(numMonths==null?[1,1]:(typeof numMonths==="number"?[1,numMonths]:numMonths));
},

_getMinMaxDate:function(inst,minMax){
return this._determineDate(inst,this._get(inst,minMax+"Date"),null);
},

_getDaysInMonth:function(year,month){
return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate();
},

_getFirstDayOfMonth:function(year,month){
return new Date(year,month,1).getDay();
},

_canAdjustMonth:function(inst,offset,curYear,curMonth){
var numMonths=this._getNumberOfMonths(inst),
date=this._daylightSavingAdjust(new Date(curYear,
curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));
if(offset<0){
date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()));
}
return this._isInRange(inst,date);
},

_isInRange:function(inst,date){
var yearSplit,currentYear,
minDate=this._getMinMaxDate(inst,"min"),
maxDate=this._getMinMaxDate(inst,"max"),
minYear=null,
maxYear=null,
years=this._get(inst,"yearRange");
if(years){
yearSplit=years.split(":");
currentYear=new Date().getFullYear();
minYear=parseInt(yearSplit[0],10);
maxYear=parseInt(yearSplit[1],10);
if(yearSplit[0].match(/[+\-].*/)){
minYear+=currentYear;
}
if(yearSplit[1].match(/[+\-].*/)){
maxYear+=currentYear;
}
}
return((!minDate||date.getTime()>=minDate.getTime())&&
(!maxDate||date.getTime()<=maxDate.getTime())&&
(!minYear||date.getFullYear()>=minYear)&&
(!maxYear||date.getFullYear()<=maxYear));
},

_getFormatConfig:function(inst){
var shortYearCutoff=this._get(inst,"shortYearCutoff");
shortYearCutoff=(typeof shortYearCutoff!=="string"?shortYearCutoff:
new Date().getFullYear()%100+parseInt(shortYearCutoff,10));
return{shortYearCutoff:shortYearCutoff,
dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),
monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")};
},

_formatDate:function(inst,day,month,year){
if(!day){
inst.currentDay=inst.selectedDay;
inst.currentMonth=inst.selectedMonth;
inst.currentYear=inst.selectedYear;
}
var date=(day?(typeof day==="object"?day:
this._daylightSavingAdjust(new Date(year,month,day))):
this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));
return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst));
}
});

function bindHover(dpDiv){
var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";
return dpDiv.delegate(selector,"mouseout",function(){
$(this).removeClass("ui-state-hover");
if(this.className.indexOf("ui-datepicker-prev")!==-1){
$(this).removeClass("ui-datepicker-prev-hover");
}
if(this.className.indexOf("ui-datepicker-next")!==-1){
$(this).removeClass("ui-datepicker-next-hover");
}
})
.delegate(selector,"mouseover",function(){
if(!$.datepicker._isDisabledDatepicker(instActive.inline?dpDiv.parent()[0]:instActive.input[0])){
$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");
$(this).addClass("ui-state-hover");
if(this.className.indexOf("ui-datepicker-prev")!==-1){
$(this).addClass("ui-datepicker-prev-hover");
}
if(this.className.indexOf("ui-datepicker-next")!==-1){
$(this).addClass("ui-datepicker-next-hover");
}
}
});
}

function extendRemove(target,props){
$.extend(target,props);
for(var name in props){
if(props[name]==null){
target[name]=props[name];
}
}
return target;
}

$.fn.datepicker=function(options){

if(!this.length){
return this;
}

if(!$.datepicker.initialized){
$(document).mousedown($.datepicker._checkExternalClick);
$.datepicker.initialized=true;
}

if($("#"+$.datepicker._mainDivId).length===0){
$("body").append($.datepicker.dpDiv);
}
var otherArgs=Array.prototype.slice.call(arguments,1);
if(typeof options==="string"&&(options==="isDisabled"||options==="getDate"||options==="widget")){
return $.datepicker["_"+options+"Datepicker"].
apply($.datepicker,[this[0]].concat(otherArgs));
}
if(options==="option"&&arguments.length===2&&typeof arguments[1]==="string"){
return $.datepicker["_"+options+"Datepicker"].
apply($.datepicker,[this[0]].concat(otherArgs));
}
return this.each(function(){
typeof options==="string"?
$.datepicker["_"+options+"Datepicker"].
apply($.datepicker,[this].concat(otherArgs)):
$.datepicker._attachDatepicker(this,options);
});
};
$.datepicker=new Datepicker();$.datepicker.initialized=false;
$.datepicker.uuid=new Date().getTime();
$.datepicker.version="1.10.4";
})(jQuery);
(function($,undefined){
var sizeRelatedOptions={
buttons:true,
height:true,
maxHeight:true,
maxWidth:true,
minHeight:true,
minWidth:true,
width:true
},
resizableRelatedOptions={
maxHeight:true,
maxWidth:true,
minHeight:true,
minWidth:true
};
$.widget("ui.dialog",{
version:"1.10.4",
options:{
appendTo:"body",
autoOpen:true,
buttons:[],
closeOnEscape:true,
closeText:"close",
dialogClass:"",
draggable:true,
hide:null,
height:"auto",
maxHeight:null,
maxWidth:null,
minHeight:150,
minWidth:150,
modal:false,
position:{
my:"center",
at:"center",
of:window,
collision:"fit",
using:function(pos){
var topOffset=$(this).css(pos).offset().top;
if(topOffset<0){
$(this).css("top",pos.top-topOffset);
}
}
},
resizable:true,
show:null,
title:null,
width:300,
beforeClose:null,
close:null,
drag:null,
dragStart:null,
dragStop:null,
focus:null,
open:null,
resize:null,
resizeStart:null,
resizeStop:null
},
_create:function(){
this.originalCss={
display:this.element[0].style.display,
width:this.element[0].style.width,
minHeight:this.element[0].style.minHeight,
maxHeight:this.element[0].style.maxHeight,
height:this.element[0].style.height
};
this.originalPosition={
parent:this.element.parent(),
index:this.element.parent().children().index(this.element)
};
this.originalTitle=this.element.attr("title");
this.options.title=this.options.title||this.originalTitle;
this._createWrapper();
this.element
.show()
.removeAttr("title")
.addClass("ui-dialog-content ui-widget-content")
.appendTo(this.uiDialog);
this._createTitlebar();
this._createButtonPane();
if(this.options.draggable&&$.fn.draggable){
this._makeDraggable();
}
if(this.options.resizable&&$.fn.resizable){
this._makeResizable();
}
this._isOpen=false;
},
_init:function(){
if(this.options.autoOpen){
this.open();
}
},
_appendTo:function(){
var element=this.options.appendTo;
if(element&&(element.jquery||element.nodeType)){
return $(element);
}
return this.document.find(element||"body").eq(0);
},
_destroy:function(){
var next,
originalPosition=this.originalPosition;
this._destroyOverlay();
this.element
.removeUniqueId()
.removeClass("ui-dialog-content ui-widget-content")
.css(this.originalCss)
.detach();
this.uiDialog.stop(true,true).remove();
if(this.originalTitle){
this.element.attr("title",this.originalTitle);
}
next=originalPosition.parent.children().eq(originalPosition.index);
if(next.length&&next[0]!==this.element[0]){
next.before(this.element);
}else{
originalPosition.parent.append(this.element);
}
},
widget:function(){
return this.uiDialog;
},
disable:$.noop,
enable:$.noop,
close:function(event){
var activeElement,
that=this;
if(!this._isOpen||this._trigger("beforeClose",event)===false){
return;
}
this._isOpen=false;
this._destroyOverlay();
if(!this.opener.filter(":focusable").focus().length){
try{
activeElement=this.document[0].activeElement;
if(activeElement&&activeElement.nodeName.toLowerCase()!=="body"){
$(activeElement).blur();
}
}catch(error){}
}
this._hide(this.uiDialog,this.options.hide,function(){
that._trigger("close",event);
});
},
isOpen:function(){
return this._isOpen;
},
moveToTop:function(){
this._moveToTop();
},
_moveToTop:function(event,silent){
var moved=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;
if(moved&&!silent){
this._trigger("focus",event);
}
return moved;
},
open:function(){
var that=this;
if(this._isOpen){
if(this._moveToTop()){
this._focusTabbable();
}
return;
}
this._isOpen=true;
this.opener=$(this.document[0].activeElement);
this._size();
this._position();
this._createOverlay();
this._moveToTop(null,true);
this._show(this.uiDialog,this.options.show,function(){
that._focusTabbable();
that._trigger("focus");
});
this._trigger("open");
},
_focusTabbable:function(){
var hasFocus=this.element.find("[autofocus]");
if(!hasFocus.length){
hasFocus=this.element.find(":tabbable");
}
if(!hasFocus.length){
hasFocus=this.uiDialogButtonPane.find(":tabbable");
}
if(!hasFocus.length){
hasFocus=this.uiDialogTitlebarClose.filter(":tabbable");
}
if(!hasFocus.length){
hasFocus=this.uiDialog;
}
hasFocus.eq(0).focus();
},
_keepFocus:function(event){
function checkFocus(){
var activeElement=this.document[0].activeElement,
isActive=this.uiDialog[0]===activeElement||
$.contains(this.uiDialog[0],activeElement);
if(!isActive){
this._focusTabbable();
}
}
event.preventDefault();
checkFocus.call(this);
this._delay(checkFocus);
},
_createWrapper:function(){
this.uiDialog=$("<div>")
.addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+
this.options.dialogClass)
.hide()
.attr({
tabIndex:-1,
role:"dialog"
})
.appendTo(this._appendTo());
this._on(this.uiDialog,{
keydown:function(event){
if(this.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&
event.keyCode===$.ui.keyCode.ESCAPE){
event.preventDefault();
this.close(event);
return;
}
if(event.keyCode!==$.ui.keyCode.TAB){
return;
}
var tabbables=this.uiDialog.find(":tabbable"),
first=tabbables.filter(":first"),
last=tabbables.filter(":last");
if((event.target===last[0]||event.target===this.uiDialog[0])&&!event.shiftKey){
first.focus(1);
event.preventDefault();
}else if((event.target===first[0]||event.target===this.uiDialog[0])&&event.shiftKey){
last.focus(1);
event.preventDefault();
}
},
mousedown:function(event){
if(this._moveToTop(event)){
this._focusTabbable();
}
}
});
if(!this.element.find("[aria-describedby]").length){
this.uiDialog.attr({
"aria-describedby":this.element.uniqueId().attr("id")
});
}
},
_createTitlebar:function(){
var uiDialogTitle;
this.uiDialogTitlebar=$("<div>")
.addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix")
.prependTo(this.uiDialog);
this._on(this.uiDialogTitlebar,{
mousedown:function(event){
if(!$(event.target).closest(".ui-dialog-titlebar-close")){
this.uiDialog.focus();
}
}
});
this.uiDialogTitlebarClose=$("<button type='button'></button>")
.button({
label:this.options.closeText,
icons:{
primary:"ui-icon-closethick"
},
text:false
})
.addClass("ui-dialog-titlebar-close")
.appendTo(this.uiDialogTitlebar);
this._on(this.uiDialogTitlebarClose,{
click:function(event){
event.preventDefault();
this.close(event);
}
});
uiDialogTitle=$("<span>")
.uniqueId()
.addClass("ui-dialog-title")
.prependTo(this.uiDialogTitlebar);
this._title(uiDialogTitle);
this.uiDialog.attr({
"aria-labelledby":uiDialogTitle.attr("id")
});
},
_title:function(title){
if(!this.options.title){
title.html("&#160;");
}
title.text(this.options.title);
},
_createButtonPane:function(){
this.uiDialogButtonPane=$("<div>")
.addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");
this.uiButtonSet=$("<div>")
.addClass("ui-dialog-buttonset")
.appendTo(this.uiDialogButtonPane);
this._createButtons();
},
_createButtons:function(){
var that=this,
buttons=this.options.buttons;
this.uiDialogButtonPane.remove();
this.uiButtonSet.empty();
if($.isEmptyObject(buttons)||($.isArray(buttons)&&!buttons.length)){
this.uiDialog.removeClass("ui-dialog-buttons");
return;
}
$.each(buttons,function(name,props){
var click,buttonOptions;
props=$.isFunction(props)?
{click:props,text:name}:
props;
props=$.extend({type:"button"},props);
click=props.click;
props.click=function(){
click.apply(that.element[0],arguments);
};
buttonOptions={
icons:props.icons,
text:props.showText
};
delete props.icons;
delete props.showText;
$("<button></button>",props)
.button(buttonOptions)
.appendTo(that.uiButtonSet);
});
this.uiDialog.addClass("ui-dialog-buttons");
this.uiDialogButtonPane.appendTo(this.uiDialog);
},
_makeDraggable:function(){
var that=this,
options=this.options;
function filteredUi(ui){
return{
position:ui.position,
offset:ui.offset
};
}
this.uiDialog.draggable({
cancel:".ui-dialog-content, .ui-dialog-titlebar-close",
handle:".ui-dialog-titlebar",
containment:"document",
start:function(event,ui){
$(this).addClass("ui-dialog-dragging");
that._blockFrames();
that._trigger("dragStart",event,filteredUi(ui));
},
drag:function(event,ui){
that._trigger("drag",event,filteredUi(ui));
},
stop:function(event,ui){
options.position=[
ui.position.left-that.document.scrollLeft(),
ui.position.top-that.document.scrollTop()
];
$(this).removeClass("ui-dialog-dragging");
that._unblockFrames();
that._trigger("dragStop",event,filteredUi(ui));
}
});
},
_makeResizable:function(){
var that=this,
options=this.options,
handles=options.resizable,
position=this.uiDialog.css("position"),
resizeHandles=typeof handles==="string"?
handles:
"n,e,s,w,se,sw,ne,nw";
function filteredUi(ui){
return{
originalPosition:ui.originalPosition,
originalSize:ui.originalSize,
position:ui.position,
size:ui.size
};
}
this.uiDialog.resizable({
cancel:".ui-dialog-content",
containment:"document",
alsoResize:this.element,
maxWidth:options.maxWidth,
maxHeight:options.maxHeight,
minWidth:options.minWidth,
minHeight:this._minHeight(),
handles:resizeHandles,
start:function(event,ui){
$(this).addClass("ui-dialog-resizing");
that._blockFrames();
that._trigger("resizeStart",event,filteredUi(ui));
},
resize:function(event,ui){
that._trigger("resize",event,filteredUi(ui));
},
stop:function(event,ui){
options.height=$(this).height();
options.width=$(this).width();
$(this).removeClass("ui-dialog-resizing");
that._unblockFrames();
that._trigger("resizeStop",event,filteredUi(ui));
}
})
.css("position",position);
},
_minHeight:function(){
var options=this.options;
return options.height==="auto"?
options.minHeight:
Math.min(options.minHeight,options.height);
},
_position:function(){
var isVisible=this.uiDialog.is(":visible");
if(!isVisible){
this.uiDialog.show();
}
this.uiDialog.position(this.options.position);
if(!isVisible){
this.uiDialog.hide();
}
},
_setOptions:function(options){
var that=this,
resize=false,
resizableOptions={};
$.each(options,function(key,value){
that._setOption(key,value);
if(key in sizeRelatedOptions){
resize=true;
}
if(key in resizableRelatedOptions){
resizableOptions[key]=value;
}
});
if(resize){
this._size();
this._position();
}
if(this.uiDialog.is(":data(ui-resizable)")){
this.uiDialog.resizable("option",resizableOptions);
}
},
_setOption:function(key,value){
var isDraggable,isResizable,
uiDialog=this.uiDialog;
if(key==="dialogClass"){
uiDialog
.removeClass(this.options.dialogClass)
.addClass(value);
}
if(key==="disabled"){
return;
}
this._super(key,value);
if(key==="appendTo"){
this.uiDialog.appendTo(this._appendTo());
}
if(key==="buttons"){
this._createButtons();
}
if(key==="closeText"){
this.uiDialogTitlebarClose.button({
label:""+value
});
}
if(key==="draggable"){
isDraggable=uiDialog.is(":data(ui-draggable)");
if(isDraggable&&!value){
uiDialog.draggable("destroy");
}
if(!isDraggable&&value){
this._makeDraggable();
}
}
if(key==="position"){
this._position();
}
if(key==="resizable"){
isResizable=uiDialog.is(":data(ui-resizable)");
if(isResizable&&!value){
uiDialog.resizable("destroy");
}
if(isResizable&&typeof value==="string"){
uiDialog.resizable("option","handles",value);
}
if(!isResizable&&value!==false){
this._makeResizable();
}
}
if(key==="title"){
this._title(this.uiDialogTitlebar.find(".ui-dialog-title"));
}
},
_size:function(){
var nonContentHeight,minContentHeight,maxContentHeight,
options=this.options;
this.element.show().css({
width:"auto",
minHeight:0,
maxHeight:"none",
height:0
});
if(options.minWidth>options.width){
options.width=options.minWidth;
}
nonContentHeight=this.uiDialog.css({
height:"auto",
width:options.width
})
.outerHeight();
minContentHeight=Math.max(0,options.minHeight-nonContentHeight);
maxContentHeight=typeof options.maxHeight==="number"?
Math.max(0,options.maxHeight-nonContentHeight):
"none";
if(options.height==="auto"){
this.element.css({
minHeight:minContentHeight,
maxHeight:maxContentHeight,
height:"auto"
});
}else{
this.element.height(Math.max(0,options.height-nonContentHeight));
}
if(this.uiDialog.is(":data(ui-resizable)")){
this.uiDialog.resizable("option","minHeight",this._minHeight());
}
},
_blockFrames:function(){
this.iframeBlocks=this.document.find("iframe").map(function(){
var iframe=$(this);
return $("<div>")
.css({
position:"absolute",
width:iframe.outerWidth(),
height:iframe.outerHeight()
})
.appendTo(iframe.parent())
.offset(iframe.offset())[0];
});
},
_unblockFrames:function(){
if(this.iframeBlocks){
this.iframeBlocks.remove();
delete this.iframeBlocks;
}
},
_allowInteraction:function(event){
if($(event.target).closest(".ui-dialog").length){
return true;
}
return!!$(event.target).closest(".ui-datepicker").length;
},
_createOverlay:function(){
if(!this.options.modal){
return;
}
var that=this,
widgetFullName=this.widgetFullName;
if(!$.ui.dialog.overlayInstances){
this._delay(function(){
if($.ui.dialog.overlayInstances){
this.document.bind("focusin.dialog",function(event){
if(!that._allowInteraction(event)){
event.preventDefault();
$(".ui-dialog:visible:last .ui-dialog-content")
.data(widgetFullName)._focusTabbable();
}
});
}
});
}
this.overlay=$("<div>")
.addClass("ui-widget-overlay ui-front")
.appendTo(this._appendTo());
this._on(this.overlay,{
mousedown:"_keepFocus"
});
$.ui.dialog.overlayInstances++;
},
_destroyOverlay:function(){
if(!this.options.modal){
return;
}
if(this.overlay){
$.ui.dialog.overlayInstances--;
if(!$.ui.dialog.overlayInstances){
this.document.unbind("focusin.dialog");
}
this.overlay.remove();
this.overlay=null;
}
}
});
$.ui.dialog.overlayInstances=0;
if($.uiBackCompat!==false){
$.widget("ui.dialog",$.ui.dialog,{
_position:function(){
var position=this.options.position,
myAt=[],
offset=[0,0],
isVisible;
if(position){
if(typeof position==="string"||(typeof position==="object"&&"0"in position)){
myAt=position.split?position.split(" "):[position[0],position[1]];
if(myAt.length===1){
myAt[1]=myAt[0];
}
$.each(["left","top"],function(i,offsetPosition){
if(+myAt[i]===myAt[i]){
offset[i]=myAt[i];
myAt[i]=offsetPosition;
}
});
position={
my:myAt[0]+(offset[0]<0?offset[0]:"+"+offset[0])+" "+
myAt[1]+(offset[1]<0?offset[1]:"+"+offset[1]),
at:myAt.join(" ")
};
}
position=$.extend({},$.ui.dialog.prototype.options.position,position);
}else{
position=$.ui.dialog.prototype.options.position;
}
isVisible=this.uiDialog.is(":visible");
if(!isVisible){
this.uiDialog.show();
}
this.uiDialog.position(position);
if(!isVisible){
this.uiDialog.hide();
}
}
});
}
}(jQuery));
(function($,undefined){
$.widget("ui.draggable",$.ui.mouse,{
version:"1.10.4",
widgetEventPrefix:"drag",
options:{
addClasses:true,
appendTo:"parent",
axis:false,
connectToSortable:false,
containment:false,
cursor:"auto",
cursorAt:false,
grid:false,
handle:false,
helper:"original",
iframeFix:false,
opacity:false,
refreshPositions:false,
revert:false,
revertDuration:500,
scope:"default",
scroll:true,
scrollSensitivity:20,
scrollSpeed:20,
snap:false,
snapMode:"both",
snapTolerance:20,
stack:false,
zIndex:false,
drag:null,
start:null,
stop:null
},
_create:function(){
if(this.options.helper==="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){
this.element[0].style.position="relative";
}
if(this.options.addClasses){
this.element.addClass("ui-draggable");
}
if(this.options.disabled){
this.element.addClass("ui-draggable-disabled");
}
this._mouseInit();
},
_destroy:function(){
this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");
this._mouseDestroy();
},
_mouseCapture:function(event){
var o=this.options;
if(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0){
return false;
}
this.handle=this._getHandle(event);
if(!this.handle){
return false;
}
$(o.iframeFix===true?"iframe":o.iframeFix).each(function(){
$("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>")
.css({
width:this.offsetWidth+"px",height:this.offsetHeight+"px",
position:"absolute",opacity:"0.001",zIndex:1000
})
.css($(this).offset())
.appendTo("body");
});
return true;
},
_mouseStart:function(event){
var o=this.options;
this.helper=this._createHelper(event);
this.helper.addClass("ui-draggable-dragging");
this._cacheHelperProportions();
if($.ui.ddmanager){
$.ui.ddmanager.current=this;
}

this._cacheMargins();
this.cssPosition=this.helper.css("position");
this.scrollParent=this.helper.scrollParent();
this.offsetParent=this.helper.offsetParent();
this.offsetParentCssPosition=this.offsetParent.css("position");
this.offset=this.positionAbs=this.element.offset();
this.offset={
top:this.offset.top-this.margins.top,
left:this.offset.left-this.margins.left
};
this.offset.scroll=false;
$.extend(this.offset,{
click:{left:event.pageX-this.offset.left,
top:event.pageY-this.offset.top
},
parent:this._getParentOffset(),
relative:this._getRelativeOffset()});
this.originalPosition=this.position=this._generatePosition(event);
this.originalPageX=event.pageX;
this.originalPageY=event.pageY;
(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));
this._setContainment();
if(this._trigger("start",event)===false){
this._clear();
return false;
}
this._cacheHelperProportions();
if($.ui.ddmanager&&!o.dropBehaviour){
$.ui.ddmanager.prepareOffsets(this,event);
}
this._mouseDrag(event,true);if($.ui.ddmanager){
$.ui.ddmanager.dragStart(this,event);
}
return true;
},
_mouseDrag:function(event,noPropagation){
if(this.offsetParentCssPosition==="fixed"){
this.offset.parent=this._getParentOffset();
}
this.position=this._generatePosition(event);
this.positionAbs=this._convertPositionTo("absolute");
if(!noPropagation){
var ui=this._uiHash();
if(this._trigger("drag",event,ui)===false){
this._mouseUp({});
return false;
}
this.position=ui.position;
}
if(!this.options.axis||this.options.axis!=="y"){
this.helper[0].style.left=this.position.left+"px";
}
if(!this.options.axis||this.options.axis!=="x"){
this.helper[0].style.top=this.position.top+"px";
}
if($.ui.ddmanager){
$.ui.ddmanager.drag(this,event);
}
return false;
},
_mouseStop:function(event){
var that=this,
dropped=false;
if($.ui.ddmanager&&!this.options.dropBehaviour){
dropped=$.ui.ddmanager.drop(this,event);
}
if(this.dropped){
dropped=this.dropped;
this.dropped=false;
}
if(this.options.helper==="original"&&!$.contains(this.element[0].ownerDocument,this.element[0])){
return false;
}
if((this.options.revert==="invalid"&&!dropped)||(this.options.revert==="valid"&&dropped)||this.options.revert===true||($.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped))){
$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){
if(that._trigger("stop",event)!==false){
that._clear();
}
});
}else{
if(this._trigger("stop",event)!==false){
this._clear();
}
}
return false;
},
_mouseUp:function(event){
$("div.ui-draggable-iframeFix").each(function(){
this.parentNode.removeChild(this);
});
if($.ui.ddmanager){
$.ui.ddmanager.dragStop(this,event);
}
return $.ui.mouse.prototype._mouseUp.call(this,event);
},
cancel:function(){
if(this.helper.is(".ui-draggable-dragging")){
this._mouseUp({});
}else{
this._clear();
}
return this;
},
_getHandle:function(event){
return this.options.handle?
!!$(event.target).closest(this.element.find(this.options.handle)).length:
true;
},
_createHelper:function(event){
var o=this.options,
helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event])):(o.helper==="clone"?this.element.clone().removeAttr("id"):this.element);
if(!helper.parents("body").length){
helper.appendTo((o.appendTo==="parent"?this.element[0].parentNode:o.appendTo));
}
if(helper[0]!==this.element[0]&&!(/(fixed|absolute)/).test(helper.css("position"))){
helper.css("position","absolute");
}
return helper;
},
_adjustOffsetFromHelper:function(obj){
if(typeof obj==="string"){
obj=obj.split(" ");
}
if($.isArray(obj)){
obj={left:+obj[0],top:+obj[1]||0};
}
if("left"in obj){
this.offset.click.left=obj.left+this.margins.left;
}
if("right"in obj){
this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;
}
if("top"in obj){
this.offset.click.top=obj.top+this.margins.top;
}
if("bottom"in obj){
this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;
}
},
_getParentOffset:function(){
var po=this.offsetParent.offset();
if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){
po.left+=this.scrollParent.scrollLeft();
po.top+=this.scrollParent.scrollTop();
}
if((this.offsetParent[0]===document.body)||
(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){
po={top:0,left:0};
}
return{
top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),
left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)
};
},
_getRelativeOffset:function(){
if(this.cssPosition==="relative"){
var p=this.element.position();
return{
top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),
left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()
};
}else{
return{top:0,left:0};
}
},
_cacheMargins:function(){
this.margins={
left:(parseInt(this.element.css("marginLeft"),10)||0),
top:(parseInt(this.element.css("marginTop"),10)||0),
right:(parseInt(this.element.css("marginRight"),10)||0),
bottom:(parseInt(this.element.css("marginBottom"),10)||0)
};
},
_cacheHelperProportions:function(){
this.helperProportions={
width:this.helper.outerWidth(),
height:this.helper.outerHeight()
};
},
_setContainment:function(){
var over,c,ce,
o=this.options;
if(!o.containment){
this.containment=null;
return;
}
if(o.containment==="window"){
this.containment=[
$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,
$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,
$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,
$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top
];
return;
}
if(o.containment==="document"){
this.containment=[
0,
0,
$(document).width()-this.helperProportions.width-this.margins.left,
($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top
];
return;
}
if(o.containment.constructor===Array){
this.containment=o.containment;
return;
}
if(o.containment==="parent"){
o.containment=this.helper[0].parentNode;
}
c=$(o.containment);
ce=c[0];
if(!ce){
return;
}
over=c.css("overflow")!=="hidden";
this.containment=[
(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),
(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),
(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,
(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom
];
this.relative_container=c;
},
_convertPositionTo:function(d,pos){
if(!pos){
pos=this.position;
}
var mod=d==="absolute"?1:-1,
scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent;
if(!this.offset.scroll){
this.offset.scroll={top:scroll.scrollTop(),left:scroll.scrollLeft()};
}
return{
top:(
pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)*mod)
),
left:(
pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)*mod)
)
};
},
_generatePosition:function(event){
var containment,co,top,left,
o=this.options,
scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,
pageX=event.pageX,
pageY=event.pageY;
if(!this.offset.scroll){
this.offset.scroll={top:scroll.scrollTop(),left:scroll.scrollLeft()};
}

if(this.originalPosition){
if(this.containment){
if(this.relative_container){
co=this.relative_container.offset();
containment=[
this.containment[0]+co.left,
this.containment[1]+co.top,
this.containment[2]+co.left,
this.containment[3]+co.top
];
}
else{
containment=this.containment;
}
if(event.pageX-this.offset.click.left<containment[0]){
pageX=containment[0]+this.offset.click.left;
}
if(event.pageY-this.offset.click.top<containment[1]){
pageY=containment[1]+this.offset.click.top;
}
if(event.pageX-this.offset.click.left>containment[2]){
pageX=containment[2]+this.offset.click.left;
}
if(event.pageY-this.offset.click.top>containment[3]){
pageY=containment[3]+this.offset.click.top;
}
}
if(o.grid){
top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;
pageY=containment?((top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3])?top:((top-this.offset.click.top>=containment[1])?top-o.grid[1]:top+o.grid[1])):top;
left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;
pageX=containment?((left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2])?left:((left-this.offset.click.left>=containment[0])?left-o.grid[0]:left+o.grid[0])):left;
}
}
return{
top:(
pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)
),
left:(
pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)
)
};
},
_clear:function(){
this.helper.removeClass("ui-draggable-dragging");
if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){
this.helper.remove();
}
this.helper=null;
this.cancelHelperRemoval=false;
},
_trigger:function(type,event,ui){
ui=ui||this._uiHash();
$.ui.plugin.call(this,type,[event,ui]);
if(type==="drag"){
this.positionAbs=this._convertPositionTo("absolute");
}
return $.Widget.prototype._trigger.call(this,type,event,ui);
},
plugins:{},
_uiHash:function(){
return{
helper:this.helper,
position:this.position,
originalPosition:this.originalPosition,
offset:this.positionAbs
};
}
});
$.ui.plugin.add("draggable","connectToSortable",{
start:function(event,ui){
var inst=$(this).data("ui-draggable"),o=inst.options,
uiSortable=$.extend({},ui,{item:inst.element});
inst.sortables=[];
$(o.connectToSortable).each(function(){
var sortable=$.data(this,"ui-sortable");
if(sortable&&!sortable.options.disabled){
inst.sortables.push({
instance:sortable,
shouldRevert:sortable.options.revert
});
sortable.refreshPositions();sortable._trigger("activate",event,uiSortable);
}
});
},
stop:function(event,ui){
var inst=$(this).data("ui-draggable"),
uiSortable=$.extend({},ui,{item:inst.element});
$.each(inst.sortables,function(){
if(this.instance.isOver){
this.instance.isOver=0;
inst.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){
this.instance.options.revert=this.shouldRevert;
}
this.instance._mouseStop(event);
this.instance.options.helper=this.instance.options._helper;
if(inst.options.helper==="original"){
this.instance.currentItem.css({top:"auto",left:"auto"});
}
}else{
this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",event,uiSortable);
}
});
},
drag:function(event,ui){
var inst=$(this).data("ui-draggable"),that=this;
$.each(inst.sortables,function(){
var innermostIntersecting=false,
thisSortable=this;
this.instance.positionAbs=inst.positionAbs;
this.instance.helperProportions=inst.helperProportions;
this.instance.offset.click=inst.offset.click;
if(this.instance._intersectsWith(this.instance.containerCache)){
innermostIntersecting=true;
$.each(inst.sortables,function(){
this.instance.positionAbs=inst.positionAbs;
this.instance.helperProportions=inst.helperProportions;
this.instance.offset.click=inst.offset.click;
if(this!==thisSortable&&
this.instance._intersectsWith(this.instance.containerCache)&&
$.contains(thisSortable.instance.element[0],this.instance.element[0])
){
innermostIntersecting=false;
}
return innermostIntersecting;
});
}
if(innermostIntersecting){
if(!this.instance.isOver){
this.instance.isOver=1;
this.instance.currentItem=$(that).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",true);
this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return ui.helper[0]};
event.target=this.instance.currentItem[0];
this.instance._mouseCapture(event,true);
this.instance._mouseStart(event,true,true);
this.instance.offset.click.top=inst.offset.click.top;
this.instance.offset.click.left=inst.offset.click.left;
this.instance.offset.parent.left-=inst.offset.parent.left-this.instance.offset.parent.left;
this.instance.offset.parent.top-=inst.offset.parent.top-this.instance.offset.parent.top;
inst._trigger("toSortable",event);
inst.dropped=this.instance.element;inst.currentItem=inst.element;
this.instance.fromOutside=inst;
}
if(this.instance.currentItem){
this.instance._mouseDrag(event);
}
}else{
if(this.instance.isOver){
this.instance.isOver=0;
this.instance.cancelHelperRemoval=true;
this.instance.options.revert=false;
this.instance._trigger("out",event,this.instance._uiHash(this.instance));
this.instance._mouseStop(event,true);
this.instance.options.helper=this.instance.options._helper;
this.instance.currentItem.remove();
if(this.instance.placeholder){
this.instance.placeholder.remove();
}
inst._trigger("fromSortable",event);
inst.dropped=false}
}
});
}
});
$.ui.plugin.add("draggable","cursor",{
start:function(){
var t=$("body"),o=$(this).data("ui-draggable").options;
if(t.css("cursor")){
o._cursor=t.css("cursor");
}
t.css("cursor",o.cursor);
},
stop:function(){
var o=$(this).data("ui-draggable").options;
if(o._cursor){
$("body").css("cursor",o._cursor);
}
}
});
$.ui.plugin.add("draggable","opacity",{
start:function(event,ui){
var t=$(ui.helper),o=$(this).data("ui-draggable").options;
if(t.css("opacity")){
o._opacity=t.css("opacity");
}
t.css("opacity",o.opacity);
},
stop:function(event,ui){
var o=$(this).data("ui-draggable").options;
if(o._opacity){
$(ui.helper).css("opacity",o._opacity);
}
}
});
$.ui.plugin.add("draggable","scroll",{
start:function(){
var i=$(this).data("ui-draggable");
if(i.scrollParent[0]!==document&&i.scrollParent[0].tagName!=="HTML"){
i.overflowOffset=i.scrollParent.offset();
}
},
drag:function(event){
var i=$(this).data("ui-draggable"),o=i.options,scrolled=false;
if(i.scrollParent[0]!==document&&i.scrollParent[0].tagName!=="HTML"){
if(!o.axis||o.axis!=="x"){
if((i.overflowOffset.top+i.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){
i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop+o.scrollSpeed;
}else if(event.pageY-i.overflowOffset.top<o.scrollSensitivity){
i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop-o.scrollSpeed;
}
}
if(!o.axis||o.axis!=="y"){
if((i.overflowOffset.left+i.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){
i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft+o.scrollSpeed;
}else if(event.pageX-i.overflowOffset.left<o.scrollSensitivity){
i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft-o.scrollSpeed;
}
}
}else{
if(!o.axis||o.axis!=="x"){
if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){
scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);
}else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){
scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);
}
}
if(!o.axis||o.axis!=="y"){
if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){
scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);
}else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){
scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);
}
}
}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){
$.ui.ddmanager.prepareOffsets(i,event);
}
}
});
$.ui.plugin.add("draggable","snap",{
start:function(){
var i=$(this).data("ui-draggable"),
o=i.options;
i.snapElements=[];
$(o.snap.constructor!==String?(o.snap.items||":data(ui-draggable)"):o.snap).each(function(){
var $t=$(this),
$o=$t.offset();
if(this!==i.element[0]){
i.snapElements.push({
item:this,
width:$t.outerWidth(),height:$t.outerHeight(),
top:$o.top,left:$o.left
});
}
});
},
drag:function(event,ui){
var ts,bs,ls,rs,l,r,t,b,i,first,
inst=$(this).data("ui-draggable"),
o=inst.options,
d=o.snapTolerance,
x1=ui.offset.left,x2=x1+inst.helperProportions.width,
y1=ui.offset.top,y2=y1+inst.helperProportions.height;
for(i=inst.snapElements.length-1;i>=0;i--){
l=inst.snapElements[i].left;
r=l+inst.snapElements[i].width;
t=inst.snapElements[i].top;
b=t+inst.snapElements[i].height;
if(x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)){
if(inst.snapElements[i].snapping){
(inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));
}
inst.snapElements[i].snapping=false;
continue;
}
if(o.snapMode!=="inner"){
ts=Math.abs(t-y2)<=d;
bs=Math.abs(b-y1)<=d;
ls=Math.abs(l-x2)<=d;
rs=Math.abs(r-x1)<=d;
if(ts){
ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top-inst.margins.top;
}
if(bs){
ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top-inst.margins.top;
}
if(ls){
ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left-inst.margins.left;
}
if(rs){
ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left-inst.margins.left;
}
}
first=(ts||bs||ls||rs);
if(o.snapMode!=="outer"){
ts=Math.abs(t-y1)<=d;
bs=Math.abs(b-y2)<=d;
ls=Math.abs(l-x1)<=d;
rs=Math.abs(r-x2)<=d;
if(ts){
ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top-inst.margins.top;
}
if(bs){
ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top-inst.margins.top;
}
if(ls){
ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left-inst.margins.left;
}
if(rs){
ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left-inst.margins.left;
}
}
if(!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)){
(inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));
}
inst.snapElements[i].snapping=(ts||bs||ls||rs||first);
}
}
});
$.ui.plugin.add("draggable","stack",{
start:function(){
var min,
o=this.data("ui-draggable").options,
group=$.makeArray($(o.stack)).sort(function(a,b){
return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0);
});
if(!group.length){return}
min=parseInt($(group[0]).css("zIndex"),10)||0;
$(group).each(function(i){
$(this).css("zIndex",min+i);
});
this.css("zIndex",(min+group.length));
}
});
$.ui.plugin.add("draggable","zIndex",{
start:function(event,ui){
var t=$(ui.helper),o=$(this).data("ui-draggable").options;
if(t.css("zIndex")){
o._zIndex=t.css("zIndex");
}
t.css("zIndex",o.zIndex);
},
stop:function(event,ui){
var o=$(this).data("ui-draggable").options;
if(o._zIndex){
$(ui.helper).css("zIndex",o._zIndex);
}
}
});
})(jQuery);
(function($,undefined){
function isOverAxis(x,reference,size){
return(x>reference)&&(x<(reference+size));
}
$.widget("ui.droppable",{
version:"1.10.4",
widgetEventPrefix:"drop",
options:{
accept:"*",
activeClass:false,
addClasses:true,
greedy:false,
hoverClass:false,
scope:"default",
tolerance:"intersect",
activate:null,
deactivate:null,
drop:null,
out:null,
over:null
},
_create:function(){
var proportions,
o=this.options,
accept=o.accept;
this.isover=false;
this.isout=true;
this.accept=$.isFunction(accept)?accept:function(d){
return d.is(accept);
};
this.proportions=function(){
if(arguments.length){
proportions=arguments[0];
}else{
return proportions?
proportions:
proportions={
width:this.element[0].offsetWidth,
height:this.element[0].offsetHeight
};
}
};
$.ui.ddmanager.droppables[o.scope]=$.ui.ddmanager.droppables[o.scope]||[];
$.ui.ddmanager.droppables[o.scope].push(this);
(o.addClasses&&this.element.addClass("ui-droppable"));
},
_destroy:function(){
var i=0,
drop=$.ui.ddmanager.droppables[this.options.scope];
for(;i<drop.length;i++){
if(drop[i]===this){
drop.splice(i,1);
}
}
this.element.removeClass("ui-droppable ui-droppable-disabled");
},
_setOption:function(key,value){
if(key==="accept"){
this.accept=$.isFunction(value)?value:function(d){
return d.is(value);
};
}
$.Widget.prototype._setOption.apply(this,arguments);
},
_activate:function(event){
var draggable=$.ui.ddmanager.current;
if(this.options.activeClass){
this.element.addClass(this.options.activeClass);
}
if(draggable){
this._trigger("activate",event,this.ui(draggable));
}
},
_deactivate:function(event){
var draggable=$.ui.ddmanager.current;
if(this.options.activeClass){
this.element.removeClass(this.options.activeClass);
}
if(draggable){
this._trigger("deactivate",event,this.ui(draggable));
}
},
_over:function(event){
var draggable=$.ui.ddmanager.current;
if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){
return;
}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){
if(this.options.hoverClass){
this.element.addClass(this.options.hoverClass);
}
this._trigger("over",event,this.ui(draggable));
}
},
_out:function(event){
var draggable=$.ui.ddmanager.current;
if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){
return;
}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){
if(this.options.hoverClass){
this.element.removeClass(this.options.hoverClass);
}
this._trigger("out",event,this.ui(draggable));
}
},
_drop:function(event,custom){
var draggable=custom||$.ui.ddmanager.current,
childrenIntersection=false;
if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){
return false;
}
this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){
var inst=$.data(this,"ui-droppable");
if(
inst.options.greedy&&
!inst.options.disabled&&
inst.options.scope===draggable.options.scope&&
inst.accept.call(inst.element[0],(draggable.currentItem||draggable.element))&&
$.ui.intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance)
){childrenIntersection=true;return false}
});
if(childrenIntersection){
return false;
}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){
if(this.options.activeClass){
this.element.removeClass(this.options.activeClass);
}
if(this.options.hoverClass){
this.element.removeClass(this.options.hoverClass);
}
this._trigger("drop",event,this.ui(draggable));
return this.element;
}
return false;
},
ui:function(c){
return{
draggable:(c.currentItem||c.element),
helper:c.helper,
position:c.position,
offset:c.positionAbs
};
}
});
$.ui.intersect=function(draggable,droppable,toleranceMode){
if(!droppable.offset){
return false;
}
var draggableLeft,draggableTop,
x1=(draggable.positionAbs||draggable.position.absolute).left,
y1=(draggable.positionAbs||draggable.position.absolute).top,
x2=x1+draggable.helperProportions.width,
y2=y1+draggable.helperProportions.height,
l=droppable.offset.left,
t=droppable.offset.top,
r=l+droppable.proportions().width,
b=t+droppable.proportions().height;
switch(toleranceMode){
case"fit":
return(l<=x1&&x2<=r&&t<=y1&&y2<=b);
case"intersect":
return(l<x1+(draggable.helperProportions.width/2)&&x2-(draggable.helperProportions.width/2)<r&&t<y1+(draggable.helperProportions.height/2)&&y2-(draggable.helperProportions.height/2)<b);case"pointer":
draggableLeft=((draggable.positionAbs||draggable.position.absolute).left+(draggable.clickOffset||draggable.offset.click).left);
draggableTop=((draggable.positionAbs||draggable.position.absolute).top+(draggable.clickOffset||draggable.offset.click).top);
return isOverAxis(draggableTop,t,droppable.proportions().height)&&isOverAxis(draggableLeft,l,droppable.proportions().width);
case"touch":
return(
(y1>=t&&y1<=b)||(y2>=t&&y2<=b)||(y1<t&&y2>b))&&(
(x1>=l&&x1<=r)||(x2>=l&&x2<=r)||(x1<l&&x2>r));
default:
return false;
}
};

$.ui.ddmanager={
current:null,
droppables:{"default":[]},
prepareOffsets:function(t,event){
var i,j,
m=$.ui.ddmanager.droppables[t.options.scope]||[],
type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();
droppablesLoop:for(i=0;i<m.length;i++){
if(m[i].options.disabled||(t&&!m[i].accept.call(m[i].element[0],(t.currentItem||t.element)))){
continue;
}
for(j=0;j<list.length;j++){
if(list[j]===m[i].element[0]){
m[i].proportions().height=0;
continue droppablesLoop;
}
}
m[i].visible=m[i].element.css("display")!=="none";
if(!m[i].visible){
continue;
}
if(type==="mousedown"){
m[i]._activate.call(m[i],event);
}
m[i].offset=m[i].element.offset();
m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight});
}
},
drop:function(draggable,event){
var dropped=false;
$.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){
if(!this.options){
return;
}
if(!this.options.disabled&&this.visible&&$.ui.intersect(draggable,this,this.options.tolerance)){
dropped=this._drop.call(this,event)||dropped;
}
if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){
this.isout=true;
this.isover=false;
this._deactivate.call(this,event);
}
});
return dropped;
},
dragStart:function(draggable,event){
draggable.element.parentsUntil("body").bind("scroll.droppable",function(){
if(!draggable.options.refreshPositions){
$.ui.ddmanager.prepareOffsets(draggable,event);
}
});
},
drag:function(draggable,event){
if(draggable.options.refreshPositions){
$.ui.ddmanager.prepareOffsets(draggable,event);
}
$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){
if(this.options.disabled||this.greedyChild||!this.visible){
return;
}
var parentInstance,scope,parent,
intersects=$.ui.intersect(draggable,this,this.options.tolerance),
c=!intersects&&this.isover?"isout":(intersects&&!this.isover?"isover":null);
if(!c){
return;
}
if(this.options.greedy){
scope=this.options.scope;
parent=this.element.parents(":data(ui-droppable)").filter(function(){
return $.data(this,"ui-droppable").options.scope===scope;
});
if(parent.length){
parentInstance=$.data(parent[0],"ui-droppable");
parentInstance.greedyChild=(c==="isover");
}
}
if(parentInstance&&c==="isover"){
parentInstance.isover=false;
parentInstance.isout=true;
parentInstance._out.call(parentInstance,event);
}
this[c]=true;
this[c==="isout"?"isover":"isout"]=false;
this[c==="isover"?"_over":"_out"].call(this,event);
if(parentInstance&&c==="isout"){
parentInstance.isout=false;
parentInstance.isover=true;
parentInstance._over.call(parentInstance,event);
}
});
},
dragStop:function(draggable,event){
draggable.element.parentsUntil("body").unbind("scroll.droppable");
if(!draggable.options.refreshPositions){
$.ui.ddmanager.prepareOffsets(draggable,event);
}
}
};
})(jQuery);
(function($,undefined){
var dataSpace="ui-effects-";
$.effects={
effect:{}
};

(function(jQuery,undefined){
var stepHooks="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",
rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,
stringParsers=[{
re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
parse:function(execResult){
return[
execResult[1],
execResult[2],
execResult[3],
execResult[4]
];
}
},{
re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
parse:function(execResult){
return[
execResult[1]*2.55,
execResult[2]*2.55,
execResult[3]*2.55,
execResult[4]
];
}
},{
re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,
parse:function(execResult){
return[
parseInt(execResult[1],16),
parseInt(execResult[2],16),
parseInt(execResult[3],16)
];
}
},{
re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,
parse:function(execResult){
return[
parseInt(execResult[1]+execResult[1],16),
parseInt(execResult[2]+execResult[2],16),
parseInt(execResult[3]+execResult[3],16)
];
}
},{
re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
space:"hsla",
parse:function(execResult){
return[
execResult[1],
execResult[2]/100,
execResult[3]/100,
execResult[4]
];
}
}],
color=jQuery.Color=function(color,green,blue,alpha){
return new jQuery.Color.fn.parse(color,green,blue,alpha);
},
spaces={
rgba:{
props:{
red:{
idx:0,
type:"byte"
},
green:{
idx:1,
type:"byte"
},
blue:{
idx:2,
type:"byte"
}
}
},
hsla:{
props:{
hue:{
idx:0,
type:"degrees"
},
saturation:{
idx:1,
type:"percent"
},
lightness:{
idx:2,
type:"percent"
}
}
}
},
propTypes={
"byte":{
floor:true,
max:255
},
"percent":{
max:1
},
"degrees":{
mod:360,
floor:true
}
},
support=color.support={},
supportElem=jQuery("<p>")[0],
colors,
each=jQuery.each;
supportElem.style.cssText="background-color:rgba(1,1,1,.5)";
support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1;
each(spaces,function(spaceName,space){
space.cache="_"+spaceName;
space.props.alpha={
idx:3,
type:"percent",
def:1
};
});
function clamp(value,prop,allowEmpty){
var type=propTypes[prop.type]||{};
if(value==null){
return(allowEmpty||!prop.def)?null:prop.def;
}
value=type.floor?~~value:parseFloat(value);
if(isNaN(value)){
return prop.def;
}
if(type.mod){
return(value+type.mod)%type.mod;
}
return 0>value?0:type.max<value?type.max:value;
}
function stringParse(string){
var inst=color(),
rgba=inst._rgba=[];
string=string.toLowerCase();
each(stringParsers,function(i,parser){
var parsed,
match=parser.re.exec(string),
values=match&&parser.parse(match),
spaceName=parser.space||"rgba";
if(values){
parsed=inst[spaceName](values);
inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache];
rgba=inst._rgba=parsed._rgba;
return false;
}
});
if(rgba.length){
if(rgba.join()==="0,0,0,0"){
jQuery.extend(rgba,colors.transparent);
}
return inst;
}
return colors[string];
}
color.fn=jQuery.extend(color.prototype,{
parse:function(red,green,blue,alpha){
if(red===undefined){
this._rgba=[null,null,null,null];
return this;
}
if(red.jquery||red.nodeType){
red=jQuery(red).css(green);
green=undefined;
}
var inst=this,
type=jQuery.type(red),
rgba=this._rgba=[];
if(green!==undefined){
red=[red,green,blue,alpha];
type="array";
}
if(type==="string"){
return this.parse(stringParse(red)||colors._default);
}
if(type==="array"){
each(spaces.rgba.props,function(key,prop){
rgba[prop.idx]=clamp(red[prop.idx],prop);
});
return this;
}
if(type==="object"){
if(red instanceof color){
each(spaces,function(spaceName,space){
if(red[space.cache]){
inst[space.cache]=red[space.cache].slice();
}
});
}else{
each(spaces,function(spaceName,space){
var cache=space.cache;
each(space.props,function(key,prop){
if(!inst[cache]&&space.to){
if(key==="alpha"||red[key]==null){
return;
}
inst[cache]=space.to(inst._rgba);
}
inst[cache][prop.idx]=clamp(red[key],prop,true);
});
if(inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0){
inst[cache][3]=1;
if(space.from){
inst._rgba=space.from(inst[cache]);
}
}
});
}
return this;
}
},
is:function(compare){
var is=color(compare),
same=true,
inst=this;
each(spaces,function(_,space){
var localCache,
isCache=is[space.cache];
if(isCache){
localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[];
each(space.props,function(_,prop){
if(isCache[prop.idx]!=null){
same=(isCache[prop.idx]===localCache[prop.idx]);
return same;
}
});
}
return same;
});
return same;
},
_space:function(){
var used=[],
inst=this;
each(spaces,function(spaceName,space){
if(inst[space.cache]){
used.push(spaceName);
}
});
return used.pop();
},
transition:function(other,distance){
var end=color(other),
spaceName=end._space(),
space=spaces[spaceName],
startColor=this.alpha()===0?color("transparent"):this,
start=startColor[space.cache]||space.to(startColor._rgba),
result=start.slice();
end=end[space.cache];
each(space.props,function(key,prop){
var index=prop.idx,
startValue=start[index],
endValue=end[index],
type=propTypes[prop.type]||{};
if(endValue===null){
return;
}
if(startValue===null){
result[index]=endValue;
}else{
if(type.mod){
if(endValue-startValue>type.mod/2){
startValue+=type.mod;
}else if(startValue-endValue>type.mod/2){
startValue-=type.mod;
}
}
result[index]=clamp((endValue-startValue)*distance+startValue,prop);
}
});
return this[spaceName](result);
},
blend:function(opaque){
if(this._rgba[3]===1){
return this;
}
var rgb=this._rgba.slice(),
a=rgb.pop(),
blend=color(opaque)._rgba;
return color(jQuery.map(rgb,function(v,i){
return(1-a)*blend[i]+a*v;
}));
},
toRgbaString:function(){
var prefix="rgba(",
rgba=jQuery.map(this._rgba,function(v,i){
return v==null?(i>2?1:0):v;
});
if(rgba[3]===1){
rgba.pop();
prefix="rgb(";
}
return prefix+rgba.join()+")";
},
toHslaString:function(){
var prefix="hsla(",
hsla=jQuery.map(this.hsla(),function(v,i){
if(v==null){
v=i>2?1:0;
}
if(i&&i<3){
v=Math.round(v*100)+"%";
}
return v;
});
if(hsla[3]===1){
hsla.pop();
prefix="hsl(";
}
return prefix+hsla.join()+")";
},
toHexString:function(includeAlpha){
var rgba=this._rgba.slice(),
alpha=rgba.pop();
if(includeAlpha){
rgba.push(~~(alpha*255));
}
return"#"+jQuery.map(rgba,function(v){
v=(v||0).toString(16);
return v.length===1?"0"+v:v;
}).join("");
},
toString:function(){
return this._rgba[3]===0?"transparent":this.toRgbaString();
}
});
color.fn.parse.prototype=color.fn;
function hue2rgb(p,q,h){
h=(h+1)%1;
if(h*6<1){
return p+(q-p)*h*6;
}
if(h*2<1){
return q;
}
if(h*3<2){
return p+(q-p)*((2/3)-h)*6;
}
return p;
}
spaces.hsla.to=function(rgba){
if(rgba[0]==null||rgba[1]==null||rgba[2]==null){
return[null,null,null,rgba[3]];
}
var r=rgba[0]/255,
g=rgba[1]/255,
b=rgba[2]/255,
a=rgba[3],
max=Math.max(r,g,b),
min=Math.min(r,g,b),
diff=max-min,
add=max+min,
l=add*0.5,
h,s;
if(min===max){
h=0;
}else if(r===max){
h=(60*(g-b)/diff)+360;
}else if(g===max){
h=(60*(b-r)/diff)+120;
}else{
h=(60*(r-g)/diff)+240;
}
if(diff===0){
s=0;
}else if(l<=0.5){
s=diff/add;
}else{
s=diff/(2-add);
}
return[Math.round(h)%360,s,l,a==null?1:a];
};
spaces.hsla.from=function(hsla){
if(hsla[0]==null||hsla[1]==null||hsla[2]==null){
return[null,null,null,hsla[3]];
}
var h=hsla[0]/360,
s=hsla[1],
l=hsla[2],
a=hsla[3],
q=l<=0.5?l*(1+s):l+s-l*s,
p=2*l-q;
return[
Math.round(hue2rgb(p,q,h+(1/3))*255),
Math.round(hue2rgb(p,q,h)*255),
Math.round(hue2rgb(p,q,h-(1/3))*255),
a
];
};
each(spaces,function(spaceName,space){
var props=space.props,
cache=space.cache,
to=space.to,
from=space.from;
color.fn[spaceName]=function(value){
if(to&&!this[cache]){
this[cache]=to(this._rgba);
}
if(value===undefined){
return this[cache].slice();
}
var ret,
type=jQuery.type(value),
arr=(type==="array"||type==="object")?value:arguments,
local=this[cache].slice();
each(props,function(key,prop){
var val=arr[type==="object"?key:prop.idx];
if(val==null){
val=local[prop.idx];
}
local[prop.idx]=clamp(val,prop);
});
if(from){
ret=color(from(local));
ret[cache]=local;
return ret;
}else{
return color(local);
}
};
each(props,function(key,prop){
if(color.fn[key]){
return;
}
color.fn[key]=function(value){
var vtype=jQuery.type(value),
fn=(key==="alpha"?(this._hsla?"hsla":"rgba"):spaceName),
local=this[fn](),
cur=local[prop.idx],
match;
if(vtype==="undefined"){
return cur;
}
if(vtype==="function"){
value=value.call(this,cur);
vtype=jQuery.type(value);
}
if(value==null&&prop.empty){
return this;
}
if(vtype==="string"){
match=rplusequals.exec(value);
if(match){
value=cur+parseFloat(match[2])*(match[1]==="+"?1:-1);
}
}
local[prop.idx]=value;
return this[fn](local);
};
});
});
color.hook=function(hook){
var hooks=hook.split(" ");
each(hooks,function(i,hook){
jQuery.cssHooks[hook]={
set:function(elem,value){
var parsed,curElem,
backgroundColor="";
if(value!=="transparent"&&(jQuery.type(value)!=="string"||(parsed=stringParse(value)))){
value=color(parsed||value);
if(!support.rgba&&value._rgba[3]!==1){
curElem=hook==="backgroundColor"?elem.parentNode:elem;
while(
(backgroundColor===""||backgroundColor==="transparent")&&
curElem&&curElem.style
){
try{
backgroundColor=jQuery.css(curElem,"backgroundColor");
curElem=curElem.parentNode;
}catch(e){
}
}
value=value.blend(backgroundColor&&backgroundColor!=="transparent"?
backgroundColor:
"_default");
}
value=value.toRgbaString();
}
try{
elem.style[hook]=value;
}catch(e){
}
}
};
jQuery.fx.step[hook]=function(fx){
if(!fx.colorInit){
fx.start=color(fx.elem,hook);
fx.end=color(fx.end);
fx.colorInit=true;
}
jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos));
};
});
};
color.hook(stepHooks);
jQuery.cssHooks.borderColor={
expand:function(value){
var expanded={};
each(["Top","Right","Bottom","Left"],function(i,part){
expanded["border"+part+"Color"]=value;
});
return expanded;
}
};
colors=jQuery.Color.names={
aqua:"#00ffff",
black:"#000000",
blue:"#0000ff",
fuchsia:"#ff00ff",
gray:"#808080",
green:"#008000",
lime:"#00ff00",
maroon:"#800000",
navy:"#000080",
olive:"#808000",
purple:"#800080",
red:"#ff0000",
silver:"#c0c0c0",
teal:"#008080",
white:"#ffffff",
yellow:"#ffff00",
transparent:[null,null,null,0],
_default:"#ffffff"
};
})(jQuery);



(function(){
var classAnimationActions=["add","remove","toggle"],
shorthandStyles={
border:1,
borderBottom:1,
borderColor:1,
borderLeft:1,
borderRight:1,
borderTop:1,
borderWidth:1,
margin:1,
padding:1
};
$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){
$.fx.step[prop]=function(fx){
if(fx.end!=="none"&&!fx.setAttr||fx.pos===1&&!fx.setAttr){
jQuery.style(fx.elem,prop,fx.end);
fx.setAttr=true;
}
};
});
function getElementStyles(elem){
var key,len,
style=elem.ownerDocument.defaultView?
elem.ownerDocument.defaultView.getComputedStyle(elem,null):
elem.currentStyle,
styles={};
if(style&&style.length&&style[0]&&style[style[0]]){
len=style.length;
while(len--){
key=style[len];
if(typeof style[key]==="string"){
styles[$.camelCase(key)]=style[key];
}
}
}else{
for(key in style){
if(typeof style[key]==="string"){
styles[key]=style[key];
}
}
}
return styles;
}
function styleDifference(oldStyle,newStyle){
var diff={},
name,value;
for(name in newStyle){
value=newStyle[name];
if(oldStyle[name]!==value){
if(!shorthandStyles[name]){
if($.fx.step[name]||!isNaN(parseFloat(value))){
diff[name]=value;
}
}
}
}
return diff;
}
if(!$.fn.addBack){
$.fn.addBack=function(selector){
return this.add(selector==null?
this.prevObject:this.prevObject.filter(selector)
);
};
}
$.effects.animateClass=function(value,duration,easing,callback){
var o=$.speed(duration,easing,callback);
return this.queue(function(){
var animated=$(this),
baseClass=animated.attr("class")||"",
applyClassChange,
allAnimations=o.children?animated.find("*").addBack():animated;
allAnimations=allAnimations.map(function(){
var el=$(this);
return{
el:el,
start:getElementStyles(this)
};
});
applyClassChange=function(){
$.each(classAnimationActions,function(i,action){
if(value[action]){
animated[action+"Class"](value[action]);
}
});
};
applyClassChange();
allAnimations=allAnimations.map(function(){
this.end=getElementStyles(this.el[0]);
this.diff=styleDifference(this.start,this.end);
return this;
});
animated.attr("class",baseClass);
allAnimations=allAnimations.map(function(){
var styleInfo=this,
dfd=$.Deferred(),
opts=$.extend({},o,{
queue:false,
complete:function(){
dfd.resolve(styleInfo);
}
});
this.el.animate(this.diff,opts);
return dfd.promise();
});
$.when.apply($,allAnimations.get()).done(function(){
applyClassChange();
$.each(arguments,function(){
var el=this.el;
$.each(this.diff,function(key){
el.css(key,"");
});
});
o.complete.call(animated[0]);
});
});
};
$.fn.extend({
addClass:(function(orig){
return function(classNames,speed,easing,callback){
return speed?
$.effects.animateClass.call(this,
{add:classNames},speed,easing,callback):
orig.apply(this,arguments);
};
})($.fn.addClass),
removeClass:(function(orig){
return function(classNames,speed,easing,callback){
return arguments.length>1?
$.effects.animateClass.call(this,
{remove:classNames},speed,easing,callback):
orig.apply(this,arguments);
};
})($.fn.removeClass),
toggleClass:(function(orig){
return function(classNames,force,speed,easing,callback){
if(typeof force==="boolean"||force===undefined){
if(!speed){
return orig.apply(this,arguments);
}else{
return $.effects.animateClass.call(this,
(force?{add:classNames}:{remove:classNames}),
speed,easing,callback);
}
}else{
return $.effects.animateClass.call(this,
{toggle:classNames},force,speed,easing);
}
};
})($.fn.toggleClass),
switchClass:function(remove,add,speed,easing,callback){
return $.effects.animateClass.call(this,{
add:add,
remove:remove
},speed,easing,callback);
}
});
})();



(function(){
$.extend($.effects,{
version:"1.10.4",
save:function(element,set){
for(var i=0;i<set.length;i++){
if(set[i]!==null){
element.data(dataSpace+set[i],element[0].style[set[i]]);
}
}
},
restore:function(element,set){
var val,i;
for(i=0;i<set.length;i++){
if(set[i]!==null){
val=element.data(dataSpace+set[i]);
if(val===undefined){
val="";
}
element.css(set[i],val);
}
}
},
setMode:function(el,mode){
if(mode==="toggle"){
mode=el.is(":hidden")?"show":"hide";
}
return mode;
},
getBaseline:function(origin,original){
var y,x;
switch(origin[0]){
case"top":y=0;break;
case"middle":y=0.5;break;
case"bottom":y=1;break;
default:y=origin[0]/original.height;
}
switch(origin[1]){
case"left":x=0;break;
case"center":x=0.5;break;
case"right":x=1;break;
default:x=origin[1]/original.width;
}
return{
x:x,
y:y
};
},
createWrapper:function(element){
if(element.parent().is(".ui-effects-wrapper")){
return element.parent();
}
var props={
width:element.outerWidth(true),
height:element.outerHeight(true),
"float":element.css("float")
},
wrapper=$("<div></div>")
.addClass("ui-effects-wrapper")
.css({
fontSize:"100%",
background:"transparent",
border:"none",
margin:0,
padding:0
}),
size={
width:element.width(),
height:element.height()
},
active=document.activeElement;
try{
active.id;
}catch(e){
active=document.body;
}
element.wrap(wrapper);
if(element[0]===active||$.contains(element[0],active)){
$(active).focus();
}
wrapper=element.parent();if(element.css("position")==="static"){
wrapper.css({position:"relative"});
element.css({position:"relative"});
}else{
$.extend(props,{
position:element.css("position"),
zIndex:element.css("z-index")
});
$.each(["top","left","bottom","right"],function(i,pos){
props[pos]=element.css(pos);
if(isNaN(parseInt(props[pos],10))){
props[pos]="auto";
}
});
element.css({
position:"relative",
top:0,
left:0,
right:"auto",
bottom:"auto"
});
}
element.css(size);
return wrapper.css(props).show();
},
removeWrapper:function(element){
var active=document.activeElement;
if(element.parent().is(".ui-effects-wrapper")){
element.parent().replaceWith(element);
if(element[0]===active||$.contains(element[0],active)){
$(active).focus();
}
}
return element;
},
setTransition:function(element,list,factor,value){
value=value||{};
$.each(list,function(i,x){
var unit=element.cssUnit(x);
if(unit[0]>0){
value[x]=unit[0]*factor+unit[1];
}
});
return value;
}
});
function _normalizeArguments(effect,options,speed,callback){
if($.isPlainObject(effect)){
options=effect;
effect=effect.effect;
}
effect={effect:effect};
if(options==null){
options={};
}
if($.isFunction(options)){
callback=options;
speed=null;
options={};
}
if(typeof options==="number"||$.fx.speeds[options]){
callback=speed;
speed=options;
options={};
}
if($.isFunction(speed)){
callback=speed;
speed=null;
}
if(options){
$.extend(effect,options);
}
speed=speed||options.duration;
effect.duration=$.fx.off?0:
typeof speed==="number"?speed:
speed in $.fx.speeds?$.fx.speeds[speed]:
$.fx.speeds._default;
effect.complete=callback||options.complete;
return effect;
}
function standardAnimationOption(option){
if(!option||typeof option==="number"||$.fx.speeds[option]){
return true;
}
if(typeof option==="string"&&!$.effects.effect[option]){
return true;
}
if($.isFunction(option)){
return true;
}
if(typeof option==="object"&&!option.effect){
return true;
}
return false;
}
$.fn.extend({
effect:function(){
var args=_normalizeArguments.apply(this,arguments),
mode=args.mode,
queue=args.queue,
effectMethod=$.effects.effect[args.effect];
if($.fx.off||!effectMethod){
if(mode){
return this[mode](args.duration,args.complete);
}else{
return this.each(function(){
if(args.complete){
args.complete.call(this);
}
});
}
}
function run(next){
var elem=$(this),
complete=args.complete,
mode=args.mode;
function done(){
if($.isFunction(complete)){
complete.call(elem[0]);
}
if($.isFunction(next)){
next();
}
}
if(elem.is(":hidden")?mode==="hide":mode==="show"){
elem[mode]();
done();
}else{
effectMethod.call(elem[0],args,done);
}
}
return queue===false?this.each(run):this.queue(queue||"fx",run);
},
show:(function(orig){
return function(option){
if(standardAnimationOption(option)){
return orig.apply(this,arguments);
}else{
var args=_normalizeArguments.apply(this,arguments);
args.mode="show";
return this.effect.call(this,args);
}
};
})($.fn.show),
hide:(function(orig){
return function(option){
if(standardAnimationOption(option)){
return orig.apply(this,arguments);
}else{
var args=_normalizeArguments.apply(this,arguments);
args.mode="hide";
return this.effect.call(this,args);
}
};
})($.fn.hide),
toggle:(function(orig){
return function(option){
if(standardAnimationOption(option)||typeof option==="boolean"){
return orig.apply(this,arguments);
}else{
var args=_normalizeArguments.apply(this,arguments);
args.mode="toggle";
return this.effect.call(this,args);
}
};
})($.fn.toggle),
cssUnit:function(key){
var style=this.css(key),
val=[];
$.each(["em","px","%","pt"],function(i,unit){
if(style.indexOf(unit)>0){
val=[parseFloat(style),unit];
}
});
return val;
}
});
})();



(function(){
var baseEasings={};
$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){
baseEasings[name]=function(p){
return Math.pow(p,i+2);
};
});
$.extend(baseEasings,{
Sine:function(p){
return 1-Math.cos(p*Math.PI/2);
},
Circ:function(p){
return 1-Math.sqrt(1-p*p);
},
Elastic:function(p){
return p===0||p===1?p:
-Math.pow(2,8*(p-1))*Math.sin(((p-1)*80-7.5)*Math.PI/15);
},
Back:function(p){
return p*p*(3*p-2);
},
Bounce:function(p){
var pow2,
bounce=4;
while(p<((pow2=Math.pow(2,--bounce))-1)/11){}
return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((pow2*3-2)/22-p,2);
}
});
$.each(baseEasings,function(name,easeIn){
$.easing["easeIn"+name]=easeIn;
$.easing["easeOut"+name]=function(p){
return 1-easeIn(1-p);
};
$.easing["easeInOut"+name]=function(p){
return p<0.5?
easeIn(p*2)/2:
1-easeIn(p*-2+2)/2;
};
});
})();
})(jQuery);
(function($,undefined){
var rvertical=/up|down|vertical/,
rpositivemotion=/up|left|vertical|horizontal/;
$.effects.effect.blind=function(o,done){
var el=$(this),
props=["position","top","bottom","left","right","height","width"],
mode=$.effects.setMode(el,o.mode||"hide"),
direction=o.direction||"up",
vertical=rvertical.test(direction),
ref=vertical?"height":"width",
ref2=vertical?"top":"left",
motion=rpositivemotion.test(direction),
animation={},
show=mode==="show",
wrapper,distance,margin;
if(el.parent().is(".ui-effects-wrapper")){
$.effects.save(el.parent(),props);
}else{
$.effects.save(el,props);
}
el.show();
wrapper=$.effects.createWrapper(el).css({
overflow:"hidden"
});
distance=wrapper[ref]();
margin=parseFloat(wrapper.css(ref2))||0;
animation[ref]=show?distance:0;
if(!motion){
el
.css(vertical?"bottom":"right",0)
.css(vertical?"top":"left","auto")
.css({position:"absolute"});
animation[ref2]=show?margin:distance+margin;
}
if(show){
wrapper.css(ref,0);
if(!motion){
wrapper.css(ref2,margin+distance);
}
}
wrapper.animate(animation,{
duration:o.duration,
easing:o.easing,
queue:false,
complete:function(){
if(mode==="hide"){
el.hide();
}
$.effects.restore(el,props);
$.effects.removeWrapper(el);
done();
}
});
};
})(jQuery);
(function($,undefined){
$.effects.effect.bounce=function(o,done){
var el=$(this),
props=["position","top","bottom","left","right","height","width"],
mode=$.effects.setMode(el,o.mode||"effect"),
hide=mode==="hide",
show=mode==="show",
direction=o.direction||"up",
distance=o.distance,
times=o.times||5,
anims=times*2+(show||hide?1:0),
speed=o.duration/anims,
easing=o.easing,
ref=(direction==="up"||direction==="down")?"top":"left",
motion=(direction==="up"||direction==="left"),
i,
upAnim,
downAnim,
queue=el.queue(),
queuelen=queue.length;
if(show||hide){
props.push("opacity");
}
$.effects.save(el,props);
el.show();
$.effects.createWrapper(el);if(!distance){
distance=el[ref==="top"?"outerHeight":"outerWidth"]()/3;
}
if(show){
downAnim={opacity:1};
downAnim[ref]=0;
el.css("opacity",0)
.css(ref,motion?-distance*2:distance*2)
.animate(downAnim,speed,easing);
}
if(hide){
distance=distance/Math.pow(2,times-1);
}
downAnim={};
downAnim[ref]=0;
for(i=0;i<times;i++){
upAnim={};
upAnim[ref]=(motion?"-=":"+=")+distance;
el.animate(upAnim,speed,easing)
.animate(downAnim,speed,easing);
distance=hide?distance*2:distance/2;
}
if(hide){
upAnim={opacity:0};
upAnim[ref]=(motion?"-=":"+=")+distance;
el.animate(upAnim,speed,easing);
}
el.queue(function(){
if(hide){
el.hide();
}
$.effects.restore(el,props);
$.effects.removeWrapper(el);
done();
});
if(queuelen>1){
queue.splice.apply(queue,
[1,0].concat(queue.splice(queuelen,anims+1)));
}
el.dequeue();
};
})(jQuery);
(function($,undefined){
$.effects.effect.clip=function(o,done){
var el=$(this),
props=["position","top","bottom","left","right","height","width"],
mode=$.effects.setMode(el,o.mode||"hide"),
show=mode==="show",
direction=o.direction||"vertical",
vert=direction==="vertical",
size=vert?"height":"width",
position=vert?"top":"left",
animation={},
wrapper,animate,distance;
$.effects.save(el,props);
el.show();
wrapper=$.effects.createWrapper(el).css({
overflow:"hidden"
});
animate=(el[0].tagName==="IMG")?wrapper:el;
distance=animate[size]();
if(show){
animate.css(size,0);
animate.css(position,distance/2);
}
animation[size]=show?distance:0;
animation[position]=show?0:distance/2;
animate.animate(animation,{
queue:false,
duration:o.duration,
easing:o.easing,
complete:function(){
if(!show){
el.hide();
}
$.effects.restore(el,props);
$.effects.removeWrapper(el);
done();
}
});
};
})(jQuery);
(function($,undefined){
$.effects.effect.drop=function(o,done){
var el=$(this),
props=["position","top","bottom","left","right","opacity","height","width"],
mode=$.effects.setMode(el,o.mode||"hide"),
show=mode==="show",
direction=o.direction||"left",
ref=(direction==="up"||direction==="down")?"top":"left",
motion=(direction==="up"||direction==="left")?"pos":"neg",
animation={
opacity:show?1:0
},
distance;
$.effects.save(el,props);
el.show();
$.effects.createWrapper(el);
distance=o.distance||el[ref==="top"?"outerHeight":"outerWidth"](true)/2;
if(show){
el
.css("opacity",0)
.css(ref,motion==="pos"?-distance:distance);
}
animation[ref]=(show?
(motion==="pos"?"+=":"-="):
(motion==="pos"?"-=":"+="))+
distance;
el.animate(animation,{
queue:false,
duration:o.duration,
easing:o.easing,
complete:function(){
if(mode==="hide"){
el.hide();
}
$.effects.restore(el,props);
$.effects.removeWrapper(el);
done();
}
});
};
})(jQuery);
(function($,undefined){
$.effects.effect.explode=function(o,done){
var rows=o.pieces?Math.round(Math.sqrt(o.pieces)):3,
cells=rows,
el=$(this),
mode=$.effects.setMode(el,o.mode||"hide"),
show=mode==="show",
offset=el.show().css("visibility","hidden").offset(),
width=Math.ceil(el.outerWidth()/cells),
height=Math.ceil(el.outerHeight()/rows),
pieces=[],
i,j,left,top,mx,my;
function childComplete(){
pieces.push(this);
if(pieces.length===rows*cells){
animComplete();
}
}
for(i=0;i<rows;i++){top=offset.top+i*height;
my=i-(rows-1)/2;
for(j=0;j<cells;j++){left=offset.left+j*width;
mx=j-(cells-1)/2;
el
.clone()
.appendTo("body")
.wrap("<div></div>")
.css({
position:"absolute",
visibility:"visible",
left:-j*width,
top:-i*height
})
.parent()
.addClass("ui-effects-explode")
.css({
position:"absolute",
overflow:"hidden",
width:width,
height:height,
left:left+(show?mx*width:0),
top:top+(show?my*height:0),
opacity:show?0:1
}).animate({
left:left+(show?0:mx*width),
top:top+(show?0:my*height),
opacity:show?1:0
},o.duration||500,o.easing,childComplete);
}
}
function animComplete(){
el.css({
visibility:"visible"
});
$(pieces).remove();
if(!show){
el.hide();
}
done();
}
};
})(jQuery);
(function($,undefined){
$.effects.effect.fade=function(o,done){
var el=$(this),
mode=$.effects.setMode(el,o.mode||"toggle");
el.animate({
opacity:mode
},{
queue:false,
duration:o.duration,
easing:o.easing,
complete:done
});
};
})(jQuery);
(function($,undefined){
$.effects.effect.fold=function(o,done){
var el=$(this),
props=["position","top","bottom","left","right","height","width"],
mode=$.effects.setMode(el,o.mode||"hide"),
show=mode==="show",
hide=mode==="hide",
size=o.size||15,
percent=/([0-9]+)%/.exec(size),
horizFirst=!!o.horizFirst,
widthFirst=show!==horizFirst,
ref=widthFirst?["width","height"]:["height","width"],
duration=o.duration/2,
wrapper,distance,
animation1={},
animation2={};
$.effects.save(el,props);
el.show();
wrapper=$.effects.createWrapper(el).css({
overflow:"hidden"
});
distance=widthFirst?
[wrapper.width(),wrapper.height()]:
[wrapper.height(),wrapper.width()];
if(percent){
size=parseInt(percent[1],10)/100*distance[hide?0:1];
}
if(show){
wrapper.css(horizFirst?{
height:0,
width:size
}:{
height:size,
width:0
});
}
animation1[ref[0]]=show?distance[0]:size;
animation2[ref[1]]=show?distance[1]:0;
wrapper
.animate(animation1,duration,o.easing)
.animate(animation2,duration,o.easing,function(){
if(hide){
el.hide();
}
$.effects.restore(el,props);
$.effects.removeWrapper(el);
done();
});
};
})(jQuery);
(function($,undefined){
$.effects.effect.highlight=function(o,done){
var elem=$(this),
props=["backgroundImage","backgroundColor","opacity"],
mode=$.effects.setMode(elem,o.mode||"show"),
animation={
backgroundColor:elem.css("backgroundColor")
};
if(mode==="hide"){
animation.opacity=0;
}
$.effects.save(elem,props);
elem
.show()
.css({
backgroundImage:"none",
backgroundColor:o.color||"#ffff99"
})
.animate(animation,{
queue:false,
duration:o.duration,
easing:o.easing,
complete:function(){
if(mode==="hide"){
elem.hide();
}
$.effects.restore(elem,props);
done();
}
});
};
})(jQuery);
(function($,undefined){
$.effects.effect.pulsate=function(o,done){
var elem=$(this),
mode=$.effects.setMode(elem,o.mode||"show"),
show=mode==="show",
hide=mode==="hide",
showhide=(show||mode==="hide"),
anims=((o.times||5)*2)+(showhide?1:0),
duration=o.duration/anims,
animateTo=0,
queue=elem.queue(),
queuelen=queue.length,
i;
if(show||!elem.is(":visible")){
elem.css("opacity",0).show();
animateTo=1;
}
for(i=1;i<anims;i++){
elem.animate({
opacity:animateTo
},duration,o.easing);
animateTo=1-animateTo;
}
elem.animate({
opacity:animateTo
},duration,o.easing);
elem.queue(function(){
if(hide){
elem.hide();
}
done();
});
if(queuelen>1){
queue.splice.apply(queue,
[1,0].concat(queue.splice(queuelen,anims+1)));
}
elem.dequeue();
};
})(jQuery);
(function($,undefined){
$.effects.effect.puff=function(o,done){
var elem=$(this),
mode=$.effects.setMode(elem,o.mode||"hide"),
hide=mode==="hide",
percent=parseInt(o.percent,10)||150,
factor=percent/100,
original={
height:elem.height(),
width:elem.width(),
outerHeight:elem.outerHeight(),
outerWidth:elem.outerWidth()
};
$.extend(o,{
effect:"scale",
queue:false,
fade:true,
mode:mode,
complete:done,
percent:hide?percent:100,
from:hide?
original:
{
height:original.height*factor,
width:original.width*factor,
outerHeight:original.outerHeight*factor,
outerWidth:original.outerWidth*factor
}
});
elem.effect(o);
};
$.effects.effect.scale=function(o,done){
var el=$(this),
options=$.extend(true,{},o),
mode=$.effects.setMode(el,o.mode||"effect"),
percent=parseInt(o.percent,10)||
(parseInt(o.percent,10)===0?0:(mode==="hide"?0:100)),
direction=o.direction||"both",
origin=o.origin,
original={
height:el.height(),
width:el.width(),
outerHeight:el.outerHeight(),
outerWidth:el.outerWidth()
},
factor={
y:direction!=="horizontal"?(percent/100):1,
x:direction!=="vertical"?(percent/100):1
};
options.effect="size";
options.queue=false;
options.complete=done;
if(mode!=="effect"){
options.origin=origin||["middle","center"];
options.restore=true;
}
options.from=o.from||(mode==="show"?{
height:0,
width:0,
outerHeight:0,
outerWidth:0
}:original);
options.to={
height:original.height*factor.y,
width:original.width*factor.x,
outerHeight:original.outerHeight*factor.y,
outerWidth:original.outerWidth*factor.x
};
if(options.fade){
if(mode==="show"){
options.from.opacity=0;
options.to.opacity=1;
}
if(mode==="hide"){
options.from.opacity=1;
options.to.opacity=0;
}
}
el.effect(options);
};
$.effects.effect.size=function(o,done){
var original,baseline,factor,
el=$(this),
props0=["position","top","bottom","left","right","width","height","overflow","opacity"],
props1=["position","top","bottom","left","right","overflow","opacity"],
props2=["width","height","overflow"],
cProps=["fontSize"],
vProps=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],
hProps=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],
mode=$.effects.setMode(el,o.mode||"effect"),
restore=o.restore||mode!=="effect",
scale=o.scale||"both",
origin=o.origin||["middle","center"],
position=el.css("position"),
props=restore?props0:props1,
zero={
height:0,
width:0,
outerHeight:0,
outerWidth:0
};
if(mode==="show"){
el.show();
}
original={
height:el.height(),
width:el.width(),
outerHeight:el.outerHeight(),
outerWidth:el.outerWidth()
};
if(o.mode==="toggle"&&mode==="show"){
el.from=o.to||zero;
el.to=o.from||original;
}else{
el.from=o.from||(mode==="show"?zero:original);
el.to=o.to||(mode==="hide"?zero:original);
}
factor={
from:{
y:el.from.height/original.height,
x:el.from.width/original.width
},
to:{
y:el.to.height/original.height,
x:el.to.width/original.width
}
};
if(scale==="box"||scale==="both"){
if(factor.from.y!==factor.to.y){
props=props.concat(vProps);
el.from=$.effects.setTransition(el,vProps,factor.from.y,el.from);
el.to=$.effects.setTransition(el,vProps,factor.to.y,el.to);
}
if(factor.from.x!==factor.to.x){
props=props.concat(hProps);
el.from=$.effects.setTransition(el,hProps,factor.from.x,el.from);
el.to=$.effects.setTransition(el,hProps,factor.to.x,el.to);
}
}
if(scale==="content"||scale==="both"){
if(factor.from.y!==factor.to.y){
props=props.concat(cProps).concat(props2);
el.from=$.effects.setTransition(el,cProps,factor.from.y,el.from);
el.to=$.effects.setTransition(el,cProps,factor.to.y,el.to);
}
}
$.effects.save(el,props);
el.show();
$.effects.createWrapper(el);
el.css("overflow","hidden").css(el.from);
if(origin){baseline=$.effects.getBaseline(origin,original);
el.from.top=(original.outerHeight-el.outerHeight())*baseline.y;
el.from.left=(original.outerWidth-el.outerWidth())*baseline.x;
el.to.top=(original.outerHeight-el.to.outerHeight)*baseline.y;
el.to.left=(original.outerWidth-el.to.outerWidth)*baseline.x;
}
el.css(el.from);if(scale==="content"||scale==="both"){vProps=vProps.concat(["marginTop","marginBottom"]).concat(cProps);
hProps=hProps.concat(["marginLeft","marginRight"]);
props2=props0.concat(vProps).concat(hProps);
el.find("*[width]").each(function(){
var child=$(this),
c_original={
height:child.height(),
width:child.width(),
outerHeight:child.outerHeight(),
outerWidth:child.outerWidth()
};
if(restore){
$.effects.save(child,props2);
}
child.from={
height:c_original.height*factor.from.y,
width:c_original.width*factor.from.x,
outerHeight:c_original.outerHeight*factor.from.y,
outerWidth:c_original.outerWidth*factor.from.x
};
child.to={
height:c_original.height*factor.to.y,
width:c_original.width*factor.to.x,
outerHeight:c_original.height*factor.to.y,
outerWidth:c_original.width*factor.to.x
};
if(factor.from.y!==factor.to.y){
child.from=$.effects.setTransition(child,vProps,factor.from.y,child.from);
child.to=$.effects.setTransition(child,vProps,factor.to.y,child.to);
}
if(factor.from.x!==factor.to.x){
child.from=$.effects.setTransition(child,hProps,factor.from.x,child.from);
child.to=$.effects.setTransition(child,hProps,factor.to.x,child.to);
}
child.css(child.from);
child.animate(child.to,o.duration,o.easing,function(){
if(restore){
$.effects.restore(child,props2);
}
});
});
}
el.animate(el.to,{
queue:false,
duration:o.duration,
easing:o.easing,
complete:function(){
if(el.to.opacity===0){
el.css("opacity",el.from.opacity);
}
if(mode==="hide"){
el.hide();
}
$.effects.restore(el,props);
if(!restore){
if(position==="static"){
el.css({
position:"relative",
top:el.to.top,
left:el.to.left
});
}else{
$.each(["top","left"],function(idx,pos){
el.css(pos,function(_,str){
var val=parseInt(str,10),
toRef=idx?el.to.left:el.to.top;
if(str==="auto"){
return toRef+"px";
}
return val+toRef+"px";
});
});
}
}
$.effects.removeWrapper(el);
done();
}
});
};
})(jQuery);
(function($,undefined){
$.effects.effect.shake=function(o,done){
var el=$(this),
props=["position","top","bottom","left","right","height","width"],
mode=$.effects.setMode(el,o.mode||"effect"),
direction=o.direction||"left",
distance=o.distance||20,
times=o.times||3,
anims=times*2+1,
speed=Math.round(o.duration/anims),
ref=(direction==="up"||direction==="down")?"top":"left",
positiveMotion=(direction==="up"||direction==="left"),
animation={},
animation1={},
animation2={},
i,
queue=el.queue(),
queuelen=queue.length;
$.effects.save(el,props);
el.show();
$.effects.createWrapper(el);
animation[ref]=(positiveMotion?"-=":"+=")+distance;
animation1[ref]=(positiveMotion?"+=":"-=")+distance*2;
animation2[ref]=(positiveMotion?"-=":"+=")+distance*2;
el.animate(animation,speed,o.easing);
for(i=1;i<times;i++){
el.animate(animation1,speed,o.easing).animate(animation2,speed,o.easing);
}
el
.animate(animation1,speed,o.easing)
.animate(animation,speed/2,o.easing)
.queue(function(){
if(mode==="hide"){
el.hide();
}
$.effects.restore(el,props);
$.effects.removeWrapper(el);
done();
});
if(queuelen>1){
queue.splice.apply(queue,
[1,0].concat(queue.splice(queuelen,anims+1)));
}
el.dequeue();
};
})(jQuery);
(function($,undefined){
$.effects.effect.slide=function(o,done){
var el=$(this),
props=["position","top","bottom","left","right","width","height"],
mode=$.effects.setMode(el,o.mode||"show"),
show=mode==="show",
direction=o.direction||"left",
ref=(direction==="up"||direction==="down")?"top":"left",
positiveMotion=(direction==="up"||direction==="left"),
distance,
animation={};
$.effects.save(el,props);
el.show();
distance=o.distance||el[ref==="top"?"outerHeight":"outerWidth"](true);
$.effects.createWrapper(el).css({
overflow:"hidden"
});
if(show){
el.css(ref,positiveMotion?(isNaN(distance)?"-"+distance:-distance):distance);
}
animation[ref]=(show?
(positiveMotion?"+=":"-="):
(positiveMotion?"-=":"+="))+
distance;
el.animate(animation,{
queue:false,
duration:o.duration,
easing:o.easing,
complete:function(){
if(mode==="hide"){
el.hide();
}
$.effects.restore(el,props);
$.effects.removeWrapper(el);
done();
}
});
};
})(jQuery);
(function($,undefined){
$.effects.effect.transfer=function(o,done){
var elem=$(this),
target=$(o.to),
targetFixed=target.css("position")==="fixed",
body=$("body"),
fixTop=targetFixed?body.scrollTop():0,
fixLeft=targetFixed?body.scrollLeft():0,
endPosition=target.offset(),
animation={
top:endPosition.top-fixTop,
left:endPosition.left-fixLeft,
height:target.innerHeight(),
width:target.innerWidth()
},
startPosition=elem.offset(),
transfer=$("<div class='ui-effects-transfer'></div>")
.appendTo(document.body)
.addClass(o.className)
.css({
top:startPosition.top-fixTop,
left:startPosition.left-fixLeft,
height:elem.innerHeight(),
width:elem.innerWidth(),
position:targetFixed?"fixed":"absolute"
})
.animate(animation,o.duration,o.easing,function(){
transfer.remove();
done();
});
};
})(jQuery);
(function($,undefined){
$.widget("ui.menu",{
version:"1.10.4",
defaultElement:"<ul>",
delay:300,
options:{
icons:{
submenu:"ui-icon-carat-1-e"
},
menus:"ul",
position:{
my:"left top",
at:"right top"
},
role:"menu",
blur:null,
focus:null,
select:null
},
_create:function(){
this.activeMenu=this.element;
this.mouseHandled=false;
this.element
.uniqueId()
.addClass("ui-menu ui-widget ui-widget-content ui-corner-all")
.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length)
.attr({
role:this.options.role,
tabIndex:0
})
.bind("click"+this.eventNamespace,$.proxy(function(event){
if(this.options.disabled){
event.preventDefault();
}
},this));
if(this.options.disabled){
this.element
.addClass("ui-state-disabled")
.attr("aria-disabled","true");
}
this._on({
"mousedown .ui-menu-item > a":function(event){
event.preventDefault();
},
"click .ui-state-disabled > a":function(event){
event.preventDefault();
},
"click .ui-menu-item:has(a)":function(event){
var target=$(event.target).closest(".ui-menu-item");
if(!this.mouseHandled&&target.not(".ui-state-disabled").length){
this.select(event);
if(!event.isPropagationStopped()){
this.mouseHandled=true;
}
if(target.has(".ui-menu").length){
this.expand(event);
}else if(!this.element.is(":focus")&&$(this.document[0].activeElement).closest(".ui-menu").length){
this.element.trigger("focus",[true]);
if(this.active&&this.active.parents(".ui-menu").length===1){
clearTimeout(this.timer);
}
}
}
},
"mouseenter .ui-menu-item":function(event){
var target=$(event.currentTarget);
target.siblings().children(".ui-state-active").removeClass("ui-state-active");
this.focus(event,target);
},
mouseleave:"collapseAll",
"mouseleave .ui-menu":"collapseAll",
focus:function(event,keepActiveItem){
var item=this.active||this.element.children(".ui-menu-item").eq(0);
if(!keepActiveItem){
this.focus(event,item);
}
},
blur:function(event){
this._delay(function(){
if(!$.contains(this.element[0],this.document[0].activeElement)){
this.collapseAll(event);
}
});
},
keydown:"_keydown"
});
this.refresh();
this._on(this.document,{
click:function(event){
if(!$(event.target).closest(".ui-menu").length){
this.collapseAll(event);
}
this.mouseHandled=false;
}
});
},
_destroy:function(){
this.element
.removeAttr("aria-activedescendant")
.find(".ui-menu").addBack()
.removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons")
.removeAttr("role")
.removeAttr("tabIndex")
.removeAttr("aria-labelledby")
.removeAttr("aria-expanded")
.removeAttr("aria-hidden")
.removeAttr("aria-disabled")
.removeUniqueId()
.show();
this.element.find(".ui-menu-item")
.removeClass("ui-menu-item")
.removeAttr("role")
.removeAttr("aria-disabled")
.children("a")
.removeUniqueId()
.removeClass("ui-corner-all ui-state-hover")
.removeAttr("tabIndex")
.removeAttr("role")
.removeAttr("aria-haspopup")
.children().each(function(){
var elem=$(this);
if(elem.data("ui-menu-submenu-carat")){
elem.remove();
}
});
this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content");
},
_keydown:function(event){
var match,prev,character,skip,regex,
preventDefault=true;
function escape(value){
return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");
}
switch(event.keyCode){
case $.ui.keyCode.PAGE_UP:
this.previousPage(event);
break;
case $.ui.keyCode.PAGE_DOWN:
this.nextPage(event);
break;
case $.ui.keyCode.HOME:
this._move("first","first",event);
break;
case $.ui.keyCode.END:
this._move("last","last",event);
break;
case $.ui.keyCode.UP:
this.previous(event);
break;
case $.ui.keyCode.DOWN:
this.next(event);
break;
case $.ui.keyCode.LEFT:
this.collapse(event);
break;
case $.ui.keyCode.RIGHT:
if(this.active&&!this.active.is(".ui-state-disabled")){
this.expand(event);
}
break;
case $.ui.keyCode.ENTER:
case $.ui.keyCode.SPACE:
this._activate(event);
break;
case $.ui.keyCode.ESCAPE:
this.collapse(event);
break;
default:
preventDefault=false;
prev=this.previousFilter||"";
character=String.fromCharCode(event.keyCode);
skip=false;
clearTimeout(this.filterTimer);
if(character===prev){
skip=true;
}else{
character=prev+character;
}
regex=new RegExp("^"+escape(character),"i");
match=this.activeMenu.children(".ui-menu-item").filter(function(){
return regex.test($(this).children("a").text());
});
match=skip&&match.index(this.active.next())!==-1?
this.active.nextAll(".ui-menu-item"):
match;
if(!match.length){
character=String.fromCharCode(event.keyCode);
regex=new RegExp("^"+escape(character),"i");
match=this.activeMenu.children(".ui-menu-item").filter(function(){
return regex.test($(this).children("a").text());
});
}
if(match.length){
this.focus(event,match);
if(match.length>1){
this.previousFilter=character;
this.filterTimer=this._delay(function(){
delete this.previousFilter;
},1000);
}else{
delete this.previousFilter;
}
}else{
delete this.previousFilter;
}
}
if(preventDefault){
event.preventDefault();
}
},
_activate:function(event){
if(!this.active.is(".ui-state-disabled")){
if(this.active.children("a[aria-haspopup='true']").length){
this.expand(event);
}else{
this.select(event);
}
}
},
refresh:function(){
var menus,
icon=this.options.icons.submenu,
submenus=this.element.find(this.options.menus);
this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length);
submenus.filter(":not(.ui-menu)")
.addClass("ui-menu ui-widget ui-widget-content ui-corner-all")
.hide()
.attr({
role:this.options.role,
"aria-hidden":"true",
"aria-expanded":"false"
})
.each(function(){
var menu=$(this),
item=menu.prev("a"),
submenuCarat=$("<span>")
.addClass("ui-menu-icon ui-icon "+icon)
.data("ui-menu-submenu-carat",true);
item
.attr("aria-haspopup","true")
.prepend(submenuCarat);
menu.attr("aria-labelledby",item.attr("id"));
});
menus=submenus.add(this.element);
menus.children(":not(.ui-menu-item):has(a)")
.addClass("ui-menu-item")
.attr("role","presentation")
.children("a")
.uniqueId()
.addClass("ui-corner-all")
.attr({
tabIndex:-1,
role:this._itemRole()
});
menus.children(":not(.ui-menu-item)").each(function(){
var item=$(this);
if(!/[^\-\u2014\u2013\s]/.test(item.text())){
item.addClass("ui-widget-content ui-menu-divider");
}
});
menus.children(".ui-state-disabled").attr("aria-disabled","true");
if(this.active&&!$.contains(this.element[0],this.active[0])){
this.blur();
}
},
_itemRole:function(){
return{
menu:"menuitem",
listbox:"option"
}[this.options.role];
},
_setOption:function(key,value){
if(key==="icons"){
this.element.find(".ui-menu-icon")
.removeClass(this.options.icons.submenu)
.addClass(value.submenu);
}
this._super(key,value);
},
focus:function(event,item){
var nested,focused;
this.blur(event,event&&event.type==="focus");
this._scrollIntoView(item);
this.active=item.first();
focused=this.active.children("a").addClass("ui-state-focus");
if(this.options.role){
this.element.attr("aria-activedescendant",focused.attr("id"));
}
this.active
.parent()
.closest(".ui-menu-item")
.children("a:first")
.addClass("ui-state-active");
if(event&&event.type==="keydown"){
this._close();
}else{
this.timer=this._delay(function(){
this._close();
},this.delay);
}
nested=item.children(".ui-menu");
if(nested.length&&event&&(/^mouse/.test(event.type))){
this._startOpening(nested);
}
this.activeMenu=item.parent();
this._trigger("focus",event,{item:item});
},
_scrollIntoView:function(item){
var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;
if(this._hasScroll()){
borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0;
paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0;
offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop;
scroll=this.activeMenu.scrollTop();
elementHeight=this.activeMenu.height();
itemHeight=item.height();
if(offset<0){
this.activeMenu.scrollTop(scroll+offset);
}else if(offset+itemHeight>elementHeight){
this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight);
}
}
},
blur:function(event,fromFocus){
if(!fromFocus){
clearTimeout(this.timer);
}
if(!this.active){
return;
}
this.active.children("a").removeClass("ui-state-focus");
this.active=null;
this._trigger("blur",event,{item:this.active});
},
_startOpening:function(submenu){
clearTimeout(this.timer);
if(submenu.attr("aria-hidden")!=="true"){
return;
}
this.timer=this._delay(function(){
this._close();
this._open(submenu);
},this.delay);
},
_open:function(submenu){
var position=$.extend({
of:this.active
},this.options.position);
clearTimeout(this.timer);
this.element.find(".ui-menu").not(submenu.parents(".ui-menu"))
.hide()
.attr("aria-hidden","true");
submenu
.show()
.removeAttr("aria-hidden")
.attr("aria-expanded","true")
.position(position);
},
collapseAll:function(event,all){
clearTimeout(this.timer);
this.timer=this._delay(function(){
var currentMenu=all?this.element:
$(event&&event.target).closest(this.element.find(".ui-menu"));
if(!currentMenu.length){
currentMenu=this.element;
}
this._close(currentMenu);
this.blur(event);
this.activeMenu=currentMenu;
},this.delay);
},
_close:function(startMenu){
if(!startMenu){
startMenu=this.active?this.active.parent():this.element;
}
startMenu
.find(".ui-menu")
.hide()
.attr("aria-hidden","true")
.attr("aria-expanded","false")
.end()
.find("a.ui-state-active")
.removeClass("ui-state-active");
},
collapse:function(event){
var newItem=this.active&&
this.active.parent().closest(".ui-menu-item",this.element);
if(newItem&&newItem.length){
this._close();
this.focus(event,newItem);
}
},
expand:function(event){
var newItem=this.active&&
this.active
.children(".ui-menu ")
.children(".ui-menu-item")
.first();
if(newItem&&newItem.length){
this._open(newItem.parent());
this._delay(function(){
this.focus(event,newItem);
});
}
},
next:function(event){
this._move("next","first",event);
},
previous:function(event){
this._move("prev","last",event);
},
isFirstItem:function(){
return this.active&&!this.active.prevAll(".ui-menu-item").length;
},
isLastItem:function(){
return this.active&&!this.active.nextAll(".ui-menu-item").length;
},
_move:function(direction,filter,event){
var next;
if(this.active){
if(direction==="first"||direction==="last"){
next=this.active
[direction==="first"?"prevAll":"nextAll"](".ui-menu-item")
.eq(-1);
}else{
next=this.active
[direction+"All"](".ui-menu-item")
.eq(0);
}
}
if(!next||!next.length||!this.active){
next=this.activeMenu.children(".ui-menu-item")[filter]();
}
this.focus(event,next);
},
nextPage:function(event){
var item,base,height;
if(!this.active){
this.next(event);
return;
}
if(this.isLastItem()){
return;
}
if(this._hasScroll()){
base=this.active.offset().top;
height=this.element.height();
this.active.nextAll(".ui-menu-item").each(function(){
item=$(this);
return item.offset().top-base-height<0;
});
this.focus(event,item);
}else{
this.focus(event,this.activeMenu.children(".ui-menu-item")
[!this.active?"first":"last"]());
}
},
previousPage:function(event){
var item,base,height;
if(!this.active){
this.next(event);
return;
}
if(this.isFirstItem()){
return;
}
if(this._hasScroll()){
base=this.active.offset().top;
height=this.element.height();
this.active.prevAll(".ui-menu-item").each(function(){
item=$(this);
return item.offset().top-base+height>0;
});
this.focus(event,item);
}else{
this.focus(event,this.activeMenu.children(".ui-menu-item").first());
}
},
_hasScroll:function(){
return this.element.outerHeight()<this.element.prop("scrollHeight");
},
select:function(event){
this.active=this.active||$(event.target).closest(".ui-menu-item");
var ui={item:this.active};
if(!this.active.has(".ui-menu").length){
this.collapseAll(event,true);
}
this._trigger("select",event,ui);
}
});
}(jQuery));
(function($,undefined){
$.widget("ui.progressbar",{
version:"1.10.4",
options:{
max:100,
value:0,
change:null,
complete:null
},
min:0,
_create:function(){
this.oldValue=this.options.value=this._constrainedValue();
this.element
.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all")
.attr({
role:"progressbar",
"aria-valuemin":this.min
});
this.valueDiv=$("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>")
.appendTo(this.element);
this._refreshValue();
},
_destroy:function(){
this.element
.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all")
.removeAttr("role")
.removeAttr("aria-valuemin")
.removeAttr("aria-valuemax")
.removeAttr("aria-valuenow");
this.valueDiv.remove();
},
value:function(newValue){
if(newValue===undefined){
return this.options.value;
}
this.options.value=this._constrainedValue(newValue);
this._refreshValue();
},
_constrainedValue:function(newValue){
if(newValue===undefined){
newValue=this.options.value;
}
this.indeterminate=newValue===false;
if(typeof newValue!=="number"){
newValue=0;
}
return this.indeterminate?false:
Math.min(this.options.max,Math.max(this.min,newValue));
},
_setOptions:function(options){
var value=options.value;
delete options.value;
this._super(options);
this.options.value=this._constrainedValue(value);
this._refreshValue();
},
_setOption:function(key,value){
if(key==="max"){
value=Math.max(this.min,value);
}
this._super(key,value);
},
_percentage:function(){
return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min);
},
_refreshValue:function(){
var value=this.options.value,
percentage=this._percentage();
this.valueDiv
.toggle(this.indeterminate||value>this.min)
.toggleClass("ui-corner-right",value===this.options.max)
.width(percentage.toFixed(0)+"%");
this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate);
if(this.indeterminate){
this.element.removeAttr("aria-valuenow");
if(!this.overlayDiv){
this.overlayDiv=$("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv);
}
}else{
this.element.attr({
"aria-valuemax":this.options.max,
"aria-valuenow":value
});
if(this.overlayDiv){
this.overlayDiv.remove();
this.overlayDiv=null;
}
}
if(this.oldValue!==value){
this.oldValue=value;
this._trigger("change");
}
if(value===this.options.max){
this._trigger("complete");
}
}
});
})(jQuery);
(function($,undefined){
function num(v){
return parseInt(v,10)||0;
}
function isNumber(value){
return!isNaN(parseInt(value,10));
}
$.widget("ui.resizable",$.ui.mouse,{
version:"1.10.4",
widgetEventPrefix:"resize",
options:{
alsoResize:false,
animate:false,
animateDuration:"slow",
animateEasing:"swing",
aspectRatio:false,
autoHide:false,
containment:false,
ghost:false,
grid:false,
handles:"e,s,se",
helper:false,
maxHeight:null,
maxWidth:null,
minHeight:10,
minWidth:10,
zIndex:90,
resize:null,
start:null,
stop:null
},
_create:function(){
var n,i,handle,axis,hname,
that=this,
o=this.options;
this.element.addClass("ui-resizable");
$.extend(this,{
_aspectRatio:!!(o.aspectRatio),
aspectRatio:o.aspectRatio,
originalElement:this.element,
_proportionallyResizeElements:[],
_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null
});
if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){
this.element.wrap(
$("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({
position:this.element.css("position"),
width:this.element.outerWidth(),
height:this.element.outerHeight(),
top:this.element.css("top"),
left:this.element.css("left")
})
);
this.element=this.element.parent().data(
"ui-resizable",this.element.data("ui-resizable")
);
this.elementIsWrapper=true;
this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});
this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});
this.originalResizeStyle=this.originalElement.css("resize");
this.originalElement.css("resize","none");
this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));
this.originalElement.css({margin:this.originalElement.css("margin")});
this._proportionallyResize();
}
this.handles=o.handles||(!$(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});
if(this.handles.constructor===String){
if(this.handles==="all"){
this.handles="n,e,s,w,se,sw,ne,nw";
}
n=this.handles.split(",");
this.handles={};
for(i=0;i<n.length;i++){
handle=$.trim(n[i]);
hname="ui-resizable-"+handle;
axis=$("<div class='ui-resizable-handle "+hname+"'></div>");
axis.css({zIndex:o.zIndex});
if("se"===handle){
axis.addClass("ui-icon ui-icon-gripsmall-diagonal-se");
}
this.handles[handle]=".ui-resizable-"+handle;
this.element.append(axis);
}
}
this._renderAxis=function(target){
var i,axis,padPos,padWrapper;
target=target||this.element;
for(i in this.handles){
if(this.handles[i].constructor===String){
this.handles[i]=$(this.handles[i],this.element).show();
}
if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){
axis=$(this.handles[i],this.element);
padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth();
padPos=["padding",
/ne|nw|n/.test(i)?"Top":
/se|sw|s/.test(i)?"Bottom":
/^e$/.test(i)?"Right":"Left"].join("");
target.css(padPos,padWrapper);
this._proportionallyResize();
}
if(!$(this.handles[i]).length){
continue;
}
}
};
this._renderAxis(this.element);
this._handles=$(".ui-resizable-handle",this.element)
.disableSelection();
this._handles.mouseover(function(){
if(!that.resizing){
if(this.className){
axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);
}
that.axis=axis&&axis[1]?axis[1]:"se";
}
});
if(o.autoHide){
this._handles.hide();
$(this.element)
.addClass("ui-resizable-autohide")
.mouseenter(function(){
if(o.disabled){
return;
}
$(this).removeClass("ui-resizable-autohide");
that._handles.show();
})
.mouseleave(function(){
if(o.disabled){
return;
}
if(!that.resizing){
$(this).addClass("ui-resizable-autohide");
that._handles.hide();
}
});
}
this._mouseInit();
},
_destroy:function(){
this._mouseDestroy();
var wrapper,
_destroy=function(exp){
$(exp).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing")
.removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove();
};
if(this.elementIsWrapper){
_destroy(this.element);
wrapper=this.element;
this.originalElement.css({
position:wrapper.css("position"),
width:wrapper.outerWidth(),
height:wrapper.outerHeight(),
top:wrapper.css("top"),
left:wrapper.css("left")
}).insertAfter(wrapper);
wrapper.remove();
}
this.originalElement.css("resize",this.originalResizeStyle);
_destroy(this.originalElement);
return this;
},
_mouseCapture:function(event){
var i,handle,
capture=false;
for(i in this.handles){
handle=$(this.handles[i])[0];
if(handle===event.target||$.contains(handle,event.target)){
capture=true;
}
}
return!this.options.disabled&&capture;
},
_mouseStart:function(event){
var curleft,curtop,cursor,
o=this.options,
iniPos=this.element.position(),
el=this.element;
this.resizing=true;
if((/absolute/).test(el.css("position"))){
el.css({position:"absolute",top:el.css("top"),left:el.css("left")});
}else if(el.is(".ui-draggable")){
el.css({position:"absolute",top:iniPos.top,left:iniPos.left});
}
this._renderProxy();
curleft=num(this.helper.css("left"));
curtop=num(this.helper.css("top"));
if(o.containment){
curleft+=$(o.containment).scrollLeft()||0;
curtop+=$(o.containment).scrollTop()||0;
}
this.offset=this.helper.offset();
this.position={left:curleft,top:curtop};
this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:el.width(),height:el.height()};
this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};
this.originalPosition={left:curleft,top:curtop};
this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()};
this.originalMousePosition={left:event.pageX,top:event.pageY};
this.aspectRatio=(typeof o.aspectRatio==="number")?o.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);
cursor=$(".ui-resizable-"+this.axis).css("cursor");
$("body").css("cursor",cursor==="auto"?this.axis+"-resize":cursor);
el.addClass("ui-resizable-resizing");
this._propagate("start",event);
return true;
},
_mouseDrag:function(event){
var data,
el=this.helper,props={},
smp=this.originalMousePosition,
a=this.axis,
prevTop=this.position.top,
prevLeft=this.position.left,
prevWidth=this.size.width,
prevHeight=this.size.height,
dx=(event.pageX-smp.left)||0,
dy=(event.pageY-smp.top)||0,
trigger=this._change[a];
if(!trigger){
return false;
}
data=trigger.apply(this,[event,dx,dy]);
this._updateVirtualBoundaries(event.shiftKey);
if(this._aspectRatio||event.shiftKey){
data=this._updateRatio(data,event);
}
data=this._respectSize(data,event);
this._updateCache(data);
this._propagate("resize",event);
if(this.position.top!==prevTop){
props.top=this.position.top+"px";
}
if(this.position.left!==prevLeft){
props.left=this.position.left+"px";
}
if(this.size.width!==prevWidth){
props.width=this.size.width+"px";
}
if(this.size.height!==prevHeight){
props.height=this.size.height+"px";
}
el.css(props);
if(!this._helper&&this._proportionallyResizeElements.length){
this._proportionallyResize();
}
if(!$.isEmptyObject(props)){
this._trigger("resize",event,this.ui());
}
return false;
},
_mouseStop:function(event){
this.resizing=false;
var pr,ista,soffseth,soffsetw,s,left,top,
o=this.options,that=this;
if(this._helper){
pr=this._proportionallyResizeElements;
ista=pr.length&&(/textarea/i).test(pr[0].nodeName);
soffseth=ista&&$.ui.hasScroll(pr[0],"left")?0:that.sizeDiff.height;
soffsetw=ista?0:that.sizeDiff.width;
s={width:(that.helper.width()-soffsetw),height:(that.helper.height()-soffseth)};
left=(parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left))||null;
top=(parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top))||null;
if(!o.animate){
this.element.css($.extend(s,{top:top,left:left}));
}
that.helper.height(that.size.height);
that.helper.width(that.size.width);
if(this._helper&&!o.animate){
this._proportionallyResize();
}
}
$("body").css("cursor","auto");
this.element.removeClass("ui-resizable-resizing");
this._propagate("stop",event);
if(this._helper){
this.helper.remove();
}
return false;
},
_updateVirtualBoundaries:function(forceAspectRatio){
var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,
o=this.options;
b={
minWidth:isNumber(o.minWidth)?o.minWidth:0,
maxWidth:isNumber(o.maxWidth)?o.maxWidth:Infinity,
minHeight:isNumber(o.minHeight)?o.minHeight:0,
maxHeight:isNumber(o.maxHeight)?o.maxHeight:Infinity
};
if(this._aspectRatio||forceAspectRatio){
pMinWidth=b.minHeight*this.aspectRatio;
pMinHeight=b.minWidth/this.aspectRatio;
pMaxWidth=b.maxHeight*this.aspectRatio;
pMaxHeight=b.maxWidth/this.aspectRatio;
if(pMinWidth>b.minWidth){
b.minWidth=pMinWidth;
}
if(pMinHeight>b.minHeight){
b.minHeight=pMinHeight;
}
if(pMaxWidth<b.maxWidth){
b.maxWidth=pMaxWidth;
}
if(pMaxHeight<b.maxHeight){
b.maxHeight=pMaxHeight;
}
}
this._vBoundaries=b;
},
_updateCache:function(data){
this.offset=this.helper.offset();
if(isNumber(data.left)){
this.position.left=data.left;
}
if(isNumber(data.top)){
this.position.top=data.top;
}
if(isNumber(data.height)){
this.size.height=data.height;
}
if(isNumber(data.width)){
this.size.width=data.width;
}
},
_updateRatio:function(data){
var cpos=this.position,
csize=this.size,
a=this.axis;
if(isNumber(data.height)){
data.width=(data.height*this.aspectRatio);
}else if(isNumber(data.width)){
data.height=(data.width/this.aspectRatio);
}
if(a==="sw"){
data.left=cpos.left+(csize.width-data.width);
data.top=null;
}
if(a==="nw"){
data.top=cpos.top+(csize.height-data.height);
data.left=cpos.left+(csize.width-data.width);
}
return data;
},
_respectSize:function(data){
var o=this._vBoundaries,
a=this.axis,
ismaxw=isNumber(data.width)&&o.maxWidth&&(o.maxWidth<data.width),ismaxh=isNumber(data.height)&&o.maxHeight&&(o.maxHeight<data.height),
isminw=isNumber(data.width)&&o.minWidth&&(o.minWidth>data.width),isminh=isNumber(data.height)&&o.minHeight&&(o.minHeight>data.height),
dw=this.originalPosition.left+this.originalSize.width,
dh=this.position.top+this.size.height,
cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);
if(isminw){
data.width=o.minWidth;
}
if(isminh){
data.height=o.minHeight;
}
if(ismaxw){
data.width=o.maxWidth;
}
if(ismaxh){
data.height=o.maxHeight;
}
if(isminw&&cw){
data.left=dw-o.minWidth;
}
if(ismaxw&&cw){
data.left=dw-o.maxWidth;
}
if(isminh&&ch){
data.top=dh-o.minHeight;
}
if(ismaxh&&ch){
data.top=dh-o.maxHeight;
}
if(!data.width&&!data.height&&!data.left&&data.top){
data.top=null;
}else if(!data.width&&!data.height&&!data.top&&data.left){
data.left=null;
}
return data;
},
_proportionallyResize:function(){
if(!this._proportionallyResizeElements.length){
return;
}
var i,j,borders,paddings,prel,
element=this.helper||this.element;
for(i=0;i<this._proportionallyResizeElements.length;i++){
prel=this._proportionallyResizeElements[i];
if(!this.borderDif){
this.borderDif=[];
borders=[prel.css("borderTopWidth"),prel.css("borderRightWidth"),prel.css("borderBottomWidth"),prel.css("borderLeftWidth")];
paddings=[prel.css("paddingTop"),prel.css("paddingRight"),prel.css("paddingBottom"),prel.css("paddingLeft")];
for(j=0;j<borders.length;j++){
this.borderDif[j]=(parseInt(borders[j],10)||0)+(parseInt(paddings[j],10)||0);
}
}
prel.css({
height:(element.height()-this.borderDif[0]-this.borderDif[2])||0,
width:(element.width()-this.borderDif[1]-this.borderDif[3])||0
});
}
},
_renderProxy:function(){
var el=this.element,o=this.options;
this.elementOffset=el.offset();
if(this._helper){
this.helper=this.helper||$("<div style='overflow:hidden;'></div>");
this.helper.addClass(this._helper).css({
width:this.element.outerWidth()-1,
height:this.element.outerHeight()-1,
position:"absolute",
left:this.elementOffset.left+"px",
top:this.elementOffset.top+"px",
zIndex:++o.zIndex});
this.helper
.appendTo("body")
.disableSelection();
}else{
this.helper=this.element;
}
},
_change:{
e:function(event,dx){
return{width:this.originalSize.width+dx};
},
w:function(event,dx){
var cs=this.originalSize,sp=this.originalPosition;
return{left:sp.left+dx,width:cs.width-dx};
},
n:function(event,dx,dy){
var cs=this.originalSize,sp=this.originalPosition;
return{top:sp.top+dy,height:cs.height-dy};
},
s:function(event,dx,dy){
return{height:this.originalSize.height+dy};
},
se:function(event,dx,dy){
return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]));
},
sw:function(event,dx,dy){
return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]));
},
ne:function(event,dx,dy){
return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]));
},
nw:function(event,dx,dy){
return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]));
}
},
_propagate:function(n,event){
$.ui.plugin.call(this,n,[event,this.ui()]);
(n!=="resize"&&this._trigger(n,event,this.ui()));
},
plugins:{},
ui:function(){
return{
originalElement:this.originalElement,
element:this.element,
helper:this.helper,
position:this.position,
size:this.size,
originalSize:this.originalSize,
originalPosition:this.originalPosition
};
}
});

$.ui.plugin.add("resizable","animate",{
stop:function(event){
var that=$(this).data("ui-resizable"),
o=that.options,
pr=that._proportionallyResizeElements,
ista=pr.length&&(/textarea/i).test(pr[0].nodeName),
soffseth=ista&&$.ui.hasScroll(pr[0],"left")?0:that.sizeDiff.height,
soffsetw=ista?0:that.sizeDiff.width,
style={width:(that.size.width-soffsetw),height:(that.size.height-soffseth)},
left=(parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left))||null,
top=(parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top))||null;
that.element.animate(
$.extend(style,top&&left?{top:top,left:left}:{}),{
duration:o.animateDuration,
easing:o.animateEasing,
step:function(){
var data={
width:parseInt(that.element.css("width"),10),
height:parseInt(that.element.css("height"),10),
top:parseInt(that.element.css("top"),10),
left:parseInt(that.element.css("left"),10)
};
if(pr&&pr.length){
$(pr[0]).css({width:data.width,height:data.height});
}
that._updateCache(data);
that._propagate("resize",event);
}
}
);
}
});
$.ui.plugin.add("resizable","containment",{
start:function(){
var element,p,co,ch,cw,width,height,
that=$(this).data("ui-resizable"),
o=that.options,
el=that.element,
oc=o.containment,
ce=(oc instanceof $)?oc.get(0):(/parent/.test(oc))?el.parent().get(0):oc;
if(!ce){
return;
}
that.containerElement=$(ce);
if(/document/.test(oc)||oc===document){
that.containerOffset={left:0,top:0};
that.containerPosition={left:0,top:0};
that.parentData={
element:$(document),left:0,top:0,
width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight
};
}
else{
element=$(ce);
p=[];
$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=num(element.css("padding"+name))});
that.containerOffset=element.offset();
that.containerPosition=element.position();
that.containerSize={height:(element.innerHeight()-p[3]),width:(element.innerWidth()-p[1])};
co=that.containerOffset;
ch=that.containerSize.height;
cw=that.containerSize.width;
width=($.ui.hasScroll(ce,"left")?ce.scrollWidth:cw);
height=($.ui.hasScroll(ce)?ce.scrollHeight:ch);
that.parentData={
element:ce,left:co.left,top:co.top,width:width,height:height
};
}
},
resize:function(event){
var woset,hoset,isParent,isOffsetRelative,
that=$(this).data("ui-resizable"),
o=that.options,
co=that.containerOffset,cp=that.position,
pRatio=that._aspectRatio||event.shiftKey,
cop={top:0,left:0},ce=that.containerElement;
if(ce[0]!==document&&(/static/).test(ce.css("position"))){
cop=co;
}
if(cp.left<(that._helper?co.left:0)){
that.size.width=that.size.width+(that._helper?(that.position.left-co.left):(that.position.left-cop.left));
if(pRatio){
that.size.height=that.size.width/that.aspectRatio;
}
that.position.left=o.helper?co.left:0;
}
if(cp.top<(that._helper?co.top:0)){
that.size.height=that.size.height+(that._helper?(that.position.top-co.top):that.position.top);
if(pRatio){
that.size.width=that.size.height*that.aspectRatio;
}
that.position.top=that._helper?co.top:0;
}
that.offset.left=that.parentData.left+that.position.left;
that.offset.top=that.parentData.top+that.position.top;
woset=Math.abs((that._helper?that.offset.left-cop.left:(that.offset.left-cop.left))+that.sizeDiff.width);
hoset=Math.abs((that._helper?that.offset.top-cop.top:(that.offset.top-co.top))+that.sizeDiff.height);
isParent=that.containerElement.get(0)===that.element.parent().get(0);
isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position"));
if(isParent&&isOffsetRelative){
woset-=Math.abs(that.parentData.left);
}
if(woset+that.size.width>=that.parentData.width){
that.size.width=that.parentData.width-woset;
if(pRatio){
that.size.height=that.size.width/that.aspectRatio;
}
}
if(hoset+that.size.height>=that.parentData.height){
that.size.height=that.parentData.height-hoset;
if(pRatio){
that.size.width=that.size.height*that.aspectRatio;
}
}
},
stop:function(){
var that=$(this).data("ui-resizable"),
o=that.options,
co=that.containerOffset,
cop=that.containerPosition,
ce=that.containerElement,
helper=$(that.helper),
ho=helper.offset(),
w=helper.outerWidth()-that.sizeDiff.width,
h=helper.outerHeight()-that.sizeDiff.height;
if(that._helper&&!o.animate&&(/relative/).test(ce.css("position"))){
$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});
}
if(that._helper&&!o.animate&&(/static/).test(ce.css("position"))){
$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});
}
}
});
$.ui.plugin.add("resizable","alsoResize",{
start:function(){
var that=$(this).data("ui-resizable"),
o=that.options,
_store=function(exp){
$(exp).each(function(){
var el=$(this);
el.data("ui-resizable-alsoresize",{
width:parseInt(el.width(),10),height:parseInt(el.height(),10),
left:parseInt(el.css("left"),10),top:parseInt(el.css("top"),10)
});
});
};
if(typeof(o.alsoResize)==="object"&&!o.alsoResize.parentNode){
if(o.alsoResize.length){o.alsoResize=o.alsoResize[0];_store(o.alsoResize)}
else{$.each(o.alsoResize,function(exp){_store(exp)})}
}else{
_store(o.alsoResize);
}
},
resize:function(event,ui){
var that=$(this).data("ui-resizable"),
o=that.options,
os=that.originalSize,
op=that.originalPosition,
delta={
height:(that.size.height-os.height)||0,width:(that.size.width-os.width)||0,
top:(that.position.top-op.top)||0,left:(that.position.left-op.left)||0
},
_alsoResize=function(exp,c){
$(exp).each(function(){
var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},
css=c&&c.length?c:el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];
$.each(css,function(i,prop){
var sum=(start[prop]||0)+(delta[prop]||0);
if(sum&&sum>=0){
style[prop]=sum||null;
}
});
el.css(style);
});
};
if(typeof(o.alsoResize)==="object"&&!o.alsoResize.nodeType){
$.each(o.alsoResize,function(exp,c){_alsoResize(exp,c)});
}else{
_alsoResize(o.alsoResize);
}
},
stop:function(){
$(this).removeData("resizable-alsoresize");
}
});
$.ui.plugin.add("resizable","ghost",{
start:function(){
var that=$(this).data("ui-resizable"),o=that.options,cs=that.size;
that.ghost=that.originalElement.clone();
that.ghost
.css({opacity:0.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0})
.addClass("ui-resizable-ghost")
.addClass(typeof o.ghost==="string"?o.ghost:"");
that.ghost.appendTo(that.helper);
},
resize:function(){
var that=$(this).data("ui-resizable");
if(that.ghost){
that.ghost.css({position:"relative",height:that.size.height,width:that.size.width});
}
},
stop:function(){
var that=$(this).data("ui-resizable");
if(that.ghost&&that.helper){
that.helper.get(0).removeChild(that.ghost.get(0));
}
}
});
$.ui.plugin.add("resizable","grid",{
resize:function(){
var that=$(this).data("ui-resizable"),
o=that.options,
cs=that.size,
os=that.originalSize,
op=that.originalPosition,
a=that.axis,
grid=typeof o.grid==="number"?[o.grid,o.grid]:o.grid,
gridX=(grid[0]||1),
gridY=(grid[1]||1),
ox=Math.round((cs.width-os.width)/gridX)*gridX,
oy=Math.round((cs.height-os.height)/gridY)*gridY,
newWidth=os.width+ox,
newHeight=os.height+oy,
isMaxWidth=o.maxWidth&&(o.maxWidth<newWidth),
isMaxHeight=o.maxHeight&&(o.maxHeight<newHeight),
isMinWidth=o.minWidth&&(o.minWidth>newWidth),
isMinHeight=o.minHeight&&(o.minHeight>newHeight);
o.grid=grid;
if(isMinWidth){
newWidth=newWidth+gridX;
}
if(isMinHeight){
newHeight=newHeight+gridY;
}
if(isMaxWidth){
newWidth=newWidth-gridX;
}
if(isMaxHeight){
newHeight=newHeight-gridY;
}
if(/^(se|s|e)$/.test(a)){
that.size.width=newWidth;
that.size.height=newHeight;
}else if(/^(ne)$/.test(a)){
that.size.width=newWidth;
that.size.height=newHeight;
that.position.top=op.top-oy;
}else if(/^(sw)$/.test(a)){
that.size.width=newWidth;
that.size.height=newHeight;
that.position.left=op.left-ox;
}else{
if(newHeight-gridY>0){
that.size.height=newHeight;
that.position.top=op.top-oy;
}else{
that.size.height=gridY;
that.position.top=op.top+os.height-gridY;
}
if(newWidth-gridX>0){
that.size.width=newWidth;
that.position.left=op.left-ox;
}else{
that.size.width=gridX;
that.position.left=op.left+os.width-gridX;
}
}
}
});
})(jQuery);
(function($,undefined){
$.widget("ui.selectable",$.ui.mouse,{
version:"1.10.4",
options:{
appendTo:"body",
autoRefresh:true,
distance:0,
filter:"*",
tolerance:"touch",
selected:null,
selecting:null,
start:null,
stop:null,
unselected:null,
unselecting:null
},
_create:function(){
var selectees,
that=this;
this.element.addClass("ui-selectable");
this.dragged=false;
this.refresh=function(){
selectees=$(that.options.filter,that.element[0]);
selectees.addClass("ui-selectee");
selectees.each(function(){
var $this=$(this),
pos=$this.offset();
$.data(this,"selectable-item",{
element:this,
$element:$this,
left:pos.left,
top:pos.top,
right:pos.left+$this.outerWidth(),
bottom:pos.top+$this.outerHeight(),
startselected:false,
selected:$this.hasClass("ui-selected"),
selecting:$this.hasClass("ui-selecting"),
unselecting:$this.hasClass("ui-unselecting")
});
});
};
this.refresh();
this.selectees=selectees.addClass("ui-selectee");
this._mouseInit();
this.helper=$("<div class='ui-selectable-helper'></div>");
},
_destroy:function(){
this.selectees
.removeClass("ui-selectee")
.removeData("selectable-item");
this.element
.removeClass("ui-selectable ui-selectable-disabled");
this._mouseDestroy();
},
_mouseStart:function(event){
var that=this,
options=this.options;
this.opos=[event.pageX,event.pageY];
if(this.options.disabled){
return;
}
this.selectees=$(options.filter,this.element[0]);
this._trigger("start",event);
$(options.appendTo).append(this.helper);
this.helper.css({
"left":event.pageX,
"top":event.pageY,
"width":0,
"height":0
});
if(options.autoRefresh){
this.refresh();
}
this.selectees.filter(".ui-selected").each(function(){
var selectee=$.data(this,"selectable-item");
selectee.startselected=true;
if(!event.metaKey&&!event.ctrlKey){
selectee.$element.removeClass("ui-selected");
selectee.selected=false;
selectee.$element.addClass("ui-unselecting");
selectee.unselecting=true;
that._trigger("unselecting",event,{
unselecting:selectee.element
});
}
});
$(event.target).parents().addBack().each(function(){
var doSelect,
selectee=$.data(this,"selectable-item");
if(selectee){
doSelect=(!event.metaKey&&!event.ctrlKey)||!selectee.$element.hasClass("ui-selected");
selectee.$element
.removeClass(doSelect?"ui-unselecting":"ui-selected")
.addClass(doSelect?"ui-selecting":"ui-unselecting");
selectee.unselecting=!doSelect;
selectee.selecting=doSelect;
selectee.selected=doSelect;
if(doSelect){
that._trigger("selecting",event,{
selecting:selectee.element
});
}else{
that._trigger("unselecting",event,{
unselecting:selectee.element
});
}
return false;
}
});
},
_mouseDrag:function(event){
this.dragged=true;
if(this.options.disabled){
return;
}
var tmp,
that=this,
options=this.options,
x1=this.opos[0],
y1=this.opos[1],
x2=event.pageX,
y2=event.pageY;
if(x1>x2){tmp=x2;x2=x1;x1=tmp}
if(y1>y2){tmp=y2;y2=y1;y1=tmp}
this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1});
this.selectees.each(function(){
var selectee=$.data(this,"selectable-item"),
hit=false;
if(!selectee||selectee.element===that.element[0]){
return;
}
if(options.tolerance==="touch"){
hit=(!(selectee.left>x2||selectee.right<x1||selectee.top>y2||selectee.bottom<y1));
}else if(options.tolerance==="fit"){
hit=(selectee.left>x1&&selectee.right<x2&&selectee.top>y1&&selectee.bottom<y2);
}
if(hit){
if(selectee.selected){
selectee.$element.removeClass("ui-selected");
selectee.selected=false;
}
if(selectee.unselecting){
selectee.$element.removeClass("ui-unselecting");
selectee.unselecting=false;
}
if(!selectee.selecting){
selectee.$element.addClass("ui-selecting");
selectee.selecting=true;
that._trigger("selecting",event,{
selecting:selectee.element
});
}
}else{
if(selectee.selecting){
if((event.metaKey||event.ctrlKey)&&selectee.startselected){
selectee.$element.removeClass("ui-selecting");
selectee.selecting=false;
selectee.$element.addClass("ui-selected");
selectee.selected=true;
}else{
selectee.$element.removeClass("ui-selecting");
selectee.selecting=false;
if(selectee.startselected){
selectee.$element.addClass("ui-unselecting");
selectee.unselecting=true;
}
that._trigger("unselecting",event,{
unselecting:selectee.element
});
}
}
if(selectee.selected){
if(!event.metaKey&&!event.ctrlKey&&!selectee.startselected){
selectee.$element.removeClass("ui-selected");
selectee.selected=false;
selectee.$element.addClass("ui-unselecting");
selectee.unselecting=true;
that._trigger("unselecting",event,{
unselecting:selectee.element
});
}
}
}
});
return false;
},
_mouseStop:function(event){
var that=this;
this.dragged=false;
$(".ui-unselecting",this.element[0]).each(function(){
var selectee=$.data(this,"selectable-item");
selectee.$element.removeClass("ui-unselecting");
selectee.unselecting=false;
selectee.startselected=false;
that._trigger("unselected",event,{
unselected:selectee.element
});
});
$(".ui-selecting",this.element[0]).each(function(){
var selectee=$.data(this,"selectable-item");
selectee.$element.removeClass("ui-selecting").addClass("ui-selected");
selectee.selecting=false;
selectee.selected=true;
selectee.startselected=true;
that._trigger("selected",event,{
selected:selectee.element
});
});
this._trigger("stop",event);
this.helper.remove();
return false;
}
});
})(jQuery);
(function($,undefined){
var numPages=5;
$.widget("ui.slider",$.ui.mouse,{
version:"1.10.4",
widgetEventPrefix:"slide",
options:{
animate:false,
distance:0,
max:100,
min:0,
orientation:"horizontal",
range:false,
step:1,
value:0,
values:null,
change:null,
slide:null,
start:null,
stop:null
},
_create:function(){
this._keySliding=false;
this._mouseSliding=false;
this._animateOff=true;
this._handleIndex=null;
this._detectOrientation();
this._mouseInit();
this.element
.addClass("ui-slider"+
" ui-slider-"+this.orientation+
" ui-widget"+
" ui-widget-content"+
" ui-corner-all");
this._refresh();
this._setOption("disabled",this.options.disabled);
this._animateOff=false;
},
_refresh:function(){
this._createRange();
this._createHandles();
this._setupEvents();
this._refreshValue();
},
_createHandles:function(){
var i,handleCount,
options=this.options,
existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),
handle="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",
handles=[];
handleCount=(options.values&&options.values.length)||1;
if(existingHandles.length>handleCount){
existingHandles.slice(handleCount).remove();
existingHandles=existingHandles.slice(0,handleCount);
}
for(i=existingHandles.length;i<handleCount;i++){
handles.push(handle);
}
this.handles=existingHandles.add($(handles.join("")).appendTo(this.element));
this.handle=this.handles.eq(0);
this.handles.each(function(i){
$(this).data("ui-slider-handle-index",i);
});
},
_createRange:function(){
var options=this.options,
classes="";
if(options.range){
if(options.range===true){
if(!options.values){
options.values=[this._valueMin(),this._valueMin()];
}else if(options.values.length&&options.values.length!==2){
options.values=[options.values[0],options.values[0]];
}else if($.isArray(options.values)){
options.values=options.values.slice(0);
}
}
if(!this.range||!this.range.length){
this.range=$("<div></div>")
.appendTo(this.element);
classes="ui-slider-range"+
" ui-widget-header ui-corner-all";
}else{
this.range.removeClass("ui-slider-range-min ui-slider-range-max")
.css({
"left":"",
"bottom":""
});
}
this.range.addClass(classes+
((options.range==="min"||options.range==="max")?" ui-slider-range-"+options.range:""));
}else{
if(this.range){
this.range.remove();
}
this.range=null;
}
},
_setupEvents:function(){
var elements=this.handles.add(this.range).filter("a");
this._off(elements);
this._on(elements,this._handleEvents);
this._hoverable(elements);
this._focusable(elements);
},
_destroy:function(){
this.handles.remove();
if(this.range){
this.range.remove();
}
this.element
.removeClass("ui-slider"+
" ui-slider-horizontal"+
" ui-slider-vertical"+
" ui-widget"+
" ui-widget-content"+
" ui-corner-all");
this._mouseDestroy();
},
_mouseCapture:function(event){
var position,normValue,distance,closestHandle,index,allowed,offset,mouseOverHandle,
that=this,
o=this.options;
if(o.disabled){
return false;
}
this.elementSize={
width:this.element.outerWidth(),
height:this.element.outerHeight()
};
this.elementOffset=this.element.offset();
position={x:event.pageX,y:event.pageY};
normValue=this._normValueFromMouse(position);
distance=this._valueMax()-this._valueMin()+1;
this.handles.each(function(i){
var thisDistance=Math.abs(normValue-that.values(i));
if((distance>thisDistance)||
(distance===thisDistance&&
(i===that._lastChangedValue||that.values(i)===o.min))){
distance=thisDistance;
closestHandle=$(this);
index=i;
}
});
allowed=this._start(event,index);
if(allowed===false){
return false;
}
this._mouseSliding=true;
this._handleIndex=index;
closestHandle
.addClass("ui-state-active")
.focus();
offset=closestHandle.offset();
mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle");
this._clickOffset=mouseOverHandle?{left:0,top:0}:{
left:event.pageX-offset.left-(closestHandle.width()/2),
top:event.pageY-offset.top-
(closestHandle.height()/2)-
(parseInt(closestHandle.css("borderTopWidth"),10)||0)-
(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+
(parseInt(closestHandle.css("marginTop"),10)||0)
};
if(!this.handles.hasClass("ui-state-hover")){
this._slide(event,index,normValue);
}
this._animateOff=true;
return true;
},
_mouseStart:function(){
return true;
},
_mouseDrag:function(event){
var position={x:event.pageX,y:event.pageY},
normValue=this._normValueFromMouse(position);
this._slide(event,this._handleIndex,normValue);
return false;
},
_mouseStop:function(event){
this.handles.removeClass("ui-state-active");
this._mouseSliding=false;
this._stop(event,this._handleIndex);
this._change(event,this._handleIndex);
this._handleIndex=null;
this._clickOffset=null;
this._animateOff=false;
return false;
},
_detectOrientation:function(){
this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal";
},
_normValueFromMouse:function(position){
var pixelTotal,
pixelMouse,
percentMouse,
valueTotal,
valueMouse;
if(this.orientation==="horizontal"){
pixelTotal=this.elementSize.width;
pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0);
}else{
pixelTotal=this.elementSize.height;
pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0);
}
percentMouse=(pixelMouse/pixelTotal);
if(percentMouse>1){
percentMouse=1;
}
if(percentMouse<0){
percentMouse=0;
}
if(this.orientation==="vertical"){
percentMouse=1-percentMouse;
}
valueTotal=this._valueMax()-this._valueMin();
valueMouse=this._valueMin()+percentMouse*valueTotal;
return this._trimAlignValue(valueMouse);
},
_start:function(event,index){
var uiHash={
handle:this.handles[index],
value:this.value()
};
if(this.options.values&&this.options.values.length){
uiHash.value=this.values(index);
uiHash.values=this.values();
}
return this._trigger("start",event,uiHash);
},
_slide:function(event,index,newVal){
var otherVal,
newValues,
allowed;
if(this.options.values&&this.options.values.length){
otherVal=this.values(index?0:1);
if((this.options.values.length===2&&this.options.range===true)&&
((index===0&&newVal>otherVal)||(index===1&&newVal<otherVal))
){
newVal=otherVal;
}
if(newVal!==this.values(index)){
newValues=this.values();
newValues[index]=newVal;
allowed=this._trigger("slide",event,{
handle:this.handles[index],
value:newVal,
values:newValues
});
otherVal=this.values(index?0:1);
if(allowed!==false){
this.values(index,newVal);
}
}
}else{
if(newVal!==this.value()){
allowed=this._trigger("slide",event,{
handle:this.handles[index],
value:newVal
});
if(allowed!==false){
this.value(newVal);
}
}
}
},
_stop:function(event,index){
var uiHash={
handle:this.handles[index],
value:this.value()
};
if(this.options.values&&this.options.values.length){
uiHash.value=this.values(index);
uiHash.values=this.values();
}
this._trigger("stop",event,uiHash);
},
_change:function(event,index){
if(!this._keySliding&&!this._mouseSliding){
var uiHash={
handle:this.handles[index],
value:this.value()
};
if(this.options.values&&this.options.values.length){
uiHash.value=this.values(index);
uiHash.values=this.values();
}
this._lastChangedValue=index;
this._trigger("change",event,uiHash);
}
},
value:function(newValue){
if(arguments.length){
this.options.value=this._trimAlignValue(newValue);
this._refreshValue();
this._change(null,0);
return;
}
return this._value();
},
values:function(index,newValue){
var vals,
newValues,
i;
if(arguments.length>1){
this.options.values[index]=this._trimAlignValue(newValue);
this._refreshValue();
this._change(null,index);
return;
}
if(arguments.length){
if($.isArray(arguments[0])){
vals=this.options.values;
newValues=arguments[0];
for(i=0;i<vals.length;i+=1){
vals[i]=this._trimAlignValue(newValues[i]);
this._change(null,i);
}
this._refreshValue();
}else{
if(this.options.values&&this.options.values.length){
return this._values(index);
}else{
return this.value();
}
}
}else{
return this._values();
}
},
_setOption:function(key,value){
var i,
valsLength=0;
if(key==="range"&&this.options.range===true){
if(value==="min"){
this.options.value=this._values(0);
this.options.values=null;
}else if(value==="max"){
this.options.value=this._values(this.options.values.length-1);
this.options.values=null;
}
}
if($.isArray(this.options.values)){
valsLength=this.options.values.length;
}
$.Widget.prototype._setOption.apply(this,arguments);
switch(key){
case"orientation":
this._detectOrientation();
this.element
.removeClass("ui-slider-horizontal ui-slider-vertical")
.addClass("ui-slider-"+this.orientation);
this._refreshValue();
break;
case"value":
this._animateOff=true;
this._refreshValue();
this._change(null,0);
this._animateOff=false;
break;
case"values":
this._animateOff=true;
this._refreshValue();
for(i=0;i<valsLength;i+=1){
this._change(null,i);
}
this._animateOff=false;
break;
case"min":
case"max":
this._animateOff=true;
this._refreshValue();
this._animateOff=false;
break;
case"range":
this._animateOff=true;
this._refresh();
this._animateOff=false;
break;
}
},
_value:function(){
var val=this.options.value;
val=this._trimAlignValue(val);
return val;
},
_values:function(index){
var val,
vals,
i;
if(arguments.length){
val=this.options.values[index];
val=this._trimAlignValue(val);
return val;
}else if(this.options.values&&this.options.values.length){
vals=this.options.values.slice();
for(i=0;i<vals.length;i+=1){
vals[i]=this._trimAlignValue(vals[i]);
}
return vals;
}else{
return[];
}
},
_trimAlignValue:function(val){
if(val<=this._valueMin()){
return this._valueMin();
}
if(val>=this._valueMax()){
return this._valueMax();
}
var step=(this.options.step>0)?this.options.step:1,
valModStep=(val-this._valueMin())%step,
alignValue=val-valModStep;
if(Math.abs(valModStep)*2>=step){
alignValue+=(valModStep>0)?step:(-step);
}
return parseFloat(alignValue.toFixed(5));
},
_valueMin:function(){
return this.options.min;
},
_valueMax:function(){
return this.options.max;
},
_refreshValue:function(){
var lastValPercent,valPercent,value,valueMin,valueMax,
oRange=this.options.range,
o=this.options,
that=this,
animate=(!this._animateOff)?o.animate:false,
_set={};
if(this.options.values&&this.options.values.length){
this.handles.each(function(i){
valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100;
_set[that.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";
$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate);
if(that.options.range===true){
if(that.orientation==="horizontal"){
if(i===0){
that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate);
}
if(i===1){
that.range[animate?"animate":"css"]({width:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate});
}
}else{
if(i===0){
that.range.stop(1,1)[animate?"animate":"css"]({bottom:(valPercent)+"%"},o.animate);
}
if(i===1){
that.range[animate?"animate":"css"]({height:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate});
}
}
}
lastValPercent=valPercent;
});
}else{
value=this.value();
valueMin=this._valueMin();
valueMax=this._valueMax();
valPercent=(valueMax!==valueMin)?
(value-valueMin)/(valueMax-valueMin)*100:
0;
_set[this.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";
this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate);
if(oRange==="min"&&this.orientation==="horizontal"){
this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate);
}
if(oRange==="max"&&this.orientation==="horizontal"){
this.range[animate?"animate":"css"]({width:(100-valPercent)+"%"},{queue:false,duration:o.animate});
}
if(oRange==="min"&&this.orientation==="vertical"){
this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate);
}
if(oRange==="max"&&this.orientation==="vertical"){
this.range[animate?"animate":"css"]({height:(100-valPercent)+"%"},{queue:false,duration:o.animate});
}
}
},
_handleEvents:{
keydown:function(event){
var allowed,curVal,newVal,step,
index=$(event.target).data("ui-slider-handle-index");
switch(event.keyCode){
case $.ui.keyCode.HOME:
case $.ui.keyCode.END:
case $.ui.keyCode.PAGE_UP:
case $.ui.keyCode.PAGE_DOWN:
case $.ui.keyCode.UP:
case $.ui.keyCode.RIGHT:
case $.ui.keyCode.DOWN:
case $.ui.keyCode.LEFT:
event.preventDefault();
if(!this._keySliding){
this._keySliding=true;
$(event.target).addClass("ui-state-active");
allowed=this._start(event,index);
if(allowed===false){
return;
}
}
break;
}
step=this.options.step;
if(this.options.values&&this.options.values.length){
curVal=newVal=this.values(index);
}else{
curVal=newVal=this.value();
}
switch(event.keyCode){
case $.ui.keyCode.HOME:
newVal=this._valueMin();
break;
case $.ui.keyCode.END:
newVal=this._valueMax();
break;
case $.ui.keyCode.PAGE_UP:
newVal=this._trimAlignValue(curVal+((this._valueMax()-this._valueMin())/numPages));
break;
case $.ui.keyCode.PAGE_DOWN:
newVal=this._trimAlignValue(curVal-((this._valueMax()-this._valueMin())/numPages));
break;
case $.ui.keyCode.UP:
case $.ui.keyCode.RIGHT:
if(curVal===this._valueMax()){
return;
}
newVal=this._trimAlignValue(curVal+step);
break;
case $.ui.keyCode.DOWN:
case $.ui.keyCode.LEFT:
if(curVal===this._valueMin()){
return;
}
newVal=this._trimAlignValue(curVal-step);
break;
}
this._slide(event,index,newVal);
},
click:function(event){
event.preventDefault();
},
keyup:function(event){
var index=$(event.target).data("ui-slider-handle-index");
if(this._keySliding){
this._keySliding=false;
this._stop(event,index);
this._change(event,index);
$(event.target).removeClass("ui-state-active");
}
}
}
});
}(jQuery));
(function($,undefined){
function isOverAxis(x,reference,size){
return(x>reference)&&(x<(reference+size));
}
function isFloating(item){
return(/left|right/).test(item.css("float"))||(/inline|table-cell/).test(item.css("display"));
}
$.widget("ui.sortable",$.ui.mouse,{
version:"1.10.4",
widgetEventPrefix:"sort",
ready:false,
options:{
appendTo:"parent",
axis:false,
connectWith:false,
containment:false,
cursor:"auto",
cursorAt:false,
dropOnEmpty:true,
forcePlaceholderSize:false,
forceHelperSize:false,
grid:false,
handle:false,
helper:"original",
items:"> *",
opacity:false,
placeholder:false,
revert:false,
scroll:true,
scrollSensitivity:20,
scrollSpeed:20,
scope:"default",
tolerance:"intersect",
zIndex:1000,
activate:null,
beforeStop:null,
change:null,
deactivate:null,
out:null,
over:null,
receive:null,
remove:null,
sort:null,
start:null,
stop:null,
update:null
},
_create:function(){
var o=this.options;
this.containerCache={};
this.element.addClass("ui-sortable");
this.refresh();
this.floating=this.items.length?o.axis==="x"||isFloating(this.items[0].item):false;
this.offset=this.element.offset();
this._mouseInit();
this.ready=true;
},
_destroy:function(){
this.element
.removeClass("ui-sortable ui-sortable-disabled");
this._mouseDestroy();
for(var i=this.items.length-1;i>=0;i--){
this.items[i].item.removeData(this.widgetName+"-item");
}
return this;
},
_setOption:function(key,value){
if(key==="disabled"){
this.options[key]=value;
this.widget().toggleClass("ui-sortable-disabled",!!value);
}else{
$.Widget.prototype._setOption.apply(this,arguments);
}
},
_mouseCapture:function(event,overrideHandle){
var currentItem=null,
validHandle=false,
that=this;
if(this.reverting){
return false;
}
if(this.options.disabled||this.options.type==="static"){
return false;
}
this._refreshItems(event);
$(event.target).parents().each(function(){
if($.data(this,that.widgetName+"-item")===that){
currentItem=$(this);
return false;
}
});
if($.data(event.target,that.widgetName+"-item")===that){
currentItem=$(event.target);
}
if(!currentItem){
return false;
}
if(this.options.handle&&!overrideHandle){
$(this.options.handle,currentItem).find("*").addBack().each(function(){
if(this===event.target){
validHandle=true;
}
});
if(!validHandle){
return false;
}
}
this.currentItem=currentItem;
this._removeCurrentsFromItems();
return true;
},
_mouseStart:function(event,overrideHandle,noActivation){
var i,body,
o=this.options;
this.currentContainer=this;
this.refreshPositions();
this.helper=this._createHelper(event);
this._cacheHelperProportions();

this._cacheMargins();
this.scrollParent=this.helper.scrollParent();
this.offset=this.currentItem.offset();
this.offset={
top:this.offset.top-this.margins.top,
left:this.offset.left-this.margins.left
};
$.extend(this.offset,{
click:{left:event.pageX-this.offset.left,
top:event.pageY-this.offset.top
},
parent:this._getParentOffset(),
relative:this._getRelativeOffset()});
this.helper.css("position","absolute");
this.cssPosition=this.helper.css("position");
this.originalPosition=this._generatePosition(event);
this.originalPageX=event.pageX;
this.originalPageY=event.pageY;
(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));
this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};
if(this.helper[0]!==this.currentItem[0]){
this.currentItem.hide();
}
this._createPlaceholder();
if(o.containment){
this._setContainment();
}
if(o.cursor&&o.cursor!=="auto"){body=this.document.find("body");
this.storedCursor=body.css("cursor");
body.css("cursor",o.cursor);
this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body);
}
if(o.opacity){if(this.helper.css("opacity")){
this._storedOpacity=this.helper.css("opacity");
}
this.helper.css("opacity",o.opacity);
}
if(o.zIndex){if(this.helper.css("zIndex")){
this._storedZIndex=this.helper.css("zIndex");
}
this.helper.css("zIndex",o.zIndex);
}
if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){
this.overflowOffset=this.scrollParent.offset();
}
this._trigger("start",event,this._uiHash());
if(!this._preserveHelperProportions){
this._cacheHelperProportions();
}
if(!noActivation){
for(i=this.containers.length-1;i>=0;i--){
this.containers[i]._trigger("activate",event,this._uiHash(this));
}
}
if($.ui.ddmanager){
$.ui.ddmanager.current=this;
}
if($.ui.ddmanager&&!o.dropBehaviour){
$.ui.ddmanager.prepareOffsets(this,event);
}
this.dragging=true;
this.helper.addClass("ui-sortable-helper");
this._mouseDrag(event);return true;
},
_mouseDrag:function(event){
var i,item,itemElement,intersection,
o=this.options,
scrolled=false;
this.position=this._generatePosition(event);
this.positionAbs=this._convertPositionTo("absolute");
if(!this.lastPositionAbs){
this.lastPositionAbs=this.positionAbs;
}
if(this.options.scroll){
if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){
if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){
this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed;
}else if(event.pageY-this.overflowOffset.top<o.scrollSensitivity){
this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed;
}
if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){
this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed;
}else if(event.pageX-this.overflowOffset.left<o.scrollSensitivity){
this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed;
}
}else{
if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){
scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);
}else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){
scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);
}
if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){
scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);
}else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){
scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);
}
}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){
$.ui.ddmanager.prepareOffsets(this,event);
}
}
this.positionAbs=this._convertPositionTo("absolute");
if(!this.options.axis||this.options.axis!=="y"){
this.helper[0].style.left=this.position.left+"px";
}
if(!this.options.axis||this.options.axis!=="x"){
this.helper[0].style.top=this.position.top+"px";
}
for(i=this.items.length-1;i>=0;i--){
item=this.items[i];
itemElement=item.item[0];
intersection=this._intersectsWithPointer(item);
if(!intersection){
continue;
}
if(item.instance!==this.currentContainer){
continue;
}
if(itemElement!==this.currentItem[0]&&
this.placeholder[intersection===1?"next":"prev"]()[0]!==itemElement&&
!$.contains(this.placeholder[0],itemElement)&&
(this.options.type==="semi-dynamic"?!$.contains(this.element[0],itemElement):true)
){
this.direction=intersection===1?"down":"up";
if(this.options.tolerance==="pointer"||this._intersectsWithSides(item)){
this._rearrange(event,item);
}else{
break;
}
this._trigger("change",event,this._uiHash());
break;
}
}
this._contactContainers(event);
if($.ui.ddmanager){
$.ui.ddmanager.drag(this,event);
}
this._trigger("sort",event,this._uiHash());
this.lastPositionAbs=this.positionAbs;
return false;
},
_mouseStop:function(event,noPropagation){
if(!event){
return;
}
if($.ui.ddmanager&&!this.options.dropBehaviour){
$.ui.ddmanager.drop(this,event);
}
if(this.options.revert){
var that=this,
cur=this.placeholder.offset(),
axis=this.options.axis,
animation={};
if(!axis||axis==="x"){
animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft);
}
if(!axis||axis==="y"){
animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop);
}
this.reverting=true;
$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){
that._clear(event);
});
}else{
this._clear(event,noPropagation);
}
return false;
},
cancel:function(){
if(this.dragging){
this._mouseUp({target:null});
if(this.options.helper==="original"){
this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
}else{
this.currentItem.show();
}
for(var i=this.containers.length-1;i>=0;i--){
this.containers[i]._trigger("deactivate",null,this._uiHash(this));
if(this.containers[i].containerCache.over){
this.containers[i]._trigger("out",null,this._uiHash(this));
this.containers[i].containerCache.over=0;
}
}
}
if(this.placeholder){
if(this.placeholder[0].parentNode){
this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
}
if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){
this.helper.remove();
}
$.extend(this,{
helper:null,
dragging:false,
reverting:false,
_noFinalSort:null
});
if(this.domPosition.prev){
$(this.domPosition.prev).after(this.currentItem);
}else{
$(this.domPosition.parent).prepend(this.currentItem);
}
}
return this;
},
serialize:function(o){
var items=this._getItemsAsjQuery(o&&o.connected),
str=[];
o=o||{};
$(items).each(function(){
var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||(/(.+)[\-=_](.+)/));
if(res){
str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]));
}
});
if(!str.length&&o.key){
str.push(o.key+"=");
}
return str.join("&");
},
toArray:function(o){
var items=this._getItemsAsjQuery(o&&o.connected),
ret=[];
o=o||{};
items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"")});
return ret;
},

_intersectsWith:function(item){
var x1=this.positionAbs.left,
x2=x1+this.helperProportions.width,
y1=this.positionAbs.top,
y2=y1+this.helperProportions.height,
l=item.left,
r=l+item.width,
t=item.top,
b=t+item.height,
dyClick=this.offset.click.top,
dxClick=this.offset.click.left,
isOverElementHeight=(this.options.axis==="x")||((y1+dyClick)>t&&(y1+dyClick)<b),
isOverElementWidth=(this.options.axis==="y")||((x1+dxClick)>l&&(x1+dxClick)<r),
isOverElement=isOverElementHeight&&isOverElementWidth;
if(this.options.tolerance==="pointer"||
this.options.forcePointerForContainers||
(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"])
){
return isOverElement;
}else{
return(l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b)}
},
_intersectsWithPointer:function(item){
var isOverElementHeight=(this.options.axis==="x")||isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),
isOverElementWidth=(this.options.axis==="y")||isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),
isOverElement=isOverElementHeight&&isOverElementWidth,
verticalDirection=this._getDragVerticalDirection(),
horizontalDirection=this._getDragHorizontalDirection();
if(!isOverElement){
return false;
}
return this.floating?
(((horizontalDirection&&horizontalDirection==="right")||verticalDirection==="down")?2:1)
:(verticalDirection&&(verticalDirection==="down"?2:1));
},
_intersectsWithSides:function(item){
var isOverBottomHalf=isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+(item.height/2),item.height),
isOverRightHalf=isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+(item.width/2),item.width),
verticalDirection=this._getDragVerticalDirection(),
horizontalDirection=this._getDragHorizontalDirection();
if(this.floating&&horizontalDirection){
return((horizontalDirection==="right"&&isOverRightHalf)||(horizontalDirection==="left"&&!isOverRightHalf));
}else{
return verticalDirection&&((verticalDirection==="down"&&isOverBottomHalf)||(verticalDirection==="up"&&!isOverBottomHalf));
}
},
_getDragVerticalDirection:function(){
var delta=this.positionAbs.top-this.lastPositionAbs.top;
return delta!==0&&(delta>0?"down":"up");
},
_getDragHorizontalDirection:function(){
var delta=this.positionAbs.left-this.lastPositionAbs.left;
return delta!==0&&(delta>0?"right":"left");
},
refresh:function(event){
this._refreshItems(event);
this.refreshPositions();
return this;
},
_connectWith:function(){
var options=this.options;
return options.connectWith.constructor===String?[options.connectWith]:options.connectWith;
},
_getItemsAsjQuery:function(connected){
var i,j,cur,inst,
items=[],
queries=[],
connectWith=this._connectWith();
if(connectWith&&connected){
for(i=connectWith.length-1;i>=0;i--){
cur=$(connectWith[i]);
for(j=cur.length-1;j>=0;j--){
inst=$.data(cur[j],this.widgetFullName);
if(inst&&inst!==this&&!inst.options.disabled){
queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);
}
}
}
}
queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);
function addItems(){
items.push(this);
}
for(i=queries.length-1;i>=0;i--){
queries[i][0].each(addItems);
}
return $(items);
},
_removeCurrentsFromItems:function(){
var list=this.currentItem.find(":data("+this.widgetName+"-item)");
this.items=$.grep(this.items,function(item){
for(var j=0;j<list.length;j++){
if(list[j]===item.item[0]){
return false;
}
}
return true;
});
},
_refreshItems:function(event){
this.items=[];
this.containers=[this];
var i,j,cur,inst,targetData,_queries,item,queriesLength,
items=this.items,
queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],
connectWith=this._connectWith();
if(connectWith&&this.ready){for(i=connectWith.length-1;i>=0;i--){
cur=$(connectWith[i]);
for(j=cur.length-1;j>=0;j--){
inst=$.data(cur[j],this.widgetFullName);
if(inst&&inst!==this&&!inst.options.disabled){
queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]);
this.containers.push(inst);
}
}
}
}
for(i=queries.length-1;i>=0;i--){
targetData=queries[i][1];
_queries=queries[i][0];
for(j=0,queriesLength=_queries.length;j<queriesLength;j++){
item=$(_queries[j]);
item.data(this.widgetName+"-item",targetData);items.push({
item:item,
instance:targetData,
width:0,height:0,
left:0,top:0
});
}
}
},
refreshPositions:function(fast){
if(this.offsetParent&&this.helper){
this.offset.parent=this._getParentOffset();
}
var i,item,t,p;
for(i=this.items.length-1;i>=0;i--){
item=this.items[i];
if(item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]){
continue;
}
t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item;
if(!fast){
item.width=t.outerWidth();
item.height=t.outerHeight();
}
p=t.offset();
item.left=p.left;
item.top=p.top;
}
if(this.options.custom&&this.options.custom.refreshContainers){
this.options.custom.refreshContainers.call(this);
}else{
for(i=this.containers.length-1;i>=0;i--){
p=this.containers[i].element.offset();
this.containers[i].containerCache.left=p.left;
this.containers[i].containerCache.top=p.top;
this.containers[i].containerCache.width=this.containers[i].element.outerWidth();
this.containers[i].containerCache.height=this.containers[i].element.outerHeight();
}
}
return this;
},
_createPlaceholder:function(that){
that=that||this;
var className,
o=that.options;
if(!o.placeholder||o.placeholder.constructor===String){
className=o.placeholder;
o.placeholder={
element:function(){
var nodeName=that.currentItem[0].nodeName.toLowerCase(),
element=$("<"+nodeName+">",that.document[0])
.addClass(className||that.currentItem[0].className+" ui-sortable-placeholder")
.removeClass("ui-sortable-helper");
if(nodeName==="tr"){
that.currentItem.children().each(function(){
$("<td>&#160;</td>",that.document[0])
.attr("colspan",$(this).attr("colspan")||1)
.appendTo(element);
});
}else if(nodeName==="img"){
element.attr("src",that.currentItem.attr("src"));
}
if(!className){
element.css("visibility","hidden");
}
return element;
},
update:function(container,p){
if(className&&!o.forcePlaceholderSize){
return;
}
if(!p.height()){p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10))}
if(!p.width()){p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10))}
}
};
}
that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem));
that.currentItem.after(that.placeholder);
o.placeholder.update(that,that.placeholder);
},
_contactContainers:function(event){
var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,base,cur,nearBottom,floating,
innermostContainer=null,
innermostIndex=null;
for(i=this.containers.length-1;i>=0;i--){
if($.contains(this.currentItem[0],this.containers[i].element[0])){
continue;
}
if(this._intersectsWith(this.containers[i].containerCache)){
if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0])){
continue;
}
innermostContainer=this.containers[i];
innermostIndex=i;
}else{
if(this.containers[i].containerCache.over){
this.containers[i]._trigger("out",event,this._uiHash(this));
this.containers[i].containerCache.over=0;
}
}
}
if(!innermostContainer){
return;
}
if(this.containers.length===1){
if(!this.containers[innermostIndex].containerCache.over){
this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));
this.containers[innermostIndex].containerCache.over=1;
}
}else{
dist=10000;
itemWithLeastDistance=null;
floating=innermostContainer.floating||isFloating(this.currentItem);
posProperty=floating?"left":"top";
sizeProperty=floating?"width":"height";
base=this.positionAbs[posProperty]+this.offset.click[posProperty];
for(j=this.items.length-1;j>=0;j--){
if(!$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])){
continue;
}
if(this.items[j].item[0]===this.currentItem[0]){
continue;
}
if(floating&&!isOverAxis(this.positionAbs.top+this.offset.click.top,this.items[j].top,this.items[j].height)){
continue;
}
cur=this.items[j].item.offset()[posProperty];
nearBottom=false;
if(Math.abs(cur-base)>Math.abs(cur+this.items[j][sizeProperty]-base)){
nearBottom=true;
cur+=this.items[j][sizeProperty];
}
if(Math.abs(cur-base)<dist){
dist=Math.abs(cur-base);itemWithLeastDistance=this.items[j];
this.direction=nearBottom?"up":"down";
}
}
if(!itemWithLeastDistance&&!this.options.dropOnEmpty){
return;
}
if(this.currentContainer===this.containers[innermostIndex]){
return;
}
itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,true):this._rearrange(event,null,this.containers[innermostIndex].element,true);
this._trigger("change",event,this._uiHash());
this.containers[innermostIndex]._trigger("change",event,this._uiHash(this));
this.currentContainer=this.containers[innermostIndex];
this.options.placeholder.update(this.currentContainer,this.placeholder);
this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));
this.containers[innermostIndex].containerCache.over=1;
}
},
_createHelper:function(event){
var o=this.options,
helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):(o.helper==="clone"?this.currentItem.clone():this.currentItem);
if(!helper.parents("body").length){
$(o.appendTo!=="parent"?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]);
}
if(helper[0]===this.currentItem[0]){
this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};
}
if(!helper[0].style.width||o.forceHelperSize){
helper.width(this.currentItem.width());
}
if(!helper[0].style.height||o.forceHelperSize){
helper.height(this.currentItem.height());
}
return helper;
},
_adjustOffsetFromHelper:function(obj){
if(typeof obj==="string"){
obj=obj.split(" ");
}
if($.isArray(obj)){
obj={left:+obj[0],top:+obj[1]||0};
}
if("left"in obj){
this.offset.click.left=obj.left+this.margins.left;
}
if("right"in obj){
this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;
}
if("top"in obj){
this.offset.click.top=obj.top+this.margins.top;
}
if("bottom"in obj){
this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;
}
},
_getParentOffset:function(){
this.offsetParent=this.helper.offsetParent();
var po=this.offsetParent.offset();
if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){
po.left+=this.scrollParent.scrollLeft();
po.top+=this.scrollParent.scrollTop();
}
if(this.offsetParent[0]===document.body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){
po={top:0,left:0};
}
return{
top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),
left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)
};
},
_getRelativeOffset:function(){
if(this.cssPosition==="relative"){
var p=this.currentItem.position();
return{
top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),
left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()
};
}else{
return{top:0,left:0};
}
},
_cacheMargins:function(){
this.margins={
left:(parseInt(this.currentItem.css("marginLeft"),10)||0),
top:(parseInt(this.currentItem.css("marginTop"),10)||0)
};
},
_cacheHelperProportions:function(){
this.helperProportions={
width:this.helper.outerWidth(),
height:this.helper.outerHeight()
};
},
_setContainment:function(){
var ce,co,over,
o=this.options;
if(o.containment==="parent"){
o.containment=this.helper[0].parentNode;
}
if(o.containment==="document"||o.containment==="window"){
this.containment=[
0-this.offset.relative.left-this.offset.parent.left,
0-this.offset.relative.top-this.offset.parent.top,
$(o.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,
($(o.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top
];
}
if(!(/^(document|window|parent)$/).test(o.containment)){
ce=$(o.containment)[0];
co=$(o.containment).offset();
over=($(ce).css("overflow")!=="hidden");
this.containment=[
co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,
co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,
co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,
co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top
];
}
},
_convertPositionTo:function(d,pos){
if(!pos){
pos=this.position;
}
var mod=d==="absolute"?1:-1,
scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,
scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);
return{
top:(
pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)
),
left:(
pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod)
)
};
},
_generatePosition:function(event){
var top,left,
o=this.options,
pageX=event.pageX,
pageY=event.pageY,
scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);
if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0])){
this.offset.relative=this._getRelativeOffset();
}

if(this.originalPosition){if(this.containment){
if(event.pageX-this.offset.click.left<this.containment[0]){
pageX=this.containment[0]+this.offset.click.left;
}
if(event.pageY-this.offset.click.top<this.containment[1]){
pageY=this.containment[1]+this.offset.click.top;
}
if(event.pageX-this.offset.click.left>this.containment[2]){
pageX=this.containment[2]+this.offset.click.left;
}
if(event.pageY-this.offset.click.top>this.containment[3]){
pageY=this.containment[3]+this.offset.click.top;
}
}
if(o.grid){
top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1];
pageY=this.containment?((top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3])?top:((top-this.offset.click.top>=this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;
left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0];
pageX=this.containment?((left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2])?left:((left-this.offset.click.left>=this.containment[0])?left-o.grid[0]:left+o.grid[0])):left;
}
}
return{
top:(
pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))
),
left:(
pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft()))
)
};
},
_rearrange:function(event,i,a,hardRefresh){
a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?i.item[0]:i.item[0].nextSibling));
this.counter=this.counter?++this.counter:1;
var counter=this.counter;
this._delay(function(){
if(counter===this.counter){
this.refreshPositions(!hardRefresh)}
});
},
_clear:function(event,noPropagation){

this.reverting=false;
var i,
delayedTriggers=[];
if(!this._noFinalSort&&this.currentItem.parent().length){
this.placeholder.before(this.currentItem);
}
this._noFinalSort=null;
if(this.helper[0]===this.currentItem[0]){
for(i in this._storedCSS){
if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){
this._storedCSS[i]="";
}
}
this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
}else{
this.currentItem.show();
}
if(this.fromOutside&&!noPropagation){
delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside))});
}
if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!noPropagation){
delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash())})}
if(this!==this.currentContainer){
if(!noPropagation){
delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash())});
delayedTriggers.push((function(c){return function(event){c._trigger("receive",event,this._uiHash(this))}}).call(this,this.currentContainer));
delayedTriggers.push((function(c){return function(event){c._trigger("update",event,this._uiHash(this))}}).call(this,this.currentContainer));
}
}
function delayEvent(type,instance,container){
return function(event){
container._trigger(type,event,instance._uiHash(instance));
};
}
for(i=this.containers.length-1;i>=0;i--){
if(!noPropagation){
delayedTriggers.push(delayEvent("deactivate",this,this.containers[i]));
}
if(this.containers[i].containerCache.over){
delayedTriggers.push(delayEvent("out",this,this.containers[i]));
this.containers[i].containerCache.over=0;
}
}
if(this.storedCursor){
this.document.find("body").css("cursor",this.storedCursor);
this.storedStylesheet.remove();
}
if(this._storedOpacity){
this.helper.css("opacity",this._storedOpacity);
}
if(this._storedZIndex){
this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex);
}
this.dragging=false;
if(this.cancelHelperRemoval){
if(!noPropagation){
this._trigger("beforeStop",event,this._uiHash());
for(i=0;i<delayedTriggers.length;i++){
delayedTriggers[i].call(this,event);
}this._trigger("stop",event,this._uiHash());
}
this.fromOutside=false;
return false;
}
if(!noPropagation){
this._trigger("beforeStop",event,this._uiHash());
}
this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
if(this.helper[0]!==this.currentItem[0]){
this.helper.remove();
}
this.helper=null;
if(!noPropagation){
for(i=0;i<delayedTriggers.length;i++){
delayedTriggers[i].call(this,event);
}this._trigger("stop",event,this._uiHash());
}
this.fromOutside=false;
return true;
},
_trigger:function(){
if($.Widget.prototype._trigger.apply(this,arguments)===false){
this.cancel();
}
},
_uiHash:function(_inst){
var inst=_inst||this;
return{
helper:inst.helper,
placeholder:inst.placeholder||$([]),
position:inst.position,
originalPosition:inst.originalPosition,
offset:inst.positionAbs,
item:inst.currentItem,
sender:_inst?_inst.element:null
};
}
});
})(jQuery);
(function($){
function modifier(fn){
return function(){
var previous=this.element.val();
fn.apply(this,arguments);
this._refresh();
if(previous!==this.element.val()){
this._trigger("change");
}
};
}
$.widget("ui.spinner",{
version:"1.10.4",
defaultElement:"<input>",
widgetEventPrefix:"spin",
options:{
culture:null,
icons:{
down:"ui-icon-triangle-1-s",
up:"ui-icon-triangle-1-n"
},
incremental:true,
max:null,
min:null,
numberFormat:null,
page:10,
step:1,
change:null,
spin:null,
start:null,
stop:null
},
_create:function(){
this._setOption("max",this.options.max);
this._setOption("min",this.options.min);
this._setOption("step",this.options.step);
if(this.value()!==""){
this._value(this.element.val(),true);
}
this._draw();
this._on(this._events);
this._refresh();
this._on(this.window,{
beforeunload:function(){
this.element.removeAttr("autocomplete");
}
});
},
_getCreateOptions:function(){
var options={},
element=this.element;
$.each(["min","max","step"],function(i,option){
var value=element.attr(option);
if(value!==undefined&&value.length){
options[option]=value;
}
});
return options;
},
_events:{
keydown:function(event){
if(this._start(event)&&this._keydown(event)){
event.preventDefault();
}
},
keyup:"_stop",
focus:function(){
this.previous=this.element.val();
},
blur:function(event){
if(this.cancelBlur){
delete this.cancelBlur;
return;
}
this._stop();
this._refresh();
if(this.previous!==this.element.val()){
this._trigger("change",event);
}
},
mousewheel:function(event,delta){
if(!delta){
return;
}
if(!this.spinning&&!this._start(event)){
return false;
}
this._spin((delta>0?1:-1)*this.options.step,event);
clearTimeout(this.mousewheelTimer);
this.mousewheelTimer=this._delay(function(){
if(this.spinning){
this._stop(event);
}
},100);
event.preventDefault();
},
"mousedown .ui-spinner-button":function(event){
var previous;
previous=this.element[0]===this.document[0].activeElement?
this.previous:this.element.val();
function checkFocus(){
var isActive=this.element[0]===this.document[0].activeElement;
if(!isActive){
this.element.focus();
this.previous=previous;
this._delay(function(){
this.previous=previous;
});
}
}
event.preventDefault();
checkFocus.call(this);
this.cancelBlur=true;
this._delay(function(){
delete this.cancelBlur;
checkFocus.call(this);
});
if(this._start(event)===false){
return;
}
this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event);
},
"mouseup .ui-spinner-button":"_stop",
"mouseenter .ui-spinner-button":function(event){
if(!$(event.currentTarget).hasClass("ui-state-active")){
return;
}
if(this._start(event)===false){
return false;
}
this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event);
},
"mouseleave .ui-spinner-button":"_stop"
},
_draw:function(){
var uiSpinner=this.uiSpinner=this.element
.addClass("ui-spinner-input")
.attr("autocomplete","off")
.wrap(this._uiSpinnerHtml())
.parent()
.append(this._buttonHtml());
this.element.attr("role","spinbutton");
this.buttons=uiSpinner.find(".ui-spinner-button")
.attr("tabIndex",-1)
.button()
.removeClass("ui-corner-all");
if(this.buttons.height()>Math.ceil(uiSpinner.height()*0.5)&&
uiSpinner.height()>0){
uiSpinner.height(uiSpinner.height());
}
if(this.options.disabled){
this.disable();
}
},
_keydown:function(event){
var options=this.options,
keyCode=$.ui.keyCode;
switch(event.keyCode){
case keyCode.UP:
this._repeat(null,1,event);
return true;
case keyCode.DOWN:
this._repeat(null,-1,event);
return true;
case keyCode.PAGE_UP:
this._repeat(null,options.page,event);
return true;
case keyCode.PAGE_DOWN:
this._repeat(null,-options.page,event);
return true;
}
return false;
},
_uiSpinnerHtml:function(){
return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>";
},
_buttonHtml:function(){
return""+
"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'>"+
"<span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+
"</a>"+
"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+
"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+
"</a>";
},
_start:function(event){
if(!this.spinning&&this._trigger("start",event)===false){
return false;
}
if(!this.counter){
this.counter=1;
}
this.spinning=true;
return true;
},
_repeat:function(i,steps,event){
i=i||500;
clearTimeout(this.timer);
this.timer=this._delay(function(){
this._repeat(40,steps,event);
},i);
this._spin(steps*this.options.step,event);
},
_spin:function(step,event){
var value=this.value()||0;
if(!this.counter){
this.counter=1;
}
value=this._adjustValue(value+step*this._increment(this.counter));
if(!this.spinning||this._trigger("spin",event,{value:value})!==false){
this._value(value);
this.counter++;
}
},
_increment:function(i){
var incremental=this.options.incremental;
if(incremental){
return $.isFunction(incremental)?
incremental(i):
Math.floor(i*i*i/50000-i*i/500+17*i/200+1);
}
return 1;
},
_precision:function(){
var precision=this._precisionOf(this.options.step);
if(this.options.min!==null){
precision=Math.max(precision,this._precisionOf(this.options.min));
}
return precision;
},
_precisionOf:function(num){
var str=num.toString(),
decimal=str.indexOf(".");
return decimal===-1?0:str.length-decimal-1;
},
_adjustValue:function(value){
var base,aboveMin,
options=this.options;
base=options.min!==null?options.min:0;
aboveMin=value-base;
aboveMin=Math.round(aboveMin/options.step)*options.step;
value=base+aboveMin;
value=parseFloat(value.toFixed(this._precision()));
if(options.max!==null&&value>options.max){
return options.max;
}
if(options.min!==null&&value<options.min){
return options.min;
}
return value;
},
_stop:function(event){
if(!this.spinning){
return;
}
clearTimeout(this.timer);
clearTimeout(this.mousewheelTimer);
this.counter=0;
this.spinning=false;
this._trigger("stop",event);
},
_setOption:function(key,value){
if(key==="culture"||key==="numberFormat"){
var prevValue=this._parse(this.element.val());
this.options[key]=value;
this.element.val(this._format(prevValue));
return;
}
if(key==="max"||key==="min"||key==="step"){
if(typeof value==="string"){
value=this._parse(value);
}
}
if(key==="icons"){
this.buttons.first().find(".ui-icon")
.removeClass(this.options.icons.up)
.addClass(value.up);
this.buttons.last().find(".ui-icon")
.removeClass(this.options.icons.down)
.addClass(value.down);
}
this._super(key,value);
if(key==="disabled"){
if(value){
this.element.prop("disabled",true);
this.buttons.button("disable");
}else{
this.element.prop("disabled",false);
this.buttons.button("enable");
}
}
},
_setOptions:modifier(function(options){
this._super(options);
this._value(this.element.val());
}),
_parse:function(val){
if(typeof val==="string"&&val!==""){
val=window.Globalize&&this.options.numberFormat?
Globalize.parseFloat(val,10,this.options.culture):+val;
}
return val===""||isNaN(val)?null:val;
},
_format:function(value){
if(value===""){
return"";
}
return window.Globalize&&this.options.numberFormat?
Globalize.format(value,this.options.numberFormat,this.options.culture):
value;
},
_refresh:function(){
this.element.attr({
"aria-valuemin":this.options.min,
"aria-valuemax":this.options.max,
"aria-valuenow":this._parse(this.element.val())
});
},
_value:function(value,allowAny){
var parsed;
if(value!==""){
parsed=this._parse(value);
if(parsed!==null){
if(!allowAny){
parsed=this._adjustValue(parsed);
}
value=this._format(parsed);
}
}
this.element.val(value);
this._refresh();
},
_destroy:function(){
this.element
.removeClass("ui-spinner-input")
.prop("disabled",false)
.removeAttr("autocomplete")
.removeAttr("role")
.removeAttr("aria-valuemin")
.removeAttr("aria-valuemax")
.removeAttr("aria-valuenow");
this.uiSpinner.replaceWith(this.element);
},
stepUp:modifier(function(steps){
this._stepUp(steps);
}),
_stepUp:function(steps){
if(this._start()){
this._spin((steps||1)*this.options.step);
this._stop();
}
},
stepDown:modifier(function(steps){
this._stepDown(steps);
}),
_stepDown:function(steps){
if(this._start()){
this._spin((steps||1)*-this.options.step);
this._stop();
}
},
pageUp:modifier(function(pages){
this._stepUp((pages||1)*this.options.page);
}),
pageDown:modifier(function(pages){
this._stepDown((pages||1)*this.options.page);
}),
value:function(newVal){
if(!arguments.length){
return this._parse(this.element.val());
}
modifier(this._value).call(this,newVal);
},
widget:function(){
return this.uiSpinner;
}
});
}(jQuery));
(function($,undefined){
var tabId=0,
rhash=/#.*$/;
function getNextTabId(){
return++tabId;
}
function isLocal(anchor){
anchor=anchor.cloneNode(false);
return anchor.hash.length>1&&
decodeURIComponent(anchor.href.replace(rhash,""))===
decodeURIComponent(location.href.replace(rhash,""));
}
$.widget("ui.tabs",{
version:"1.10.4",
delay:300,
options:{
active:null,
collapsible:false,
event:"click",
heightStyle:"content",
hide:null,
show:null,
activate:null,
beforeActivate:null,
beforeLoad:null,
load:null
},
_create:function(){
var that=this,
options=this.options;
this.running=false;
this.element
.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all")
.toggleClass("ui-tabs-collapsible",options.collapsible)
.delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(event){
if($(this).is(".ui-state-disabled")){
event.preventDefault();
}
})
.delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){
if($(this).closest("li").is(".ui-state-disabled")){
this.blur();
}
});
this._processTabs();
options.active=this._initialActive();
if($.isArray(options.disabled)){
options.disabled=$.unique(options.disabled.concat(
$.map(this.tabs.filter(".ui-state-disabled"),function(li){
return that.tabs.index(li);
})
)).sort();
}
if(this.options.active!==false&&this.anchors.length){
this.active=this._findActive(options.active);
}else{
this.active=$();
}
this._refresh();
if(this.active.length){
this.load(options.active);
}
},
_initialActive:function(){
var active=this.options.active,
collapsible=this.options.collapsible,
locationHash=location.hash.substring(1);
if(active===null){
if(locationHash){
this.tabs.each(function(i,tab){
if($(tab).attr("aria-controls")===locationHash){
active=i;
return false;
}
});
}
if(active===null){
active=this.tabs.index(this.tabs.filter(".ui-tabs-active"));
}
if(active===null||active===-1){
active=this.tabs.length?0:false;
}
}
if(active!==false){
active=this.tabs.index(this.tabs.eq(active));
if(active===-1){
active=collapsible?false:0;
}
}
if(!collapsible&&active===false&&this.anchors.length){
active=0;
}
return active;
},
_getCreateEventData:function(){
return{
tab:this.active,
panel:!this.active.length?$():this._getPanelForTab(this.active)
};
},
_tabKeydown:function(event){
var focusedTab=$(this.document[0].activeElement).closest("li"),
selectedIndex=this.tabs.index(focusedTab),
goingForward=true;
if(this._handlePageNav(event)){
return;
}
switch(event.keyCode){
case $.ui.keyCode.RIGHT:
case $.ui.keyCode.DOWN:
selectedIndex++;
break;
case $.ui.keyCode.UP:
case $.ui.keyCode.LEFT:
goingForward=false;
selectedIndex--;
break;
case $.ui.keyCode.END:
selectedIndex=this.anchors.length-1;
break;
case $.ui.keyCode.HOME:
selectedIndex=0;
break;
case $.ui.keyCode.SPACE:
event.preventDefault();
clearTimeout(this.activating);
this._activate(selectedIndex);
return;
case $.ui.keyCode.ENTER:
event.preventDefault();
clearTimeout(this.activating);
this._activate(selectedIndex===this.options.active?false:selectedIndex);
return;
default:
return;
}
event.preventDefault();
clearTimeout(this.activating);
selectedIndex=this._focusNextTab(selectedIndex,goingForward);
if(!event.ctrlKey){
focusedTab.attr("aria-selected","false");
this.tabs.eq(selectedIndex).attr("aria-selected","true");
this.activating=this._delay(function(){
this.option("active",selectedIndex);
},this.delay);
}
},
_panelKeydown:function(event){
if(this._handlePageNav(event)){
return;
}
if(event.ctrlKey&&event.keyCode===$.ui.keyCode.UP){
event.preventDefault();
this.active.focus();
}
},
_handlePageNav:function(event){
if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP){
this._activate(this._focusNextTab(this.options.active-1,false));
return true;
}
if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN){
this._activate(this._focusNextTab(this.options.active+1,true));
return true;
}
},
_findNextTab:function(index,goingForward){
var lastTabIndex=this.tabs.length-1;
function constrain(){
if(index>lastTabIndex){
index=0;
}
if(index<0){
index=lastTabIndex;
}
return index;
}
while($.inArray(constrain(),this.options.disabled)!==-1){
index=goingForward?index+1:index-1;
}
return index;
},
_focusNextTab:function(index,goingForward){
index=this._findNextTab(index,goingForward);
this.tabs.eq(index).focus();
return index;
},
_setOption:function(key,value){
if(key==="active"){
this._activate(value);
return;
}
if(key==="disabled"){
this._setupDisabled(value);
return;
}
this._super(key,value);
if(key==="collapsible"){
this.element.toggleClass("ui-tabs-collapsible",value);
if(!value&&this.options.active===false){
this._activate(0);
}
}
if(key==="event"){
this._setupEvents(value);
}
if(key==="heightStyle"){
this._setupHeightStyle(value);
}
},
_tabId:function(tab){
return tab.attr("aria-controls")||"ui-tabs-"+getNextTabId();
},
_sanitizeSelector:function(hash){
return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):"";
},
refresh:function(){
var options=this.options,
lis=this.tablist.children(":has(a[href])");
options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){
return lis.index(tab);
});
this._processTabs();
if(options.active===false||!this.anchors.length){
options.active=false;
this.active=$();
}else if(this.active.length&&!$.contains(this.tablist[0],this.active[0])){
if(this.tabs.length===options.disabled.length){
options.active=false;
this.active=$();
}else{
this._activate(this._findNextTab(Math.max(0,options.active-1),false));
}
}else{
options.active=this.tabs.index(this.active);
}
this._refresh();
},
_refresh:function(){
this._setupDisabled(this.options.disabled);
this._setupEvents(this.options.event);
this._setupHeightStyle(this.options.heightStyle);
this.tabs.not(this.active).attr({
"aria-selected":"false",
tabIndex:-1
});
this.panels.not(this._getPanelForTab(this.active))
.hide()
.attr({
"aria-expanded":"false",
"aria-hidden":"true"
});
if(!this.active.length){
this.tabs.eq(0).attr("tabIndex",0);
}else{
this.active
.addClass("ui-tabs-active ui-state-active")
.attr({
"aria-selected":"true",
tabIndex:0
});
this._getPanelForTab(this.active)
.show()
.attr({
"aria-expanded":"true",
"aria-hidden":"false"
});
}
},
_processTabs:function(){
var that=this;
this.tablist=this._getList()
.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all")
.attr("role","tablist");
this.tabs=this.tablist.find("> li:has(a[href])")
.addClass("ui-state-default ui-corner-top")
.attr({
role:"tab",
tabIndex:-1
});
this.anchors=this.tabs.map(function(){
return $("a",this)[0];
})
.addClass("ui-tabs-anchor")
.attr({
role:"presentation",
tabIndex:-1
});
this.panels=$();
this.anchors.each(function(i,anchor){
var selector,panel,panelId,
anchorId=$(anchor).uniqueId().attr("id"),
tab=$(anchor).closest("li"),
originalAriaControls=tab.attr("aria-controls");
if(isLocal(anchor)){
selector=anchor.hash;
panel=that.element.find(that._sanitizeSelector(selector));
}else{
panelId=that._tabId(tab);
selector="#"+panelId;
panel=that.element.find(selector);
if(!panel.length){
panel=that._createPanel(panelId);
panel.insertAfter(that.panels[i-1]||that.tablist);
}
panel.attr("aria-live","polite");
}
if(panel.length){
that.panels=that.panels.add(panel);
}
if(originalAriaControls){
tab.data("ui-tabs-aria-controls",originalAriaControls);
}
tab.attr({
"aria-controls":selector.substring(1),
"aria-labelledby":anchorId
});
panel.attr("aria-labelledby",anchorId);
});
this.panels
.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom")
.attr("role","tabpanel");
},
_getList:function(){
return this.tablist||this.element.find("ol,ul").eq(0);
},
_createPanel:function(id){
return $("<div>")
.attr("id",id)
.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom")
.data("ui-tabs-destroy",true);
},
_setupDisabled:function(disabled){
if($.isArray(disabled)){
if(!disabled.length){
disabled=false;
}else if(disabled.length===this.anchors.length){
disabled=true;
}
}
for(var i=0,li;(li=this.tabs[i]);i++){
if(disabled===true||$.inArray(i,disabled)!==-1){
$(li)
.addClass("ui-state-disabled")
.attr("aria-disabled","true");
}else{
$(li)
.removeClass("ui-state-disabled")
.removeAttr("aria-disabled");
}
}
this.options.disabled=disabled;
},
_setupEvents:function(event){
var events={
click:function(event){
event.preventDefault();
}
};
if(event){
$.each(event.split(" "),function(index,eventName){
events[eventName]="_eventHandler";
});
}
this._off(this.anchors.add(this.tabs).add(this.panels));
this._on(this.anchors,events);
this._on(this.tabs,{keydown:"_tabKeydown"});
this._on(this.panels,{keydown:"_panelKeydown"});
this._focusable(this.tabs);
this._hoverable(this.tabs);
},
_setupHeightStyle:function(heightStyle){
var maxHeight,
parent=this.element.parent();
if(heightStyle==="fill"){
maxHeight=parent.height();
maxHeight-=this.element.outerHeight()-this.element.height();
this.element.siblings(":visible").each(function(){
var elem=$(this),
position=elem.css("position");
if(position==="absolute"||position==="fixed"){
return;
}
maxHeight-=elem.outerHeight(true);
});
this.element.children().not(this.panels).each(function(){
maxHeight-=$(this).outerHeight(true);
});
this.panels.each(function(){
$(this).height(Math.max(0,maxHeight-
$(this).innerHeight()+$(this).height()));
})
.css("overflow","auto");
}else if(heightStyle==="auto"){
maxHeight=0;
this.panels.each(function(){
maxHeight=Math.max(maxHeight,$(this).height("").height());
}).height(maxHeight);
}
},
_eventHandler:function(event){
var options=this.options,
active=this.active,
anchor=$(event.currentTarget),
tab=anchor.closest("li"),
clickedIsActive=tab[0]===active[0],
collapsing=clickedIsActive&&options.collapsible,
toShow=collapsing?$():this._getPanelForTab(tab),
toHide=!active.length?$():this._getPanelForTab(active),
eventData={
oldTab:active,
oldPanel:toHide,
newTab:collapsing?$():tab,
newPanel:toShow
};
event.preventDefault();
if(tab.hasClass("ui-state-disabled")||
tab.hasClass("ui-tabs-loading")||
this.running||
(clickedIsActive&&!options.collapsible)||
(this._trigger("beforeActivate",event,eventData)===false)){
return;
}
options.active=collapsing?false:this.tabs.index(tab);
this.active=clickedIsActive?$():tab;
if(this.xhr){
this.xhr.abort();
}
if(!toHide.length&&!toShow.length){
$.error("jQuery UI Tabs: Mismatching fragment identifier.");
}
if(toShow.length){
this.load(this.tabs.index(tab),event);
}
this._toggle(event,eventData);
},
_toggle:function(event,eventData){
var that=this,
toShow=eventData.newPanel,
toHide=eventData.oldPanel;
this.running=true;
function complete(){
that.running=false;
that._trigger("activate",event,eventData);
}
function show(){
eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active");
if(toShow.length&&that.options.show){
that._show(toShow,that.options.show,complete);
}else{
toShow.show();
complete();
}
}
if(toHide.length&&this.options.hide){
this._hide(toHide,this.options.hide,function(){
eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");
show();
});
}else{
eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");
toHide.hide();
show();
}
toHide.attr({
"aria-expanded":"false",
"aria-hidden":"true"
});
eventData.oldTab.attr("aria-selected","false");
if(toShow.length&&toHide.length){
eventData.oldTab.attr("tabIndex",-1);
}else if(toShow.length){
this.tabs.filter(function(){
return $(this).attr("tabIndex")===0;
})
.attr("tabIndex",-1);
}
toShow.attr({
"aria-expanded":"true",
"aria-hidden":"false"
});
eventData.newTab.attr({
"aria-selected":"true",
tabIndex:0
});
},
_activate:function(index){
var anchor,
active=this._findActive(index);
if(active[0]===this.active[0]){
return;
}
if(!active.length){
active=this.active;
}
anchor=active.find(".ui-tabs-anchor")[0];
this._eventHandler({
target:anchor,
currentTarget:anchor,
preventDefault:$.noop
});
},
_findActive:function(index){
return index===false?$():this.tabs.eq(index);
},
_getIndex:function(index){
if(typeof index==="string"){
index=this.anchors.index(this.anchors.filter("[href$='"+index+"']"));
}
return index;
},
_destroy:function(){
if(this.xhr){
this.xhr.abort();
}
this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");
this.tablist
.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all")
.removeAttr("role");
this.anchors
.removeClass("ui-tabs-anchor")
.removeAttr("role")
.removeAttr("tabIndex")
.removeUniqueId();
this.tabs.add(this.panels).each(function(){
if($.data(this,"ui-tabs-destroy")){
$(this).remove();
}else{
$(this)
.removeClass("ui-state-default ui-state-active ui-state-disabled "+
"ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel")
.removeAttr("tabIndex")
.removeAttr("aria-live")
.removeAttr("aria-busy")
.removeAttr("aria-selected")
.removeAttr("aria-labelledby")
.removeAttr("aria-hidden")
.removeAttr("aria-expanded")
.removeAttr("role");
}
});
this.tabs.each(function(){
var li=$(this),
prev=li.data("ui-tabs-aria-controls");
if(prev){
li
.attr("aria-controls",prev)
.removeData("ui-tabs-aria-controls");
}else{
li.removeAttr("aria-controls");
}
});
this.panels.show();
if(this.options.heightStyle!=="content"){
this.panels.css("height","");
}
},
enable:function(index){
var disabled=this.options.disabled;
if(disabled===false){
return;
}
if(index===undefined){
disabled=false;
}else{
index=this._getIndex(index);
if($.isArray(disabled)){
disabled=$.map(disabled,function(num){
return num!==index?num:null;
});
}else{
disabled=$.map(this.tabs,function(li,num){
return num!==index?num:null;
});
}
}
this._setupDisabled(disabled);
},
disable:function(index){
var disabled=this.options.disabled;
if(disabled===true){
return;
}
if(index===undefined){
disabled=true;
}else{
index=this._getIndex(index);
if($.inArray(index,disabled)!==-1){
return;
}
if($.isArray(disabled)){
disabled=$.merge([index],disabled).sort();
}else{
disabled=[index];
}
}
this._setupDisabled(disabled);
},
load:function(index,event){
index=this._getIndex(index);
var that=this,
tab=this.tabs.eq(index),
anchor=tab.find(".ui-tabs-anchor"),
panel=this._getPanelForTab(tab),
eventData={
tab:tab,
panel:panel
};
if(isLocal(anchor[0])){
return;
}
this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData));
if(this.xhr&&this.xhr.statusText!=="canceled"){
tab.addClass("ui-tabs-loading");
panel.attr("aria-busy","true");
this.xhr
.success(function(response){
setTimeout(function(){
panel.html(response);
that._trigger("load",event,eventData);
},1);
})
.complete(function(jqXHR,status){
setTimeout(function(){
if(status==="abort"){
that.panels.stop(false,true);
}
tab.removeClass("ui-tabs-loading");
panel.removeAttr("aria-busy");
if(jqXHR===that.xhr){
delete that.xhr;
}
},1);
});
}
},
_ajaxSettings:function(anchor,event,eventData){
var that=this;
return{
url:anchor.attr("href"),
beforeSend:function(jqXHR,settings){
return that._trigger("beforeLoad",event,
$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData));
}
};
},
_getPanelForTab:function(tab){
var id=$(tab).attr("aria-controls");
return this.element.find(this._sanitizeSelector("#"+id));
}
});
})(jQuery);
(function($){
var increments=0;
function addDescribedBy(elem,id){
var describedby=(elem.attr("aria-describedby")||"").split(/\s+/);
describedby.push(id);
elem
.data("ui-tooltip-id",id)
.attr("aria-describedby",$.trim(describedby.join(" ")));
}
function removeDescribedBy(elem){
var id=elem.data("ui-tooltip-id"),
describedby=(elem.attr("aria-describedby")||"").split(/\s+/),
index=$.inArray(id,describedby);
if(index!==-1){
describedby.splice(index,1);
}
elem.removeData("ui-tooltip-id");
describedby=$.trim(describedby.join(" "));
if(describedby){
elem.attr("aria-describedby",describedby);
}else{
elem.removeAttr("aria-describedby");
}
}
$.widget("ui.tooltip",{
version:"1.10.4",
options:{
content:function(){
var title=$(this).attr("title")||"";
return $("<a>").text(title).html();
},
hide:true,
items:"[title]:not([disabled])",
position:{
my:"left top+15",
at:"left bottom",
collision:"flipfit flip"
},
show:true,
tooltipClass:null,
track:false,
close:null,
open:null
},
_create:function(){
this._on({
mouseover:"open",
focusin:"open"
});
this.tooltips={};
this.parents={};
if(this.options.disabled){
this._disable();
}
},
_setOption:function(key,value){
var that=this;
if(key==="disabled"){
this[value?"_disable":"_enable"]();
this.options[key]=value;
return;
}
this._super(key,value);
if(key==="content"){
$.each(this.tooltips,function(id,element){
that._updateContent(element);
});
}
},
_disable:function(){
var that=this;
$.each(this.tooltips,function(id,element){
var event=$.Event("blur");
event.target=event.currentTarget=element[0];
that.close(event,true);
});
this.element.find(this.options.items).addBack().each(function(){
var element=$(this);
if(element.is("[title]")){
element
.data("ui-tooltip-title",element.attr("title"))
.attr("title","");
}
});
},
_enable:function(){
this.element.find(this.options.items).addBack().each(function(){
var element=$(this);
if(element.data("ui-tooltip-title")){
element.attr("title",element.data("ui-tooltip-title"));
}
});
},
open:function(event){
var that=this,
target=$(event?event.target:this.element)
.closest(this.options.items);
if(!target.length||target.data("ui-tooltip-id")){
return;
}
if(target.attr("title")){
target.data("ui-tooltip-title",target.attr("title"));
}
target.data("ui-tooltip-open",true);
if(event&&event.type==="mouseover"){
target.parents().each(function(){
var parent=$(this),
blurEvent;
if(parent.data("ui-tooltip-open")){
blurEvent=$.Event("blur");
blurEvent.target=blurEvent.currentTarget=this;
that.close(blurEvent,true);
}
if(parent.attr("title")){
parent.uniqueId();
that.parents[this.id]={
element:this,
title:parent.attr("title")
};
parent.attr("title","");
}
});
}
this._updateContent(target,event);
},
_updateContent:function(target,event){
var content,
contentOption=this.options.content,
that=this,
eventType=event?event.type:null;
if(typeof contentOption==="string"){
return this._open(event,target,contentOption);
}
content=contentOption.call(target[0],function(response){
if(!target.data("ui-tooltip-open")){
return;
}
that._delay(function(){
if(event){
event.type=eventType;
}
this._open(event,target,response);
});
});
if(content){
this._open(event,target,content);
}
},
_open:function(event,target,content){
var tooltip,events,delayedShow,
positionOption=$.extend({},this.options.position);
if(!content){
return;
}
tooltip=this._find(target);
if(tooltip.length){
tooltip.find(".ui-tooltip-content").html(content);
return;
}
if(target.is("[title]")){
if(event&&event.type==="mouseover"){
target.attr("title","");
}else{
target.removeAttr("title");
}
}
tooltip=this._tooltip(target);
addDescribedBy(target,tooltip.attr("id"));
tooltip.find(".ui-tooltip-content").html(content);
function position(event){
positionOption.of=event;
if(tooltip.is(":hidden")){
return;
}
tooltip.position(positionOption);
}
if(this.options.track&&event&&/^mouse/.test(event.type)){
this._on(this.document,{
mousemove:position
});
position(event);
}else{
tooltip.position($.extend({
of:target
},this.options.position));
}
tooltip.hide();
this._show(tooltip,this.options.show);
if(this.options.show&&this.options.show.delay){
delayedShow=this.delayedShow=setInterval(function(){
if(tooltip.is(":visible")){
position(positionOption.of);
clearInterval(delayedShow);
}
},$.fx.interval);
}
this._trigger("open",event,{tooltip:tooltip});
events={
keyup:function(event){
if(event.keyCode===$.ui.keyCode.ESCAPE){
var fakeEvent=$.Event(event);
fakeEvent.currentTarget=target[0];
this.close(fakeEvent,true);
}
},
remove:function(){
this._removeTooltip(tooltip);
}
};
if(!event||event.type==="mouseover"){
events.mouseleave="close";
}
if(!event||event.type==="focusin"){
events.focusout="close";
}
this._on(true,target,events);
},
close:function(event){
var that=this,
target=$(event?event.currentTarget:this.element),
tooltip=this._find(target);
if(this.closing){
return;
}
clearInterval(this.delayedShow);
if(target.data("ui-tooltip-title")){
target.attr("title",target.data("ui-tooltip-title"));
}
removeDescribedBy(target);
tooltip.stop(true);
this._hide(tooltip,this.options.hide,function(){
that._removeTooltip($(this));
});
target.removeData("ui-tooltip-open");
this._off(target,"mouseleave focusout keyup");
if(target[0]!==this.element[0]){
this._off(target,"remove");
}
this._off(this.document,"mousemove");
if(event&&event.type==="mouseleave"){
$.each(this.parents,function(id,parent){
$(parent.element).attr("title",parent.title);
delete that.parents[id];
});
}
this.closing=true;
this._trigger("close",event,{tooltip:tooltip});
this.closing=false;
},
_tooltip:function(element){
var id="ui-tooltip-"+increments++,
tooltip=$("<div>")
.attr({
id:id,
role:"tooltip"
})
.addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+
(this.options.tooltipClass||""));
$("<div>")
.addClass("ui-tooltip-content")
.appendTo(tooltip);
tooltip.appendTo(this.document[0].body);
this.tooltips[id]=element;
return tooltip;
},
_find:function(target){
var id=target.data("ui-tooltip-id");
return id?$("#"+id):$();
},
_removeTooltip:function(tooltip){
tooltip.remove();
delete this.tooltips[tooltip.attr("id")];
},
_destroy:function(){
var that=this;
$.each(this.tooltips,function(id,element){
var event=$.Event("blur");
event.target=event.currentTarget=element[0];
that.close(event,true);
$("#"+id).remove();
if(element.data("ui-tooltip-title")){
element.attr("title",element.data("ui-tooltip-title"));
element.removeData("ui-tooltip-title");
}
});
}
});
}(jQuery));
;

;
;(function($,undefined){
var rkeyEvent=/^key/,
rmouseEvent=/^(?:mouse|contextmenu)|click/;
$.fn.simulate=function(type,options){
return this.each(function(){
new $.simulate(this,type,options);
});
};
$.simulate=function(elem,type,options){
var method=$.camelCase("simulate-"+type);
this.target=elem;
this.options=options;
if(this[method]){
this[method]();
}else{
this.simulateEvent(elem,type,options);
}
};
$.extend($.simulate,{
keyCode:{
BACKSPACE:8,
COMMA:188,
DELETE:46,
DOWN:40,
END:35,
ENTER:13,
ESCAPE:27,
HOME:36,
LEFT:37,
NUMPAD_ADD:107,
NUMPAD_DECIMAL:110,
NUMPAD_DIVIDE:111,
NUMPAD_ENTER:108,
NUMPAD_MULTIPLY:106,
NUMPAD_SUBTRACT:109,
PAGE_DOWN:34,
PAGE_UP:33,
PERIOD:190,
RIGHT:39,
SPACE:32,
TAB:9,
UP:38
},
buttonCode:{
LEFT:0,
MIDDLE:1,
RIGHT:2
}
});
$.extend($.simulate.prototype,{
simulateEvent:function(elem,type,options){
var event=this.createEvent(type,options);
this.dispatchEvent(elem,type,event,options);
},
createEvent:function(type,options){
if(rkeyEvent.test(type)){
return this.keyEvent(type,options);
}
if(rmouseEvent.test(type)){
return this.mouseEvent(type,options);
}
},
mouseEvent:function(type,options){
var event,eventDoc,doc,body;
options=$.extend({
bubbles:true,
cancelable:(type!=="mousemove"),
view:window,
detail:0,
screenX:0,
screenY:0,
clientX:1,
clientY:1,
ctrlKey:false,
altKey:false,
shiftKey:false,
metaKey:false,
button:0,
relatedTarget:undefined
},options);
if(document.createEvent){
event=document.createEvent("MouseEvents");
event.initMouseEvent(type,options.bubbles,options.cancelable,
options.view,options.detail,
options.screenX,options.screenY,options.clientX,options.clientY,
options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,
options.button,options.relatedTarget||document.body.parentNode);
if(event.pageX===0&&event.pageY===0&&Object.defineProperty){
eventDoc=event.relatedTarget.ownerDocument||document;
doc=eventDoc.documentElement;
body=eventDoc.body;
Object.defineProperty(event,"pageX",{
get:function(){
return options.clientX+
(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-
(doc&&doc.clientLeft||body&&body.clientLeft||0);
}
});
Object.defineProperty(event,"pageY",{
get:function(){
return options.clientY+
(doc&&doc.scrollTop||body&&body.scrollTop||0)-
(doc&&doc.clientTop||body&&body.clientTop||0);
}
});
}
}else if(document.createEventObject){
event=document.createEventObject();
$.extend(event,options);
event.button={
0:1,
1:4,
2:2
}[event.button]||event.button;
}
return event;
},
keyEvent:function(type,options){
var event;
options=$.extend({
bubbles:true,
cancelable:true,
view:window,
ctrlKey:false,
altKey:false,
shiftKey:false,
metaKey:false,
keyCode:0,
charCode:undefined
},options);
if(document.createEvent){
try{
event=document.createEvent("KeyEvents");
event.initKeyEvent(type,options.bubbles,options.cancelable,options.view,
options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,
options.keyCode,options.charCode);
}catch(err){
event=document.createEvent("Events");
event.initEvent(type,options.bubbles,options.cancelable);
$.extend(event,{
view:options.view,
ctrlKey:options.ctrlKey,
altKey:options.altKey,
shiftKey:options.shiftKey,
metaKey:options.metaKey,
keyCode:options.keyCode,
charCode:options.charCode
});
}
}else if(document.createEventObject){
event=document.createEventObject();
$.extend(event,options);
}
if(!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase())||(({}).toString.call(window.opera)==="[object Opera]")){
event.keyCode=(options.charCode>0)?options.charCode:options.keyCode;
event.charCode=undefined;
}
return event;
},
dispatchEvent:function(elem,type,event){
if(elem.dispatchEvent){
elem.dispatchEvent(event);
}else if(elem.fireEvent){
elem.fireEvent("on"+type,event);
}
},
simulateFocus:function(){
var focusinEvent,
triggered=false,
element=$(this.target);
function trigger(){
triggered=true;
}
element.bind("focus",trigger);
element[0].focus();
if(!triggered){
focusinEvent=$.Event("focusin");
focusinEvent.preventDefault();
element.trigger(focusinEvent);
element.triggerHandler("focus");
}
element.unbind("focus",trigger);
},
simulateBlur:function(){
var focusoutEvent,
triggered=false,
element=$(this.target);
function trigger(){
triggered=true;
}
element.bind("blur",trigger);
element[0].blur();
setTimeout(function(){
if(element[0].ownerDocument.activeElement===element[0]){
element[0].ownerDocument.body.focus();
}
if(!triggered){
focusoutEvent=$.Event("focusout");
focusoutEvent.preventDefault();
element.trigger(focusoutEvent);
element.triggerHandler("blur");
}
element.unbind("blur",trigger);
},1);
}
});

function findCenter(elem){
var offset,
document=$(elem.ownerDocument);
elem=$(elem);
offset=elem.offset();
return{
x:offset.left+elem.outerWidth()/2-document.scrollLeft(),
y:offset.top+elem.outerHeight()/2-document.scrollTop()
};
}
$.extend($.simulate.prototype,{
simulateDrag:function(){
var i=0,
target=this.target,
options=this.options,
center=findCenter(target),
x=Math.floor(center.x),
y=Math.floor(center.y),
dx=options.dx||0,
dy=options.dy||0,
moves=options.moves||3,
coord={clientX:x,clientY:y};
this.simulateEvent(target,"mousedown",coord);
for(;i<moves;i++){
x+=dx/moves;
y+=dy/moves;
coord={
clientX:Math.round(x),
clientY:Math.round(y)
};
this.simulateEvent(document,"mousemove",coord);
}
this.simulateEvent(target,"mouseup",coord);
this.simulateEvent(target,"click",coord);
}
});
})(jQuery);
;

;
(function($){
$.support.touch='ontouchend'in document;
if(!$.support.touch){
return;
}
var mouseProto=$.ui.mouse.prototype,
_mouseInit=mouseProto._mouseInit,
_mouseDestroy=mouseProto._mouseDestroy,
touchHandled;

function simulateMouseEvent(event,simulatedType){
if(event.originalEvent.touches.length>1){
return;
}
event.preventDefault();
var touch=event.originalEvent.changedTouches[0],
simulatedEvent=document.createEvent('MouseEvents');
simulatedEvent.initMouseEvent(
simulatedType,true,true,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,false,false,false,false,0,null);
event.target.dispatchEvent(simulatedEvent);
}

mouseProto._touchStart=function(event){
var self=this;
if(touchHandled||!self._mouseCapture(event.originalEvent.changedTouches[0])){
return;
}
touchHandled=true;
self._touchMoved=false;
simulateMouseEvent(event,'mouseover');
simulateMouseEvent(event,'mousemove');
simulateMouseEvent(event,'mousedown');
};

mouseProto._touchMove=function(event){
if(!touchHandled){
return;
}
this._touchMoved=true;
simulateMouseEvent(event,'mousemove');
};

mouseProto._touchEnd=function(event){
if(!touchHandled){
return;
}
simulateMouseEvent(event,'mouseup');
simulateMouseEvent(event,'mouseout');
if(!this._touchMoved){
simulateMouseEvent(event,'click');
}
touchHandled=false;
};

mouseProto._mouseInit=function(){
var self=this;
self.element.bind({
touchstart:$.proxy(self,'_touchStart'),
touchmove:$.proxy(self,'_touchMove'),
touchend:$.proxy(self,'_touchEnd')
});
_mouseInit.call(self);
};

mouseProto._mouseDestroy=function(){
var self=this;
self.element.unbind({
touchstart:$.proxy(self,'_touchStart'),
touchmove:$.proxy(self,'_touchMove'),
touchend:$.proxy(self,'_touchEnd')
});
_mouseDestroy.call(self);
};
})(jQuery);
;

;
(function(window,undefined){
var
readyList,
rootjQuery,
core_strundefined=typeof undefined,
document=window.document,
location=window.location,
_jQuery=window.jQuery,
_$=window.$,
class2type={},
core_deletedIds=[],
core_version="1.9.1",
core_concat=core_deletedIds.concat,
core_push=core_deletedIds.push,
core_slice=core_deletedIds.slice,
core_indexOf=core_deletedIds.indexOf,
core_toString=class2type.toString,
core_hasOwn=class2type.hasOwnProperty,
core_trim=core_version.trim,
jQuery=function(selector,context){
return new jQuery.fn.init(selector,context,rootjQuery);
},
core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
core_rnotwhite=/\S+/g,
rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
rquickExpr=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,
rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,
rvalidchars=/^[\],:{}\s]*$/,
rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,
rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,
rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,
rmsPrefix=/^-ms-/,
rdashAlpha=/-([\da-z])/gi,
fcamelCase=function(all,letter){
return letter.toUpperCase();
},
completed=function(event){
if(document.addEventListener||event.type==="load"||document.readyState==="complete"){
detach();
jQuery.ready();
}
},
detach=function(){
if(document.addEventListener){
document.removeEventListener("DOMContentLoaded",completed,false);
window.removeEventListener("load",completed,false);
}else{
document.detachEvent("onreadystatechange",completed);
window.detachEvent("onload",completed);
}
};
jQuery.fn=jQuery.prototype={
jquery:core_version,
constructor:jQuery,
init:function(selector,context,rootjQuery){
var match,elem;
if(!selector){
return this;
}
if(typeof selector==="string"){
if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){
match=[null,selector,null];
}else{
match=rquickExpr.exec(selector);
}
if(match&&(match[1]||!context)){
if(match[1]){
context=context instanceof jQuery?context[0]:context;
jQuery.merge(this,jQuery.parseHTML(
match[1],
context&&context.nodeType?context.ownerDocument||context:document,
true
));
if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){
for(match in context){
if(jQuery.isFunction(this[match])){
this[match](context[match]);
}else{
this.attr(match,context[match]);
}
}
}
return this;
}else{
elem=document.getElementById(match[2]);
if(elem&&elem.parentNode){
if(elem.id!==match[2]){
return rootjQuery.find(selector);
}
this.length=1;
this[0]=elem;
}
this.context=document;
this.selector=selector;
return this;
}
}else if(!context||context.jquery){
return(context||rootjQuery).find(selector);
}else{
return this.constructor(context).find(selector);
}
}else if(selector.nodeType){
this.context=this[0]=selector;
this.length=1;
return this;
}else if(jQuery.isFunction(selector)){
return rootjQuery.ready(selector);
}
if(selector.selector!==undefined){
this.selector=selector.selector;
this.context=selector.context;
}
return jQuery.makeArray(selector,this);
},
selector:"",
length:0,
size:function(){
return this.length;
},
toArray:function(){
return core_slice.call(this);
},
get:function(num){
return num==null?
this.toArray():
(num<0?this[this.length+num]:this[num]);
},
pushStack:function(elems){
var ret=jQuery.merge(this.constructor(),elems);
ret.prevObject=this;
ret.context=this.context;
return ret;
},
each:function(callback,args){
return jQuery.each(this,callback,args);
},
ready:function(fn){
jQuery.ready.promise().done(fn);
return this;
},
slice:function(){
return this.pushStack(core_slice.apply(this,arguments));
},
first:function(){
return this.eq(0);
},
last:function(){
return this.eq(-1);
},
eq:function(i){
var len=this.length,
j=+i+(i<0?len:0);
return this.pushStack(j>=0&&j<len?[this[j]]:[]);
},
map:function(callback){
return this.pushStack(jQuery.map(this,function(elem,i){
return callback.call(elem,i,elem);
}));
},
end:function(){
return this.prevObject||this.constructor(null);
},
push:core_push,
sort:[].sort,
splice:[].splice
};
jQuery.fn.init.prototype=jQuery.fn;
jQuery.extend=jQuery.fn.extend=function(){
var src,copyIsArray,copy,name,options,clone,
target=arguments[0]||{},
i=1,
length=arguments.length,
deep=false;
if(typeof target==="boolean"){
deep=target;
target=arguments[1]||{};
i=2;
}
if(typeof target!=="object"&&!jQuery.isFunction(target)){
target={};
}
if(length===i){
target=this;
--i;
}
for(;i<length;i++){
if((options=arguments[i])!=null){
for(name in options){
src=target[name];
copy=options[name];
if(target===copy){
continue;
}
if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){
if(copyIsArray){
copyIsArray=false;
clone=src&&jQuery.isArray(src)?src:[];
}else{
clone=src&&jQuery.isPlainObject(src)?src:{};
}
target[name]=jQuery.extend(deep,clone,copy);
}else if(copy!==undefined){
target[name]=copy;
}
}
}
}
return target;
};
jQuery.extend({
noConflict:function(deep){
if(window.$===jQuery){
window.$=_$;
}
if(deep&&window.jQuery===jQuery){
window.jQuery=_jQuery;
}
return jQuery;
},
isReady:false,
readyWait:1,
holdReady:function(hold){
if(hold){
jQuery.readyWait++;
}else{
jQuery.ready(true);
}
},
ready:function(wait){
if(wait===true?--jQuery.readyWait:jQuery.isReady){
return;
}
if(!document.body){
return setTimeout(jQuery.ready);
}
jQuery.isReady=true;
if(wait!==true&&--jQuery.readyWait>0){
return;
}
readyList.resolveWith(document,[jQuery]);
if(jQuery.fn.trigger){
jQuery(document).trigger("ready").off("ready");
}
},
isFunction:function(obj){
return jQuery.type(obj)==="function";
},
isArray:Array.isArray||function(obj){
return jQuery.type(obj)==="array";
},
isWindow:function(obj){
return obj!=null&&obj==obj.window;
},
isNumeric:function(obj){
return!isNaN(parseFloat(obj))&&isFinite(obj);
},
type:function(obj){
if(obj==null){
return String(obj);
}
return typeof obj==="object"||typeof obj==="function"?
class2type[core_toString.call(obj)]||"object":
typeof obj;
},
isPlainObject:function(obj){
if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){
return false;
}
try{
if(obj.constructor&&
!core_hasOwn.call(obj,"constructor")&&
!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){
return false;
}
}catch(e){
return false;
}
var key;
for(key in obj){}
return key===undefined||core_hasOwn.call(obj,key);
},
isEmptyObject:function(obj){
var name;
for(name in obj){
return false;
}
return true;
},
error:function(msg){
throw new Error(msg);
},
parseHTML:function(data,context,keepScripts){
if(!data||typeof data!=="string"){
return null;
}
if(typeof context==="boolean"){
keepScripts=context;
context=false;
}
context=context||document;
var parsed=rsingleTag.exec(data),
scripts=!keepScripts&&[];
if(parsed){
return[context.createElement(parsed[1])];
}
parsed=jQuery.buildFragment([data],context,scripts);
if(scripts){
jQuery(scripts).remove();
}
return jQuery.merge([],parsed.childNodes);
},
parseJSON:function(data){
if(window.JSON&&window.JSON.parse){
return window.JSON.parse(data);
}
if(data===null){
return data;
}
if(typeof data==="string"){
data=jQuery.trim(data);
if(data){
if(rvalidchars.test(data.replace(rvalidescape,"@")
.replace(rvalidtokens,"]")
.replace(rvalidbraces,""))){
return(new Function("return "+data))();
}
}
}
jQuery.error("Invalid JSON: "+data);
},
parseXML:function(data){
var xml,tmp;
if(!data||typeof data!=="string"){
return null;
}
try{
if(window.DOMParser){tmp=new DOMParser();
xml=tmp.parseFromString(data,"text/xml");
}else{xml=new ActiveXObject("Microsoft.XMLDOM");
xml.async="false";
xml.loadXML(data);
}
}catch(e){
xml=undefined;
}
if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){
jQuery.error("Invalid XML: "+data);
}
return xml;
},
noop:function(){},
globalEval:function(data){
if(data&&jQuery.trim(data)){
(window.execScript||function(data){
window["eval"].call(window,data);
})(data);
}
},
camelCase:function(string){
return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase);
},
nodeName:function(elem,name){
return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase();
},
each:function(obj,callback,args){
var value,
i=0,
length=obj.length,
isArray=isArraylike(obj);
if(args){
if(isArray){
for(;i<length;i++){
value=callback.apply(obj[i],args);
if(value===false){
break;
}
}
}else{
for(i in obj){
value=callback.apply(obj[i],args);
if(value===false){
break;
}
}
}
}else{
if(isArray){
for(;i<length;i++){
value=callback.call(obj[i],i,obj[i]);
if(value===false){
break;
}
}
}else{
for(i in obj){
value=callback.call(obj[i],i,obj[i]);
if(value===false){
break;
}
}
}
}
return obj;
},
trim:core_trim&&!core_trim.call("\uFEFF\xA0")?
function(text){
return text==null?
"":
core_trim.call(text);
}:
function(text){
return text==null?
"":
(text+"").replace(rtrim,"");
},
makeArray:function(arr,results){
var ret=results||[];
if(arr!=null){
if(isArraylike(Object(arr))){
jQuery.merge(ret,
typeof arr==="string"?
[arr]:arr
);
}else{
core_push.call(ret,arr);
}
}
return ret;
},
inArray:function(elem,arr,i){
var len;
if(arr){
if(core_indexOf){
return core_indexOf.call(arr,elem,i);
}
len=arr.length;
i=i?i<0?Math.max(0,len+i):i:0;
for(;i<len;i++){
if(i in arr&&arr[i]===elem){
return i;
}
}
}
return-1;
},
merge:function(first,second){
var l=second.length,
i=first.length,
j=0;
if(typeof l==="number"){
for(;j<l;j++){
first[i++]=second[j];
}
}else{
while(second[j]!==undefined){
first[i++]=second[j++];
}
}
first.length=i;
return first;
},
grep:function(elems,callback,inv){
var retVal,
ret=[],
i=0,
length=elems.length;
inv=!!inv;
for(;i<length;i++){
retVal=!!callback(elems[i],i);
if(inv!==retVal){
ret.push(elems[i]);
}
}
return ret;
},
map:function(elems,callback,arg){
var value,
i=0,
length=elems.length,
isArray=isArraylike(elems),
ret=[];
if(isArray){
for(;i<length;i++){
value=callback(elems[i],i,arg);
if(value!=null){
ret[ret.length]=value;
}
}
}else{
for(i in elems){
value=callback(elems[i],i,arg);
if(value!=null){
ret[ret.length]=value;
}
}
}
return core_concat.apply([],ret);
},
guid:1,
proxy:function(fn,context){
var args,proxy,tmp;
if(typeof context==="string"){
tmp=fn[context];
context=fn;
fn=tmp;
}
if(!jQuery.isFunction(fn)){
return undefined;
}
args=core_slice.call(arguments,2);
proxy=function(){
return fn.apply(context||this,args.concat(core_slice.call(arguments)));
};
proxy.guid=fn.guid=fn.guid||jQuery.guid++;
return proxy;
},
access:function(elems,fn,key,value,chainable,emptyGet,raw){
var i=0,
length=elems.length,
bulk=key==null;
if(jQuery.type(key)==="object"){
chainable=true;
for(i in key){
jQuery.access(elems,fn,i,key[i],true,emptyGet,raw);
}
}else if(value!==undefined){
chainable=true;
if(!jQuery.isFunction(value)){
raw=true;
}
if(bulk){
if(raw){
fn.call(elems,value);
fn=null;
}else{
bulk=fn;
fn=function(elem,key,value){
return bulk.call(jQuery(elem),value);
};
}
}
if(fn){
for(;i<length;i++){
fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));
}
}
}
return chainable?
elems:
bulk?
fn.call(elems):
length?fn(elems[0],key):emptyGet;
},
now:function(){
return(new Date()).getTime();
}
});
jQuery.ready.promise=function(obj){
if(!readyList){
readyList=jQuery.Deferred();
if(document.readyState==="complete"){
setTimeout(jQuery.ready);
}else if(document.addEventListener){
document.addEventListener("DOMContentLoaded",completed,false);
window.addEventListener("load",completed,false);
}else{
document.attachEvent("onreadystatechange",completed);
window.attachEvent("onload",completed);
var top=false;
try{
top=window.frameElement==null&&document.documentElement;
}catch(e){}
if(top&&top.doScroll){
(function doScrollCheck(){
if(!jQuery.isReady){
try{
top.doScroll("left");
}catch(e){
return setTimeout(doScrollCheck,50);
}
detach();
jQuery.ready();
}
})();
}
}
}
return readyList.promise(obj);
};
jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){
class2type["[object "+name+"]"]=name.toLowerCase();
});
function isArraylike(obj){
var length=obj.length,
type=jQuery.type(obj);
if(jQuery.isWindow(obj)){
return false;
}
if(obj.nodeType===1&&length){
return true;
}
return type==="array"||type!=="function"&&
(length===0||
typeof length==="number"&&length>0&&(length-1)in obj);
}
rootjQuery=jQuery(document);
var optionsCache={};
function createOptions(options){
var object=optionsCache[options]={};
jQuery.each(options.match(core_rnotwhite)||[],function(_,flag){
object[flag]=true;
});
return object;
}

jQuery.Callbacks=function(options){
options=typeof options==="string"?
(optionsCache[options]||createOptions(options)):
jQuery.extend({},options);
var firing,
memory,
fired,
firingLength,
firingIndex,
firingStart,
list=[],
stack=!options.once&&[],
fire=function(data){
memory=options.memory&&data;
fired=true;
firingIndex=firingStart||0;
firingStart=0;
firingLength=list.length;
firing=true;
for(;list&&firingIndex<firingLength;firingIndex++){
if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){
memory=false;break;
}
}
firing=false;
if(list){
if(stack){
if(stack.length){
fire(stack.shift());
}
}else if(memory){
list=[];
}else{
self.disable();
}
}
},
self={
add:function(){
if(list){
var start=list.length;
(function add(args){
jQuery.each(args,function(_,arg){
var type=jQuery.type(arg);
if(type==="function"){
if(!options.unique||!self.has(arg)){
list.push(arg);
}
}else if(arg&&arg.length&&type!=="string"){
add(arg);
}
});
})(arguments);
if(firing){
firingLength=list.length;
}else if(memory){
firingStart=start;
fire(memory);
}
}
return this;
},
remove:function(){
if(list){
jQuery.each(arguments,function(_,arg){
var index;
while((index=jQuery.inArray(arg,list,index))>-1){
list.splice(index,1);
if(firing){
if(index<=firingLength){
firingLength--;
}
if(index<=firingIndex){
firingIndex--;
}
}
}
});
}
return this;
},
has:function(fn){
return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length);
},
empty:function(){
list=[];
return this;
},
disable:function(){
list=stack=memory=undefined;
return this;
},
disabled:function(){
return!list;
},
lock:function(){
stack=undefined;
if(!memory){
self.disable();
}
return this;
},
locked:function(){
return!stack;
},
fireWith:function(context,args){
args=args||[];
args=[context,args.slice?args.slice():args];
if(list&&(!fired||stack)){
if(firing){
stack.push(args);
}else{
fire(args);
}
}
return this;
},
fire:function(){
self.fireWith(this,arguments);
return this;
},
fired:function(){
return!!fired;
}
};
return self;
};
jQuery.extend({
Deferred:function(func){
var tuples=[
["resolve","done",jQuery.Callbacks("once memory"),"resolved"],
["reject","fail",jQuery.Callbacks("once memory"),"rejected"],
["notify","progress",jQuery.Callbacks("memory")]
],
state="pending",
promise={
state:function(){
return state;
},
always:function(){
deferred.done(arguments).fail(arguments);
return this;
},
then:function(){
var fns=arguments;
return jQuery.Deferred(function(newDefer){
jQuery.each(tuples,function(i,tuple){
var action=tuple[0],
fn=jQuery.isFunction(fns[i])&&fns[i];
deferred[tuple[1]](function(){
var returned=fn&&fn.apply(this,arguments);
if(returned&&jQuery.isFunction(returned.promise)){
returned.promise()
.done(newDefer.resolve)
.fail(newDefer.reject)
.progress(newDefer.notify);
}else{
newDefer[action+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments);
}
});
});
fns=null;
}).promise();
},
promise:function(obj){
return obj!=null?jQuery.extend(obj,promise):promise;
}
},
deferred={};
promise.pipe=promise.then;
jQuery.each(tuples,function(i,tuple){
var list=tuple[2],
stateString=tuple[3];
promise[tuple[1]]=list.add;
if(stateString){
list.add(function(){
state=stateString;
},tuples[i^1][2].disable,tuples[2][2].lock);
}
deferred[tuple[0]]=function(){
deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);
return this;
};
deferred[tuple[0]+"With"]=list.fireWith;
});
promise.promise(deferred);
if(func){
func.call(deferred,deferred);
}
return deferred;
},
when:function(subordinate){
var i=0,
resolveValues=core_slice.call(arguments),
length=resolveValues.length,
remaining=length!==1||(subordinate&&jQuery.isFunction(subordinate.promise))?length:0,
deferred=remaining===1?subordinate:jQuery.Deferred(),
updateFunc=function(i,contexts,values){
return function(value){
contexts[i]=this;
values[i]=arguments.length>1?core_slice.call(arguments):value;
if(values===progressValues){
deferred.notifyWith(contexts,values);
}else if(!(--remaining)){
deferred.resolveWith(contexts,values);
}
};
},
progressValues,progressContexts,resolveContexts;
if(length>1){
progressValues=new Array(length);
progressContexts=new Array(length);
resolveContexts=new Array(length);
for(;i<length;i++){
if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){
resolveValues[i].promise()
.done(updateFunc(i,resolveContexts,resolveValues))
.fail(deferred.reject)
.progress(updateFunc(i,progressContexts,progressValues));
}else{
--remaining;
}
}
}
if(!remaining){
deferred.resolveWith(resolveContexts,resolveValues);
}
return deferred.promise();
}
});
jQuery.support=(function(){
var support,all,a,
input,select,fragment,
opt,eventName,isSupported,i,
div=document.createElement("div");
div.setAttribute("className","t");
div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
all=div.getElementsByTagName("*");
a=div.getElementsByTagName("a")[0];
if(!all||!a||!all.length){
return{};
}
select=document.createElement("select");
opt=select.appendChild(document.createElement("option"));
input=div.getElementsByTagName("input")[0];
a.style.cssText="top:1px;float:left;opacity:.5";
support={
getSetAttribute:div.className!=="t",
leadingWhitespace:div.firstChild.nodeType===3,
tbody:!div.getElementsByTagName("tbody").length,
htmlSerialize:!!div.getElementsByTagName("link").length,
style:/top/.test(a.getAttribute("style")),
hrefNormalized:a.getAttribute("href")==="/a",
opacity:/^0.5/.test(a.style.opacity),
cssFloat:!!a.style.cssFloat,
checkOn:!!input.value,
optSelected:opt.selected,
enctype:!!document.createElement("form").enctype,
html5Clone:document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",
boxModel:document.compatMode==="CSS1Compat",
deleteExpando:true,
noCloneEvent:true,
inlineBlockNeedsLayout:false,
shrinkWrapBlocks:false,
reliableMarginRight:true,
boxSizingReliable:true,
pixelPosition:false
};
input.checked=true;
support.noCloneChecked=input.cloneNode(true).checked;
select.disabled=true;
support.optDisabled=!opt.disabled;
try{
delete div.test;
}catch(e){
support.deleteExpando=false;
}
input=document.createElement("input");
input.setAttribute("value","");
support.input=input.getAttribute("value")==="";
input.value="t";
input.setAttribute("type","radio");
support.radioValue=input.value==="t";
input.setAttribute("checked","t");
input.setAttribute("name","t");
fragment=document.createDocumentFragment();
fragment.appendChild(input);
support.appendChecked=input.checked;
support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;
if(div.attachEvent){
div.attachEvent("onclick",function(){
support.noCloneEvent=false;
});
div.cloneNode(true).click();
}
for(i in{submit:true,change:true,focusin:true}){
div.setAttribute(eventName="on"+i,"t");
support[i+"Bubbles"]=eventName in window||div.attributes[eventName].expando===false;
}
div.style.backgroundClip="content-box";
div.cloneNode(true).style.backgroundClip="";
support.clearCloneStyle=div.style.backgroundClip==="content-box";
jQuery(function(){
var container,marginDiv,tds,
divReset="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",
body=document.getElementsByTagName("body")[0];
if(!body){
return;
}
container=document.createElement("div");
container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";
body.appendChild(container).appendChild(div);
div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";
tds=div.getElementsByTagName("td");
tds[0].style.cssText="padding:0;margin:0;border:0;display:none";
isSupported=(tds[0].offsetHeight===0);
tds[0].style.display="";
tds[1].style.display="none";
support.reliableHiddenOffsets=isSupported&&(tds[0].offsetHeight===0);
div.innerHTML="";
div.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";
support.boxSizing=(div.offsetWidth===4);
support.doesNotIncludeMarginInBodyOffset=(body.offsetTop!==1);
if(window.getComputedStyle){
support.pixelPosition=(window.getComputedStyle(div,null)||{}).top!=="1%";
support.boxSizingReliable=(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px";
marginDiv=div.appendChild(document.createElement("div"));
marginDiv.style.cssText=div.style.cssText=divReset;
marginDiv.style.marginRight=marginDiv.style.width="0";
div.style.width="1px";
support.reliableMarginRight=
!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight);
}
if(typeof div.style.zoom!==core_strundefined){
div.innerHTML="";
div.style.cssText=divReset+"width:1px;padding:1px;display:inline;zoom:1";
support.inlineBlockNeedsLayout=(div.offsetWidth===3);
div.style.display="block";
div.innerHTML="<div></div>";
div.firstChild.style.width="5px";
support.shrinkWrapBlocks=(div.offsetWidth!==3);
if(support.inlineBlockNeedsLayout){
body.style.zoom=1;
}
}
body.removeChild(container);
container=div=tds=marginDiv=null;
});
all=select=fragment=opt=a=input=null;
return support;
})();
var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,
rmultiDash=/([A-Z])/g;
function internalData(elem,name,data,pvt){
if(!jQuery.acceptData(elem)){
return;
}
var thisCache,ret,
internalKey=jQuery.expando,
getByName=typeof name==="string",
isNode=elem.nodeType,
cache=isNode?jQuery.cache:elem,
id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;
if((!id||!cache[id]||(!pvt&&!cache[id].data))&&getByName&&data===undefined){
return;
}
if(!id){
if(isNode){
elem[internalKey]=id=core_deletedIds.pop()||jQuery.guid++;
}else{
id=internalKey;
}
}
if(!cache[id]){
cache[id]={};
if(!isNode){
cache[id].toJSON=jQuery.noop;
}
}
if(typeof name==="object"||typeof name==="function"){
if(pvt){
cache[id]=jQuery.extend(cache[id],name);
}else{
cache[id].data=jQuery.extend(cache[id].data,name);
}
}
thisCache=cache[id];
if(!pvt){
if(!thisCache.data){
thisCache.data={};
}
thisCache=thisCache.data;
}
if(data!==undefined){
thisCache[jQuery.camelCase(name)]=data;
}
if(getByName){
ret=thisCache[name];
if(ret==null){
ret=thisCache[jQuery.camelCase(name)];
}
}else{
ret=thisCache;
}
return ret;
}
function internalRemoveData(elem,name,pvt){
if(!jQuery.acceptData(elem)){
return;
}
var i,l,thisCache,
isNode=elem.nodeType,
cache=isNode?jQuery.cache:elem,
id=isNode?elem[jQuery.expando]:jQuery.expando;
if(!cache[id]){
return;
}
if(name){
thisCache=pvt?cache[id]:cache[id].data;
if(thisCache){
if(!jQuery.isArray(name)){
if(name in thisCache){
name=[name];
}else{
name=jQuery.camelCase(name);
if(name in thisCache){
name=[name];
}else{
name=name.split(" ");
}
}
}else{
name=name.concat(jQuery.map(name,jQuery.camelCase));
}
for(i=0,l=name.length;i<l;i++){
delete thisCache[name[i]];
}
if(!(pvt?isEmptyDataObject:jQuery.isEmptyObject)(thisCache)){
return;
}
}
}
if(!pvt){
delete cache[id].data;
if(!isEmptyDataObject(cache[id])){
return;
}
}
if(isNode){
jQuery.cleanData([elem],true);
}else if(jQuery.support.deleteExpando||cache!=cache.window){
delete cache[id];
}else{
cache[id]=null;
}
}
jQuery.extend({
cache:{},
expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),
noData:{
"embed":true,
"object":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",
"applet":true
},
hasData:function(elem){
elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];
return!!elem&&!isEmptyDataObject(elem);
},
data:function(elem,name,data){
return internalData(elem,name,data);
},
removeData:function(elem,name){
return internalRemoveData(elem,name);
},
_data:function(elem,name,data){
return internalData(elem,name,data,true);
},
_removeData:function(elem,name){
return internalRemoveData(elem,name,true);
},
acceptData:function(elem){
if(elem.nodeType&&elem.nodeType!==1&&elem.nodeType!==9){
return false;
}
var noData=elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()];
return!noData||noData!==true&&elem.getAttribute("classid")===noData;
}
});
jQuery.fn.extend({
data:function(key,value){
var attrs,name,
elem=this[0],
i=0,
data=null;
if(key===undefined){
if(this.length){
data=jQuery.data(elem);
if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){
attrs=elem.attributes;
for(;i<attrs.length;i++){
name=attrs[i].name;
if(!name.indexOf("data-")){
name=jQuery.camelCase(name.slice(5));
dataAttr(elem,name,data[name]);
}
}
jQuery._data(elem,"parsedAttrs",true);
}
}
return data;
}
if(typeof key==="object"){
return this.each(function(){
jQuery.data(this,key);
});
}
return jQuery.access(this,function(value){
if(value===undefined){
return elem?dataAttr(elem,key,jQuery.data(elem,key)):null;
}
this.each(function(){
jQuery.data(this,key,value);
});
},null,value,arguments.length>1,null,true);
},
removeData:function(key){
return this.each(function(){
jQuery.removeData(this,key);
});
}
});
function dataAttr(elem,key,data){
if(data===undefined&&elem.nodeType===1){
var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();
data=elem.getAttribute(name);
if(typeof data==="string"){
try{
data=data==="true"?true:
data==="false"?false:
data==="null"?null:
+data+""===data?+data:
rbrace.test(data)?jQuery.parseJSON(data):
data;
}catch(e){}
jQuery.data(elem,key,data);
}else{
data=undefined;
}
}
return data;
}
function isEmptyDataObject(obj){
var name;
for(name in obj){
if(name==="data"&&jQuery.isEmptyObject(obj[name])){
continue;
}
if(name!=="toJSON"){
return false;
}
}
return true;
}
jQuery.extend({
queue:function(elem,type,data){
var queue;
if(elem){
type=(type||"fx")+"queue";
queue=jQuery._data(elem,type);
if(data){
if(!queue||jQuery.isArray(data)){
queue=jQuery._data(elem,type,jQuery.makeArray(data));
}else{
queue.push(data);
}
}
return queue||[];
}
},
dequeue:function(elem,type){
type=type||"fx";
var queue=jQuery.queue(elem,type),
startLength=queue.length,
fn=queue.shift(),
hooks=jQuery._queueHooks(elem,type),
next=function(){
jQuery.dequeue(elem,type);
};
if(fn==="inprogress"){
fn=queue.shift();
startLength--;
}
hooks.cur=fn;
if(fn){
if(type==="fx"){
queue.unshift("inprogress");
}
delete hooks.stop;
fn.call(elem,next,hooks);
}
if(!startLength&&hooks){
hooks.empty.fire();
}
},
_queueHooks:function(elem,type){
var key=type+"queueHooks";
return jQuery._data(elem,key)||jQuery._data(elem,key,{
empty:jQuery.Callbacks("once memory").add(function(){
jQuery._removeData(elem,type+"queue");
jQuery._removeData(elem,key);
})
});
}
});
jQuery.fn.extend({
queue:function(type,data){
var setter=2;
if(typeof type!=="string"){
data=type;
type="fx";
setter--;
}
if(arguments.length<setter){
return jQuery.queue(this[0],type);
}
return data===undefined?
this:
this.each(function(){
var queue=jQuery.queue(this,type,data);
jQuery._queueHooks(this,type);
if(type==="fx"&&queue[0]!=="inprogress"){
jQuery.dequeue(this,type);
}
});
},
dequeue:function(type){
return this.each(function(){
jQuery.dequeue(this,type);
});
},
delay:function(time,type){
time=jQuery.fx?jQuery.fx.speeds[time]||time:time;
type=type||"fx";
return this.queue(type,function(next,hooks){
var timeout=setTimeout(next,time);
hooks.stop=function(){
clearTimeout(timeout);
};
});
},
clearQueue:function(type){
return this.queue(type||"fx",[]);
},
promise:function(type,obj){
var tmp,
count=1,
defer=jQuery.Deferred(),
elements=this,
i=this.length,
resolve=function(){
if(!(--count)){
defer.resolveWith(elements,[elements]);
}
};
if(typeof type!=="string"){
obj=type;
type=undefined;
}
type=type||"fx";
while(i--){
tmp=jQuery._data(elements[i],type+"queueHooks");
if(tmp&&tmp.empty){
count++;
tmp.empty.add(resolve);
}
}
resolve();
return defer.promise(obj);
}
});
var nodeHook,boolHook,
rclass=/[\t\r\n]/g,
rreturn=/\r/g,
rfocusable=/^(?:input|select|textarea|button|object)$/i,
rclickable=/^(?:a|area)$/i,
rboolean=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,
ruseDefault=/^(?:checked|selected)$/i,
getSetAttribute=jQuery.support.getSetAttribute,
getSetInput=jQuery.support.input;
jQuery.fn.extend({
attr:function(name,value){
return jQuery.access(this,jQuery.attr,name,value,arguments.length>1);
},
removeAttr:function(name){
return this.each(function(){
jQuery.removeAttr(this,name);
});
},
prop:function(name,value){
return jQuery.access(this,jQuery.prop,name,value,arguments.length>1);
},
removeProp:function(name){
name=jQuery.propFix[name]||name;
return this.each(function(){
try{
this[name]=undefined;
delete this[name];
}catch(e){}
});
},
addClass:function(value){
var classes,elem,cur,clazz,j,
i=0,
len=this.length,
proceed=typeof value==="string"&&value;
if(jQuery.isFunction(value)){
return this.each(function(j){
jQuery(this).addClass(value.call(this,j,this.className));
});
}
if(proceed){
classes=(value||"").match(core_rnotwhite)||[];
for(;i<len;i++){
elem=this[i];
cur=elem.nodeType===1&&(elem.className?
(" "+elem.className+" ").replace(rclass," "):
" "
);
if(cur){
j=0;
while((clazz=classes[j++])){
if(cur.indexOf(" "+clazz+" ")<0){
cur+=clazz+" ";
}
}
elem.className=jQuery.trim(cur);
}
}
}
return this;
},
removeClass:function(value){
var classes,elem,cur,clazz,j,
i=0,
len=this.length,
proceed=arguments.length===0||typeof value==="string"&&value;
if(jQuery.isFunction(value)){
return this.each(function(j){
jQuery(this).removeClass(value.call(this,j,this.className));
});
}
if(proceed){
classes=(value||"").match(core_rnotwhite)||[];
for(;i<len;i++){
elem=this[i];
cur=elem.nodeType===1&&(elem.className?
(" "+elem.className+" ").replace(rclass," "):
""
);
if(cur){
j=0;
while((clazz=classes[j++])){
while(cur.indexOf(" "+clazz+" ")>=0){
cur=cur.replace(" "+clazz+" "," ");
}
}
elem.className=value?jQuery.trim(cur):"";
}
}
}
return this;
},
toggleClass:function(value,stateVal){
var type=typeof value,
isBool=typeof stateVal==="boolean";
if(jQuery.isFunction(value)){
return this.each(function(i){
jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal);
});
}
return this.each(function(){
if(type==="string"){
var className,
i=0,
self=jQuery(this),
state=stateVal,
classNames=value.match(core_rnotwhite)||[];
while((className=classNames[i++])){
state=isBool?state:!self.hasClass(className);
self[state?"addClass":"removeClass"](className);
}
}else if(type===core_strundefined||type==="boolean"){
if(this.className){
jQuery._data(this,"__className__",this.className);
}
this.className=this.className||value===false?"":jQuery._data(this,"__className__")||"";
}
});
},
hasClass:function(selector){
var className=" "+selector+" ",
i=0,
l=this.length;
for(;i<l;i++){
if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){
return true;
}
}
return false;
},
val:function(value){
var ret,hooks,isFunction,
elem=this[0];
if(!arguments.length){
if(elem){
hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];
if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){
return ret;
}
ret=elem.value;
return typeof ret==="string"?
ret.replace(rreturn,""):
ret==null?"":ret;
}
return;
}
isFunction=jQuery.isFunction(value);
return this.each(function(i){
var val,
self=jQuery(this);
if(this.nodeType!==1){
return;
}
if(isFunction){
val=value.call(this,i,self.val());
}else{
val=value;
}
if(val==null){
val="";
}else if(typeof val==="number"){
val+="";
}else if(jQuery.isArray(val)){
val=jQuery.map(val,function(value){
return value==null?"":value+"";
});
}
hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];
if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){
this.value=val;
}
});
}
});
jQuery.extend({
valHooks:{
option:{
get:function(elem){
var val=elem.attributes.value;
return!val||val.specified?elem.value:elem.text;
}
},
select:{
get:function(elem){
var value,option,
options=elem.options,
index=elem.selectedIndex,
one=elem.type==="select-one"||index<0,
values=one?null:[],
max=one?index+1:options.length,
i=index<0?
max:
one?index:0;
for(;i<max;i++){
option=options[i];
if((option.selected||i===index)&&
(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&
(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){
value=jQuery(option).val();
if(one){
return value;
}
values.push(value);
}
}
return values;
},
set:function(elem,value){
var values=jQuery.makeArray(value);
jQuery(elem).find("option").each(function(){
this.selected=jQuery.inArray(jQuery(this).val(),values)>=0;
});
if(!values.length){
elem.selectedIndex=-1;
}
return values;
}
}
},
attr:function(elem,name,value){
var hooks,notxml,ret,
nType=elem.nodeType;
if(!elem||nType===3||nType===8||nType===2){
return;
}
if(typeof elem.getAttribute===core_strundefined){
return jQuery.prop(elem,name,value);
}
notxml=nType!==1||!jQuery.isXMLDoc(elem);
if(notxml){
name=name.toLowerCase();
hooks=jQuery.attrHooks[name]||(rboolean.test(name)?boolHook:nodeHook);
}
if(value!==undefined){
if(value===null){
jQuery.removeAttr(elem,name);
}else if(hooks&&notxml&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){
return ret;
}else{
elem.setAttribute(name,value+"");
return value;
}
}else if(hooks&&notxml&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){
return ret;
}else{
if(typeof elem.getAttribute!==core_strundefined){
ret=elem.getAttribute(name);
}
return ret==null?
undefined:
ret;
}
},
removeAttr:function(elem,value){
var name,propName,
i=0,
attrNames=value&&value.match(core_rnotwhite);
if(attrNames&&elem.nodeType===1){
while((name=attrNames[i++])){
propName=jQuery.propFix[name]||name;
if(rboolean.test(name)){
if(!getSetAttribute&&ruseDefault.test(name)){
elem[jQuery.camelCase("default-"+name)]=
elem[propName]=false;
}else{
elem[propName]=false;
}
}else{
jQuery.attr(elem,name,"");
}
elem.removeAttribute(getSetAttribute?name:propName);
}
}
},
attrHooks:{
type:{
set:function(elem,value){
if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){
var val=elem.value;
elem.setAttribute("type",value);
if(val){
elem.value=val;
}
return value;
}
}
}
},
propFix:{
tabindex:"tabIndex",
readonly:"readOnly",
"for":"htmlFor",
"class":"className",
maxlength:"maxLength",
cellspacing:"cellSpacing",
cellpadding:"cellPadding",
rowspan:"rowSpan",
colspan:"colSpan",
usemap:"useMap",
frameborder:"frameBorder",
contenteditable:"contentEditable"
},
prop:function(elem,name,value){
var ret,hooks,notxml,
nType=elem.nodeType;
if(!elem||nType===3||nType===8||nType===2){
return;
}
notxml=nType!==1||!jQuery.isXMLDoc(elem);
if(notxml){
name=jQuery.propFix[name]||name;
hooks=jQuery.propHooks[name];
}
if(value!==undefined){
if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){
return ret;
}else{
return(elem[name]=value);
}
}else{
if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){
return ret;
}else{
return elem[name];
}
}
},
propHooks:{
tabIndex:{
get:function(elem){
var attributeNode=elem.getAttributeNode("tabindex");
return attributeNode&&attributeNode.specified?
parseInt(attributeNode.value,10):
rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?
0:
undefined;
}
}
}
});
boolHook={
get:function(elem,name){
var
prop=jQuery.prop(elem,name),
attr=typeof prop==="boolean"&&elem.getAttribute(name),
detail=typeof prop==="boolean"?
getSetInput&&getSetAttribute?
attr!=null:
ruseDefault.test(name)?
elem[jQuery.camelCase("default-"+name)]:
!!attr:
elem.getAttributeNode(name);
return detail&&detail.value!==false?
name.toLowerCase():
undefined;
},
set:function(elem,value,name){
if(value===false){
jQuery.removeAttr(elem,name);
}else if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){
elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name);
}else{
elem[jQuery.camelCase("default-"+name)]=elem[name]=true;
}
return name;
}
};
if(!getSetInput||!getSetAttribute){
jQuery.attrHooks.value={
get:function(elem,name){
var ret=elem.getAttributeNode(name);
return jQuery.nodeName(elem,"input")?
elem.defaultValue:
ret&&ret.specified?ret.value:undefined;
},
set:function(elem,value,name){
if(jQuery.nodeName(elem,"input")){
elem.defaultValue=value;
}else{
return nodeHook&&nodeHook.set(elem,value,name);
}
}
};
}
if(!getSetAttribute){
nodeHook=jQuery.valHooks.button={
get:function(elem,name){
var ret=elem.getAttributeNode(name);
return ret&&(name==="id"||name==="name"||name==="coords"?ret.value!=="":ret.specified)?
ret.value:
undefined;
},
set:function(elem,value,name){
var ret=elem.getAttributeNode(name);
if(!ret){
elem.setAttributeNode(
(ret=elem.ownerDocument.createAttribute(name))
);
}
ret.value=value+="";
return name==="value"||value===elem.getAttribute(name)?
value:
undefined;
}
};
jQuery.attrHooks.contenteditable={
get:nodeHook.get,
set:function(elem,value,name){
nodeHook.set(elem,value===""?false:value,name);
}
};
jQuery.each(["width","height"],function(i,name){
jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{
set:function(elem,value){
if(value===""){
elem.setAttribute(name,"auto");
return value;
}
}
});
});
}
if(!jQuery.support.hrefNormalized){
jQuery.each(["href","src","width","height"],function(i,name){
jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{
get:function(elem){
var ret=elem.getAttribute(name,2);
return ret==null?undefined:ret;
}
});
});
jQuery.each(["href","src"],function(i,name){
jQuery.propHooks[name]={
get:function(elem){
return elem.getAttribute(name,4);
}
};
});
}
if(!jQuery.support.style){
jQuery.attrHooks.style={
get:function(elem){
return elem.style.cssText||undefined;
},
set:function(elem,value){
return(elem.style.cssText=value+"");
}
};
}
if(!jQuery.support.optSelected){
jQuery.propHooks.selected=jQuery.extend(jQuery.propHooks.selected,{
get:function(elem){
var parent=elem.parentNode;
if(parent){
parent.selectedIndex;
if(parent.parentNode){
parent.parentNode.selectedIndex;
}
}
return null;
}
});
}
if(!jQuery.support.enctype){
jQuery.propFix.enctype="encoding";
}
if(!jQuery.support.checkOn){
jQuery.each(["radio","checkbox"],function(){
jQuery.valHooks[this]={
get:function(elem){
return elem.getAttribute("value")===null?"on":elem.value;
}
};
});
}
jQuery.each(["radio","checkbox"],function(){
jQuery.valHooks[this]=jQuery.extend(jQuery.valHooks[this],{
set:function(elem,value){
if(jQuery.isArray(value)){
return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0);
}
}
});
});
var rformElems=/^(?:input|select|textarea)$/i,
rkeyEvent=/^key/,
rmouseEvent=/^(?:mouse|contextmenu)|click/,
rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,
rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;
function returnTrue(){
return true;
}
function returnFalse(){
return false;
}

jQuery.event={
global:{},
add:function(elem,types,handler,data,selector){
var tmp,events,t,handleObjIn,
special,eventHandle,handleObj,
handlers,type,namespaces,origType,
elemData=jQuery._data(elem);
if(!elemData){
return;
}
if(handler.handler){
handleObjIn=handler;
handler=handleObjIn.handler;
selector=handleObjIn.selector;
}
if(!handler.guid){
handler.guid=jQuery.guid++;
}
if(!(events=elemData.events)){
events=elemData.events={};
}
if(!(eventHandle=elemData.handle)){
eventHandle=elemData.handle=function(e){
return typeof jQuery!==core_strundefined&&(!e||jQuery.event.triggered!==e.type)?
jQuery.event.dispatch.apply(eventHandle.elem,arguments):
undefined;
};
eventHandle.elem=elem;
}
types=(types||"").match(core_rnotwhite)||[""];
t=types.length;
while(t--){
tmp=rtypenamespace.exec(types[t])||[];
type=origType=tmp[1];
namespaces=(tmp[2]||"").split(".").sort();
special=jQuery.event.special[type]||{};
type=(selector?special.delegateType:special.bindType)||type;
special=jQuery.event.special[type]||{};
handleObj=jQuery.extend({
type:type,
origType:origType,
data:data,
handler:handler,
guid:handler.guid,
selector:selector,
needsContext:selector&&jQuery.expr.match.needsContext.test(selector),
namespace:namespaces.join(".")
},handleObjIn);
if(!(handlers=events[type])){
handlers=events[type]=[];
handlers.delegateCount=0;
if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){
if(elem.addEventListener){
elem.addEventListener(type,eventHandle,false);
}else if(elem.attachEvent){
elem.attachEvent("on"+type,eventHandle);
}
}
}
if(special.add){
special.add.call(elem,handleObj);
if(!handleObj.handler.guid){
handleObj.handler.guid=handler.guid;
}
}
if(selector){
handlers.splice(handlers.delegateCount++,0,handleObj);
}else{
handlers.push(handleObj);
}
jQuery.event.global[type]=true;
}
elem=null;
},
remove:function(elem,types,handler,selector,mappedTypes){
var j,handleObj,tmp,
origCount,t,events,
special,handlers,type,
namespaces,origType,
elemData=jQuery.hasData(elem)&&jQuery._data(elem);
if(!elemData||!(events=elemData.events)){
return;
}
types=(types||"").match(core_rnotwhite)||[""];
t=types.length;
while(t--){
tmp=rtypenamespace.exec(types[t])||[];
type=origType=tmp[1];
namespaces=(tmp[2]||"").split(".").sort();
if(!type){
for(type in events){
jQuery.event.remove(elem,type+types[t],handler,selector,true);
}
continue;
}
special=jQuery.event.special[type]||{};
type=(selector?special.delegateType:special.bindType)||type;
handlers=events[type]||[];
tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");
origCount=j=handlers.length;
while(j--){
handleObj=handlers[j];
if((mappedTypes||origType===handleObj.origType)&&
(!handler||handler.guid===handleObj.guid)&&
(!tmp||tmp.test(handleObj.namespace))&&
(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){
handlers.splice(j,1);
if(handleObj.selector){
handlers.delegateCount--;
}
if(special.remove){
special.remove.call(elem,handleObj);
}
}
}
if(origCount&&!handlers.length){
if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){
jQuery.removeEvent(elem,type,elemData.handle);
}
delete events[type];
}
}
if(jQuery.isEmptyObject(events)){
delete elemData.handle;
jQuery._removeData(elem,"events");
}
},
trigger:function(event,data,elem,onlyHandlers){
var handle,ontype,cur,
bubbleType,special,tmp,i,
eventPath=[elem||document],
type=core_hasOwn.call(event,"type")?event.type:event,
namespaces=core_hasOwn.call(event,"namespace")?event.namespace.split("."):[];
cur=tmp=elem=elem||document;
if(elem.nodeType===3||elem.nodeType===8){
return;
}
if(rfocusMorph.test(type+jQuery.event.triggered)){
return;
}
if(type.indexOf(".")>=0){
namespaces=type.split(".");
type=namespaces.shift();
namespaces.sort();
}
ontype=type.indexOf(":")<0&&"on"+type;
event=event[jQuery.expando]?
event:
new jQuery.Event(type,typeof event==="object"&&event);
event.isTrigger=true;
event.namespace=namespaces.join(".");
event.namespace_re=event.namespace?
new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):
null;
event.result=undefined;
if(!event.target){
event.target=elem;
}
data=data==null?
[event]:
jQuery.makeArray(data,[event]);
special=jQuery.event.special[type]||{};
if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){
return;
}
if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){
bubbleType=special.delegateType||type;
if(!rfocusMorph.test(bubbleType+type)){
cur=cur.parentNode;
}
for(;cur;cur=cur.parentNode){
eventPath.push(cur);
tmp=cur;
}
if(tmp===(elem.ownerDocument||document)){
eventPath.push(tmp.defaultView||tmp.parentWindow||window);
}
}
i=0;
while((cur=eventPath[i++])&&!event.isPropagationStopped()){
event.type=i>1?
bubbleType:
special.bindType||type;
handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");
if(handle){
handle.apply(cur,data);
}
handle=ontype&&cur[ontype];
if(handle&&jQuery.acceptData(cur)&&handle.apply&&handle.apply(cur,data)===false){
event.preventDefault();
}
}
event.type=type;
if(!onlyHandlers&&!event.isDefaultPrevented()){
if((!special._default||special._default.apply(elem.ownerDocument,data)===false)&&
!(type==="click"&&jQuery.nodeName(elem,"a"))&&jQuery.acceptData(elem)){
if(ontype&&elem[type]&&!jQuery.isWindow(elem)){
tmp=elem[ontype];
if(tmp){
elem[ontype]=null;
}
jQuery.event.triggered=type;
try{
elem[type]();
}catch(e){
}
jQuery.event.triggered=undefined;
if(tmp){
elem[ontype]=tmp;
}
}
}
}
return event.result;
},
dispatch:function(event){
event=jQuery.event.fix(event);
var i,ret,handleObj,matched,j,
handlerQueue=[],
args=core_slice.call(arguments),
handlers=(jQuery._data(this,"events")||{})[event.type]||[],
special=jQuery.event.special[event.type]||{};
args[0]=event;
event.delegateTarget=this;
if(special.preDispatch&&special.preDispatch.call(this,event)===false){
return;
}
handlerQueue=jQuery.event.handlers.call(this,event,handlers);
i=0;
while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){
event.currentTarget=matched.elem;
j=0;
while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){
if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){
event.handleObj=handleObj;
event.data=handleObj.data;
ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler)
.apply(matched.elem,args);
if(ret!==undefined){
if((event.result=ret)===false){
event.preventDefault();
event.stopPropagation();
}
}
}
}
}
if(special.postDispatch){
special.postDispatch.call(this,event);
}
return event.result;
},
handlers:function(event,handlers){
var sel,handleObj,matches,i,
handlerQueue=[],
delegateCount=handlers.delegateCount,
cur=event.target;
if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){
for(;cur!=this;cur=cur.parentNode||this){
if(cur.nodeType===1&&(cur.disabled!==true||event.type!=="click")){
matches=[];
for(i=0;i<delegateCount;i++){
handleObj=handlers[i];
sel=handleObj.selector+" ";
if(matches[sel]===undefined){
matches[sel]=handleObj.needsContext?
jQuery(sel,this).index(cur)>=0:
jQuery.find(sel,this,null,[cur]).length;
}
if(matches[sel]){
matches.push(handleObj);
}
}
if(matches.length){
handlerQueue.push({elem:cur,handlers:matches});
}
}
}
}
if(delegateCount<handlers.length){
handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)});
}
return handlerQueue;
},
fix:function(event){
if(event[jQuery.expando]){
return event;
}
var i,prop,copy,
type=event.type,
originalEvent=event,
fixHook=this.fixHooks[type];
if(!fixHook){
this.fixHooks[type]=fixHook=
rmouseEvent.test(type)?this.mouseHooks:
rkeyEvent.test(type)?this.keyHooks:
{};
}
copy=fixHook.props?this.props.concat(fixHook.props):this.props;
event=new jQuery.Event(originalEvent);
i=copy.length;
while(i--){
prop=copy[i];
event[prop]=originalEvent[prop];
}
if(!event.target){
event.target=originalEvent.srcElement||document;
}
if(event.target.nodeType===3){
event.target=event.target.parentNode;
}
event.metaKey=!!event.metaKey;
return fixHook.filter?fixHook.filter(event,originalEvent):event;
},
props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},
keyHooks:{
props:"char charCode key keyCode".split(" "),
filter:function(event,original){
if(event.which==null){
event.which=original.charCode!=null?original.charCode:original.keyCode;
}
return event;
}
},
mouseHooks:{
props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(event,original){
var body,eventDoc,doc,
button=original.button,
fromElement=original.fromElement;
if(event.pageX==null&&original.clientX!=null){
eventDoc=event.target.ownerDocument||document;
doc=eventDoc.documentElement;
body=eventDoc.body;
event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);
event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);
}
if(!event.relatedTarget&&fromElement){
event.relatedTarget=fromElement===event.target?original.toElement:fromElement;
}
if(!event.which&&button!==undefined){
event.which=(button&1?1:(button&2?3:(button&4?2:0)));
}
return event;
}
},
special:{
load:{
noBubble:true
},
click:{
trigger:function(){
if(jQuery.nodeName(this,"input")&&this.type==="checkbox"&&this.click){
this.click();
return false;
}
}
},
focus:{
trigger:function(){
if(this!==document.activeElement&&this.focus){
try{
this.focus();
return false;
}catch(e){
}
}
},
delegateType:"focusin"
},
blur:{
trigger:function(){
if(this===document.activeElement&&this.blur){
this.blur();
return false;
}
},
delegateType:"focusout"
},
beforeunload:{
postDispatch:function(event){
if(event.result!==undefined){
event.originalEvent.returnValue=event.result;
}
}
}
},
simulate:function(type,elem,event,bubble){
var e=jQuery.extend(
new jQuery.Event(),
event,
{type:type,
isSimulated:true,
originalEvent:{}
}
);
if(bubble){
jQuery.event.trigger(e,null,elem);
}else{
jQuery.event.dispatch.call(elem,e);
}
if(e.isDefaultPrevented()){
event.preventDefault();
}
}
};
jQuery.removeEvent=document.removeEventListener?
function(elem,type,handle){
if(elem.removeEventListener){
elem.removeEventListener(type,handle,false);
}
}:
function(elem,type,handle){
var name="on"+type;
if(elem.detachEvent){
if(typeof elem[name]===core_strundefined){
elem[name]=null;
}
elem.detachEvent(name,handle);
}
};
jQuery.Event=function(src,props){
if(!(this instanceof jQuery.Event)){
return new jQuery.Event(src,props);
}
if(src&&src.type){
this.originalEvent=src;
this.type=src.type;
this.isDefaultPrevented=(src.defaultPrevented||src.returnValue===false||
src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse;
}else{
this.type=src;
}
if(props){
jQuery.extend(this,props);
}
this.timeStamp=src&&src.timeStamp||jQuery.now();
this[jQuery.expando]=true;
};
jQuery.Event.prototype={
isDefaultPrevented:returnFalse,
isPropagationStopped:returnFalse,
isImmediatePropagationStopped:returnFalse,
preventDefault:function(){
var e=this.originalEvent;
this.isDefaultPrevented=returnTrue;
if(!e){
return;
}
if(e.preventDefault){
e.preventDefault();
}else{
e.returnValue=false;
}
},
stopPropagation:function(){
var e=this.originalEvent;
this.isPropagationStopped=returnTrue;
if(!e){
return;
}
if(e.stopPropagation){
e.stopPropagation();
}
e.cancelBubble=true;
},
stopImmediatePropagation:function(){
this.isImmediatePropagationStopped=returnTrue;
this.stopPropagation();
}
};
jQuery.each({
mouseenter:"mouseover",
mouseleave:"mouseout"
},function(orig,fix){
jQuery.event.special[orig]={
delegateType:fix,
bindType:fix,
handle:function(event){
var ret,
target=this,
related=event.relatedTarget,
handleObj=event.handleObj;
if(!related||(related!==target&&!jQuery.contains(target,related))){
event.type=handleObj.origType;
ret=handleObj.handler.apply(this,arguments);
event.type=fix;
}
return ret;
}
};
});
if(!jQuery.support.submitBubbles){
jQuery.event.special.submit={
setup:function(){
if(jQuery.nodeName(this,"form")){
return false;
}
jQuery.event.add(this,"click._submit keypress._submit",function(e){
var elem=e.target,
form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;
if(form&&!jQuery._data(form,"submitBubbles")){
jQuery.event.add(form,"submit._submit",function(event){
event._submit_bubble=true;
});
jQuery._data(form,"submitBubbles",true);
}
});
},
postDispatch:function(event){
if(event._submit_bubble){
delete event._submit_bubble;
if(this.parentNode&&!event.isTrigger){
jQuery.event.simulate("submit",this.parentNode,event,true);
}
}
},
teardown:function(){
if(jQuery.nodeName(this,"form")){
return false;
}
jQuery.event.remove(this,"._submit");
}
};
}
if(!jQuery.support.changeBubbles){
jQuery.event.special.change={
setup:function(){
if(rformElems.test(this.nodeName)){
if(this.type==="checkbox"||this.type==="radio"){
jQuery.event.add(this,"propertychange._change",function(event){
if(event.originalEvent.propertyName==="checked"){
this._just_changed=true;
}
});
jQuery.event.add(this,"click._change",function(event){
if(this._just_changed&&!event.isTrigger){
this._just_changed=false;
}
jQuery.event.simulate("change",this,event,true);
});
}
return false;
}
jQuery.event.add(this,"beforeactivate._change",function(e){
var elem=e.target;
if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")){
jQuery.event.add(elem,"change._change",function(event){
if(this.parentNode&&!event.isSimulated&&!event.isTrigger){
jQuery.event.simulate("change",this.parentNode,event,true);
}
});
jQuery._data(elem,"changeBubbles",true);
}
});
},
handle:function(event){
var elem=event.target;
if(this!==elem||event.isSimulated||event.isTrigger||(elem.type!=="radio"&&elem.type!=="checkbox")){
return event.handleObj.handler.apply(this,arguments);
}
},
teardown:function(){
jQuery.event.remove(this,"._change");
return!rformElems.test(this.nodeName);
}
};
}
if(!jQuery.support.focusinBubbles){
jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){
var attaches=0,
handler=function(event){
jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true);
};
jQuery.event.special[fix]={
setup:function(){
if(attaches++===0){
document.addEventListener(orig,handler,true);
}
},
teardown:function(){
if(--attaches===0){
document.removeEventListener(orig,handler,true);
}
}
};
});
}
jQuery.fn.extend({
on:function(types,selector,data,fn,one){
var type,origFn;
if(typeof types==="object"){
if(typeof selector!=="string"){
data=data||selector;
selector=undefined;
}
for(type in types){
this.on(type,selector,data,types[type],one);
}
return this;
}
if(data==null&&fn==null){
fn=selector;
data=selector=undefined;
}else if(fn==null){
if(typeof selector==="string"){
fn=data;
data=undefined;
}else{
fn=data;
data=selector;
selector=undefined;
}
}
if(fn===false){
fn=returnFalse;
}else if(!fn){
return this;
}
if(one===1){
origFn=fn;
fn=function(event){
jQuery().off(event);
return origFn.apply(this,arguments);
};
fn.guid=origFn.guid||(origFn.guid=jQuery.guid++);
}
return this.each(function(){
jQuery.event.add(this,types,fn,data,selector);
});
},
one:function(types,selector,data,fn){
return this.on(types,selector,data,fn,1);
},
off:function(types,selector,fn){
var handleObj,type;
if(types&&types.preventDefault&&types.handleObj){
handleObj=types.handleObj;
jQuery(types.delegateTarget).off(
handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,
handleObj.selector,
handleObj.handler
);
return this;
}
if(typeof types==="object"){
for(type in types){
this.off(type,selector,types[type]);
}
return this;
}
if(selector===false||typeof selector==="function"){
fn=selector;
selector=undefined;
}
if(fn===false){
fn=returnFalse;
}
return this.each(function(){
jQuery.event.remove(this,types,fn,selector);
});
},
bind:function(types,data,fn){
return this.on(types,null,data,fn);
},
unbind:function(types,fn){
return this.off(types,null,fn);
},
delegate:function(selector,types,data,fn){
return this.on(types,selector,data,fn);
},
undelegate:function(selector,types,fn){
return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn);
},
trigger:function(type,data){
return this.each(function(){
jQuery.event.trigger(type,data,this);
});
},
triggerHandler:function(type,data){
var elem=this[0];
if(elem){
return jQuery.event.trigger(type,data,elem,true);
}
}
});

(function(window,undefined){
var i,
cachedruns,
Expr,
getText,
isXML,
compile,
hasDuplicate,
outermostContext,
setDocument,
document,
docElem,
documentIsXML,
rbuggyQSA,
rbuggyMatches,
matches,
contains,
sortOrder,
expando="sizzle"+ -(new Date()),
preferredDoc=window.document,
support={},
dirruns=0,
done=0,
classCache=createCache(),
tokenCache=createCache(),
compilerCache=createCache(),
strundefined=typeof undefined,
MAX_NEGATIVE=1<<31,
arr=[],
pop=arr.pop,
push=arr.push,
slice=arr.slice,
indexOf=arr.indexOf||function(elem){
var i=0,
len=this.length;
for(;i<len;i++){
if(this[i]===elem){
return i;
}
}
return-1;
},
whitespace="[\\x20\\t\\r\\n\\f]",
characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
identifier=characterEncoding.replace("w","w#"),
operators="([*^$|!~]?=)",
attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+
"*(?:"+operators+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",
pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",
rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),
rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),
rcombinators=new RegExp("^"+whitespace+"*([\\x20\\t\\r\\n\\f>+~])"+whitespace+"*"),
rpseudo=new RegExp(pseudos),
ridentifier=new RegExp("^"+identifier+"$"),
matchExpr={
"ID":new RegExp("^#("+characterEncoding+")"),
"CLASS":new RegExp("^\\.("+characterEncoding+")"),
"NAME":new RegExp("^\\[name=['\"]?("+characterEncoding+")['\"]?\\]"),
"TAG":new RegExp("^("+characterEncoding.replace("w","w*")+")"),
"ATTR":new RegExp("^"+attributes),
"PSEUDO":new RegExp("^"+pseudos),
"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+
"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+
"*(\\d+)|))"+whitespace+"*\\)|)","i"),
"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+
whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")
},
rsibling=/[\x20\t\r\n\f]*[+~]/,
rnative=/^[^{]+\{\s*\[native code/,
rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
rinputs=/^(?:input|select|textarea|button)$/i,
rheader=/^h\d$/i,
rescape=/'|\\/g,
rattributeQuotes=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,
runescape=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,
funescape=function(_,escaped){
var high="0x"+escaped-0x10000;
return high!==high?
escaped:
high<0?
String.fromCharCode(high+0x10000):
String.fromCharCode(high>>10|0xD800,high&0x3FF|0xDC00);
};
try{
slice.call(preferredDoc.documentElement.childNodes,0)[0].nodeType;
}catch(e){
slice=function(i){
var elem,
results=[];
while((elem=this[i++])){
results.push(elem);
}
return results;
};
}

function isNative(fn){
return rnative.test(fn+"");
}

function createCache(){
var cache,
keys=[];
return(cache=function(key,value){
if(keys.push(key+=" ")>Expr.cacheLength){
delete cache[keys.shift()];
}
return(cache[key]=value);
});
}

function markFunction(fn){
fn[expando]=true;
return fn;
}

function assert(fn){
var div=document.createElement("div");
try{
return fn(div);
}catch(e){
return false;
}finally{
div=null;
}
}
function Sizzle(selector,context,results,seed){
var match,elem,m,nodeType,
i,groups,old,nid,newContext,newSelector;
if((context?context.ownerDocument||context:preferredDoc)!==document){
setDocument(context);
}
context=context||document;
results=results||[];
if(!selector||typeof selector!=="string"){
return results;
}
if((nodeType=context.nodeType)!==1&&nodeType!==9){
return[];
}
if(!documentIsXML&&!seed){
if((match=rquickExpr.exec(selector))){
if((m=match[1])){
if(nodeType===9){
elem=context.getElementById(m);
if(elem&&elem.parentNode){
if(elem.id===m){
results.push(elem);
return results;
}
}else{
return results;
}
}else{
if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&
contains(context,elem)&&elem.id===m){
results.push(elem);
return results;
}
}
}else if(match[2]){
push.apply(results,slice.call(context.getElementsByTagName(selector),0));
return results;
}else if((m=match[3])&&support.getByClassName&&context.getElementsByClassName){
push.apply(results,slice.call(context.getElementsByClassName(m),0));
return results;
}
}
if(support.qsa&&!rbuggyQSA.test(selector)){
old=true;
nid=expando;
newContext=context;
newSelector=nodeType===9&&selector;
if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){
groups=tokenize(selector);
if((old=context.getAttribute("id"))){
nid=old.replace(rescape,"\\$&");
}else{
context.setAttribute("id",nid);
}
nid="[id='"+nid+"'] ";
i=groups.length;
while(i--){
groups[i]=nid+toSelector(groups[i]);
}
newContext=rsibling.test(selector)&&context.parentNode||context;
newSelector=groups.join(",");
}
if(newSelector){
try{
push.apply(results,slice.call(newContext.querySelectorAll(
newSelector
),0));
return results;
}catch(qsaError){
}finally{
if(!old){
context.removeAttribute("id");
}
}
}
}
}
return select(selector.replace(rtrim,"$1"),context,results,seed);
}

isXML=Sizzle.isXML=function(elem){
var documentElement=elem&&(elem.ownerDocument||elem).documentElement;
return documentElement?documentElement.nodeName!=="HTML":false;
};

setDocument=Sizzle.setDocument=function(node){
var doc=node?node.ownerDocument||node:preferredDoc;
if(doc===document||doc.nodeType!==9||!doc.documentElement){
return document;
}
document=doc;
docElem=doc.documentElement;
documentIsXML=isXML(doc);
support.tagNameNoComments=assert(function(div){
div.appendChild(doc.createComment(""));
return!div.getElementsByTagName("*").length;
});
support.attributes=assert(function(div){
div.innerHTML="<select></select>";
var type=typeof div.lastChild.getAttribute("multiple");
return type!=="boolean"&&type!=="string";
});
support.getByClassName=assert(function(div){
div.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";
if(!div.getElementsByClassName||!div.getElementsByClassName("e").length){
return false;
}
div.lastChild.className="e";
return div.getElementsByClassName("e").length===2;
});
support.getByName=assert(function(div){
div.id=expando+0;
div.innerHTML="<a name='"+expando+"'></a><div name='"+expando+"'></div>";
docElem.insertBefore(div,docElem.firstChild);
var pass=doc.getElementsByName&&
doc.getElementsByName(expando).length===2+
doc.getElementsByName(expando+0).length;
support.getIdNotName=!doc.getElementById(expando);
docElem.removeChild(div);
return pass;
});
Expr.attrHandle=assert(function(div){
div.innerHTML="<a href='#'></a>";
return div.firstChild&&typeof div.firstChild.getAttribute!==strundefined&&
div.firstChild.getAttribute("href")==="#";
})?
{}:
{
"href":function(elem){
return elem.getAttribute("href",2);
},
"type":function(elem){
return elem.getAttribute("type");
}
};
if(support.getIdNotName){
Expr.find["ID"]=function(id,context){
if(typeof context.getElementById!==strundefined&&!documentIsXML){
var m=context.getElementById(id);
return m&&m.parentNode?[m]:[];
}
};
Expr.filter["ID"]=function(id){
var attrId=id.replace(runescape,funescape);
return function(elem){
return elem.getAttribute("id")===attrId;
};
};
}else{
Expr.find["ID"]=function(id,context){
if(typeof context.getElementById!==strundefined&&!documentIsXML){
var m=context.getElementById(id);
return m?
m.id===id||typeof m.getAttributeNode!==strundefined&&m.getAttributeNode("id").value===id?
[m]:
undefined:
[];
}
};
Expr.filter["ID"]=function(id){
var attrId=id.replace(runescape,funescape);
return function(elem){
var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");
return node&&node.value===attrId;
};
};
}
Expr.find["TAG"]=support.tagNameNoComments?
function(tag,context){
if(typeof context.getElementsByTagName!==strundefined){
return context.getElementsByTagName(tag);
}
}:
function(tag,context){
var elem,
tmp=[],
i=0,
results=context.getElementsByTagName(tag);
if(tag==="*"){
while((elem=results[i++])){
if(elem.nodeType===1){
tmp.push(elem);
}
}
return tmp;
}
return results;
};
Expr.find["NAME"]=support.getByName&&function(tag,context){
if(typeof context.getElementsByName!==strundefined){
return context.getElementsByName(name);
}
};
Expr.find["CLASS"]=support.getByClassName&&function(className,context){
if(typeof context.getElementsByClassName!==strundefined&&!documentIsXML){
return context.getElementsByClassName(className);
}
};
rbuggyMatches=[];
rbuggyQSA=[":focus"];
if((support.qsa=isNative(doc.querySelectorAll))){
assert(function(div){
div.innerHTML="<select><option selected=''></option></select>";
if(!div.querySelectorAll("[selected]").length){
rbuggyQSA.push("\\["+whitespace+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)");
}
if(!div.querySelectorAll(":checked").length){
rbuggyQSA.push(":checked");
}
});
assert(function(div){
div.innerHTML="<input type='hidden' i=''/>";
if(div.querySelectorAll("[i^='']").length){
rbuggyQSA.push("[*^$]="+whitespace+"*(?:\"\"|'')");
}
if(!div.querySelectorAll(":enabled").length){
rbuggyQSA.push(":enabled",":disabled");
}
div.querySelectorAll("*,:x");
rbuggyQSA.push(",.*:");
});
}
if((support.matchesSelector=isNative((matches=docElem.matchesSelector||
docElem.mozMatchesSelector||
docElem.webkitMatchesSelector||
docElem.oMatchesSelector||
docElem.msMatchesSelector)))){
assert(function(div){
support.disconnectedMatch=matches.call(div,"div");
matches.call(div,"[s!='']:x");
rbuggyMatches.push("!=",pseudos);
});
}
rbuggyQSA=new RegExp(rbuggyQSA.join("|"));
rbuggyMatches=new RegExp(rbuggyMatches.join("|"));
contains=isNative(docElem.contains)||docElem.compareDocumentPosition?
function(a,b){
var adown=a.nodeType===9?a.documentElement:a,
bup=b&&b.parentNode;
return a===bup||!!(bup&&bup.nodeType===1&&(
adown.contains?
adown.contains(bup):
a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16
));
}:
function(a,b){
if(b){
while((b=b.parentNode)){
if(b===a){
return true;
}
}
}
return false;
};
sortOrder=docElem.compareDocumentPosition?
function(a,b){
var compare;
if(a===b){
hasDuplicate=true;
return 0;
}
if((compare=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b))){
if(compare&1||a.parentNode&&a.parentNode.nodeType===11){
if(a===doc||contains(preferredDoc,a)){
return-1;
}
if(b===doc||contains(preferredDoc,b)){
return 1;
}
return 0;
}
return compare&4?-1:1;
}
return a.compareDocumentPosition?-1:1;
}:
function(a,b){
var cur,
i=0,
aup=a.parentNode,
bup=b.parentNode,
ap=[a],
bp=[b];
if(a===b){
hasDuplicate=true;
return 0;
}else if(!aup||!bup){
return a===doc?-1:
b===doc?1:
aup?-1:
bup?1:
0;
}else if(aup===bup){
return siblingCheck(a,b);
}
cur=a;
while((cur=cur.parentNode)){
ap.unshift(cur);
}
cur=b;
while((cur=cur.parentNode)){
bp.unshift(cur);
}
while(ap[i]===bp[i]){
i++;
}
return i?
siblingCheck(ap[i],bp[i]):
ap[i]===preferredDoc?-1:
bp[i]===preferredDoc?1:
0;
};
hasDuplicate=false;
[0,0].sort(sortOrder);
support.detectDuplicates=hasDuplicate;
return document;
};
Sizzle.matches=function(expr,elements){
return Sizzle(expr,null,null,elements);
};
Sizzle.matchesSelector=function(elem,expr){
if((elem.ownerDocument||elem)!==document){
setDocument(elem);
}
expr=expr.replace(rattributeQuotes,"='$1']");
if(support.matchesSelector&&!documentIsXML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&!rbuggyQSA.test(expr)){
try{
var ret=matches.call(elem,expr);
if(ret||support.disconnectedMatch||
elem.document&&elem.document.nodeType!==11){
return ret;
}
}catch(e){}
}
return Sizzle(expr,document,null,[elem]).length>0;
};
Sizzle.contains=function(context,elem){
if((context.ownerDocument||context)!==document){
setDocument(context);
}
return contains(context,elem);
};
Sizzle.attr=function(elem,name){
var val;
if((elem.ownerDocument||elem)!==document){
setDocument(elem);
}
if(!documentIsXML){
name=name.toLowerCase();
}
if((val=Expr.attrHandle[name])){
return val(elem);
}
if(documentIsXML||support.attributes){
return elem.getAttribute(name);
}
return((val=elem.getAttributeNode(name))||elem.getAttribute(name))&&elem[name]===true?
name:
val&&val.specified?val.value:null;
};
Sizzle.error=function(msg){
throw new Error("Syntax error, unrecognized expression: "+msg);
};
Sizzle.uniqueSort=function(results){
var elem,
duplicates=[],
i=1,
j=0;
hasDuplicate=!support.detectDuplicates;
results.sort(sortOrder);
if(hasDuplicate){
for(;(elem=results[i]);i++){
if(elem===results[i-1]){
j=duplicates.push(i);
}
}
while(j--){
results.splice(duplicates[j],1);
}
}
return results;
};
function siblingCheck(a,b){
var cur=b&&a,
diff=cur&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);
if(diff){
return diff;
}
if(cur){
while((cur=cur.nextSibling)){
if(cur===b){
return-1;
}
}
}
return a?1:-1;
}
function createInputPseudo(type){
return function(elem){
var name=elem.nodeName.toLowerCase();
return name==="input"&&elem.type===type;
};
}
function createButtonPseudo(type){
return function(elem){
var name=elem.nodeName.toLowerCase();
return(name==="input"||name==="button")&&elem.type===type;
};
}
function createPositionalPseudo(fn){
return markFunction(function(argument){
argument=+argument;
return markFunction(function(seed,matches){
var j,
matchIndexes=fn([],seed.length,argument),
i=matchIndexes.length;
while(i--){
if(seed[(j=matchIndexes[i])]){
seed[j]=!(matches[j]=seed[j]);
}
}
});
});
}

getText=Sizzle.getText=function(elem){
var node,
ret="",
i=0,
nodeType=elem.nodeType;
if(!nodeType){
for(;(node=elem[i]);i++){
ret+=getText(node);
}
}else if(nodeType===1||nodeType===9||nodeType===11){
if(typeof elem.textContent==="string"){
return elem.textContent;
}else{
for(elem=elem.firstChild;elem;elem=elem.nextSibling){
ret+=getText(elem);
}
}
}else if(nodeType===3||nodeType===4){
return elem.nodeValue;
}
return ret;
};
Expr=Sizzle.selectors={
cacheLength:50,
createPseudo:markFunction,
match:matchExpr,
find:{},
relative:{
">":{dir:"parentNode",first:true},
" ":{dir:"parentNode"},
"+":{dir:"previousSibling",first:true},
"~":{dir:"previousSibling"}
},
preFilter:{
"ATTR":function(match){
match[1]=match[1].replace(runescape,funescape);
match[3]=(match[4]||match[5]||"").replace(runescape,funescape);
if(match[2]==="~="){
match[3]=" "+match[3]+" ";
}
return match.slice(0,4);
},
"CHILD":function(match){

match[1]=match[1].toLowerCase();
if(match[1].slice(0,3)==="nth"){
if(!match[3]){
Sizzle.error(match[0]);
}
match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));
match[5]=+((match[7]+match[8])||match[3]==="odd");
}else if(match[3]){
Sizzle.error(match[0]);
}
return match;
},
"PSEUDO":function(match){
var excess,
unquoted=!match[5]&&match[2];
if(matchExpr["CHILD"].test(match[0])){
return null;
}
if(match[4]){
match[2]=match[4];
}else if(unquoted&&rpseudo.test(unquoted)&&
(excess=tokenize(unquoted,true))&&
(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){
match[0]=match[0].slice(0,excess);
match[2]=unquoted.slice(0,excess);
}
return match.slice(0,3);
}
},
filter:{
"TAG":function(nodeName){
if(nodeName==="*"){
return function(){return true};
}
nodeName=nodeName.replace(runescape,funescape).toLowerCase();
return function(elem){
return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;
};
},
"CLASS":function(className){
var pattern=classCache[className+" "];
return pattern||
(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&
classCache(className,function(elem){
return pattern.test(elem.className||(typeof elem.getAttribute!==strundefined&&elem.getAttribute("class"))||"");
});
},
"ATTR":function(name,operator,check){
return function(elem){
var result=Sizzle.attr(elem,name);
if(result==null){
return operator==="!=";
}
if(!operator){
return true;
}
result+="";
return operator==="="?result===check:
operator==="!="?result!==check:
operator==="^="?check&&result.indexOf(check)===0:
operator==="*="?check&&result.indexOf(check)>-1:
operator==="$="?check&&result.slice(-check.length)===check:
operator==="~="?(" "+result+" ").indexOf(check)>-1:
operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":
false;
};
},
"CHILD":function(type,what,argument,first,last){
var simple=type.slice(0,3)!=="nth",
forward=type.slice(-4)!=="last",
ofType=what==="of-type";
return first===1&&last===0?
function(elem){
return!!elem.parentNode;
}:
function(elem,context,xml){
var cache,outerCache,node,diff,nodeIndex,start,
dir=simple!==forward?"nextSibling":"previousSibling",
parent=elem.parentNode,
name=ofType&&elem.nodeName.toLowerCase(),
useCache=!xml&&!ofType;
if(parent){
if(simple){
while(dir){
node=elem;
while((node=node[dir])){
if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){
return false;
}
}
start=dir=type==="only"&&!start&&"nextSibling";
}
return true;
}
start=[forward?parent.firstChild:parent.lastChild];
if(forward&&useCache){
outerCache=parent[expando]||(parent[expando]={});
cache=outerCache[type]||[];
nodeIndex=cache[0]===dirruns&&cache[1];
diff=cache[0]===dirruns&&cache[2];
node=nodeIndex&&parent.childNodes[nodeIndex];
while((node=++nodeIndex&&node&&node[dir]||
(diff=nodeIndex=0)||start.pop())){
if(node.nodeType===1&&++diff&&node===elem){
outerCache[type]=[dirruns,nodeIndex,diff];
break;
}
}
}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){
diff=cache[1];
}else{
while((node=++nodeIndex&&node&&node[dir]||
(diff=nodeIndex=0)||start.pop())){
if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){
if(useCache){
(node[expando]||(node[expando]={}))[type]=[dirruns,diff];
}
if(node===elem){
break;
}
}
}
}
diff-=last;
return diff===first||(diff%first===0&&diff/first>=0);
}
};
},
"PSEUDO":function(pseudo,argument){
var args,
fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||
Sizzle.error("unsupported pseudo: "+pseudo);
if(fn[expando]){
return fn(argument);
}
if(fn.length>1){
args=[pseudo,pseudo,"",argument];
return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?
markFunction(function(seed,matches){
var idx,
matched=fn(seed,argument),
i=matched.length;
while(i--){
idx=indexOf.call(seed,matched[i]);
seed[idx]=!(matches[idx]=matched[i]);
}
}):
function(elem){
return fn(elem,0,args);
};
}
return fn;
}
},
pseudos:{
"not":markFunction(function(selector){
var input=[],
results=[],
matcher=compile(selector.replace(rtrim,"$1"));
return matcher[expando]?
markFunction(function(seed,matches,context,xml){
var elem,
unmatched=matcher(seed,null,xml,[]),
i=seed.length;
while(i--){
if((elem=unmatched[i])){
seed[i]=!(matches[i]=elem);
}
}
}):
function(elem,context,xml){
input[0]=elem;
matcher(input,null,xml,results);
return!results.pop();
};
}),
"has":markFunction(function(selector){
return function(elem){
return Sizzle(selector,elem).length>0;
};
}),
"contains":markFunction(function(text){
return function(elem){
return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1;
};
}),
"lang":markFunction(function(lang){
if(!ridentifier.test(lang||"")){
Sizzle.error("unsupported lang: "+lang);
}
lang=lang.replace(runescape,funescape).toLowerCase();
return function(elem){
var elemLang;
do{
if((elemLang=documentIsXML?
elem.getAttribute("xml:lang")||elem.getAttribute("lang"):
elem.lang)){
elemLang=elemLang.toLowerCase();
return elemLang===lang||elemLang.indexOf(lang+"-")===0;
}
}while((elem=elem.parentNode)&&elem.nodeType===1);
return false;
};
}),
"target":function(elem){
var hash=window.location&&window.location.hash;
return hash&&hash.slice(1)===elem.id;
},
"root":function(elem){
return elem===docElem;
},
"focus":function(elem){
return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);
},
"enabled":function(elem){
return elem.disabled===false;
},
"disabled":function(elem){
return elem.disabled===true;
},
"checked":function(elem){
var nodeName=elem.nodeName.toLowerCase();
return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected);
},
"selected":function(elem){
if(elem.parentNode){
elem.parentNode.selectedIndex;
}
return elem.selected===true;
},
"empty":function(elem){
for(elem=elem.firstChild;elem;elem=elem.nextSibling){
if(elem.nodeName>"@"||elem.nodeType===3||elem.nodeType===4){
return false;
}
}
return true;
},
"parent":function(elem){
return!Expr.pseudos["empty"](elem);
},
"header":function(elem){
return rheader.test(elem.nodeName);
},
"input":function(elem){
return rinputs.test(elem.nodeName);
},
"button":function(elem){
var name=elem.nodeName.toLowerCase();
return name==="input"&&elem.type==="button"||name==="button";
},
"text":function(elem){
var attr;
return elem.nodeName.toLowerCase()==="input"&&
elem.type==="text"&&
((attr=elem.getAttribute("type"))==null||attr.toLowerCase()===elem.type);
},
"first":createPositionalPseudo(function(){
return[0];
}),
"last":createPositionalPseudo(function(matchIndexes,length){
return[length-1];
}),
"eq":createPositionalPseudo(function(matchIndexes,length,argument){
return[argument<0?argument+length:argument];
}),
"even":createPositionalPseudo(function(matchIndexes,length){
var i=0;
for(;i<length;i+=2){
matchIndexes.push(i);
}
return matchIndexes;
}),
"odd":createPositionalPseudo(function(matchIndexes,length){
var i=1;
for(;i<length;i+=2){
matchIndexes.push(i);
}
return matchIndexes;
}),
"lt":createPositionalPseudo(function(matchIndexes,length,argument){
var i=argument<0?argument+length:argument;
for(;--i>=0;){
matchIndexes.push(i);
}
return matchIndexes;
}),
"gt":createPositionalPseudo(function(matchIndexes,length,argument){
var i=argument<0?argument+length:argument;
for(;++i<length;){
matchIndexes.push(i);
}
return matchIndexes;
})
}
};
for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){
Expr.pseudos[i]=createInputPseudo(i);
}
for(i in{submit:true,reset:true}){
Expr.pseudos[i]=createButtonPseudo(i);
}
function tokenize(selector,parseOnly){
var matched,match,tokens,type,
soFar,groups,preFilters,
cached=tokenCache[selector+" "];
if(cached){
return parseOnly?0:cached.slice(0);
}
soFar=selector;
groups=[];
preFilters=Expr.preFilter;
while(soFar){
if(!matched||(match=rcomma.exec(soFar))){
if(match){
soFar=soFar.slice(match[0].length)||soFar;
}
groups.push(tokens=[]);
}
matched=false;
if((match=rcombinators.exec(soFar))){
matched=match.shift();
tokens.push({
value:matched,
type:match[0].replace(rtrim," ")
});
soFar=soFar.slice(matched.length);
}
for(type in Expr.filter){
if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||
(match=preFilters[type](match)))){
matched=match.shift();
tokens.push({
value:matched,
type:type,
matches:match
});
soFar=soFar.slice(matched.length);
}
}
if(!matched){
break;
}
}
return parseOnly?
soFar.length:
soFar?
Sizzle.error(selector):
tokenCache(selector,groups).slice(0);
}
function toSelector(tokens){
var i=0,
len=tokens.length,
selector="";
for(;i<len;i++){
selector+=tokens[i].value;
}
return selector;
}
function addCombinator(matcher,combinator,base){
var dir=combinator.dir,
checkNonElements=base&&dir==="parentNode",
doneName=done++;
return combinator.first?
function(elem,context,xml){
while((elem=elem[dir])){
if(elem.nodeType===1||checkNonElements){
return matcher(elem,context,xml);
}
}
}:
function(elem,context,xml){
var data,cache,outerCache,
dirkey=dirruns+" "+doneName;
if(xml){
while((elem=elem[dir])){
if(elem.nodeType===1||checkNonElements){
if(matcher(elem,context,xml)){
return true;
}
}
}
}else{
while((elem=elem[dir])){
if(elem.nodeType===1||checkNonElements){
outerCache=elem[expando]||(elem[expando]={});
if((cache=outerCache[dir])&&cache[0]===dirkey){
if((data=cache[1])===true||data===cachedruns){
return data===true;
}
}else{
cache=outerCache[dir]=[dirkey];
cache[1]=matcher(elem,context,xml)||cachedruns;
if(cache[1]===true){
return true;
}
}
}
}
}
};
}
function elementMatcher(matchers){
return matchers.length>1?
function(elem,context,xml){
var i=matchers.length;
while(i--){
if(!matchers[i](elem,context,xml)){
return false;
}
}
return true;
}:
matchers[0];
}
function condense(unmatched,map,filter,context,xml){
var elem,
newUnmatched=[],
i=0,
len=unmatched.length,
mapped=map!=null;
for(;i<len;i++){
if((elem=unmatched[i])){
if(!filter||filter(elem,context,xml)){
newUnmatched.push(elem);
if(mapped){
map.push(i);
}
}
}
}
return newUnmatched;
}
function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){
if(postFilter&&!postFilter[expando]){
postFilter=setMatcher(postFilter);
}
if(postFinder&&!postFinder[expando]){
postFinder=setMatcher(postFinder,postSelector);
}
return markFunction(function(seed,results,context,xml){
var temp,i,elem,
preMap=[],
postMap=[],
preexisting=results.length,
elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),
matcherIn=preFilter&&(seed||!selector)?
condense(elems,preMap,preFilter,context,xml):
elems,
matcherOut=matcher?
postFinder||(seed?preFilter:preexisting||postFilter)?
[]:
results:
matcherIn;
if(matcher){
matcher(matcherIn,matcherOut,context,xml);
}
if(postFilter){
temp=condense(matcherOut,postMap);
postFilter(temp,[],context,xml);
i=temp.length;
while(i--){
if((elem=temp[i])){
matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem);
}
}
}
if(seed){
if(postFinder||preFilter){
if(postFinder){
temp=[];
i=matcherOut.length;
while(i--){
if((elem=matcherOut[i])){
temp.push((matcherIn[i]=elem));
}
}
postFinder(null,(matcherOut=[]),temp,xml);
}
i=matcherOut.length;
while(i--){
if((elem=matcherOut[i])&&
(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){
seed[temp]=!(results[temp]=elem);
}
}
}
}else{
matcherOut=condense(
matcherOut===results?
matcherOut.splice(preexisting,matcherOut.length):
matcherOut
);
if(postFinder){
postFinder(null,results,matcherOut,xml);
}else{
push.apply(results,matcherOut);
}
}
});
}
function matcherFromTokens(tokens){
var checkContext,matcher,j,
len=tokens.length,
leadingRelative=Expr.relative[tokens[0].type],
implicitRelative=leadingRelative||Expr.relative[" "],
i=leadingRelative?1:0,
matchContext=addCombinator(function(elem){
return elem===checkContext;
},implicitRelative,true),
matchAnyContext=addCombinator(function(elem){
return indexOf.call(checkContext,elem)>-1;
},implicitRelative,true),
matchers=[function(elem,context,xml){
return(!leadingRelative&&(xml||context!==outermostContext))||(
(checkContext=context).nodeType?
matchContext(elem,context,xml):
matchAnyContext(elem,context,xml));
}];
for(;i<len;i++){
if((matcher=Expr.relative[tokens[i].type])){
matchers=[addCombinator(elementMatcher(matchers),matcher)];
}else{
matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);
if(matcher[expando]){
j=++i;
for(;j<len;j++){
if(Expr.relative[tokens[j].type]){
break;
}
}
return setMatcher(
i>1&&elementMatcher(matchers),
i>1&&toSelector(tokens.slice(0,i-1)).replace(rtrim,"$1"),
matcher,
i<j&&matcherFromTokens(tokens.slice(i,j)),
j<len&&matcherFromTokens((tokens=tokens.slice(j))),
j<len&&toSelector(tokens)
);
}
matchers.push(matcher);
}
}
return elementMatcher(matchers);
}
function matcherFromGroupMatchers(elementMatchers,setMatchers){
var matcherCachedRuns=0,
bySet=setMatchers.length>0,
byElement=elementMatchers.length>0,
superMatcher=function(seed,context,xml,results,expandContext){
var elem,j,matcher,
setMatched=[],
matchedCount=0,
i="0",
unmatched=seed&&[],
outermost=expandContext!=null,
contextBackup=outermostContext,
elems=seed||byElement&&Expr.find["TAG"]("*",expandContext&&context.parentNode||context),
dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1);
if(outermost){
outermostContext=context!==document&&context;
cachedruns=matcherCachedRuns;
}
for(;(elem=elems[i])!=null;i++){
if(byElement&&elem){
j=0;
while((matcher=elementMatchers[j++])){
if(matcher(elem,context,xml)){
results.push(elem);
break;
}
}
if(outermost){
dirruns=dirrunsUnique;
cachedruns=++matcherCachedRuns;
}
}
if(bySet){
if((elem=!matcher&&elem)){
matchedCount--;
}
if(seed){
unmatched.push(elem);
}
}
}
matchedCount+=i;
if(bySet&&i!==matchedCount){
j=0;
while((matcher=setMatchers[j++])){
matcher(unmatched,setMatched,context,xml);
}
if(seed){
if(matchedCount>0){
while(i--){
if(!(unmatched[i]||setMatched[i])){
setMatched[i]=pop.call(results);
}
}
}
setMatched=condense(setMatched);
}
push.apply(results,setMatched);
if(outermost&&!seed&&setMatched.length>0&&
(matchedCount+setMatchers.length)>1){
Sizzle.uniqueSort(results);
}
}
if(outermost){
dirruns=dirrunsUnique;
outermostContext=contextBackup;
}
return unmatched;
};
return bySet?
markFunction(superMatcher):
superMatcher;
}
compile=Sizzle.compile=function(selector,group){
var i,
setMatchers=[],
elementMatchers=[],
cached=compilerCache[selector+" "];
if(!cached){
if(!group){
group=tokenize(selector);
}
i=group.length;
while(i--){
cached=matcherFromTokens(group[i]);
if(cached[expando]){
setMatchers.push(cached);
}else{
elementMatchers.push(cached);
}
}
cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));
}
return cached;
};
function multipleContexts(selector,contexts,results){
var i=0,
len=contexts.length;
for(;i<len;i++){
Sizzle(selector,contexts[i],results);
}
return results;
}
function select(selector,context,results,seed){
var i,tokens,token,type,find,
match=tokenize(selector);
if(!seed){
if(match.length===1){
tokens=match[0]=match[0].slice(0);
if(tokens.length>2&&(token=tokens[0]).type==="ID"&&
context.nodeType===9&&!documentIsXML&&
Expr.relative[tokens[1].type]){
context=Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)[0];
if(!context){
return results;
}
selector=selector.slice(tokens.shift().value.length);
}
i=matchExpr["needsContext"].test(selector)?0:tokens.length;
while(i--){
token=tokens[i];
if(Expr.relative[(type=token.type)]){
break;
}
if((find=Expr.find[type])){
if((seed=find(
token.matches[0].replace(runescape,funescape),
rsibling.test(tokens[0].type)&&context.parentNode||context
))){
tokens.splice(i,1);
selector=seed.length&&toSelector(tokens);
if(!selector){
push.apply(results,slice.call(seed,0));
return results;
}
break;
}
}
}
}
}
compile(selector,match)(
seed,
context,
documentIsXML,
results,
rsibling.test(selector)
);
return results;
}
Expr.pseudos["nth"]=Expr.pseudos["eq"];
function setFilters(){}
Expr.filters=setFilters.prototype=Expr.pseudos;
Expr.setFilters=new setFilters();
setDocument();
Sizzle.attr=jQuery.attr;
jQuery.find=Sizzle;
jQuery.expr=Sizzle.selectors;
jQuery.expr[":"]=jQuery.expr.pseudos;
jQuery.unique=Sizzle.uniqueSort;
jQuery.text=Sizzle.getText;
jQuery.isXMLDoc=Sizzle.isXML;
jQuery.contains=Sizzle.contains;
})(window);
var runtil=/Until$/,
rparentsprev=/^(?:parents|prev(?:Until|All))/,
isSimple=/^.[^:#\[\.,]*$/,
rneedsContext=jQuery.expr.match.needsContext,
guaranteedUnique={
children:true,
contents:true,
next:true,
prev:true
};
jQuery.fn.extend({
find:function(selector){
var i,ret,self,
len=this.length;
if(typeof selector!=="string"){
self=this;
return this.pushStack(jQuery(selector).filter(function(){
for(i=0;i<len;i++){
if(jQuery.contains(self[i],this)){
return true;
}
}
}));
}
ret=[];
for(i=0;i<len;i++){
jQuery.find(selector,this[i],ret);
}
ret=this.pushStack(len>1?jQuery.unique(ret):ret);
ret.selector=(this.selector?this.selector+" ":"")+selector;
return ret;
},
has:function(target){
var i,
targets=jQuery(target,this),
len=targets.length;
return this.filter(function(){
for(i=0;i<len;i++){
if(jQuery.contains(this,targets[i])){
return true;
}
}
});
},
not:function(selector){
return this.pushStack(winnow(this,selector,false));
},
filter:function(selector){
return this.pushStack(winnow(this,selector,true));
},
is:function(selector){
return!!selector&&(
typeof selector==="string"?
rneedsContext.test(selector)?
jQuery(selector,this.context).index(this[0])>=0:
jQuery.filter(selector,this).length>0:
this.filter(selector).length>0);
},
closest:function(selectors,context){
var cur,
i=0,
l=this.length,
ret=[],
pos=rneedsContext.test(selectors)||typeof selectors!=="string"?
jQuery(selectors,context||this.context):
0;
for(;i<l;i++){
cur=this[i];
while(cur&&cur.ownerDocument&&cur!==context&&cur.nodeType!==11){
if(pos?pos.index(cur)>-1:jQuery.find.matchesSelector(cur,selectors)){
ret.push(cur);
break;
}
cur=cur.parentNode;
}
}
return this.pushStack(ret.length>1?jQuery.unique(ret):ret);
},
index:function(elem){
if(!elem){
return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1;
}
if(typeof elem==="string"){
return jQuery.inArray(this[0],jQuery(elem));
}
return jQuery.inArray(
elem.jquery?elem[0]:elem,this);
},
add:function(selector,context){
var set=typeof selector==="string"?
jQuery(selector,context):
jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),
all=jQuery.merge(this.get(),set);
return this.pushStack(jQuery.unique(all));
},
addBack:function(selector){
return this.add(selector==null?
this.prevObject:this.prevObject.filter(selector)
);
}
});
jQuery.fn.andSelf=jQuery.fn.addBack;
function sibling(cur,dir){
do{
cur=cur[dir];
}while(cur&&cur.nodeType!==1);
return cur;
}
jQuery.each({
parent:function(elem){
var parent=elem.parentNode;
return parent&&parent.nodeType!==11?parent:null;
},
parents:function(elem){
return jQuery.dir(elem,"parentNode");
},
parentsUntil:function(elem,i,until){
return jQuery.dir(elem,"parentNode",until);
},
next:function(elem){
return sibling(elem,"nextSibling");
},
prev:function(elem){
return sibling(elem,"previousSibling");
},
nextAll:function(elem){
return jQuery.dir(elem,"nextSibling");
},
prevAll:function(elem){
return jQuery.dir(elem,"previousSibling");
},
nextUntil:function(elem,i,until){
return jQuery.dir(elem,"nextSibling",until);
},
prevUntil:function(elem,i,until){
return jQuery.dir(elem,"previousSibling",until);
},
siblings:function(elem){
return jQuery.sibling((elem.parentNode||{}).firstChild,elem);
},
children:function(elem){
return jQuery.sibling(elem.firstChild);
},
contents:function(elem){
return jQuery.nodeName(elem,"iframe")?
elem.contentDocument||elem.contentWindow.document:
jQuery.merge([],elem.childNodes);
}
},function(name,fn){
jQuery.fn[name]=function(until,selector){
var ret=jQuery.map(this,fn,until);
if(!runtil.test(name)){
selector=until;
}
if(selector&&typeof selector==="string"){
ret=jQuery.filter(selector,ret);
}
ret=this.length>1&&!guaranteedUnique[name]?jQuery.unique(ret):ret;
if(this.length>1&&rparentsprev.test(name)){
ret=ret.reverse();
}
return this.pushStack(ret);
};
});
jQuery.extend({
filter:function(expr,elems,not){
if(not){
expr=":not("+expr+")";
}
return elems.length===1?
jQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:
jQuery.find.matches(expr,elems);
},
dir:function(elem,dir,until){
var matched=[],
cur=elem[dir];
while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){
if(cur.nodeType===1){
matched.push(cur);
}
cur=cur[dir];
}
return matched;
},
sibling:function(n,elem){
var r=[];
for(;n;n=n.nextSibling){
if(n.nodeType===1&&n!==elem){
r.push(n);
}
}
return r;
}
});
function winnow(elements,qualifier,keep){
qualifier=qualifier||0;
if(jQuery.isFunction(qualifier)){
return jQuery.grep(elements,function(elem,i){
var retVal=!!qualifier.call(elem,i,elem);
return retVal===keep;
});
}else if(qualifier.nodeType){
return jQuery.grep(elements,function(elem){
return(elem===qualifier)===keep;
});
}else if(typeof qualifier==="string"){
var filtered=jQuery.grep(elements,function(elem){
return elem.nodeType===1;
});
if(isSimple.test(qualifier)){
return jQuery.filter(qualifier,filtered,!keep);
}else{
qualifier=jQuery.filter(qualifier,filtered);
}
}
return jQuery.grep(elements,function(elem){
return(jQuery.inArray(elem,qualifier)>=0)===keep;
});
}
function createSafeFragment(document){
var list=nodeNames.split("|"),
safeFrag=document.createDocumentFragment();
if(safeFrag.createElement){
while(list.length){
safeFrag.createElement(
list.pop()
);
}
}
return safeFrag;
}
var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+
"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,
rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),
rleadingWhitespace=/^\s+/,
rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
rtagName=/<([\w:]+)/,
rtbody=/<tbody/i,
rhtml=/<|&#?\w+;/,
rnoInnerhtml=/<(?:script|style|link)/i,
manipulation_rcheckableType=/^(?:checkbox|radio)$/i,
rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,
rscriptType=/^$|\/(?:java|ecma)script/i,
rscriptTypeMasked=/^true\/(.*)/,
rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
wrapMap={
option:[1,"<select multiple='multiple'>","</select>"],
legend:[1,"<fieldset>","</fieldset>"],
area:[1,"<map>","</map>"],
param:[1,"<object>","</object>"],
thead:[1,"<table>","</table>"],
tr:[2,"<table><tbody>","</tbody></table>"],
col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],
td:[3,"<table><tbody><tr>","</tr></tbody></table>"],
_default:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]
},
safeFragment=createSafeFragment(document),
fragmentDiv=safeFragment.appendChild(document.createElement("div"));
wrapMap.optgroup=wrapMap.option;
wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;
wrapMap.th=wrapMap.td;
jQuery.fn.extend({
text:function(value){
return jQuery.access(this,function(value){
return value===undefined?
jQuery.text(this):
this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value));
},null,value,arguments.length);
},
wrapAll:function(html){
if(jQuery.isFunction(html)){
return this.each(function(i){
jQuery(this).wrapAll(html.call(this,i));
});
}
if(this[0]){
var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);
if(this[0].parentNode){
wrap.insertBefore(this[0]);
}
wrap.map(function(){
var elem=this;
while(elem.firstChild&&elem.firstChild.nodeType===1){
elem=elem.firstChild;
}
return elem;
}).append(this);
}
return this;
},
wrapInner:function(html){
if(jQuery.isFunction(html)){
return this.each(function(i){
jQuery(this).wrapInner(html.call(this,i));
});
}
return this.each(function(){
var self=jQuery(this),
contents=self.contents();
if(contents.length){
contents.wrapAll(html);
}else{
self.append(html);
}
});
},
wrap:function(html){
var isFunction=jQuery.isFunction(html);
return this.each(function(i){
jQuery(this).wrapAll(isFunction?html.call(this,i):html);
});
},
unwrap:function(){
return this.parent().each(function(){
if(!jQuery.nodeName(this,"body")){
jQuery(this).replaceWith(this.childNodes);
}
}).end();
},
append:function(){
return this.domManip(arguments,true,function(elem){
if(this.nodeType===1||this.nodeType===11||this.nodeType===9){
this.appendChild(elem);
}
});
},
prepend:function(){
return this.domManip(arguments,true,function(elem){
if(this.nodeType===1||this.nodeType===11||this.nodeType===9){
this.insertBefore(elem,this.firstChild);
}
});
},
before:function(){
return this.domManip(arguments,false,function(elem){
if(this.parentNode){
this.parentNode.insertBefore(elem,this);
}
});
},
after:function(){
return this.domManip(arguments,false,function(elem){
if(this.parentNode){
this.parentNode.insertBefore(elem,this.nextSibling);
}
});
},
remove:function(selector,keepData){
var elem,
i=0;
for(;(elem=this[i])!=null;i++){
if(!selector||jQuery.filter(selector,[elem]).length>0){
if(!keepData&&elem.nodeType===1){
jQuery.cleanData(getAll(elem));
}
if(elem.parentNode){
if(keepData&&jQuery.contains(elem.ownerDocument,elem)){
setGlobalEval(getAll(elem,"script"));
}
elem.parentNode.removeChild(elem);
}
}
}
return this;
},
empty:function(){
var elem,
i=0;
for(;(elem=this[i])!=null;i++){
if(elem.nodeType===1){
jQuery.cleanData(getAll(elem,false));
}
while(elem.firstChild){
elem.removeChild(elem.firstChild);
}
if(elem.options&&jQuery.nodeName(elem,"select")){
elem.options.length=0;
}
}
return this;
},
clone:function(dataAndEvents,deepDataAndEvents){
dataAndEvents=dataAndEvents==null?false:dataAndEvents;
deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;
return this.map(function(){
return jQuery.clone(this,dataAndEvents,deepDataAndEvents);
});
},
html:function(value){
return jQuery.access(this,function(value){
var elem=this[0]||{},
i=0,
l=this.length;
if(value===undefined){
return elem.nodeType===1?
elem.innerHTML.replace(rinlinejQuery,""):
undefined;
}
if(typeof value==="string"&&!rnoInnerhtml.test(value)&&
(jQuery.support.htmlSerialize||!rnoshimcache.test(value))&&
(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&
!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){
value=value.replace(rxhtmlTag,"<$1></$2>");
try{
for(;i<l;i++){
elem=this[i]||{};
if(elem.nodeType===1){
jQuery.cleanData(getAll(elem,false));
elem.innerHTML=value;
}
}
elem=0;
}catch(e){}
}
if(elem){
this.empty().append(value);
}
},null,value,arguments.length);
},
replaceWith:function(value){
var isFunc=jQuery.isFunction(value);
if(!isFunc&&typeof value!=="string"){
value=jQuery(value).not(this).detach();
}
return this.domManip([value],true,function(elem){
var next=this.nextSibling,
parent=this.parentNode;
if(parent){
jQuery(this).remove();
parent.insertBefore(elem,next);
}
});
},
detach:function(selector){
return this.remove(selector,true);
},
domManip:function(args,table,callback){
args=core_concat.apply([],args);
var first,node,hasScripts,
scripts,doc,fragment,
i=0,
l=this.length,
set=this,
iNoClone=l-1,
value=args[0],
isFunction=jQuery.isFunction(value);
if(isFunction||!(l<=1||typeof value!=="string"||jQuery.support.checkClone||!rchecked.test(value))){
return this.each(function(index){
var self=set.eq(index);
if(isFunction){
args[0]=value.call(this,index,table?self.html():undefined);
}
self.domManip(args,table,callback);
});
}
if(l){
fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,this);
first=fragment.firstChild;
if(fragment.childNodes.length===1){
fragment=first;
}
if(first){
table=table&&jQuery.nodeName(first,"tr");
scripts=jQuery.map(getAll(fragment,"script"),disableScript);
hasScripts=scripts.length;
for(;i<l;i++){
node=fragment;
if(i!==iNoClone){
node=jQuery.clone(node,true,true);
if(hasScripts){
jQuery.merge(scripts,getAll(node,"script"));
}
}
callback.call(
table&&jQuery.nodeName(this[i],"table")?
findOrAppend(this[i],"tbody"):
this[i],
node,
i
);
}
if(hasScripts){
doc=scripts[scripts.length-1].ownerDocument;
jQuery.map(scripts,restoreScript);
for(i=0;i<hasScripts;i++){
node=scripts[i];
if(rscriptType.test(node.type||"")&&
!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)){
if(node.src){
jQuery.ajax({
url:node.src,
type:"GET",
dataType:"script",
async:false,
global:false,
"throws":true
});
}else{
jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,""));
}
}
}
}
fragment=first=null;
}
}
return this;
}
});
function findOrAppend(elem,tag){
return elem.getElementsByTagName(tag)[0]||elem.appendChild(elem.ownerDocument.createElement(tag));
}
function disableScript(elem){
var attr=elem.getAttributeNode("type");
elem.type=(attr&&attr.specified)+"/"+elem.type;
return elem;
}
function restoreScript(elem){
var match=rscriptTypeMasked.exec(elem.type);
if(match){
elem.type=match[1];
}else{
elem.removeAttribute("type");
}
return elem;
}
function setGlobalEval(elems,refElements){
var elem,
i=0;
for(;(elem=elems[i])!=null;i++){
jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"));
}
}
function cloneCopyEvent(src,dest){
if(dest.nodeType!==1||!jQuery.hasData(src)){
return;
}
var type,i,l,
oldData=jQuery._data(src),
curData=jQuery._data(dest,oldData),
events=oldData.events;
if(events){
delete curData.handle;
curData.events={};
for(type in events){
for(i=0,l=events[type].length;i<l;i++){
jQuery.event.add(dest,type,events[type][i]);
}
}
}
if(curData.data){
curData.data=jQuery.extend({},curData.data);
}
}
function fixCloneNodeIssues(src,dest){
var nodeName,e,data;
if(dest.nodeType!==1){
return;
}
nodeName=dest.nodeName.toLowerCase();
if(!jQuery.support.noCloneEvent&&dest[jQuery.expando]){
data=jQuery._data(dest);
for(e in data.events){
jQuery.removeEvent(dest,e,data.handle);
}
dest.removeAttribute(jQuery.expando);
}
if(nodeName==="script"&&dest.text!==src.text){
disableScript(dest).text=src.text;
restoreScript(dest);
}else if(nodeName==="object"){
if(dest.parentNode){
dest.outerHTML=src.outerHTML;
}
if(jQuery.support.html5Clone&&(src.innerHTML&&!jQuery.trim(dest.innerHTML))){
dest.innerHTML=src.innerHTML;
}
}else if(nodeName==="input"&&manipulation_rcheckableType.test(src.type)){
dest.defaultChecked=dest.checked=src.checked;
if(dest.value!==src.value){
dest.value=src.value;
}
}else if(nodeName==="option"){
dest.defaultSelected=dest.selected=src.defaultSelected;
}else if(nodeName==="input"||nodeName==="textarea"){
dest.defaultValue=src.defaultValue;
}
}
jQuery.each({
appendTo:"append",
prependTo:"prepend",
insertBefore:"before",
insertAfter:"after",
replaceAll:"replaceWith"
},function(name,original){
jQuery.fn[name]=function(selector){
var elems,
i=0,
ret=[],
insert=jQuery(selector),
last=insert.length-1;
for(;i<=last;i++){
elems=i===last?this:this.clone(true);
jQuery(insert[i])[original](elems);
core_push.apply(ret,elems.get());
}
return this.pushStack(ret);
};
});
function getAll(context,tag){
var elems,elem,
i=0,
found=typeof context.getElementsByTagName!==core_strundefined?context.getElementsByTagName(tag||"*"):
typeof context.querySelectorAll!==core_strundefined?context.querySelectorAll(tag||"*"):
undefined;
if(!found){
for(found=[],elems=context.childNodes||context;(elem=elems[i])!=null;i++){
if(!tag||jQuery.nodeName(elem,tag)){
found.push(elem);
}else{
jQuery.merge(found,getAll(elem,tag));
}
}
}
return tag===undefined||tag&&jQuery.nodeName(context,tag)?
jQuery.merge([context],found):
found;
}
function fixDefaultChecked(elem){
if(manipulation_rcheckableType.test(elem.type)){
elem.defaultChecked=elem.checked;
}
}
jQuery.extend({
clone:function(elem,dataAndEvents,deepDataAndEvents){
var destElements,node,clone,i,srcElements,
inPage=jQuery.contains(elem.ownerDocument,elem);
if(jQuery.support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){
clone=elem.cloneNode(true);
}else{
fragmentDiv.innerHTML=elem.outerHTML;
fragmentDiv.removeChild(clone=fragmentDiv.firstChild);
}
if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&
(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){
destElements=getAll(clone);
srcElements=getAll(elem);
for(i=0;(node=srcElements[i])!=null;++i){
if(destElements[i]){
fixCloneNodeIssues(node,destElements[i]);
}
}
}
if(dataAndEvents){
if(deepDataAndEvents){
srcElements=srcElements||getAll(elem);
destElements=destElements||getAll(clone);
for(i=0;(node=srcElements[i])!=null;i++){
cloneCopyEvent(node,destElements[i]);
}
}else{
cloneCopyEvent(elem,clone);
}
}
destElements=getAll(clone,"script");
if(destElements.length>0){
setGlobalEval(destElements,!inPage&&getAll(elem,"script"));
}
destElements=srcElements=node=null;
return clone;
},
buildFragment:function(elems,context,scripts,selection){
var j,elem,contains,
tmp,tag,tbody,wrap,
l=elems.length,
safe=createSafeFragment(context),
nodes=[],
i=0;
for(;i<l;i++){
elem=elems[i];
if(elem||elem===0){
if(jQuery.type(elem)==="object"){
jQuery.merge(nodes,elem.nodeType?[elem]:elem);
}else if(!rhtml.test(elem)){
nodes.push(context.createTextNode(elem));
}else{
tmp=tmp||safe.appendChild(context.createElement("div"));
tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();
wrap=wrapMap[tag]||wrapMap._default;
tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];
j=wrap[0];
while(j--){
tmp=tmp.lastChild;
}
if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)){
nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0]));
}
if(!jQuery.support.tbody){
elem=tag==="table"&&!rtbody.test(elem)?
tmp.firstChild:
wrap[1]==="<table>"&&!rtbody.test(elem)?
tmp:
0;
j=elem&&elem.childNodes.length;
while(j--){
if(jQuery.nodeName((tbody=elem.childNodes[j]),"tbody")&&!tbody.childNodes.length){
elem.removeChild(tbody);
}
}
}
jQuery.merge(nodes,tmp.childNodes);
tmp.textContent="";
while(tmp.firstChild){
tmp.removeChild(tmp.firstChild);
}
tmp=safe.lastChild;
}
}
}
if(tmp){
safe.removeChild(tmp);
}
if(!jQuery.support.appendChecked){
jQuery.grep(getAll(nodes,"input"),fixDefaultChecked);
}
i=0;
while((elem=nodes[i++])){
if(selection&&jQuery.inArray(elem,selection)!==-1){
continue;
}
contains=jQuery.contains(elem.ownerDocument,elem);
tmp=getAll(safe.appendChild(elem),"script");
if(contains){
setGlobalEval(tmp);
}
if(scripts){
j=0;
while((elem=tmp[j++])){
if(rscriptType.test(elem.type||"")){
scripts.push(elem);
}
}
}
}
tmp=null;
return safe;
},
cleanData:function(elems,acceptData){
var elem,type,id,data,
i=0,
internalKey=jQuery.expando,
cache=jQuery.cache,
deleteExpando=jQuery.support.deleteExpando,
special=jQuery.event.special;
for(;(elem=elems[i])!=null;i++){
if(acceptData||jQuery.acceptData(elem)){
id=elem[internalKey];
data=id&&cache[id];
if(data){
if(data.events){
for(type in data.events){
if(special[type]){
jQuery.event.remove(elem,type);
}else{
jQuery.removeEvent(elem,type,data.handle);
}
}
}
if(cache[id]){
delete cache[id];
if(deleteExpando){
delete elem[internalKey];
}else if(typeof elem.removeAttribute!==core_strundefined){
elem.removeAttribute(internalKey);
}else{
elem[internalKey]=null;
}
core_deletedIds.push(id);
}
}
}
}
}
});
var iframe,getStyles,curCSS,
ralpha=/alpha\([^)]*\)/i,
ropacity=/opacity\s*=\s*([^)]*)/,
rposition=/^(top|right|bottom|left)$/,
rdisplayswap=/^(none|table(?!-c[ea]).+)/,
rmargin=/^margin/,
rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),
rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),
rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),
elemdisplay={BODY:"block"},
cssShow={position:"absolute",visibility:"hidden",display:"block"},
cssNormalTransform={
letterSpacing:0,
fontWeight:400
},
cssExpand=["Top","Right","Bottom","Left"],
cssPrefixes=["Webkit","O","Moz","ms"];
function vendorPropName(style,name){
if(name in style){
return name;
}
var capName=name.charAt(0).toUpperCase()+name.slice(1),
origName=name,
i=cssPrefixes.length;
while(i--){
name=cssPrefixes[i]+capName;
if(name in style){
return name;
}
}
return origName;
}
function isHidden(elem,el){
elem=el||elem;
return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem);
}
function showHide(elements,show){
var display,elem,hidden,
values=[],
index=0,
length=elements.length;
for(;index<length;index++){
elem=elements[index];
if(!elem.style){
continue;
}
values[index]=jQuery._data(elem,"olddisplay");
display=elem.style.display;
if(show){
if(!values[index]&&display==="none"){
elem.style.display="";
}
if(elem.style.display===""&&isHidden(elem)){
values[index]=jQuery._data(elem,"olddisplay",css_defaultDisplay(elem.nodeName));
}
}else{
if(!values[index]){
hidden=isHidden(elem);
if(display&&display!=="none"||!hidden){
jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"));
}
}
}
}
for(index=0;index<length;index++){
elem=elements[index];
if(!elem.style){
continue;
}
if(!show||elem.style.display==="none"||elem.style.display===""){
elem.style.display=show?values[index]||"":"none";
}
}
return elements;
}
jQuery.fn.extend({
css:function(name,value){
return jQuery.access(this,function(elem,name,value){
var len,styles,
map={},
i=0;
if(jQuery.isArray(name)){
styles=getStyles(elem);
len=name.length;
for(;i<len;i++){
map[name[i]]=jQuery.css(elem,name[i],false,styles);
}
return map;
}
return value!==undefined?
jQuery.style(elem,name,value):
jQuery.css(elem,name);
},name,value,arguments.length>1);
},
show:function(){
return showHide(this,true);
},
hide:function(){
return showHide(this);
},
toggle:function(state){
var bool=typeof state==="boolean";
return this.each(function(){
if(bool?state:isHidden(this)){
jQuery(this).show();
}else{
jQuery(this).hide();
}
});
}
});
jQuery.extend({
cssHooks:{
opacity:{
get:function(elem,computed){
if(computed){
var ret=curCSS(elem,"opacity");
return ret===""?"1":ret;
}
}
}
},
cssNumber:{
"columnCount":true,
"fillOpacity":true,
"fontWeight":true,
"lineHeight":true,
"opacity":true,
"orphans":true,
"widows":true,
"zIndex":true,
"zoom":true
},
cssProps:{
"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"
},
style:function(elem,name,value,extra){
if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){
return;
}
var ret,type,hooks,
origName=jQuery.camelCase(name),
style=elem.style;
name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));
hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];
if(value!==undefined){
type=typeof value;
if(type==="string"&&(ret=rrelNum.exec(value))){
value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));
type="number";
}
if(value==null||type==="number"&&isNaN(value)){
return;
}
if(type==="number"&&!jQuery.cssNumber[origName]){
value+="px";
}
if(!jQuery.support.clearCloneStyle&&value===""&&name.indexOf("background")===0){
style[name]="inherit";
}
if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){
try{
style[name]=value;
}catch(e){}
}
}else{
if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){
return ret;
}
return style[name];
}
},
css:function(elem,name,extra,styles){
var num,val,hooks,
origName=jQuery.camelCase(name);
name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));
hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];
if(hooks&&"get"in hooks){
val=hooks.get(elem,true,extra);
}
if(val===undefined){
val=curCSS(elem,name,styles);
}
if(val==="normal"&&name in cssNormalTransform){
val=cssNormalTransform[name];
}
if(extra===""||extra){
num=parseFloat(val);
return extra===true||jQuery.isNumeric(num)?num||0:val;
}
return val;
},
swap:function(elem,options,callback,args){
var ret,name,
old={};
for(name in options){
old[name]=elem.style[name];
elem.style[name]=options[name];
}
ret=callback.apply(elem,args||[]);
for(name in options){
elem.style[name]=old[name];
}
return ret;
}
});
if(window.getComputedStyle){
getStyles=function(elem){
return window.getComputedStyle(elem,null);
};
curCSS=function(elem,name,_computed){
var width,minWidth,maxWidth,
computed=_computed||getStyles(elem),
ret=computed?computed.getPropertyValue(name)||computed[name]:undefined,
style=elem.style;
if(computed){
if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){
ret=jQuery.style(elem,name);
}
if(rnumnonpx.test(ret)&&rmargin.test(name)){
width=style.width;
minWidth=style.minWidth;
maxWidth=style.maxWidth;
style.minWidth=style.maxWidth=style.width=ret;
ret=computed.width;
style.width=width;
style.minWidth=minWidth;
style.maxWidth=maxWidth;
}
}
return ret;
};
}else if(document.documentElement.currentStyle){
getStyles=function(elem){
return elem.currentStyle;
};
curCSS=function(elem,name,_computed){
var left,rs,rsLeft,
computed=_computed||getStyles(elem),
ret=computed?computed[name]:undefined,
style=elem.style;
if(ret==null&&style&&style[name]){
ret=style[name];
}
if(rnumnonpx.test(ret)&&!rposition.test(name)){
left=style.left;
rs=elem.runtimeStyle;
rsLeft=rs&&rs.left;
if(rsLeft){
rs.left=elem.currentStyle.left;
}
style.left=name==="fontSize"?"1em":ret;
ret=style.pixelLeft+"px";
style.left=left;
if(rsLeft){
rs.left=rsLeft;
}
}
return ret===""?"auto":ret;
};
}
function setPositiveNumber(elem,value,subtract){
var matches=rnumsplit.exec(value);
return matches?
Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):
value;
}
function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){
var i=extra===(isBorderBox?"border":"content")?
4:
name==="width"?1:0,
val=0;
for(;i<4;i+=2){
if(extra==="margin"){
val+=jQuery.css(elem,extra+cssExpand[i],true,styles);
}
if(isBorderBox){
if(extra==="content"){
val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles);
}
if(extra!=="margin"){
val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);
}
}else{
val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);
if(extra!=="padding"){
val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);
}
}
}
return val;
}
function getWidthOrHeight(elem,name,extra){
var valueIsBorderBox=true,
val=name==="width"?elem.offsetWidth:elem.offsetHeight,
styles=getStyles(elem),
isBorderBox=jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box";
if(val<=0||val==null){
val=curCSS(elem,name,styles);
if(val<0||val==null){
val=elem.style[name];
}
if(rnumnonpx.test(val)){
return val;
}
valueIsBorderBox=isBorderBox&&(jQuery.support.boxSizingReliable||val===elem.style[name]);
val=parseFloat(val)||0;
}
return(val+
augmentWidthOrHeight(
elem,
name,
extra||(isBorderBox?"border":"content"),
valueIsBorderBox,
styles
)
)+"px";
}
function css_defaultDisplay(nodeName){
var doc=document,
display=elemdisplay[nodeName];
if(!display){
display=actualDisplay(nodeName,doc);
if(display==="none"||!display){
iframe=(iframe||
jQuery("<iframe frameborder='0' width='0' height='0'/>")
.css("cssText","display:block !important")
).appendTo(doc.documentElement);
doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;
doc.write("<!doctype html><html><body>");
doc.close();
display=actualDisplay(nodeName,doc);
iframe.detach();
}
elemdisplay[nodeName]=display;
}
return display;
}
function actualDisplay(name,doc){
var elem=jQuery(doc.createElement(name)).appendTo(doc.body),
display=jQuery.css(elem[0],"display");
elem.remove();
return display;
}
jQuery.each(["height","width"],function(i,name){
jQuery.cssHooks[name]={
get:function(elem,computed,extra){
if(computed){
return elem.offsetWidth===0&&rdisplayswap.test(jQuery.css(elem,"display"))?
jQuery.swap(elem,cssShow,function(){
return getWidthOrHeight(elem,name,extra);
}):
getWidthOrHeight(elem,name,extra);
}
},
set:function(elem,value,extra){
var styles=extra&&getStyles(elem);
return setPositiveNumber(elem,value,extra?
augmentWidthOrHeight(
elem,
name,
extra,
jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",
styles
):0
);
}
};
});
if(!jQuery.support.opacity){
jQuery.cssHooks.opacity={
get:function(elem,computed){
return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?
(0.01*parseFloat(RegExp.$1))+"":
computed?"1":"";
},
set:function(elem,value){
var style=elem.style,
currentStyle=elem.currentStyle,
opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",
filter=currentStyle&&currentStyle.filter||style.filter||"";
style.zoom=1;
if((value>=1||value==="")&&
jQuery.trim(filter.replace(ralpha,""))===""&&
style.removeAttribute){
style.removeAttribute("filter");
if(value===""||currentStyle&&!currentStyle.filter){
return;
}
}
style.filter=ralpha.test(filter)?
filter.replace(ralpha,opacity):
filter+" "+opacity;
}
};
}
jQuery(function(){
if(!jQuery.support.reliableMarginRight){
jQuery.cssHooks.marginRight={
get:function(elem,computed){
if(computed){
return jQuery.swap(elem,{"display":"inline-block"},
curCSS,[elem,"marginRight"]);
}
}
};
}
if(!jQuery.support.pixelPosition&&jQuery.fn.position){
jQuery.each(["top","left"],function(i,prop){
jQuery.cssHooks[prop]={
get:function(elem,computed){
if(computed){
computed=curCSS(elem,prop);
return rnumnonpx.test(computed)?
jQuery(elem).position()[prop]+"px":
computed;
}
}
};
});
}
});
if(jQuery.expr&&jQuery.expr.filters){
jQuery.expr.filters.hidden=function(elem){
return elem.offsetWidth<=0&&elem.offsetHeight<=0||
(!jQuery.support.reliableHiddenOffsets&&((elem.style&&elem.style.display)||jQuery.css(elem,"display"))==="none");
};
jQuery.expr.filters.visible=function(elem){
return!jQuery.expr.filters.hidden(elem);
};
}
jQuery.each({
margin:"",
padding:"",
border:"Width"
},function(prefix,suffix){
jQuery.cssHooks[prefix+suffix]={
expand:function(value){
var i=0,
expanded={},
parts=typeof value==="string"?value.split(" "):[value];
for(;i<4;i++){
expanded[prefix+cssExpand[i]+suffix]=
parts[i]||parts[i-2]||parts[0];
}
return expanded;
}
};
if(!rmargin.test(prefix)){
jQuery.cssHooks[prefix+suffix].set=setPositiveNumber;
}
});
var r20=/%20/g,
rbracket=/\[\]$/,
rCRLF=/\r?\n/g,
rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,
rsubmittable=/^(?:input|select|textarea|keygen)/i;
jQuery.fn.extend({
serialize:function(){
return jQuery.param(this.serializeArray());
},
serializeArray:function(){
return this.map(function(){
var elements=jQuery.prop(this,"elements");
return elements?jQuery.makeArray(elements):this;
})
.filter(function(){
var type=this.type;
return this.name&&!jQuery(this).is(":disabled")&&
rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&
(this.checked||!manipulation_rcheckableType.test(type));
})
.map(function(i,elem){
var val=jQuery(this).val();
return val==null?
null:
jQuery.isArray(val)?
jQuery.map(val,function(val){
return{name:elem.name,value:val.replace(rCRLF,"\r\n")};
}):
{name:elem.name,value:val.replace(rCRLF,"\r\n")};
}).get();
}
});
jQuery.param=function(a,traditional){
var prefix,
s=[],
add=function(key,value){
value=jQuery.isFunction(value)?value():(value==null?"":value);
s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value);
};
if(traditional===undefined){
traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional;
}
if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){
jQuery.each(a,function(){
add(this.name,this.value);
});
}else{
for(prefix in a){
buildParams(prefix,a[prefix],traditional,add);
}
}
return s.join("&").replace(r20,"+");
};
function buildParams(prefix,obj,traditional,add){
var name;
if(jQuery.isArray(obj)){
jQuery.each(obj,function(i,v){
if(traditional||rbracket.test(prefix)){
add(prefix,v);
}else{
buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add);
}
});
}else if(!traditional&&jQuery.type(obj)==="object"){
for(name in obj){
buildParams(prefix+"["+name+"]",obj[name],traditional,add);
}
}else{
add(prefix,obj);
}
}
jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+
"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+
"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){
jQuery.fn[name]=function(data,fn){
return arguments.length>0?
this.on(name,null,data,fn):
this.trigger(name);
};
});
jQuery.fn.hover=function(fnOver,fnOut){
return this.mouseenter(fnOver).mouseleave(fnOut||fnOver);
};
var
ajaxLocParts,
ajaxLocation,
ajax_nonce=jQuery.now(),
ajax_rquery=/\?/,
rhash=/#.*$/,
rts=/([?&])_=[^&]*/,
rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
rnoContent=/^(?:GET|HEAD)$/,
rprotocol=/^\/\//,
rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,
_load=jQuery.fn.load,

prefilters={},

transports={},
allTypes="*/".concat("*");
try{
ajaxLocation=location.href;
}catch(e){
ajaxLocation=document.createElement("a");
ajaxLocation.href="";
ajaxLocation=ajaxLocation.href;
}
ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];
function addToPrefiltersOrTransports(structure){
return function(dataTypeExpression,func){
if(typeof dataTypeExpression!=="string"){
func=dataTypeExpression;
dataTypeExpression="*";
}
var dataType,
i=0,
dataTypes=dataTypeExpression.toLowerCase().match(core_rnotwhite)||[];
if(jQuery.isFunction(func)){
while((dataType=dataTypes[i++])){
if(dataType[0]==="+"){
dataType=dataType.slice(1)||"*";
(structure[dataType]=structure[dataType]||[]).unshift(func);
}else{
(structure[dataType]=structure[dataType]||[]).push(func);
}
}
}
};
}
function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){
var inspected={},
seekingTransport=(structure===transports);
function inspect(dataType){
var selected;
inspected[dataType]=true;
jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){
var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);
if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){
options.dataTypes.unshift(dataTypeOrTransport);
inspect(dataTypeOrTransport);
return false;
}else if(seekingTransport){
return!(selected=dataTypeOrTransport);
}
});
return selected;
}
return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*");
}
function ajaxExtend(target,src){
var deep,key,
flatOptions=jQuery.ajaxSettings.flatOptions||{};
for(key in src){
if(src[key]!==undefined){
(flatOptions[key]?target:(deep||(deep={})))[key]=src[key];
}
}
if(deep){
jQuery.extend(true,target,deep);
}
return target;
}
jQuery.fn.load=function(url,params,callback){
if(typeof url!=="string"&&_load){
return _load.apply(this,arguments);
}
var selector,response,type,
self=this,
off=url.indexOf(" ");
if(off>=0){
selector=url.slice(off,url.length);
url=url.slice(0,off);
}
if(jQuery.isFunction(params)){
callback=params;
params=undefined;
}else if(params&&typeof params==="object"){
type="POST";
}
if(self.length>0){
jQuery.ajax({
url:url,
type:type,
dataType:"html",
data:params
}).done(function(responseText){
response=arguments;
self.html(selector?
jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):
responseText);
}).complete(callback&&function(jqXHR,status){
self.each(callback,response||[jqXHR.responseText,status,jqXHR]);
});
}
return this;
};
jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){
jQuery.fn[type]=function(fn){
return this.on(type,fn);
};
});
jQuery.each(["get","post"],function(i,method){
jQuery[method]=function(url,data,callback,type){
if(jQuery.isFunction(data)){
type=type||callback;
callback=data;
data=undefined;
}
return jQuery.ajax({
url:url,
type:method,
dataType:type,
data:data,
success:callback
});
};
});
jQuery.extend({
active:0,
lastModified:{},
etag:{},
ajaxSettings:{
url:ajaxLocation,
type:"GET",
isLocal:rlocalProtocol.test(ajaxLocParts[1]),
global:true,
processData:true,
async:true,
contentType:"application/x-www-form-urlencoded; charset=UTF-8",

accepts:{
"*":allTypes,
text:"text/plain",
html:"text/html",
xml:"application/xml, text/xml",
json:"application/json, text/javascript"
},
contents:{
xml:/xml/,
html:/html/,
json:/json/
},
responseFields:{
xml:"responseXML",
text:"responseText"
},
converters:{
"* text":window.String,
"text html":true,
"text json":jQuery.parseJSON,
"text xml":jQuery.parseXML
},
flatOptions:{
url:true,
context:true
}
},
ajaxSetup:function(target,settings){
return settings?
ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):
ajaxExtend(jQuery.ajaxSettings,target);
},
ajaxPrefilter:addToPrefiltersOrTransports(prefilters),
ajaxTransport:addToPrefiltersOrTransports(transports),
ajax:function(url,options){
if(typeof url==="object"){
options=url;
url=undefined;
}
options=options||{};
var parts,
i,
cacheURL,
responseHeadersString,
timeoutTimer,
fireGlobals,
transport,
responseHeaders,
s=jQuery.ajaxSetup({},options),
callbackContext=s.context||s,
globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?
jQuery(callbackContext):
jQuery.event,
deferred=jQuery.Deferred(),
completeDeferred=jQuery.Callbacks("once memory"),
statusCode=s.statusCode||{},
requestHeaders={},
requestHeadersNames={},
state=0,
strAbort="canceled",
jqXHR={
readyState:0,
getResponseHeader:function(key){
var match;
if(state===2){
if(!responseHeaders){
responseHeaders={};
while((match=rheaders.exec(responseHeadersString))){
responseHeaders[match[1].toLowerCase()]=match[2];
}
}
match=responseHeaders[key.toLowerCase()];
}
return match==null?null:match;
},
getAllResponseHeaders:function(){
return state===2?responseHeadersString:null;
},
setRequestHeader:function(name,value){
var lname=name.toLowerCase();
if(!state){
name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;
requestHeaders[name]=value;
}
return this;
},
overrideMimeType:function(type){
if(!state){
s.mimeType=type;
}
return this;
},
statusCode:function(map){
var code;
if(map){
if(state<2){
for(code in map){
statusCode[code]=[statusCode[code],map[code]];
}
}else{
jqXHR.always(map[jqXHR.status]);
}
}
return this;
},
abort:function(statusText){
var finalText=statusText||strAbort;
if(transport){
transport.abort(finalText);
}
done(0,finalText);
return this;
}
};
deferred.promise(jqXHR).complete=completeDeferred.add;
jqXHR.success=jqXHR.done;
jqXHR.error=jqXHR.fail;
s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");
s.type=options.method||options.type||s.method||s.type;
s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(core_rnotwhite)||[""];
if(s.crossDomain==null){
parts=rurl.exec(s.url.toLowerCase());
s.crossDomain=!!(parts&&
(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||
(parts[3]||(parts[1]==="http:"?80:443))!=
(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?80:443)))
);
}
if(s.data&&s.processData&&typeof s.data!=="string"){
s.data=jQuery.param(s.data,s.traditional);
}
inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);
if(state===2){
return jqXHR;
}
fireGlobals=s.global;
if(fireGlobals&&jQuery.active++===0){
jQuery.event.trigger("ajaxStart");
}
s.type=s.type.toUpperCase();
s.hasContent=!rnoContent.test(s.type);
cacheURL=s.url;
if(!s.hasContent){
if(s.data){
cacheURL=(s.url+=(ajax_rquery.test(cacheURL)?"&":"?")+s.data);
delete s.data;
}
if(s.cache===false){
s.url=rts.test(cacheURL)?
cacheURL.replace(rts,"$1_="+ajax_nonce++):
cacheURL+(ajax_rquery.test(cacheURL)?"&":"?")+"_="+ajax_nonce++;
}
}
if(s.ifModified){
if(jQuery.lastModified[cacheURL]){
jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]);
}
if(jQuery.etag[cacheURL]){
jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL]);
}
}
if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){
jqXHR.setRequestHeader("Content-Type",s.contentType);
}
jqXHR.setRequestHeader(
"Accept",
s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?
s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):
s.accepts["*"]
);
for(i in s.headers){
jqXHR.setRequestHeader(i,s.headers[i]);
}
if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){
return jqXHR.abort();
}
strAbort="abort";
for(i in{success:1,error:1,complete:1}){
jqXHR[i](s[i]);
}
transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);
if(!transport){
done(-1,"No Transport");
}else{
jqXHR.readyState=1;
if(fireGlobals){
globalEventContext.trigger("ajaxSend",[jqXHR,s]);
}
if(s.async&&s.timeout>0){
timeoutTimer=setTimeout(function(){
jqXHR.abort("timeout");
},s.timeout);
}
try{
state=1;
transport.send(requestHeaders,done);
}catch(e){
if(state<2){
done(-1,e);
}else{
throw e;
}
}
}
function done(status,nativeStatusText,responses,headers){
var isSuccess,success,error,response,modified,
statusText=nativeStatusText;
if(state===2){
return;
}
state=2;
if(timeoutTimer){
clearTimeout(timeoutTimer);
}
transport=undefined;
responseHeadersString=headers||"";
jqXHR.readyState=status>0?4:0;
if(responses){
response=ajaxHandleResponses(s,jqXHR,responses);
}
if(status>=200&&status<300||status===304){
if(s.ifModified){
modified=jqXHR.getResponseHeader("Last-Modified");
if(modified){
jQuery.lastModified[cacheURL]=modified;
}
modified=jqXHR.getResponseHeader("etag");
if(modified){
jQuery.etag[cacheURL]=modified;
}
}
if(status===204){
isSuccess=true;
statusText="nocontent";
}else if(status===304){
isSuccess=true;
statusText="notmodified";
}else{
isSuccess=ajaxConvert(s,response);
statusText=isSuccess.state;
success=isSuccess.data;
error=isSuccess.error;
isSuccess=!error;
}
}else{
error=statusText;
if(status||!statusText){
statusText="error";
if(status<0){
status=0;
}
}
}
jqXHR.status=status;
jqXHR.statusText=(nativeStatusText||statusText)+"";
if(isSuccess){
deferred.resolveWith(callbackContext,[success,statusText,jqXHR]);
}else{
deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);
}
jqXHR.statusCode(statusCode);
statusCode=undefined;
if(fireGlobals){
globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",
[jqXHR,s,isSuccess?success:error]);
}
completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);
if(fireGlobals){
globalEventContext.trigger("ajaxComplete",[jqXHR,s]);
if(!(--jQuery.active)){
jQuery.event.trigger("ajaxStop");
}
}
}
return jqXHR;
},
getScript:function(url,callback){
return jQuery.get(url,undefined,callback,"script");
},
getJSON:function(url,data,callback){
return jQuery.get(url,data,callback,"json");
}
});

function ajaxHandleResponses(s,jqXHR,responses){
var firstDataType,ct,finalDataType,type,
contents=s.contents,
dataTypes=s.dataTypes,
responseFields=s.responseFields;
for(type in responseFields){
if(type in responses){
jqXHR[responseFields[type]]=responses[type];
}
}
while(dataTypes[0]==="*"){
dataTypes.shift();
if(ct===undefined){
ct=s.mimeType||jqXHR.getResponseHeader("Content-Type");
}
}
if(ct){
for(type in contents){
if(contents[type]&&contents[type].test(ct)){
dataTypes.unshift(type);
break;
}
}
}
if(dataTypes[0]in responses){
finalDataType=dataTypes[0];
}else{
for(type in responses){
if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){
finalDataType=type;
break;
}
if(!firstDataType){
firstDataType=type;
}
}
finalDataType=finalDataType||firstDataType;
}
if(finalDataType){
if(finalDataType!==dataTypes[0]){
dataTypes.unshift(finalDataType);
}
return responses[finalDataType];
}
}
function ajaxConvert(s,response){
var conv2,current,conv,tmp,
converters={},
i=0,
dataTypes=s.dataTypes.slice(),
prev=dataTypes[0];
if(s.dataFilter){
response=s.dataFilter(response,s.dataType);
}
if(dataTypes[1]){
for(conv in s.converters){
converters[conv.toLowerCase()]=s.converters[conv];
}
}
for(;(current=dataTypes[++i]);){
if(current!=="*"){
if(prev!=="*"&&prev!==current){
conv=converters[prev+" "+current]||converters["* "+current];
if(!conv){
for(conv2 in converters){
tmp=conv2.split(" ");
if(tmp[1]===current){
conv=converters[prev+" "+tmp[0]]||
converters["* "+tmp[0]];
if(conv){
if(conv===true){
conv=converters[conv2];
}else if(converters[conv2]!==true){
current=tmp[0];
dataTypes.splice(i--,0,current);
}
break;
}
}
}
}
if(conv!==true){
if(conv&&s["throws"]){
response=conv(response);
}else{
try{
response=conv(response);
}catch(e){
return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current};
}
}
}
}
prev=current;
}
}
return{state:"success",data:response};
}
jQuery.ajaxSetup({
accepts:{
script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
},
contents:{
script:/(?:java|ecma)script/
},
converters:{
"text script":function(text){
jQuery.globalEval(text);
return text;
}
}
});
jQuery.ajaxPrefilter("script",function(s){
if(s.cache===undefined){
s.cache=false;
}
if(s.crossDomain){
s.type="GET";
s.global=false;
}
});
jQuery.ajaxTransport("script",function(s){
if(s.crossDomain){
var script,
head=document.head||jQuery("head")[0]||document.documentElement;
return{
send:function(_,callback){
script=document.createElement("script");
script.async=true;
if(s.scriptCharset){
script.charset=s.scriptCharset;
}
script.src=s.url;
script.onload=script.onreadystatechange=function(_,isAbort){
if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){
script.onload=script.onreadystatechange=null;
if(script.parentNode){
script.parentNode.removeChild(script);
}
script=null;
if(!isAbort){
callback(200,"success");
}
}
};
head.insertBefore(script,head.firstChild);
},
abort:function(){
if(script){
script.onload(undefined,true);
}
}
};
}
});
var oldCallbacks=[],
rjsonp=/(=)\?(?=&|$)|\?\?/;
jQuery.ajaxSetup({
jsonp:"callback",
jsonpCallback:function(){
var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(ajax_nonce++));
this[callback]=true;
return callback;
}
});
jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){
var callbackName,overwritten,responseContainer,
jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?
"url":
typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data"
);
if(jsonProp||s.dataTypes[0]==="jsonp"){
callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?
s.jsonpCallback():
s.jsonpCallback;
if(jsonProp){
s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName);
}else if(s.jsonp!==false){
s.url+=(ajax_rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName;
}
s.converters["script json"]=function(){
if(!responseContainer){
jQuery.error(callbackName+" was not called");
}
return responseContainer[0];
};
s.dataTypes[0]="json";
overwritten=window[callbackName];
window[callbackName]=function(){
responseContainer=arguments;
};
jqXHR.always(function(){
window[callbackName]=overwritten;
if(s[callbackName]){
s.jsonpCallback=originalSettings.jsonpCallback;
oldCallbacks.push(callbackName);
}
if(responseContainer&&jQuery.isFunction(overwritten)){
overwritten(responseContainer[0]);
}
responseContainer=overwritten=undefined;
});
return"script";
}
});
var xhrCallbacks,xhrSupported,
xhrId=0,
xhrOnUnloadAbort=window.ActiveXObject&&function(){
var key;
for(key in xhrCallbacks){
xhrCallbacks[key](undefined,true);
}
};
function createStandardXHR(){
try{
return new window.XMLHttpRequest();
}catch(e){}
}
function createActiveXHR(){
try{
return new window.ActiveXObject("Microsoft.XMLHTTP");
}catch(e){}
}
jQuery.ajaxSettings.xhr=window.ActiveXObject?

function(){
return!this.isLocal&&createStandardXHR()||createActiveXHR();
}:
createStandardXHR;
xhrSupported=jQuery.ajaxSettings.xhr();
jQuery.support.cors=!!xhrSupported&&("withCredentials"in xhrSupported);
xhrSupported=jQuery.support.ajax=!!xhrSupported;
if(xhrSupported){
jQuery.ajaxTransport(function(s){
if(!s.crossDomain||jQuery.support.cors){
var callback;
return{
send:function(headers,complete){
var handle,i,
xhr=s.xhr();
if(s.username){
xhr.open(s.type,s.url,s.async,s.username,s.password);
}else{
xhr.open(s.type,s.url,s.async);
}
if(s.xhrFields){
for(i in s.xhrFields){
xhr[i]=s.xhrFields[i];
}
}
if(s.mimeType&&xhr.overrideMimeType){
xhr.overrideMimeType(s.mimeType);
}
if(!s.crossDomain&&!headers["X-Requested-With"]){
headers["X-Requested-With"]="XMLHttpRequest";
}
try{
for(i in headers){
xhr.setRequestHeader(i,headers[i]);
}
}catch(err){}
xhr.send((s.hasContent&&s.data)||null);
callback=function(_,isAbort){
var status,responseHeaders,statusText,responses;
try{
if(callback&&(isAbort||xhr.readyState===4)){
callback=undefined;
if(handle){
xhr.onreadystatechange=jQuery.noop;
if(xhrOnUnloadAbort){
delete xhrCallbacks[handle];
}
}
if(isAbort){
if(xhr.readyState!==4){
xhr.abort();
}
}else{
responses={};
status=xhr.status;
responseHeaders=xhr.getAllResponseHeaders();
if(typeof xhr.responseText==="string"){
responses.text=xhr.responseText;
}
try{
statusText=xhr.statusText;
}catch(e){
statusText="";
}
if(!status&&s.isLocal&&!s.crossDomain){
status=responses.text?200:404;
}else if(status===1223){
status=204;
}
}
}
}catch(firefoxAccessException){
if(!isAbort){
complete(-1,firefoxAccessException);
}
}
if(responses){
complete(status,statusText,responses,responseHeaders);
}
};
if(!s.async){
callback();
}else if(xhr.readyState===4){
setTimeout(callback);
}else{
handle=++xhrId;
if(xhrOnUnloadAbort){
if(!xhrCallbacks){
xhrCallbacks={};
jQuery(window).unload(xhrOnUnloadAbort);
}
xhrCallbacks[handle]=callback;
}
xhr.onreadystatechange=callback;
}
},
abort:function(){
if(callback){
callback(undefined,true);
}
}
};
}
});
}
var fxNow,timerId,
rfxtypes=/^(?:toggle|show|hide)$/,
rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),
rrun=/queueHooks$/,
animationPrefilters=[defaultPrefilter],
tweeners={
"*":[function(prop,value){
var end,unit,
tween=this.createTween(prop,value),
parts=rfxnum.exec(value),
target=tween.cur(),
start=+target||0,
scale=1,
maxIterations=20;
if(parts){
end=+parts[2];
unit=parts[3]||(jQuery.cssNumber[prop]?"":"px");
if(unit!=="px"&&start){
start=jQuery.css(tween.elem,prop,true)||end||1;
do{
scale=scale||".5";
start=start/scale;
jQuery.style(tween.elem,prop,start+unit);
}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations);
}
tween.unit=unit;
tween.start=start;
tween.end=parts[1]?start+(parts[1]+1)*end:end;
}
return tween;
}]
};
function createFxNow(){
setTimeout(function(){
fxNow=undefined;
});
return(fxNow=jQuery.now());
}
function createTweens(animation,props){
jQuery.each(props,function(prop,value){
var collection=(tweeners[prop]||[]).concat(tweeners["*"]),
index=0,
length=collection.length;
for(;index<length;index++){
if(collection[index].call(animation,prop,value)){
return;
}
}
});
}
function Animation(elem,properties,options){
var result,
stopped,
index=0,
length=animationPrefilters.length,
deferred=jQuery.Deferred().always(function(){
delete tick.elem;
}),
tick=function(){
if(stopped){
return false;
}
var currentTime=fxNow||createFxNow(),
remaining=Math.max(0,animation.startTime+animation.duration-currentTime),
temp=remaining/animation.duration||0,
percent=1-temp,
index=0,
length=animation.tweens.length;
for(;index<length;index++){
animation.tweens[index].run(percent);
}
deferred.notifyWith(elem,[animation,percent,remaining]);
if(percent<1&&length){
return remaining;
}else{
deferred.resolveWith(elem,[animation]);
return false;
}
},
animation=deferred.promise({
elem:elem,
props:jQuery.extend({},properties),
opts:jQuery.extend(true,{specialEasing:{}},options),
originalProperties:properties,
originalOptions:options,
startTime:fxNow||createFxNow(),
duration:options.duration,
tweens:[],
createTween:function(prop,end){
var tween=jQuery.Tween(elem,animation.opts,prop,end,
animation.opts.specialEasing[prop]||animation.opts.easing);
animation.tweens.push(tween);
return tween;
},
stop:function(gotoEnd){
var index=0,
length=gotoEnd?animation.tweens.length:0;
if(stopped){
return this;
}
stopped=true;
for(;index<length;index++){
animation.tweens[index].run(1);
}
if(gotoEnd){
deferred.resolveWith(elem,[animation,gotoEnd]);
}else{
deferred.rejectWith(elem,[animation,gotoEnd]);
}
return this;
}
}),
props=animation.props;
propFilter(props,animation.opts.specialEasing);
for(;index<length;index++){
result=animationPrefilters[index].call(animation,elem,props,animation.opts);
if(result){
return result;
}
}
createTweens(animation,props);
if(jQuery.isFunction(animation.opts.start)){
animation.opts.start.call(elem,animation);
}
jQuery.fx.timer(
jQuery.extend(tick,{
elem:elem,
anim:animation,
queue:animation.opts.queue
})
);
return animation.progress(animation.opts.progress)
.done(animation.opts.done,animation.opts.complete)
.fail(animation.opts.fail)
.always(animation.opts.always);
}
function propFilter(props,specialEasing){
var value,name,index,easing,hooks;
for(index in props){
name=jQuery.camelCase(index);
easing=specialEasing[name];
value=props[index];
if(jQuery.isArray(value)){
easing=value[1];
value=props[index]=value[0];
}
if(index!==name){
props[name]=value;
delete props[index];
}
hooks=jQuery.cssHooks[name];
if(hooks&&"expand"in hooks){
value=hooks.expand(value);
delete props[name];
for(index in value){
if(!(index in props)){
props[index]=value[index];
specialEasing[index]=easing;
}
}
}else{
specialEasing[name]=easing;
}
}
}
jQuery.Animation=jQuery.extend(Animation,{
tweener:function(props,callback){
if(jQuery.isFunction(props)){
callback=props;
props=["*"];
}else{
props=props.split(" ");
}
var prop,
index=0,
length=props.length;
for(;index<length;index++){
prop=props[index];
tweeners[prop]=tweeners[prop]||[];
tweeners[prop].unshift(callback);
}
},
prefilter:function(callback,prepend){
if(prepend){
animationPrefilters.unshift(callback);
}else{
animationPrefilters.push(callback);
}
}
});
function defaultPrefilter(elem,props,opts){

var prop,index,length,
value,dataShow,toggle,
tween,hooks,oldfire,
anim=this,
style=elem.style,
orig={},
handled=[],
hidden=elem.nodeType&&isHidden(elem);
if(!opts.queue){
hooks=jQuery._queueHooks(elem,"fx");
if(hooks.unqueued==null){
hooks.unqueued=0;
oldfire=hooks.empty.fire;
hooks.empty.fire=function(){
if(!hooks.unqueued){
oldfire();
}
};
}
hooks.unqueued++;
anim.always(function(){
anim.always(function(){
hooks.unqueued--;
if(!jQuery.queue(elem,"fx").length){
hooks.empty.fire();
}
});
});
}
if(elem.nodeType===1&&("height"in props||"width"in props)){
opts.overflow=[style.overflow,style.overflowX,style.overflowY];
if(jQuery.css(elem,"display")==="inline"&&
jQuery.css(elem,"float")==="none"){
if(!jQuery.support.inlineBlockNeedsLayout||css_defaultDisplay(elem.nodeName)==="inline"){
style.display="inline-block";
}else{
style.zoom=1;
}
}
}
if(opts.overflow){
style.overflow="hidden";
if(!jQuery.support.shrinkWrapBlocks){
anim.always(function(){
style.overflow=opts.overflow[0];
style.overflowX=opts.overflow[1];
style.overflowY=opts.overflow[2];
});
}
}
for(index in props){
value=props[index];
if(rfxtypes.exec(value)){
delete props[index];
toggle=toggle||value==="toggle";
if(value===(hidden?"hide":"show")){
continue;
}
handled.push(index);
}
}
length=handled.length;
if(length){
dataShow=jQuery._data(elem,"fxshow")||jQuery._data(elem,"fxshow",{});
if("hidden"in dataShow){
hidden=dataShow.hidden;
}
if(toggle){
dataShow.hidden=!hidden;
}
if(hidden){
jQuery(elem).show();
}else{
anim.done(function(){
jQuery(elem).hide();
});
}
anim.done(function(){
var prop;
jQuery._removeData(elem,"fxshow");
for(prop in orig){
jQuery.style(elem,prop,orig[prop]);
}
});
for(index=0;index<length;index++){
prop=handled[index];
tween=anim.createTween(prop,hidden?dataShow[prop]:0);
orig[prop]=dataShow[prop]||jQuery.style(elem,prop);
if(!(prop in dataShow)){
dataShow[prop]=tween.start;
if(hidden){
tween.end=tween.start;
tween.start=prop==="width"||prop==="height"?1:0;
}
}
}
}
}
function Tween(elem,options,prop,end,easing){
return new Tween.prototype.init(elem,options,prop,end,easing);
}
jQuery.Tween=Tween;
Tween.prototype={
constructor:Tween,
init:function(elem,options,prop,end,easing,unit){
this.elem=elem;
this.prop=prop;
this.easing=easing||"swing";
this.options=options;
this.start=this.now=this.cur();
this.end=end;
this.unit=unit||(jQuery.cssNumber[prop]?"":"px");
},
cur:function(){
var hooks=Tween.propHooks[this.prop];
return hooks&&hooks.get?
hooks.get(this):
Tween.propHooks._default.get(this);
},
run:function(percent){
var eased,
hooks=Tween.propHooks[this.prop];
if(this.options.duration){
this.pos=eased=jQuery.easing[this.easing](
percent,this.options.duration*percent,0,1,this.options.duration
);
}else{
this.pos=eased=percent;
}
this.now=(this.end-this.start)*eased+this.start;
if(this.options.step){
this.options.step.call(this.elem,this.now,this);
}
if(hooks&&hooks.set){
hooks.set(this);
}else{
Tween.propHooks._default.set(this);
}
return this;
}
};
Tween.prototype.init.prototype=Tween.prototype;
Tween.propHooks={
_default:{
get:function(tween){
var result;
if(tween.elem[tween.prop]!=null&&
(!tween.elem.style||tween.elem.style[tween.prop]==null)){
return tween.elem[tween.prop];
}
result=jQuery.css(tween.elem,tween.prop,"");
return!result||result==="auto"?0:result;
},
set:function(tween){
if(jQuery.fx.step[tween.prop]){
jQuery.fx.step[tween.prop](tween);
}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){
jQuery.style(tween.elem,tween.prop,tween.now+tween.unit);
}else{
tween.elem[tween.prop]=tween.now;
}
}
}
};
Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={
set:function(tween){
if(tween.elem.nodeType&&tween.elem.parentNode){
tween.elem[tween.prop]=tween.now;
}
}
};
jQuery.each(["toggle","show","hide"],function(i,name){
var cssFn=jQuery.fn[name];
jQuery.fn[name]=function(speed,easing,callback){
return speed==null||typeof speed==="boolean"?
cssFn.apply(this,arguments):
this.animate(genFx(name,true),speed,easing,callback);
};
});
jQuery.fn.extend({
fadeTo:function(speed,to,easing,callback){
return this.filter(isHidden).css("opacity",0).show()
.end().animate({opacity:to},speed,easing,callback);
},
animate:function(prop,speed,easing,callback){
var empty=jQuery.isEmptyObject(prop),
optall=jQuery.speed(speed,easing,callback),
doAnimation=function(){
var anim=Animation(this,jQuery.extend({},prop),optall);
doAnimation.finish=function(){
anim.stop(true);
};
if(empty||jQuery._data(this,"finish")){
anim.stop(true);
}
};
doAnimation.finish=doAnimation;
return empty||optall.queue===false?
this.each(doAnimation):
this.queue(optall.queue,doAnimation);
},
stop:function(type,clearQueue,gotoEnd){
var stopQueue=function(hooks){
var stop=hooks.stop;
delete hooks.stop;
stop(gotoEnd);
};
if(typeof type!=="string"){
gotoEnd=clearQueue;
clearQueue=type;
type=undefined;
}
if(clearQueue&&type!==false){
this.queue(type||"fx",[]);
}
return this.each(function(){
var dequeue=true,
index=type!=null&&type+"queueHooks",
timers=jQuery.timers,
data=jQuery._data(this);
if(index){
if(data[index]&&data[index].stop){
stopQueue(data[index]);
}
}else{
for(index in data){
if(data[index]&&data[index].stop&&rrun.test(index)){
stopQueue(data[index]);
}
}
}
for(index=timers.length;index--;){
if(timers[index].elem===this&&(type==null||timers[index].queue===type)){
timers[index].anim.stop(gotoEnd);
dequeue=false;
timers.splice(index,1);
}
}
if(dequeue||!gotoEnd){
jQuery.dequeue(this,type);
}
});
},
finish:function(type){
if(type!==false){
type=type||"fx";
}
return this.each(function(){
var index,
data=jQuery._data(this),
queue=data[type+"queue"],
hooks=data[type+"queueHooks"],
timers=jQuery.timers,
length=queue?queue.length:0;
data.finish=true;
jQuery.queue(this,type,[]);
if(hooks&&hooks.cur&&hooks.cur.finish){
hooks.cur.finish.call(this);
}
for(index=timers.length;index--;){
if(timers[index].elem===this&&timers[index].queue===type){
timers[index].anim.stop(true);
timers.splice(index,1);
}
}
for(index=0;index<length;index++){
if(queue[index]&&queue[index].finish){
queue[index].finish.call(this);
}
}
delete data.finish;
});
}
});
function genFx(type,includeWidth){
var which,
attrs={height:type},
i=0;
includeWidth=includeWidth?1:0;
for(;i<4;i+=2-includeWidth){
which=cssExpand[i];
attrs["margin"+which]=attrs["padding"+which]=type;
}
if(includeWidth){
attrs.opacity=attrs.width=type;
}
return attrs;
}
jQuery.each({
slideDown:genFx("show"),
slideUp:genFx("hide"),
slideToggle:genFx("toggle"),
fadeIn:{opacity:"show"},
fadeOut:{opacity:"hide"},
fadeToggle:{opacity:"toggle"}
},function(name,props){
jQuery.fn[name]=function(speed,easing,callback){
return this.animate(props,speed,easing,callback);
};
});
jQuery.speed=function(speed,easing,fn){
var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{
complete:fn||!fn&&easing||
jQuery.isFunction(speed)&&speed,
duration:speed,
easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing
};
opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:
opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;
if(opt.queue==null||opt.queue===true){
opt.queue="fx";
}
opt.old=opt.complete;
opt.complete=function(){
if(jQuery.isFunction(opt.old)){
opt.old.call(this);
}
if(opt.queue){
jQuery.dequeue(this,opt.queue);
}
};
return opt;
};
jQuery.easing={
linear:function(p){
return p;
},
swing:function(p){
return 0.5-Math.cos(p*Math.PI)/2;
}
};
jQuery.timers=[];
jQuery.fx=Tween.prototype.init;
jQuery.fx.tick=function(){
var timer,
timers=jQuery.timers,
i=0;
fxNow=jQuery.now();
for(;i<timers.length;i++){
timer=timers[i];
if(!timer()&&timers[i]===timer){
timers.splice(i--,1);
}
}
if(!timers.length){
jQuery.fx.stop();
}
fxNow=undefined;
};
jQuery.fx.timer=function(timer){
if(timer()&&jQuery.timers.push(timer)){
jQuery.fx.start();
}
};
jQuery.fx.interval=13;
jQuery.fx.start=function(){
if(!timerId){
timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval);
}
};
jQuery.fx.stop=function(){
clearInterval(timerId);
timerId=null;
};
jQuery.fx.speeds={
slow:600,
fast:200,
_default:400
};
jQuery.fx.step={};
if(jQuery.expr&&jQuery.expr.filters){
jQuery.expr.filters.animated=function(elem){
return jQuery.grep(jQuery.timers,function(fn){
return elem===fn.elem;
}).length;
};
}
jQuery.fn.offset=function(options){
if(arguments.length){
return options===undefined?
this:
this.each(function(i){
jQuery.offset.setOffset(this,options,i);
});
}
var docElem,win,
box={top:0,left:0},
elem=this[0],
doc=elem&&elem.ownerDocument;
if(!doc){
return;
}
docElem=doc.documentElement;
if(!jQuery.contains(docElem,elem)){
return box;
}
if(typeof elem.getBoundingClientRect!==core_strundefined){
box=elem.getBoundingClientRect();
}
win=getWindow(doc);
return{
top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),
left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)
};
};
jQuery.offset={
setOffset:function(elem,options,i){
var position=jQuery.css(elem,"position");
if(position==="static"){
elem.style.position="relative";
}
var curElem=jQuery(elem),
curOffset=curElem.offset(),
curCSSTop=jQuery.css(elem,"top"),
curCSSLeft=jQuery.css(elem,"left"),
calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,
props={},curPosition={},curTop,curLeft;
if(calculatePosition){
curPosition=curElem.position();
curTop=curPosition.top;
curLeft=curPosition.left;
}else{
curTop=parseFloat(curCSSTop)||0;
curLeft=parseFloat(curCSSLeft)||0;
}
if(jQuery.isFunction(options)){
options=options.call(elem,i,curOffset);
}
if(options.top!=null){
props.top=(options.top-curOffset.top)+curTop;
}
if(options.left!=null){
props.left=(options.left-curOffset.left)+curLeft;
}
if("using"in options){
options.using.call(elem,props);
}else{
curElem.css(props);
}
}
};
jQuery.fn.extend({
position:function(){
if(!this[0]){
return;
}
var offsetParent,offset,
parentOffset={top:0,left:0},
elem=this[0];
if(jQuery.css(elem,"position")==="fixed"){
offset=elem.getBoundingClientRect();
}else{
offsetParent=this.offsetParent();
offset=this.offset();
if(!jQuery.nodeName(offsetParent[0],"html")){
parentOffset=offsetParent.offset();
}
parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);
parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true);
}
return{
top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),
left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)
};
},
offsetParent:function(){
return this.map(function(){
var offsetParent=this.offsetParent||document.documentElement;
while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){
offsetParent=offsetParent.offsetParent;
}
return offsetParent||document.documentElement;
});
}
});
jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){
var top=/Y/.test(prop);
jQuery.fn[method]=function(val){
return jQuery.access(this,function(elem,method,val){
var win=getWindow(elem);
if(val===undefined){
return win?(prop in win)?win[prop]:
win.document.documentElement[method]:
elem[method];
}
if(win){
win.scrollTo(
!top?val:jQuery(win).scrollLeft(),
top?val:jQuery(win).scrollTop()
);
}else{
elem[method]=val;
}
},method,val,arguments.length,null);
};
});
function getWindow(elem){
return jQuery.isWindow(elem)?
elem:
elem.nodeType===9?
elem.defaultView||elem.parentWindow:
false;
}
jQuery.each({Height:"height",Width:"width"},function(name,type){
jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){
jQuery.fn[funcName]=function(margin,value){
var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),
extra=defaultExtra||(margin===true||value===true?"margin":"border");
return jQuery.access(this,function(elem,type,value){
var doc;
if(jQuery.isWindow(elem)){
return elem.document.documentElement["client"+name];
}
if(elem.nodeType===9){
doc=elem.documentElement;
return Math.max(
elem.body["scroll"+name],doc["scroll"+name],
elem.body["offset"+name],doc["offset"+name],
doc["client"+name]
);
}
return value===undefined?
jQuery.css(elem,type,extra):
jQuery.style(elem,type,value,extra);
},type,chainable?margin:undefined,chainable,null);
};
});
});
window.jQuery=window.$=jQuery;
if(typeof define==="function"&&define.amd&&define.amd.jQuery){
define("jquery",[],function(){return jQuery});
}
})(window);
;

;
var mejs=mejs||{};
mejs.version='2.13.2';
mejs.meIndex=0;
mejs.plugins={
silverlight:[
{version:[3,0],types:['video/mp4','video/m4v','video/mov','video/wmv','audio/wma','audio/m4a','audio/mp3','audio/wav','audio/mpeg']}
],
flash:[
{version:[9,0,124],types:['video/mp4','video/m4v','video/mov','video/flv','video/rtmp','video/x-flv','audio/flv','audio/x-flv','audio/mp3','audio/m4a','audio/mpeg','video/youtube','video/x-youtube']}
],
youtube:[
{version:null,types:['video/youtube','video/x-youtube','audio/youtube','audio/x-youtube']}
],
vimeo:[
{version:null,types:['video/vimeo','video/x-vimeo']}
]
};

mejs.Utility={
encodeUrl:function(url){
return encodeURIComponent(url)},
escapeHTML:function(s){
return s.toString().split('&').join('&amp;').split('<').join('&lt;').split('"').join('&quot;');
},
absolutizeUrl:function(url){
var el=document.createElement('div');
el.innerHTML='<a href="'+this.escapeHTML(url)+'">x</a>';
return el.firstChild.href;
},
getScriptPath:function(scriptNames){
var
i=0,
j,
codePath='',
testname='',
slashPos,
filenamePos,
scriptUrl,
scriptPath,
scriptFilename,
scripts=document.getElementsByTagName('script'),
il=scripts.length,
jl=scriptNames.length;
for(;i<il;i++){
scriptUrl=scripts[i].src;
slashPos=scriptUrl.lastIndexOf('/');
if(slashPos>-1){
scriptFilename=scriptUrl.substring(slashPos+1);
scriptPath=scriptUrl.substring(0,slashPos+1);
}else{
scriptFilename=scriptUrl;
scriptPath='';
}
for(j=0;j<jl;j++){
testname=scriptNames[j];
filenamePos=scriptFilename.indexOf(testname);
if(filenamePos>-1){
codePath=scriptPath;
break;
}
}
if(codePath!==''){
break;
}
}
return codePath;
},
secondsToTimeCode:function(time,forceHours,showFrameCount,fps){
if(typeof showFrameCount=='undefined'){
showFrameCount=false;
}else if(typeof fps=='undefined'){
fps=25;
}
var hours=Math.floor(time/3600)%24,
minutes=Math.floor(time/60)%60,
seconds=Math.floor(time%60),
frames=Math.floor(((time%1)*fps).toFixed(3)),
result=
((forceHours||hours>0)?(hours<10?'0'+hours:hours)+':':'')
+(minutes<10?'0'+minutes:minutes)+':'
+(seconds<10?'0'+seconds:seconds)
+((showFrameCount)?':'+(frames<10?'0'+frames:frames):'');
return result;
},
timeCodeToSeconds:function(hh_mm_ss_ff,forceHours,showFrameCount,fps){
if(typeof showFrameCount=='undefined'){
showFrameCount=false;
}else if(typeof fps=='undefined'){
fps=25;
}
var tc_array=hh_mm_ss_ff.split(":"),
tc_hh=parseInt(tc_array[0],10),
tc_mm=parseInt(tc_array[1],10),
tc_ss=parseInt(tc_array[2],10),
tc_ff=0,
tc_in_seconds=0;
if(showFrameCount){
tc_ff=parseInt(tc_array[3])/fps;
}
tc_in_seconds=(tc_hh*3600)+(tc_mm*60)+tc_ss+tc_ff;
return tc_in_seconds;
},
convertSMPTEtoSeconds:function(SMPTE){
if(typeof SMPTE!='string')
return false;
SMPTE=SMPTE.replace(',','.');
var secs=0,
decimalLen=(SMPTE.indexOf('.')!=-1)?SMPTE.split('.')[1].length:0,
multiplier=1;
SMPTE=SMPTE.split(':').reverse();
for(var i=0;i<SMPTE.length;i++){
multiplier=1;
if(i>0){
multiplier=Math.pow(60,i);
}
secs+=Number(SMPTE[i])*multiplier;
}
return Number(secs.toFixed(decimalLen));
},

removeSwf:function(id){
var obj=document.getElementById(id);
if(obj&&/object|embed/i.test(obj.nodeName)){
if(mejs.MediaFeatures.isIE){
obj.style.display="none";
(function(){
if(obj.readyState==4){
mejs.Utility.removeObjectInIE(id);
}else{
setTimeout(arguments.callee,10);
}
})();
}else{
obj.parentNode.removeChild(obj);
}
}
},
removeObjectInIE:function(id){
var obj=document.getElementById(id);
if(obj){
for(var i in obj){
if(typeof obj[i]=="function"){
obj[i]=null;
}
}
obj.parentNode.removeChild(obj);
}
}
};
mejs.PluginDetector={
hasPluginVersion:function(plugin,v){
var pv=this.plugins[plugin];
v[1]=v[1]||0;
v[2]=v[2]||0;
return(pv[0]>v[0]||(pv[0]==v[0]&&pv[1]>v[1])||(pv[0]==v[0]&&pv[1]==v[1]&&pv[2]>=v[2]))?true:false;
},
nav:window.navigator,
ua:window.navigator.userAgent.toLowerCase(),
plugins:[],
addPlugin:function(p,pluginName,mimeType,activeX,axDetect){
this.plugins[p]=this.detectPlugin(pluginName,mimeType,activeX,axDetect);
},
detectPlugin:function(pluginName,mimeType,activeX,axDetect){
var version=[0,0,0],
description,
i,
ax;
if(typeof(this.nav.plugins)!='undefined'&&typeof this.nav.plugins[pluginName]=='object'){
description=this.nav.plugins[pluginName].description;
if(description&&!(typeof this.nav.mimeTypes!='undefined'&&this.nav.mimeTypes[mimeType]&&!this.nav.mimeTypes[mimeType].enabledPlugin)){
version=description.replace(pluginName,'').replace(/^\s+/,'').replace(/\sr/gi,'.').split('.');
for(i=0;i<version.length;i++){
version[i]=parseInt(version[i].match(/\d+/),10);
}
}
}else if(typeof(window.ActiveXObject)!='undefined'){
try{
ax=new ActiveXObject(activeX);
if(ax){
version=axDetect(ax);
}
}
catch(e){}
}
return version;
}
};
mejs.PluginDetector.addPlugin('flash','Shockwave Flash','application/x-shockwave-flash','ShockwaveFlash.ShockwaveFlash',function(ax){
var version=[],
d=ax.GetVariable("$version");
if(d){
d=d.split(" ")[1].split(",");
version=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)];
}
return version;
});
mejs.PluginDetector.addPlugin('silverlight','Silverlight Plug-In','application/x-silverlight-2','AgControl.AgControl',function(ax){
var v=[0,0,0,0],
loopMatch=function(ax,v,i,n){
while(ax.isVersionSupported(v[0]+"."+v[1]+"."+v[2]+"."+v[3])){
v[i]+=n;
}
v[i]-=n;
};
loopMatch(ax,v,0,1);
loopMatch(ax,v,1,1);
loopMatch(ax,v,2,10000);loopMatch(ax,v,2,1000);
loopMatch(ax,v,2,100);
loopMatch(ax,v,2,10);
loopMatch(ax,v,2,1);
loopMatch(ax,v,3,1);
return v;
});

mejs.MediaFeatures={
init:function(){
var
t=this,
d=document,
nav=mejs.PluginDetector.nav,
ua=mejs.PluginDetector.ua.toLowerCase(),
i,
v,
html5Elements=['source','track','audio','video'];
t.isiPad=(ua.match(/ipad/i)!==null);
t.isiPhone=(ua.match(/iphone/i)!==null);
t.isiOS=t.isiPhone||t.isiPad;
t.isAndroid=(ua.match(/android/i)!==null);
t.isBustedAndroid=(ua.match(/android 2\.[12]/)!==null);
t.isBustedNativeHTTPS=(location.protocol==='https:'&&(ua.match(/android [12]\./)!==null||ua.match(/macintosh.* version.* safari/)!==null));
t.isIE=(nav.appName.toLowerCase().indexOf("microsoft")!=-1||nav.appName.toLowerCase().match(/trident/gi)!==null);
t.isChrome=(ua.match(/chrome/gi)!==null);
t.isFirefox=(ua.match(/firefox/gi)!==null);
t.isWebkit=(ua.match(/webkit/gi)!==null);
t.isGecko=(ua.match(/gecko/gi)!==null)&&!t.isWebkit&&!t.isIE;
t.isOpera=(ua.match(/opera/gi)!==null);
t.hasTouch=('ontouchstart'in window);t.svg=!!document.createElementNS&&
!!document.createElementNS('http://www.w3.org/2000/svg','svg').createSVGRect;
for(i=0;i<html5Elements.length;i++){
v=document.createElement(html5Elements[i]);
}
t.supportsMediaTag=(typeof v.canPlayType!=='undefined'||t.isBustedAndroid);
try{
v.canPlayType("video/mp4");
}catch(e){
t.supportsMediaTag=false;
}
t.hasSemiNativeFullScreen=(typeof v.webkitEnterFullscreen!=='undefined');
t.hasNativeFullscreen=(typeof v.requestFullscreen!=='undefined');
t.hasWebkitNativeFullScreen=(typeof v.webkitRequestFullScreen!=='undefined');
t.hasMozNativeFullScreen=(typeof v.mozRequestFullScreen!=='undefined');
t.hasMsNativeFullScreen=(typeof v.msRequestFullscreen!=='undefined');
t.hasTrueNativeFullScreen=(t.hasWebkitNativeFullScreen||t.hasMozNativeFullScreen||t.hasMsNativeFullScreen);
t.nativeFullScreenEnabled=t.hasTrueNativeFullScreen;
if(t.hasMozNativeFullScreen){
t.nativeFullScreenEnabled=document.mozFullScreenEnabled;
}else if(t.hasMsNativeFullScreen){
t.nativeFullScreenEnabled=document.msFullscreenEnabled;
}
if(t.isChrome){
t.hasSemiNativeFullScreen=false;
}
if(t.hasTrueNativeFullScreen){
t.fullScreenEventName='';
if(t.hasWebkitNativeFullScreen){
t.fullScreenEventName='webkitfullscreenchange';
}else if(t.hasMozNativeFullScreen){
t.fullScreenEventName='mozfullscreenchange';
}else if(t.hasMsNativeFullScreen){
t.fullScreenEventName='MSFullscreenChange';
}
t.isFullScreen=function(){
if(v.mozRequestFullScreen){
return d.mozFullScreen;
}else if(v.webkitRequestFullScreen){
return d.webkitIsFullScreen;
}else if(v.hasMsNativeFullScreen){
return d.msFullscreenElement!==null;
}
}
t.requestFullScreen=function(el){
if(t.hasWebkitNativeFullScreen){
el.webkitRequestFullScreen();
}else if(t.hasMozNativeFullScreen){
el.mozRequestFullScreen();
}else if(t.hasMsNativeFullScreen){
el.msRequestFullscreen();
}
}
t.cancelFullScreen=function(){
if(t.hasWebkitNativeFullScreen){
document.webkitCancelFullScreen();
}else if(t.hasMozNativeFullScreen){
document.mozCancelFullScreen();
}else if(t.hasMsNativeFullScreen){
document.msExitFullscreen();
}
}
}
if(t.hasSemiNativeFullScreen&&ua.match(/mac os x 10_5/i)){
t.hasNativeFullScreen=false;
t.hasSemiNativeFullScreen=false;
}
}
};
mejs.MediaFeatures.init();

mejs.HtmlMediaElement={
pluginType:'native',
isFullScreen:false,
setCurrentTime:function(time){
this.currentTime=time;
},
setMuted:function(muted){
this.muted=muted;
},
setVolume:function(volume){
this.volume=volume;
},
stop:function(){
this.pause();
},
setSrc:function(url){
var existingSources=this.getElementsByTagName('source');
while(existingSources.length>0){
this.removeChild(existingSources[0]);
}
var existingSources=this.getElementsByTagName('object');
while(existingSources.length>0){
this.removeChild(existingSources[0]);
}
this.pause();
if(typeof url=='string'){
this.src=url;
}else{
var i,media;
for(i=0;i<url.length;i++){
media=url[i];
if(this.canPlayType(media.type)){
this.src=media.src;
break;
}
}
}
$(this).load()},
setVideoSize:function(width,height){
this.width=width;
this.height=height;
}
};

mejs.PluginMediaElement=function(pluginid,pluginType,mediaUrl){
this.id=pluginid;
this.pluginType=pluginType;
this.src=mediaUrl;
this.events={};
this.attributes={};
};
mejs.PluginMediaElement.prototype={
pluginElement:null,
pluginType:'',
isFullScreen:false,
playbackRate:-1,
defaultPlaybackRate:-1,
seekable:[],
played:[],
paused:true,
ended:false,
seeking:false,
duration:0,
error:null,
tagName:'',
muted:false,
volume:1,
currentTime:0,
play:function(){
if(this.pluginApi!=null){
if(this.pluginType=='youtube'){
this.pluginApi.playSong();
}else{
this.pluginApi.playMedia();
}
this.paused=false;
}
},
load:function(){
if(this.pluginApi!=null){
if(this.pluginType=='youtube'){
}else{
this.pluginApi.loadMedia();
}
this.paused=false;
}
},
pause:function(){
if(this.pluginApi!=null){
if(this.pluginType=='youtube'){
this.pluginApi.pauseSong();
}else{
this.pluginApi.pauseMedia();
}
this.paused=true;
}
},
stop:function(){
if(this.pluginApi!=null){
if(this.pluginType=='youtube'){
this.pluginApi.stopVideo();
}else{
this.pluginApi.stopMedia();
}
this.paused=true;
}
},
canPlayType:function(type){
var i,
j,
pluginInfo,
pluginVersions=mejs.plugins[this.pluginType];
for(i=0;i<pluginVersions.length;i++){
pluginInfo=pluginVersions[i];
if(mejs.PluginDetector.hasPluginVersion(this.pluginType,pluginInfo.version)){
for(j=0;j<pluginInfo.types.length;j++){
if(type==pluginInfo.types[j]){
return'probably';
}
}
}
}
return'';
},
positionFullscreenButton:function(x,y,visibleAndAbove){
if(this.pluginApi!=null&&this.pluginApi.positionFullscreenButton){
this.pluginApi.positionFullscreenButton(Math.floor(x),Math.floor(y),visibleAndAbove);
}
},
hideFullscreenButton:function(){
if(this.pluginApi!=null&&this.pluginApi.hideFullscreenButton){
this.pluginApi.hideFullscreenButton();
}
},
setSrc:function(url){
if(typeof url=='string'){
this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(url));
this.src=mejs.Utility.absolutizeUrl(url);
}else{
var i,media;
for(i=0;i<url.length;i++){
media=url[i];
if(this.canPlayType(media.type)){
this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(media.src));
this.src=mejs.Utility.absolutizeUrl(url);
break;
}
}
}
},
setCurrentTime:function(time){
if(this.pluginApi!=null){
if(this.pluginType=='youtube'){
this.pluginApi.seekTo(time);
}else{
this.pluginApi.setCurrentTime(time);
}
this.currentTime=time;
}
},
setVolume:function(volume){
if(this.pluginApi!=null){
if(this.pluginType=='youtube'){
this.pluginApi.setVolume(volume*100);
}else{
this.pluginApi.setVolume(volume);
}
this.volume=volume;
}
},
setMuted:function(muted){
if(this.pluginApi!=null){
if(this.pluginType=='youtube'){
if(muted){
this.pluginApi.mute();
}else{
this.pluginApi.unMute();
}
this.muted=muted;
this.dispatchEvent('volumechange');
}else{
this.pluginApi.setMuted(muted);
}
this.muted=muted;
}
},
setVideoSize:function(width,height){
if(this.pluginElement.style){
this.pluginElement.style.width=width+'px';
this.pluginElement.style.height=height+'px';
}
if(this.pluginApi!=null&&this.pluginApi.setVideoSize){
this.pluginApi.setVideoSize(width,height);
}
},
setFullscreen:function(fullscreen){
if(this.pluginApi!=null&&this.pluginApi.setFullscreen){
this.pluginApi.setFullscreen(fullscreen);
}
},
enterFullScreen:function(){
if(this.pluginApi!=null&&this.pluginApi.setFullscreen){
this.setFullscreen(true);
}
},
exitFullScreen:function(){
if(this.pluginApi!=null&&this.pluginApi.setFullscreen){
this.setFullscreen(false);
}
},
addEventListener:function(eventName,callback,bubble){
this.events[eventName]=this.events[eventName]||[];
this.events[eventName].push(callback);
},
removeEventListener:function(eventName,callback){
if(!eventName){this.events={};return true}
var callbacks=this.events[eventName];
if(!callbacks)return true;
if(!callback){this.events[eventName]=[];return true}
for(i=0;i<callbacks.length;i++){
if(callbacks[i]===callback){
this.events[eventName].splice(i,1);
return true;
}
}
return false;
},
dispatchEvent:function(eventName){
var i,
args,
callbacks=this.events[eventName];
if(callbacks){
args=Array.prototype.slice.call(arguments,1);
for(i=0;i<callbacks.length;i++){
callbacks[i].apply(null,args);
}
}
},
hasAttribute:function(name){
return(name in this.attributes);
},
removeAttribute:function(name){
delete this.attributes[name];
},
getAttribute:function(name){
if(this.hasAttribute(name)){
return this.attributes[name];
}
return'';
},
setAttribute:function(name,value){
this.attributes[name]=value;
},
remove:function(){
mejs.Utility.removeSwf(this.pluginElement.id);
mejs.MediaPluginBridge.unregisterPluginElement(this.pluginElement.id);
}
};
mejs.MediaPluginBridge={
pluginMediaElements:{},
htmlMediaElements:{},
registerPluginElement:function(id,pluginMediaElement,htmlMediaElement){
this.pluginMediaElements[id]=pluginMediaElement;
this.htmlMediaElements[id]=htmlMediaElement;
},
unregisterPluginElement:function(id){
delete this.pluginMediaElements[id];
delete this.htmlMediaElements[id];
},
initPlugin:function(id){
var pluginMediaElement=this.pluginMediaElements[id],
htmlMediaElement=this.htmlMediaElements[id];
if(pluginMediaElement){
switch(pluginMediaElement.pluginType){
case"flash":
pluginMediaElement.pluginElement=pluginMediaElement.pluginApi=document.getElementById(id);
break;
case"silverlight":
pluginMediaElement.pluginElement=document.getElementById(pluginMediaElement.id);
pluginMediaElement.pluginApi=pluginMediaElement.pluginElement.Content.MediaElementJS;
break;
}
if(pluginMediaElement.pluginApi!=null&&pluginMediaElement.success){
pluginMediaElement.success(pluginMediaElement,htmlMediaElement);
}
}
},
fireEvent:function(id,eventName,values){
var
e,
i,
bufferedTime,
pluginMediaElement=this.pluginMediaElements[id];
if(!pluginMediaElement){
return;
}
e={
type:eventName,
target:pluginMediaElement
};
for(i in values){
pluginMediaElement[i]=values[i];
e[i]=values[i];
}
bufferedTime=values.bufferedTime||0;
e.target.buffered=e.buffered={
start:function(index){
return 0;
},
end:function(index){
return bufferedTime;
},
length:1
};
pluginMediaElement.dispatchEvent(e.type,e);
}
};

mejs.MediaElementDefaults={
mode:'auto',
plugins:['flash','silverlight','youtube','vimeo'],
enablePluginDebug:false,
httpsBasicAuthSite:false,
type:'',
pluginPath:mejs.Utility.getScriptPath(['mediaelement.js','mediaelement.min.js','mediaelement-and-player.js','mediaelement-and-player.min.js']),
flashName:'flashmediaelement.swf',
flashStreamer:'',
enablePluginSmoothing:false,
enablePseudoStreaming:false,
pseudoStreamingStartQueryParam:'start',
silverlightName:'silverlightmediaelement.xap',
defaultVideoWidth:480,
defaultVideoHeight:270,
pluginWidth:-1,
pluginHeight:-1,
pluginVars:[],
timerRate:250,
startVolume:0.8,
success:function(){},
error:function(){}
};

mejs.MediaElement=function(el,o){
return mejs.HtmlMediaElementShim.create(el,o);
};
mejs.HtmlMediaElementShim={
create:function(el,o){
var
options=mejs.MediaElementDefaults,
htmlMediaElement=(typeof(el)=='string')?document.getElementById(el):el,
tagName=htmlMediaElement.tagName.toLowerCase(),
isMediaTag=(tagName==='audio'||tagName==='video'),
src=(isMediaTag)?htmlMediaElement.getAttribute('src'):htmlMediaElement.getAttribute('href'),
poster=htmlMediaElement.getAttribute('poster'),
autoplay=htmlMediaElement.getAttribute('autoplay'),
preload=htmlMediaElement.getAttribute('preload'),
controls=htmlMediaElement.getAttribute('controls'),
playback,
prop;
for(prop in o){
options[prop]=o[prop];
}
src=(typeof src=='undefined'||src===null||src=='')?null:src;
poster=(typeof poster=='undefined'||poster===null)?'':poster;
preload=(typeof preload=='undefined'||preload===null||preload==='false')?'none':preload;
autoplay=!(typeof autoplay=='undefined'||autoplay===null||autoplay==='false');
controls=!(typeof controls=='undefined'||controls===null||controls==='false');
playback=this.determinePlayback(htmlMediaElement,options,mejs.MediaFeatures.supportsMediaTag,isMediaTag,src);
playback.url=(playback.url!==null)?mejs.Utility.absolutizeUrl(playback.url):'';
if(playback.method=='native'){
if(mejs.MediaFeatures.isBustedAndroid){
htmlMediaElement.src=playback.url;
htmlMediaElement.addEventListener('click',function(){
htmlMediaElement.play();
},false);
}
return this.updateNative(playback,options,autoplay,preload);
}else if(playback.method!==''){
return this.createPlugin(playback,options,poster,autoplay,preload,controls);
}else{
this.createErrorMessage(playback,options,poster);
return this;
}
},
determinePlayback:function(htmlMediaElement,options,supportsMediaTag,isMediaTag,src){
var
mediaFiles=[],
i,
j,
k,
l,
n,
type,
result={method:'',url:'',htmlMediaElement:htmlMediaElement,isVideo:(htmlMediaElement.tagName.toLowerCase()!='audio')},
pluginName,
pluginVersions,
pluginInfo,
dummy,
media;
if(typeof options.type!='undefined'&&options.type!==''){
if(typeof options.type=='string'){
mediaFiles.push({type:options.type,url:src});
}else{
for(i=0;i<options.type.length;i++){
mediaFiles.push({type:options.type[i],url:src});
}
}
}else if(src!==null){
type=this.formatType(src,htmlMediaElement.getAttribute('type'));
mediaFiles.push({type:type,url:src});
}else{
for(i=0;i<htmlMediaElement.childNodes.length;i++){
n=htmlMediaElement.childNodes[i];
if(n.nodeType==1&&n.tagName.toLowerCase()=='source'){
src=n.getAttribute('src');
type=this.formatType(src,n.getAttribute('type'));
media=n.getAttribute('media');
if(!media||!window.matchMedia||(window.matchMedia&&window.matchMedia(media).matches)){
mediaFiles.push({type:type,url:src});
}
}
}
}
if(!isMediaTag&&mediaFiles.length>0&&mediaFiles[0].url!==null&&this.getTypeFromFile(mediaFiles[0].url).indexOf('audio')>-1){
result.isVideo=false;
}
if(mejs.MediaFeatures.isBustedAndroid){
htmlMediaElement.canPlayType=function(type){
return(type.match(/video\/(mp4|m4v)/gi)!==null)?'maybe':'';
};
}
if(supportsMediaTag&&(options.mode==='auto'||options.mode==='auto_plugin'||options.mode==='native')&&!(mejs.MediaFeatures.isBustedNativeHTTPS&&options.httpsBasicAuthSite===true)){
if(!isMediaTag){
dummy=document.createElement(result.isVideo?'video':'audio');
htmlMediaElement.parentNode.insertBefore(dummy,htmlMediaElement);
htmlMediaElement.style.display='none';
result.htmlMediaElement=htmlMediaElement=dummy;
}
for(i=0;i<mediaFiles.length;i++){
if(htmlMediaElement.canPlayType(mediaFiles[i].type).replace(/no/,'')!==''
||htmlMediaElement.canPlayType(mediaFiles[i].type.replace(/mp3/,'mpeg')).replace(/no/,'')!==''){
result.method='native';
result.url=mediaFiles[i].url;
break;
}
}
if(result.method==='native'){
if(result.url!==null){
htmlMediaElement.src=result.url;
}
if(options.mode!=='auto_plugin'){
return result;
}
}
}
if(options.mode==='auto'||options.mode==='auto_plugin'||options.mode==='shim'){
for(i=0;i<mediaFiles.length;i++){
type=mediaFiles[i].type;
for(j=0;j<options.plugins.length;j++){
pluginName=options.plugins[j];
pluginVersions=mejs.plugins[pluginName];
for(k=0;k<pluginVersions.length;k++){
pluginInfo=pluginVersions[k];
if(pluginInfo.version==null||
mejs.PluginDetector.hasPluginVersion(pluginName,pluginInfo.version)){
for(l=0;l<pluginInfo.types.length;l++){
if(type==pluginInfo.types[l]){
result.method=pluginName;
result.url=mediaFiles[i].url;
return result;
}
}
}
}
}
}
}
if(options.mode==='auto_plugin'&&result.method==='native'){
return result;
}
if(result.method===''&&mediaFiles.length>0){
result.url=mediaFiles[0].url;
}
return result;
},
formatType:function(url,type){
var ext;
if(url&&!type){
return this.getTypeFromFile(url);
}else{
if(type&&~type.indexOf(';')){
return type.substr(0,type.indexOf(';'));
}else{
return type;
}
}
},
getTypeFromFile:function(url){
url=url.split('?')[0];
var ext=url.substring(url.lastIndexOf('.')+1).toLowerCase();
return(/(mp4|m4v|ogg|ogv|webm|webmv|flv|wmv|mpeg|mov)/gi.test(ext)?'video':'audio')+'/'+this.getTypeFromExtension(ext);
},
getTypeFromExtension:function(ext){
switch(ext){
case'mp4':
case'm4v':
return'mp4';
case'webm':
case'webma':
case'webmv':
return'webm';
case'ogg':
case'oga':
case'ogv':
return'ogg';
default:
return ext;
}
},
createErrorMessage:function(playback,options,poster){
var
htmlMediaElement=playback.htmlMediaElement,
errorContainer=document.createElement('div');
errorContainer.className='me-cannotplay';
try{
errorContainer.style.width=htmlMediaElement.width+'px';
errorContainer.style.height=htmlMediaElement.height+'px';
}catch(e){}
if(options.customError){
errorContainer.innerHTML=options.customError;
}else{
errorContainer.innerHTML=(poster!=='')?
'<a href="'+playback.url+'"><img src="'+poster+'" width="100%" height="100%" /></a>':
'<a href="'+playback.url+'"><span>'+mejs.i18n.t('Download File')+'</span></a>';
}
htmlMediaElement.parentNode.insertBefore(errorContainer,htmlMediaElement);
htmlMediaElement.style.display='none';
options.error(htmlMediaElement);
},
createPlugin:function(playback,options,poster,autoplay,preload,controls){
var
htmlMediaElement=playback.htmlMediaElement,
width=1,
height=1,
pluginid='me_'+playback.method+'_'+(mejs.meIndex++),
pluginMediaElement=new mejs.PluginMediaElement(pluginid,playback.method,playback.url),
container=document.createElement('div'),
specialIEContainer,
node,
initVars;
pluginMediaElement.tagName=htmlMediaElement.tagName
for(var i=0;i<htmlMediaElement.attributes.length;i++){
var attribute=htmlMediaElement.attributes[i];
if(attribute.specified==true){
pluginMediaElement.setAttribute(attribute.name,attribute.value);
}
}
node=htmlMediaElement.parentNode;
while(node!==null&&node.tagName.toLowerCase()!='body'){
if(node.parentNode.tagName.toLowerCase()=='p'){
node.parentNode.parentNode.insertBefore(node,node.parentNode);
break;
}
node=node.parentNode;
}
if(playback.isVideo){
width=(options.pluginWidth>0)?options.pluginWidth:(options.videoWidth>0)?options.videoWidth:(htmlMediaElement.getAttribute('width')!==null)?htmlMediaElement.getAttribute('width'):options.defaultVideoWidth;
height=(options.pluginHeight>0)?options.pluginHeight:(options.videoHeight>0)?options.videoHeight:(htmlMediaElement.getAttribute('height')!==null)?htmlMediaElement.getAttribute('height'):options.defaultVideoHeight;
width=mejs.Utility.encodeUrl(width);
height=mejs.Utility.encodeUrl(height);
}else{
if(options.enablePluginDebug){
width=320;
height=240;
}
}
pluginMediaElement.success=options.success;
mejs.MediaPluginBridge.registerPluginElement(pluginid,pluginMediaElement,htmlMediaElement);
container.className='me-plugin';
container.id=pluginid+'_container';
if(playback.isVideo){
htmlMediaElement.parentNode.insertBefore(container,htmlMediaElement);
}else{
document.body.insertBefore(container,document.body.childNodes[0]);
}
initVars=[
'id='+pluginid,
'isvideo='+((playback.isVideo)?"true":"false"),
'autoplay='+((autoplay)?"true":"false"),
'preload='+preload,
'width='+width,
'startvolume='+options.startVolume,
'timerrate='+options.timerRate,
'flashstreamer='+options.flashStreamer,
'height='+height,
'pseudostreamstart='+options.pseudoStreamingStartQueryParam];
if(playback.url!==null){
if(playback.method=='flash'){
initVars.push('file='+mejs.Utility.encodeUrl(playback.url));
}else{
initVars.push('file='+playback.url);
}
}
if(options.enablePluginDebug){
initVars.push('debug=true');
}
if(options.enablePluginSmoothing){
initVars.push('smoothing=true');
}
if(options.enablePseudoStreaming){
initVars.push('pseudostreaming=true');
}
if(controls){
initVars.push('controls=true')}
if(options.pluginVars){
initVars=initVars.concat(options.pluginVars);
}
switch(playback.method){
case'silverlight':
container.innerHTML=
'<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="'+pluginid+'" name="'+pluginid+'" width="'+width+'" height="'+height+'" class="mejs-shim">'+
'<param name="initParams" value="'+initVars.join(',')+'" />'+
'<param name="windowless" value="true" />'+
'<param name="background" value="black" />'+
'<param name="minRuntimeVersion" value="3.0.0.0" />'+
'<param name="autoUpgrade" value="true" />'+
'<param name="source" value="'+options.pluginPath+options.silverlightName+'" />'+
'</object>';
break;
case'flash':
if(mejs.MediaFeatures.isIE){
specialIEContainer=document.createElement('div');
container.appendChild(specialIEContainer);
specialIEContainer.outerHTML=
'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" '+
'id="'+pluginid+'" width="'+width+'" height="'+height+'" class="mejs-shim">'+
'<param name="movie" value="'+options.pluginPath+options.flashName+'?x='+(new Date())+'" />'+
'<param name="flashvars" value="'+initVars.join('&amp;')+'" />'+
'<param name="quality" value="high" />'+
'<param name="bgcolor" value="#000000" />'+
'<param name="wmode" value="transparent" />'+
'<param name="allowScriptAccess" value="always" />'+
'<param name="allowFullScreen" value="true" />'+
'<param name="scale" value="default" />'+
'</object>';
}else{
container.innerHTML=
'<embed id="'+pluginid+'" name="'+pluginid+'" '+
'play="true" '+
'loop="false" '+
'quality="high" '+
'bgcolor="#000000" '+
'wmode="transparent" '+
'allowScriptAccess="always" '+
'allowFullScreen="true" '+
'type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" '+
'src="'+options.pluginPath+options.flashName+'" '+
'flashvars="'+initVars.join('&')+'" '+
'width="'+width+'" '+
'height="'+height+'" '+
'scale="default"'+
'class="mejs-shim"></embed>';
}
break;
case'youtube':
var
videoId=playback.url.substr(playback.url.lastIndexOf('=')+1);
youtubeSettings={
container:container,
containerId:container.id,
pluginMediaElement:pluginMediaElement,
pluginId:pluginid,
videoId:videoId,
height:height,
width:width
};
if(mejs.PluginDetector.hasPluginVersion('flash',[10,0,0])){
mejs.YouTubeApi.createFlash(youtubeSettings);
}else{
mejs.YouTubeApi.enqueueIframe(youtubeSettings);
}
break;
case'vimeo':
pluginMediaElement.vimeoid=playback.url.substr(playback.url.lastIndexOf('/')+1);
container.innerHTML='<iframe src="http://player.vimeo.com/video/'+pluginMediaElement.vimeoid+'?portrait=0&byline=0&title=0" width="'+width+'" height="'+height+'" frameborder="0" class="mejs-shim"></iframe>';

break;
}
htmlMediaElement.style.display='none';
htmlMediaElement.removeAttribute('autoplay');
return pluginMediaElement;
},
updateNative:function(playback,options,autoplay,preload){
var htmlMediaElement=playback.htmlMediaElement,
m;
for(m in mejs.HtmlMediaElement){
htmlMediaElement[m]=mejs.HtmlMediaElement[m];
}

options.success(htmlMediaElement,htmlMediaElement);
return htmlMediaElement;
}
};

mejs.YouTubeApi={
isIframeStarted:false,
isIframeLoaded:false,
loadIframeApi:function(){
if(!this.isIframeStarted){
var tag=document.createElement('script');
tag.src="//www.youtube.com/player_api";
var firstScriptTag=document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);
this.isIframeStarted=true;
}
},
iframeQueue:[],
enqueueIframe:function(yt){
if(this.isLoaded){
this.createIframe(yt);
}else{
this.loadIframeApi();
this.iframeQueue.push(yt);
}
},
createIframe:function(settings){
var
pluginMediaElement=settings.pluginMediaElement,
player=new YT.Player(settings.containerId,{
height:settings.height,
width:settings.width,
videoId:settings.videoId,
playerVars:{controls:0},
events:{
'onReady':function(){
settings.pluginMediaElement.pluginApi=player;
mejs.MediaPluginBridge.initPlugin(settings.pluginId);
setInterval(function(){
mejs.YouTubeApi.createEvent(player,pluginMediaElement,'timeupdate');
},250);
},
'onStateChange':function(e){
mejs.YouTubeApi.handleStateChange(e.data,player,pluginMediaElement);
}
}
});
},
createEvent:function(player,pluginMediaElement,eventName){
var obj={
type:eventName,
target:pluginMediaElement
};
if(player&&player.getDuration){
pluginMediaElement.currentTime=obj.currentTime=player.getCurrentTime();
pluginMediaElement.duration=obj.duration=player.getDuration();
obj.paused=pluginMediaElement.paused;
obj.ended=pluginMediaElement.ended;
obj.muted=player.isMuted();
obj.volume=player.getVolume()/100;
obj.bytesTotal=player.getVideoBytesTotal();
obj.bufferedBytes=player.getVideoBytesLoaded();
var bufferedTime=obj.bufferedBytes/obj.bytesTotal*obj.duration;
obj.target.buffered=obj.buffered={
start:function(index){
return 0;
},
end:function(index){
return bufferedTime;
},
length:1
};
}
pluginMediaElement.dispatchEvent(obj.type,obj);
},
iFrameReady:function(){
this.isLoaded=true;
this.isIframeLoaded=true;
while(this.iframeQueue.length>0){
var settings=this.iframeQueue.pop();
this.createIframe(settings);
}
},
flashPlayers:{},
createFlash:function(settings){
this.flashPlayers[settings.pluginId]=settings;

var specialIEContainer,
youtubeUrl='//www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid='+settings.pluginId+'&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0';
if(mejs.MediaFeatures.isIE){
specialIEContainer=document.createElement('div');
settings.container.appendChild(specialIEContainer);
specialIEContainer.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" '+
'id="'+settings.pluginId+'" width="'+settings.width+'" height="'+settings.height+'" class="mejs-shim">'+
'<param name="movie" value="'+youtubeUrl+'" />'+
'<param name="wmode" value="transparent" />'+
'<param name="allowScriptAccess" value="always" />'+
'<param name="allowFullScreen" value="true" />'+
'</object>';
}else{
settings.container.innerHTML=
'<object type="application/x-shockwave-flash" id="'+settings.pluginId+'" data="'+youtubeUrl+'" '+
'width="'+settings.width+'" height="'+settings.height+'" style="visibility: visible; " class="mejs-shim">'+
'<param name="allowScriptAccess" value="always">'+
'<param name="wmode" value="transparent">'+
'</object>';
}
},
flashReady:function(id){
var
settings=this.flashPlayers[id],
player=document.getElementById(id),
pluginMediaElement=settings.pluginMediaElement;
pluginMediaElement.pluginApi=
pluginMediaElement.pluginElement=player;
mejs.MediaPluginBridge.initPlugin(id);
player.cueVideoById(settings.videoId);
var callbackName=settings.containerId+'_callback';
window[callbackName]=function(e){
mejs.YouTubeApi.handleStateChange(e,player,pluginMediaElement);
}
player.addEventListener('onStateChange',callbackName);
setInterval(function(){
mejs.YouTubeApi.createEvent(player,pluginMediaElement,'timeupdate');
},250);
},
handleStateChange:function(youTubeState,player,pluginMediaElement){
switch(youTubeState){
case-1:pluginMediaElement.paused=true;
pluginMediaElement.ended=true;
mejs.YouTubeApi.createEvent(player,pluginMediaElement,'loadedmetadata');
break;
case 0:
pluginMediaElement.paused=false;
pluginMediaElement.ended=true;
mejs.YouTubeApi.createEvent(player,pluginMediaElement,'ended');
break;
case 1:
pluginMediaElement.paused=false;
pluginMediaElement.ended=false;
mejs.YouTubeApi.createEvent(player,pluginMediaElement,'play');
mejs.YouTubeApi.createEvent(player,pluginMediaElement,'playing');
break;
case 2:
pluginMediaElement.paused=true;
pluginMediaElement.ended=false;
mejs.YouTubeApi.createEvent(player,pluginMediaElement,'pause');
break;
case 3:mejs.YouTubeApi.createEvent(player,pluginMediaElement,'progress');
break;
case 5:
break;
}
}
}
function onYouTubePlayerAPIReady(){
mejs.YouTubeApi.iFrameReady();
}
function onYouTubePlayerReady(id){
mejs.YouTubeApi.flashReady(id);
}
window.mejs=mejs;
window.MediaElement=mejs.MediaElement;

;(function(context,exports,undefined){
"use strict";
var i18n={
"locale":{
"language":'',
"strings":{}
},
"methods":{}
};

i18n.getLanguage=function(){
var language=i18n.locale.language||window.navigator.userLanguage||window.navigator.language;
return language.substr(0,2).toLowerCase();
};
if(typeof mejsL10n!='undefined'){
i18n.locale.language=mejsL10n.language;
}

i18n.methods.checkPlain=function(str){
var character,regex,
replace={
'&':'&amp;',
'"':'&quot;',
'<':'&lt;',
'>':'&gt;'
};
str=String(str);
for(character in replace){
if(replace.hasOwnProperty(character)){
regex=new RegExp(character,'g');
str=str.replace(regex,replace[character]);
}
}
return str;
};

i18n.methods.t=function(str,options){
if(i18n.locale.strings&&i18n.locale.strings[options.context]&&i18n.locale.strings[options.context][str]){
str=i18n.locale.strings[options.context][str];
}
return i18n.methods.checkPlain(str);
};

i18n.t=function(str,options){
if(typeof str==='string'&&str.length>0){
var language=i18n.getLanguage();
options=options||{
"context":language
};
return i18n.methods.t(str,options);
}
else{
throw{
"name":'InvalidArgumentException',
"message":'First argument is either not a string or empty.'
};
}
};
exports.i18n=i18n;
}(document,mejs));
;(function(exports,undefined){
"use strict";
if(typeof mejsL10n!='undefined'){
exports[mejsL10n.language]=mejsL10n.strings;
}
}(mejs.i18n.locale.strings));

;(function(exports,undefined){
"use strict";
if(typeof exports.de==='undefined'){
exports.de={
"Fullscreen":"Fullscreen",
"Go Fullscreen":"Fullscreen on",
"Turn off Fullscreen":"Fullscreen off",
"Close":"Schließen"
};
}
}(mejs.i18n.locale.strings));

;(function(exports,undefined){
"use strict";
if(typeof exports.zh==='undefined'){
exports.zh={
"Fullscreen":"全螢幕",
"Go Fullscreen":"全屏模式",
"Turn off Fullscreen":"退出全屏模式",
"Close":"關閉"
};
}
}(mejs.i18n.locale.strings));

if(typeof jQuery!='undefined'){
mejs.$=jQuery;
}else if(typeof ender!='undefined'){
mejs.$=ender;
}
(function($){
mejs.MepDefaults={
poster:'',
showPosterWhenEnded:false,
defaultVideoWidth:480,
defaultVideoHeight:270,
videoWidth:-1,
videoHeight:-1,
defaultAudioWidth:400,
defaultAudioHeight:30,
defaultSeekBackwardInterval:function(media){
return(media.duration*0.05);
},
defaultSeekForwardInterval:function(media){
return(media.duration*0.05);
},
audioWidth:-1,
audioHeight:-1,
startVolume:0.8,
loop:false,
autoRewind:true,
enableAutosize:true,
alwaysShowHours:false,
showTimecodeFrameCount:false,
framesPerSecond:25,
autosizeProgress:true,
alwaysShowControls:false,
hideVideoControlsOnLoad:false,
clickToPlayPause:true,
iPadUseNativeControls:false,
iPhoneUseNativeControls:false,
AndroidUseNativeControls:false,
features:['playpause','current','progress','duration','tracks','volume','fullscreen'],
isVideo:true,
enableKeyboard:true,
pauseOtherPlayers:true,
keyActions:[
{
keys:[
32,179],
action:function(player,media){
if(media.paused||media.ended){
player.play();
}else{
player.pause();
}
}
},
{
keys:[38],action:function(player,media){
var newVolume=Math.min(media.volume+0.1,1);
media.setVolume(newVolume);
}
},
{
keys:[40],action:function(player,media){
var newVolume=Math.max(media.volume-0.1,0);
media.setVolume(newVolume);
}
},
{
keys:[
37,227],
action:function(player,media){
if(!isNaN(media.duration)&&media.duration>0){
if(player.isVideo){
player.showControls();
player.startControlsTimer();
}
var newTime=Math.max(media.currentTime-player.options.defaultSeekBackwardInterval(media),0);
media.setCurrentTime(newTime);
}
}
},
{
keys:[
39,228],
action:function(player,media){
if(!isNaN(media.duration)&&media.duration>0){
if(player.isVideo){
player.showControls();
player.startControlsTimer();
}
var newTime=Math.min(media.currentTime+player.options.defaultSeekForwardInterval(media),media.duration);
media.setCurrentTime(newTime);
}
}
},
{
keys:[70],action:function(player,media){
if(typeof player.enterFullScreen!='undefined'){
if(player.isFullScreen){
player.exitFullScreen();
}else{
player.enterFullScreen();
}
}
}
}
]
};
mejs.mepIndex=0;
mejs.players={};
mejs.MediaElementPlayer=function(node,o){
if(!(this instanceof mejs.MediaElementPlayer)){
return new mejs.MediaElementPlayer(node,o);
}
var t=this;
t.$media=t.$node=$(node);
t.node=t.media=t.$media[0];
if(typeof t.node.player!='undefined'){
return t.node.player;
}else{
t.node.player=t;
}
if(typeof o=='undefined'){
o=t.$node.data('mejsoptions');
}
t.options=$.extend({},mejs.MepDefaults,o);
t.id='mep_'+mejs.mepIndex++;
mejs.players[t.id]=t;
t.init();
return t;
};
mejs.MediaElementPlayer.prototype={
hasFocus:false,
controlsAreVisible:true,
init:function(){
var
t=this,
mf=mejs.MediaFeatures,
meOptions=$.extend(true,{},t.options,{
success:function(media,domNode){t.meReady(media,domNode)},
error:function(e){t.handleError(e)}
}),
tagName=t.media.tagName.toLowerCase();
t.isDynamic=(tagName!=='audio'&&tagName!=='video');
if(t.isDynamic){
t.isVideo=t.options.isVideo;
}else{
t.isVideo=(tagName!=='audio'&&t.options.isVideo);
}
if((mf.isiPad&&t.options.iPadUseNativeControls)||(mf.isiPhone&&t.options.iPhoneUseNativeControls)){
t.$media.attr('controls','controls');
if(mf.isiPad&&t.media.getAttribute('autoplay')!==null){
t.play();
}
}else if(mf.isAndroid&&t.options.AndroidUseNativeControls){
}else{
t.$media.removeAttr('controls');
t.container=
$('<div id="'+t.id+'" class="mejs-container '+(mejs.MediaFeatures.svg?'svg':'no-svg')+'">'+
'<div class="mejs-inner">'+
'<div class="mejs-mediaelement"></div>'+
'<div class="mejs-layers"></div>'+
'<div class="mejs-controls"></div>'+
'<div class="mejs-clear"></div>'+
'</div>'+
'</div>')
.addClass(t.$media[0].className)
.insertBefore(t.$media);
t.container.addClass(
(mf.isAndroid?'mejs-android ':'')+
(mf.isiOS?'mejs-ios ':'')+
(mf.isiPad?'mejs-ipad ':'')+
(mf.isiPhone?'mejs-iphone ':'')+
(t.isVideo?'mejs-video ':'mejs-audio ')
);
if(mf.isiOS){
var $newMedia=t.$media.clone();
t.container.find('.mejs-mediaelement').append($newMedia);
t.$media.remove();
t.$node=t.$media=$newMedia;
t.node=t.media=$newMedia[0]
}else{
t.container.find('.mejs-mediaelement').append(t.$media);
}
t.controls=t.container.find('.mejs-controls');
t.layers=t.container.find('.mejs-layers');

var tagType=(t.isVideo?'video':'audio'),
capsTagName=tagType.substring(0,1).toUpperCase()+tagType.substring(1);
if(t.options[tagType+'Width']>0||t.options[tagType+'Width'].toString().indexOf('%')>-1){
t.width=t.options[tagType+'Width'];
}else if(t.media.style.width!==''&&t.media.style.width!==null){
t.width=t.media.style.width;
}else if(t.media.getAttribute('width')!==null){
t.width=t.$media.attr('width');
}else{
t.width=t.options['default'+capsTagName+'Width'];
}
if(t.options[tagType+'Height']>0||t.options[tagType+'Height'].toString().indexOf('%')>-1){
t.height=t.options[tagType+'Height'];
}else if(t.media.style.height!==''&&t.media.style.height!==null){
t.height=t.media.style.height;
}else if(t.$media[0].getAttribute('height')!==null){
t.height=t.$media.attr('height');
}else{
t.height=t.options['default'+capsTagName+'Height'];
}
t.setPlayerSize(t.width,t.height);
meOptions.pluginWidth=t.width;
meOptions.pluginHeight=t.height;
}
mejs.MediaElement(t.$media[0],meOptions);
if(typeof(t.container)!='undefined'&&t.controlsAreVisible){
t.container.trigger('controlsshown');
}
},
showControls:function(doAnimation){
var t=this;
doAnimation=typeof doAnimation=='undefined'||doAnimation;
if(t.controlsAreVisible)
return;
if(doAnimation){
t.controls
.css('visibility','visible')
.stop(true,true).fadeIn(200,function(){
t.controlsAreVisible=true;
t.container.trigger('controlsshown');
});
t.container.find('.mejs-control')
.css('visibility','visible')
.stop(true,true).fadeIn(200,function(){t.controlsAreVisible=true});
}else{
t.controls
.css('visibility','visible')
.css('display','block');
t.container.find('.mejs-control')
.css('visibility','visible')
.css('display','block');
t.controlsAreVisible=true;
t.container.trigger('controlsshown');
}
t.setControlsSize();
},
hideControls:function(doAnimation){
var t=this;
doAnimation=typeof doAnimation=='undefined'||doAnimation;
if(!t.controlsAreVisible||t.options.alwaysShowControls)
return;
if(doAnimation){
t.controls.stop(true,true).fadeOut(200,function(){
$(this)
.css('visibility','hidden')
.css('display','block');
t.controlsAreVisible=false;
t.container.trigger('controlshidden');
});
t.container.find('.mejs-control').stop(true,true).fadeOut(200,function(){
$(this)
.css('visibility','hidden')
.css('display','block');
});
}else{
t.controls
.css('visibility','hidden')
.css('display','block');
t.container.find('.mejs-control')
.css('visibility','hidden')
.css('display','block');
t.controlsAreVisible=false;
t.container.trigger('controlshidden');
}
},
controlsTimer:null,
startControlsTimer:function(timeout){
var t=this;
timeout=typeof timeout!='undefined'?timeout:1500;
t.killControlsTimer('start');
t.controlsTimer=setTimeout(function(){
t.hideControls();
t.killControlsTimer('hide');
},timeout);
},
killControlsTimer:function(src){
var t=this;
if(t.controlsTimer!==null){
clearTimeout(t.controlsTimer);
delete t.controlsTimer;
t.controlsTimer=null;
}
},
controlsEnabled:true,
disableControls:function(){
var t=this;
t.killControlsTimer();
t.hideControls(false);
this.controlsEnabled=false;
},
enableControls:function(){
var t=this;
t.showControls(false);
t.controlsEnabled=true;
},
meReady:function(media,domNode){
var t=this,
mf=mejs.MediaFeatures,
autoplayAttr=domNode.getAttribute('autoplay'),
autoplay=!(typeof autoplayAttr=='undefined'||autoplayAttr===null||autoplayAttr==='false'),
featureIndex,
feature;
if(t.created){
return;
}else{
t.created=true;
}
t.media=media;
t.domNode=domNode;
if(!(mf.isAndroid&&t.options.AndroidUseNativeControls)&&!(mf.isiPad&&t.options.iPadUseNativeControls)&&!(mf.isiPhone&&t.options.iPhoneUseNativeControls)){
t.buildposter(t,t.controls,t.layers,t.media);
t.buildkeyboard(t,t.controls,t.layers,t.media);
t.buildoverlays(t,t.controls,t.layers,t.media);
t.findTracks();
for(featureIndex in t.options.features){
feature=t.options.features[featureIndex];
if(t['build'+feature]){
try{
t['build'+feature](t,t.controls,t.layers,t.media);
}catch(e){
}
}
}
t.container.trigger('controlsready');
t.setPlayerSize(t.width,t.height);
t.setControlsSize();
if(t.isVideo){
if(mejs.MediaFeatures.hasTouch){
t.$media.bind('touchstart',function(){
if(t.controlsAreVisible){
t.hideControls(false);
}else{
if(t.controlsEnabled){
t.showControls(false);
}
}
});
}else{
mejs.MediaElementPlayer.prototype.clickToPlayPauseCallback=function(){
if(t.options.clickToPlayPause){
if(t.media.paused){
t.play();
}else{
t.pause();
}
}
};
t.media.addEventListener('click',t.clickToPlayPauseCallback,false);
t.container
.bind('mouseenter mouseover',function(){
if(t.controlsEnabled){
if(!t.options.alwaysShowControls){
t.killControlsTimer('enter');
t.showControls();
t.startControlsTimer(2500);
}
}
})
.bind('mousemove',function(){
if(t.controlsEnabled){
if(!t.controlsAreVisible){
t.showControls();
}
if(!t.options.alwaysShowControls){
t.startControlsTimer(2500);
}
}
})
.bind('mouseleave',function(){
if(t.controlsEnabled){
if(!t.media.paused&&!t.options.alwaysShowControls){
t.startControlsTimer(1000);
}
}
});
}
if(t.options.hideVideoControlsOnLoad){
t.hideControls(false);
}
if(autoplay&&!t.options.alwaysShowControls){
t.hideControls();
}
if(t.options.enableAutosize){
t.media.addEventListener('loadedmetadata',function(e){
if(t.options.videoHeight<=0&&t.domNode.getAttribute('height')===null&&!isNaN(e.target.videoHeight)){
t.setPlayerSize(e.target.videoWidth,e.target.videoHeight);
t.setControlsSize();
t.media.setVideoSize(e.target.videoWidth,e.target.videoHeight);
}
},false);
}
}
media.addEventListener('play',function(){
var playerIndex;
for(playerIndex in mejs.players){
var p=mejs.players[playerIndex];
if(p.id!=t.id&&t.options.pauseOtherPlayers&&!p.paused&&!p.ended){
p.pause();
}
p.hasFocus=false;
}
t.hasFocus=true;
},false);
t.media.addEventListener('ended',function(e){
if(t.options.autoRewind){
try{
t.media.setCurrentTime(0);
}catch(exp){
}
}
t.media.pause();
if(t.setProgressRail){
t.setProgressRail();
}
if(t.setCurrentRail){
t.setCurrentRail();
}
if(t.options.loop){
t.play();
}else if(!t.options.alwaysShowControls&&t.controlsEnabled){
t.showControls();
}
},false);
t.media.addEventListener('loadedmetadata',function(e){
if(t.updateDuration){
t.updateDuration();
}
if(t.updateCurrent){
t.updateCurrent();
}
if(!t.isFullScreen){
t.setPlayerSize(t.width,t.height);
t.setControlsSize();
}
},false);
setTimeout(function(){
t.setPlayerSize(t.width,t.height);
t.setControlsSize();
},50);
t.globalBind('resize',function(){
if(!(t.isFullScreen||(mejs.MediaFeatures.hasTrueNativeFullScreen&&document.webkitIsFullScreen))){
t.setPlayerSize(t.width,t.height);
}
t.setControlsSize();
});
if(t.media.pluginType=='youtube'){
t.container.find('.mejs-overlay-play').hide();
}
}
if(autoplay&&media.pluginType=='native'){
t.play();
}
if(t.options.success){
if(typeof t.options.success=='string'){
window[t.options.success](t.media,t.domNode,t);
}else{
t.options.success(t.media,t.domNode,t);
}
}
},
handleError:function(e){
var t=this;
t.controls.hide();
if(t.options.error){
t.options.error(e);
}
},
setPlayerSize:function(width,height){
var t=this;
if(typeof width!='undefined'){
t.width=width;
}
if(typeof height!='undefined'){
t.height=height;
}
if(t.height.toString().indexOf('%')>0||t.$node.css('max-width')==='100%'||parseInt(t.$node.css('max-width').replace(/px/,''),10)/t.$node.offsetParent().width()===1||(t.$node[0].currentStyle&&t.$node[0].currentStyle.maxWidth==='100%')){
var
nativeWidth=t.isVideo?((t.media.videoWidth&&t.media.videoWidth>0)?t.media.videoWidth:t.options.defaultVideoWidth):t.options.defaultAudioWidth,
nativeHeight=t.isVideo?((t.media.videoHeight&&t.media.videoHeight>0)?t.media.videoHeight:t.options.defaultVideoHeight):t.options.defaultAudioHeight,
parentWidth=t.container.parent().closest(':visible').width(),
newHeight=t.isVideo||!t.options.autosizeProgress?parseInt(parentWidth*nativeHeight/nativeWidth,10):nativeHeight;
if(t.container.parent()[0].tagName.toLowerCase()==='body'){parentWidth=$(window).width();
newHeight=$(window).height();
}
if(newHeight!=0&&parentWidth!=0){
t.container
.width(parentWidth)
.height(newHeight);
t.$media.add(t.container.find('.mejs-shim'))
.width('100%')
.height('100%');
if(t.isVideo){
if(t.media.setVideoSize){
t.media.setVideoSize(parentWidth,newHeight);
}
}
t.layers.children('.mejs-layer')
.width('100%')
.height('100%');
}
}else{
t.container
.width(t.width)
.height(t.height);
t.layers.children('.mejs-layer')
.width(t.width)
.height(t.height);
}
var playLayer=t.layers.find('.mejs-overlay-play'),
playButton=playLayer.find('.mejs-overlay-button');
playLayer.height(t.container.height()-t.controls.height());
playButton.css('margin-top','-'+(playButton.height()/2-t.controls.height()/2).toString()+'px');
},
setControlsSize:function(){
var t=this,
usedWidth=0,
railWidth=0,
rail=t.controls.find('.mejs-time-rail'),
total=t.controls.find('.mejs-time-total'),
current=t.controls.find('.mejs-time-current'),
loaded=t.controls.find('.mejs-time-loaded'),
others=rail.siblings();
if(t.options&&!t.options.autosizeProgress){
railWidth=parseInt(rail.css('width'));
}
if(railWidth===0||!railWidth){
others.each(function(){
var $this=$(this);
if($this.css('position')!='absolute'&&$this.is(':visible')){
usedWidth+=$(this).outerWidth(true);
}
});
railWidth=t.controls.width()-usedWidth-(rail.outerWidth(true)-rail.width());
}
rail.width(railWidth);
total.width(railWidth-(total.outerWidth(true)-total.width()));
if(t.setProgressRail)
t.setProgressRail();
if(t.setCurrentRail)
t.setCurrentRail();
},
buildposter:function(player,controls,layers,media){
var t=this,
poster=
$('<div class="mejs-poster mejs-layer">'+
'</div>')
.appendTo(layers),
posterUrl=player.$media.attr('poster');
if(player.options.poster!==''){
posterUrl=player.options.poster;
}
if(posterUrl!==''&&posterUrl!=null){
t.setPoster(posterUrl);
}else{
poster.hide();
}
media.addEventListener('play',function(){
poster.hide();
},false);
if(player.options.showPosterWhenEnded&&player.options.autoRewind){
media.addEventListener('ended',function(){
poster.show();
},false);
}
},
setPoster:function(url){
var t=this,
posterDiv=t.container.find('.mejs-poster'),
posterImg=posterDiv.find('img');
if(posterImg.length==0){
posterImg=$('<img width="100%" height="100%" />').appendTo(posterDiv);
}
posterImg.attr('src',url);
posterDiv.css({'background-image':'url('+url+')'});
},
buildoverlays:function(player,controls,layers,media){
var t=this;
if(!player.isVideo)
return;
var
loading=
$('<div class="mejs-overlay mejs-layer">'+
'<div class="mejs-overlay-loading"><span></span></div>'+
'</div>')
.hide().appendTo(layers),
error=
$('<div class="mejs-overlay mejs-layer">'+
'<div class="mejs-overlay-error"></div>'+
'</div>')
.hide().appendTo(layers),
bigPlay=
$('<div class="mejs-overlay mejs-layer mejs-overlay-play">'+
'<div class="mejs-overlay-button"></div>'+
'</div>')
.appendTo(layers)
.bind('click touchstart',function(){
if(t.options.clickToPlayPause){
if(media.paused){
t.play();
}
}
});

media.addEventListener('play',function(){
bigPlay.hide();
loading.hide();
controls.find('.mejs-time-buffering').hide();
error.hide();
},false);
media.addEventListener('playing',function(){
bigPlay.hide();
loading.hide();
controls.find('.mejs-time-buffering').hide();
error.hide();
},false);
media.addEventListener('seeking',function(){
loading.show();
controls.find('.mejs-time-buffering').show();
},false);
media.addEventListener('seeked',function(){
loading.hide();
controls.find('.mejs-time-buffering').hide();
},false);
media.addEventListener('pause',function(){
if(!mejs.MediaFeatures.isiPhone){
bigPlay.show();
}
},false);
media.addEventListener('waiting',function(){
loading.show();
controls.find('.mejs-time-buffering').show();
},false);
media.addEventListener('loadeddata',function(){
loading.show();
controls.find('.mejs-time-buffering').show();
},false);
media.addEventListener('canplay',function(){
loading.hide();
controls.find('.mejs-time-buffering').hide();
},false);
media.addEventListener('error',function(){
loading.hide();
controls.find('.mejs-time-buffering').hide();
error.show();
error.find('mejs-overlay-error').html("Error loading this resource");
},false);
},
buildkeyboard:function(player,controls,layers,media){
var t=this;
t.globalBind('keydown',function(e){
if(player.hasFocus&&player.options.enableKeyboard){
for(var i=0,il=player.options.keyActions.length;i<il;i++){
var keyAction=player.options.keyActions[i];
for(var j=0,jl=keyAction.keys.length;j<jl;j++){
if(e.keyCode==keyAction.keys[j]){
e.preventDefault();
keyAction.action(player,media,e.keyCode);
return false;
}
}
}
}
return true;
});
t.globalBind('click',function(event){
if($(event.target).closest('.mejs-container').length==0){
player.hasFocus=false;
}
});
},
findTracks:function(){
var t=this,
tracktags=t.$media.find('track');
t.tracks=[];
tracktags.each(function(index,track){
track=$(track);
t.tracks.push({
srclang:(track.attr('srclang'))?track.attr('srclang').toLowerCase():'',
src:track.attr('src'),
kind:track.attr('kind'),
label:track.attr('label')||'',
entries:[],
isLoaded:false
});
});
},
changeSkin:function(className){
this.container[0].className='mejs-container '+className;
this.setPlayerSize(this.width,this.height);
this.setControlsSize();
},
play:function(){
this.load();
this.media.play();
},
pause:function(){
try{
this.media.pause();
}catch(e){}
},
load:function(){
if(!this.isLoaded){
this.media.load();
}
this.isLoaded=true;
},
setMuted:function(muted){
this.media.setMuted(muted);
},
setCurrentTime:function(time){
this.media.setCurrentTime(time);
},
getCurrentTime:function(){
return this.media.currentTime;
},
setVolume:function(volume){
this.media.setVolume(volume);
},
getVolume:function(){
return this.media.volume;
},
setSrc:function(src){
this.media.setSrc(src);
},
remove:function(){
var t=this,featureIndex,feature;
for(featureIndex in t.options.features){
feature=t.options.features[featureIndex];
if(t['clean'+feature]){
try{
t['clean'+feature](t);
}catch(e){
}
}
}
if(!t.isDynamic){
t.$media.prop('controls',true);
t.$node.clone().show().insertBefore(t.container);
t.$node.remove();
}else{
t.$node.insertBefore(t.container);
}
if(t.media.pluginType!=='native'){
t.media.remove();
}
delete mejs.players[t.id];
t.container.remove();
t.globalUnbind();
delete t.node.player;
}
};
(function(){
var rwindow=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;
function splitEvents(events,id){
var ret={d:[],w:[]};
$.each((events||'').split(' '),function(k,v){
var eventname=v+'.'+id;
if(eventname.indexOf('.')===0){
ret.d.push(eventname);
ret.w.push(eventname);
}
else{
ret[rwindow.test(v)?'w':'d'].push(eventname);
}
});
ret.d=ret.d.join(' ');
ret.w=ret.w.join(' ');
return ret;
}
mejs.MediaElementPlayer.prototype.globalBind=function(events,data,callback){
var t=this;
events=splitEvents(events,t.id);
if(events.d)$(document).bind(events.d,data,callback);
if(events.w)$(window).bind(events.w,data,callback);
};
mejs.MediaElementPlayer.prototype.globalUnbind=function(events,callback){
var t=this;
events=splitEvents(events,t.id);
if(events.d)$(document).unbind(events.d,callback);
if(events.w)$(window).unbind(events.w,callback);
};
})();
if(typeof jQuery!='undefined'){
jQuery.fn.mediaelementplayer=function(options){
if(options===false){
this.each(function(){
var player=jQuery(this).data('mediaelementplayer');
if(player){
player.remove();
}
jQuery(this).removeData('mediaelementplayer');
});
}
else{
this.each(function(){
jQuery(this).data('mediaelementplayer',new mejs.MediaElementPlayer(this,options));
});
}
return this;
};
}
$(document).ready(function(){
$('.mejs-player').mediaelementplayer();
});
window.MediaElementPlayer=mejs.MediaElementPlayer;
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
playpauseText:mejs.i18n.t('Play/Pause')
});
$.extend(MediaElementPlayer.prototype,{
buildplaypause:function(player,controls,layers,media){
var
t=this,
play=
$('<div class="mejs-button mejs-playpause-button mejs-play" >'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.playpauseText+'" aria-label="'+t.options.playpauseText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
if($(this).find("button").css("opacity")!=1){return}e.preventDefault();
if(media.paused){
media.play();
}else{
media.pause();
}
return false;
});
media.addEventListener('play',function(){
play.removeClass('mejs-play').addClass('mejs-pause');
},false);
media.addEventListener('playing',function(){
play.removeClass('mejs-play').addClass('mejs-pause');
},false);
media.addEventListener('pause',function(){
play.removeClass('mejs-pause').addClass('mejs-play');
},false);
media.addEventListener('paused',function(){
play.removeClass('mejs-pause').addClass('mejs-play');
},false);
}
});
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
stopText:'Stop'
});
$.extend(MediaElementPlayer.prototype,{
buildstop:function(player,controls,layers,media){
var t=this,
stop=
$('<div class="mejs-button mejs-stop-button mejs-stop">'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.stopText+'" aria-label="'+t.options.stopText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(){
if(!media.paused){
media.pause();
}
if(media.currentTime>0){
media.setCurrentTime(0);
media.pause();
controls.find('.mejs-time-current').width('0px');
controls.find('.mejs-time-handle').css('left','0px');
controls.find('.mejs-time-float-current').html(mejs.Utility.secondsToTimeCode(0));
controls.find('.mejs-currenttime').html(mejs.Utility.secondsToTimeCode(0));
layers.find('.mejs-poster').show();
}
});
}
});
})(mejs.$);
(function($){
$.extend(MediaElementPlayer.prototype,{
buildprogress:function(player,controls,layers,media){
$('<div class="mejs-time-rail">'+
'<span class="mejs-time-total">'+
'<span class="mejs-time-buffering"></span>'+
'<span class="mejs-time-loaded"></span>'+
'<span class="mejs-time-current"></span>'+
'<span class="mejs-time-handle"></span>'+
'<span class="mejs-time-float">'+
'<span class="mejs-time-float-current">00:00</span>'+
'<span class="mejs-time-float-corner"></span>'+
'</span>'+
'</span>'+
'</div>')
.appendTo(controls);
controls.find('.mejs-time-buffering').hide();
var
t=this,
total=controls.find('.mejs-time-total'),
loaded=controls.find('.mejs-time-loaded'),
current=controls.find('.mejs-time-current'),
handle=controls.find('.mejs-time-handle'),
timefloat=controls.find('.mejs-time-float'),
timefloatcurrent=controls.find('.mejs-time-float-current'),
handleMouseMove=function(e){
var x=e.pageX,
offset=total.offset(),
width=total.outerWidth(true)*MediaElementPlayer.prototype.extoptions.scale/1.023,percentage=0,
newTime=0,
pos=0;
if(media.duration){
if(x<offset.left){
x=offset.left;
}else if(x>width+offset.left){
x=width+offset.left;
}
pos=x-offset.left;
percentage=(pos/width);
newTime=(percentage<=0.02)?0:percentage*media.duration;
if(mouseIsDown&&newTime!==media.currentTime){
media.setCurrentTime(newTime);
}
if(MediaElementPlayer.prototype.extoptions.displayBox&&!mejs.MediaFeatures.hasTouch){timefloat.css('left',pos);
timefloatcurrent.html(mejs.Utility.secondsToTimeCode(newTime));
timefloat.show();
}
}
},
mouseIsDown=false,
mouseIsOver=false;
total
.bind('mousedown',function(e){
if(e.which===1){
mouseIsDown=true;
handleMouseMove(e);
t.globalBind('mousemove.dur',function(e){
handleMouseMove(e);
});
t.globalBind('mouseup.dur',function(e){
mouseIsDown=false;
timefloat.hide();
t.globalUnbind('.dur');
});
return false;
}
})
.bind('mouseenter',function(e){
mouseIsOver=true;
t.globalBind('mousemove.dur',function(e){
handleMouseMove(e);
});
if(MediaElementPlayer.prototype.extoptions.displayBox&&!mejs.MediaFeatures.hasTouch){timefloat.show();
}
})
.bind('mouseleave',function(e){
mouseIsOver=false;
if(!mouseIsDown){
t.globalUnbind('.dur');
timefloat.hide();
}
});
media.addEventListener('progress',function(e){
player.setProgressRail(e);
player.setCurrentRail(e);
},false);
media.addEventListener('timeupdate',function(e){
player.setProgressRail(e);
player.setCurrentRail(e);
},false);
t.loaded=loaded;
t.total=total;
t.current=current;
t.handle=handle;
},
setProgressRail:function(e){
var
t=this,
target=(e!=undefined)?e.target:t.media,
percent=null;
if(target&&target.buffered&&target.buffered.length>0&&target.buffered.end&&target.duration){
percent=target.buffered.end(0)/target.duration;
}
else if(target&&target.bytesTotal!=undefined&&target.bytesTotal>0&&target.bufferedBytes!=undefined){
percent=target.bufferedBytes/target.bytesTotal;
}
else if(e&&e.lengthComputable&&e.total!=0){
percent=e.loaded/e.total;
}
if(percent!==null){
percent=Math.min(1,Math.max(0,percent));
if(t.loaded&&t.total){
t.loaded.width(t.total.width()*percent);
}
}
return percent},
setCurrentRail:function(){
var t=this;
if(t.media.currentTime!=undefined&&t.media.duration){
if(t.total&&t.handle){
var
newWidth=Math.round(t.total.width()*t.media.currentTime/t.media.duration),
handlePos=newWidth-Math.round(t.handle.outerWidth(true)/2);
t.current.width(newWidth);
t.handle.css('left',handlePos);
}
}
}
});
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
duration:-1,
timeAndDurationSeparator:'<span> | </span>'
});
$.extend(MediaElementPlayer.prototype,{
buildcurrent:function(player,controls,layers,media){
var t=this;
$('<div class="mejs-time">'+
'<span class="mejs-currenttime">'+(player.options.alwaysShowHours?'00:':'')
+(player.options.showTimecodeFrameCount?'00:00:00':'00:00')+'</span>'+
'</div>')
.appendTo(controls);
t.currenttime=t.controls.find('.mejs-currenttime');
media.addEventListener('timeupdate',function(){
player.updateCurrent();
},false);
},
buildduration:function(player,controls,layers,media){
var t=this;
if(controls.children().last().find('.mejs-currenttime').length>0){
$(t.options.timeAndDurationSeparator+
'<span class="mejs-duration">'+
(t.options.duration>0?
mejs.Utility.secondsToTimeCode(t.options.duration,t.options.alwaysShowHours||t.media.duration>3600,t.options.showTimecodeFrameCount,t.options.framesPerSecond||25):
((player.options.alwaysShowHours?'00:':'')+(player.options.showTimecodeFrameCount?'00:00:00':'00:00'))
)+
'</span>')
.appendTo(controls.find('.mejs-time'));
}else{
controls.find('.mejs-currenttime').parent().addClass('mejs-currenttime-container');
$('<div class="mejs-time mejs-duration-container">'+
'<span class="mejs-duration">'+
(t.options.duration>0?
mejs.Utility.secondsToTimeCode(t.options.duration,t.options.alwaysShowHours||t.media.duration>3600,t.options.showTimecodeFrameCount,t.options.framesPerSecond||25):
((player.options.alwaysShowHours?'00:':'')+(player.options.showTimecodeFrameCount?'00:00:00':'00:00'))
)+
'</span>'+
'</div>')
.appendTo(controls);
}
t.durationD=t.controls.find('.mejs-duration');
media.addEventListener('timeupdate',function(){
player.updateDuration();
},false);
},
updateCurrent:function(){
var t=this;
if(t.currenttime){
t.currenttime.html(mejs.Utility.secondsToTimeCode(t.media.currentTime,t.options.alwaysShowHours||t.media.duration>3600,t.options.showTimecodeFrameCount,t.options.framesPerSecond||25));
}
},
updateDuration:function(){
var t=this;
t.container.toggleClass("mejs-long-video",t.media.duration>3600);
if(t.durationD&&(t.options.duration>0||t.media.duration)){
t.durationD.html(mejs.Utility.secondsToTimeCode(t.options.duration>0?t.options.duration:t.media.duration,t.options.alwaysShowHours,t.options.showTimecodeFrameCount,t.options.framesPerSecond||25));
}
}
});
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
muteText:mejs.i18n.t('Mute Toggle'),
hideVolumeOnTouchDevices:true,
audioVolume:'horizontal',
videoVolume:'vertical'
});
$.extend(MediaElementPlayer.prototype,{
buildvolume:function(player,controls,layers,media){
var extraStyle=""
if(mejs.MediaFeatures.hasTouch&&this.options.hideVolumeOnTouchDevices)
extraStyle='style="opacity:0.6;"';
var t=this,
mode=(t.isVideo)?t.options.videoVolume:t.options.audioVolume,
mute=(mode=='horizontal')?
$('<div class="mejs-button mejs-volume-button mejs-mute" '+extraStyle+'>'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.muteText+'" aria-label="'+t.options.muteText+'"></button>'+
'</div>'+
'<div class="mejs-horizontal-volume-slider">'+'<div class="mejs-horizontal-volume-total"></div>'+'<div class="mejs-horizontal-volume-current"></div>'+'<div class="mejs-horizontal-volume-handle"></div>'+'</div>'
)
.appendTo(controls):
$('<div class="mejs-button mejs-volume-button mejs-mute" '+extraStyle+'>'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.muteText+'" aria-label="'+t.options.muteText+'"></button>'+
'<div class="mejs-volume-slider">'+'<div class="mejs-volume-total"></div>'+'<div class="mejs-volume-current"></div>'+'<div class="mejs-volume-handle"></div>'+'</div>'+
'</div>')
.appendTo(controls),
volumeSlider=t.container.find('.mejs-volume-slider, .mejs-horizontal-volume-slider'),
volumeTotal=t.container.find('.mejs-volume-total, .mejs-horizontal-volume-total'),
volumeCurrent=t.container.find('.mejs-volume-current, .mejs-horizontal-volume-current'),
volumeHandle=t.container.find('.mejs-volume-handle, .mejs-horizontal-volume-handle'),
positionVolumeHandle=function(volume,secondTry){
if(!volumeSlider.is(':visible')&&typeof secondTry=='undefined'){
volumeSlider.show();
positionVolumeHandle(volume,true);
volumeSlider.hide()
return;
}
volume=Math.max(0,volume);
volume=Math.min(volume,1);
if(volume==0){
mute.removeClass('mejs-mute').addClass('mejs-unmute');
}else{
mute.removeClass('mejs-unmute').addClass('mejs-mute');
}
if(mode=='vertical'){
var
totalHeight=volumeTotal.height(),
totalPosition=volumeTotal.position(),
newTop=totalHeight-(totalHeight*volume);
volumeHandle.css('top',Math.round(totalPosition.top+newTop-(volumeHandle.height()/2)));
volumeCurrent.height(totalHeight-newTop);
volumeCurrent.css('top',totalPosition.top+newTop);
}else{
var
totalWidth=volumeTotal.width(),
totalPosition=volumeTotal.position(),
newLeft=totalWidth*volume;
volumeHandle.css('left',Math.round(totalPosition.left+newLeft-(volumeHandle.width()/2)));
volumeCurrent.width(Math.round(newLeft));
}
},
handleVolumeMove=function(e){
var volume=null,
totalOffset=volumeTotal.offset();
if(mode=='vertical'){
var
railHeight=volumeTotal.height()*MediaElementPlayer.prototype.extoptions.scale/1.023,totalTop=parseInt(volumeTotal.css('top').replace(/px/,''),10),
newY=e.pageY-totalOffset.top;
volume=(railHeight-newY)/railHeight;
if(totalOffset.top==0||totalOffset.left==0)
return;
}else{
var
railWidth=volumeTotal.width(),
newX=e.pageX-totalOffset.left;
volume=newX/railWidth;
}
volume=Math.max(0,volume);
volume=Math.min(volume,1);
positionVolumeHandle(volume);
if(volume==0){
media.setMuted(true);
}else{
media.setMuted(false);
}
media.setVolume(volume);
},
mouseIsDown=false,
mouseIsOver=false;
mute
.hover(function(){
volumeSlider.show();
mouseIsOver=true;
},function(){
mouseIsOver=false;
if(!mouseIsDown&&mode=='vertical'){
volumeSlider.hide();
}
});
volumeSlider
.bind('mouseover',function(){
mouseIsOver=true;
})
.bind('mousedown',function(e){
handleVolumeMove(e);
t.globalBind('mousemove.vol',function(e){
handleVolumeMove(e);
});
t.globalBind('mouseup.vol',function(){
mouseIsDown=false;
t.globalUnbind('.vol');
if(!mouseIsOver&&mode=='vertical'){
volumeSlider.hide();
}
});
mouseIsDown=true;
return false;
});
mute.find('button').click(function(){
media.setMuted(!media.muted);
});
media.addEventListener('volumechange',function(e){
if(!mouseIsDown){
if(media.muted){
positionVolumeHandle(0);
mute.removeClass('mejs-mute').addClass('mejs-unmute');
}else{
positionVolumeHandle(media.volume);
mute.removeClass('mejs-unmute').addClass('mejs-mute');
}
}
},false);
if(t.container.is(':visible')){
positionVolumeHandle(player.options.startVolume);
if(player.options.startVolume===0){
media.setMuted(true);
}
if(media.pluginType==='native'){
media.setVolume(player.options.startVolume);
}
}
}
});
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
usePluginFullScreen:true,
newWindowCallback:function(){return''},
fullscreenText:mejs.i18n.t('Fullscreen')
});
$.extend(MediaElementPlayer.prototype,{
isFullScreen:false,
isNativeFullScreen:false,
isInIframe:false,
buildfullscreen:function(player,controls,layers,media){
if(!player.isVideo)
return;
player.isInIframe=(window.location!=window.parent.location);
if(mejs.MediaFeatures.hasTrueNativeFullScreen){
var func=function(e){
if(player.isFullScreen){
if(mejs.MediaFeatures.isFullScreen()){
player.isNativeFullScreen=true;
player.setControlsSize();
}else{
player.isNativeFullScreen=false;
player.exitFullScreen();
}
}
};
if(mejs.MediaFeatures.hasMozNativeFullScreen){
player.globalBind(mejs.MediaFeatures.fullScreenEventName,func);
}else{
player.container.bind(mejs.MediaFeatures.fullScreenEventName,func);
}
}
var t=this,
normalHeight=0,
normalWidth=0,
container=player.container,
fullscreenBtn=
$('<div class="mejs-button mejs-fullscreen-button">'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.fullscreenText+'" aria-label="'+t.options.fullscreenText+'"></button>'+
'</div>')
.appendTo(controls);
if(t.media.pluginType==='native'||(!t.options.usePluginFullScreen&&!mejs.MediaFeatures.isFirefox)){
fullscreenBtn.click(function(){
var isFullScreen=(mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen())||player.isFullScreen;
if(isFullScreen){
player.exitFullScreen();
}else{
player.enterFullScreen();
}
});
}else{
var hideTimeout=null,
supportsPointerEvents=(function(){
var element=document.createElement('x'),
documentElement=document.documentElement,
getComputedStyle=window.getComputedStyle,
supports;
if(!('pointerEvents'in element.style)){
return false;
}
element.style.pointerEvents='auto';
element.style.pointerEvents='x';
documentElement.appendChild(element);
supports=getComputedStyle&&
getComputedStyle(element,'').pointerEvents==='auto';
documentElement.removeChild(element);
return!!supports;
})();
if(supportsPointerEvents&&!mejs.MediaFeatures.isOpera){
var fullscreenIsDisabled=false,
restoreControls=function(){
if(fullscreenIsDisabled){
for(var i in hoverDivs){
hoverDivs[i].hide();
}
fullscreenBtn.css('pointer-events','');
t.controls.css('pointer-events','');
t.media.removeEventListener('click',t.clickToPlayPauseCallback);
fullscreenIsDisabled=false;
}
},
hoverDivs={},
hoverDivNames=['top','left','right','bottom'],
i,len,
positionHoverDivs=function(){
var fullScreenBtnOffsetLeft=fullscreenBtn.offset().left-t.container.offset().left,
fullScreenBtnOffsetTop=fullscreenBtn.offset().top-t.container.offset().top,
fullScreenBtnWidth=fullscreenBtn.outerWidth(true),
fullScreenBtnHeight=fullscreenBtn.outerHeight(true),
containerWidth=t.container.width(),
containerHeight=t.container.height();
for(i in hoverDivs){
hoverDivs[i].css({position:'absolute',top:0,left:0})}
hoverDivs['top']
.width(containerWidth)
.height(fullScreenBtnOffsetTop);
hoverDivs['left']
.width(fullScreenBtnOffsetLeft)
.height(fullScreenBtnHeight)
.css({top:fullScreenBtnOffsetTop});
hoverDivs['right']
.width(containerWidth-fullScreenBtnOffsetLeft-fullScreenBtnWidth)
.height(fullScreenBtnHeight)
.css({top:fullScreenBtnOffsetTop,
left:fullScreenBtnOffsetLeft+fullScreenBtnWidth});
hoverDivs['bottom']
.width(containerWidth)
.height(containerHeight-fullScreenBtnHeight-fullScreenBtnOffsetTop)
.css({top:fullScreenBtnOffsetTop+fullScreenBtnHeight});
};
t.globalBind('resize',function(){
positionHoverDivs();
});
for(i=0,len=hoverDivNames.length;i<len;i++){
hoverDivs[hoverDivNames[i]]=$('<div class="mejs-fullscreen-hover" />').appendTo(t.container).mouseover(restoreControls).hide();
}
fullscreenBtn.on('mouseover',function(){
if(!t.isFullScreen){
var buttonPos=fullscreenBtn.offset(),
containerPos=player.container.offset();
media.positionFullscreenButton(buttonPos.left-containerPos.left,buttonPos.top-containerPos.top,false);
fullscreenBtn.css('pointer-events','none');
t.controls.css('pointer-events','none');
t.media.addEventListener('click',t.clickToPlayPauseCallback);
for(i in hoverDivs){
hoverDivs[i].show();
}
positionHoverDivs();
fullscreenIsDisabled=true;
}
});
media.addEventListener('fullscreenchange',function(e){
t.isFullScreen=!t.isFullScreen;
if(t.isFullScreen){
t.media.removeEventListener('click',t.clickToPlayPauseCallback);
}else{
t.media.addEventListener('click',t.clickToPlayPauseCallback);
}
restoreControls();
});
t.globalBind('mousemove',function(e){
if(fullscreenIsDisabled){
var fullscreenBtnPos=fullscreenBtn.offset();
if(e.pageY<fullscreenBtnPos.top||e.pageY>fullscreenBtnPos.top+fullscreenBtn.outerHeight(true)||
e.pageX<fullscreenBtnPos.left||e.pageX>fullscreenBtnPos.left+fullscreenBtn.outerWidth(true)
){
fullscreenBtn.css('pointer-events','');
t.controls.css('pointer-events','');
fullscreenIsDisabled=false;
}
}
});
}else{
fullscreenBtn
.on('mouseover',function(){
if(hideTimeout!==null){
clearTimeout(hideTimeout);
delete hideTimeout;
}
var buttonPos=fullscreenBtn.offset(),
containerPos=player.container.offset();
media.positionFullscreenButton(buttonPos.left-containerPos.left,buttonPos.top-containerPos.top,true);
})
.on('mouseout',function(){
if(hideTimeout!==null){
clearTimeout(hideTimeout);
delete hideTimeout;
}
hideTimeout=setTimeout(function(){
media.hideFullscreenButton();
},1500);
});
}
}
player.fullscreenBtn=fullscreenBtn;
t.globalBind('keydown',function(e){
if(((mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen())||t.isFullScreen)&&e.keyCode==27){
player.exitFullScreen();
}
});
},
cleanfullscreen:function(player){
player.exitFullScreen();
},
containerSizeTimeout:null,
enterFullScreen:function(){
var t=this;
if(t.media.pluginType!=='native'&&(mejs.MediaFeatures.isFirefox||t.options.usePluginFullScreen)){
return;
}
$(document.documentElement).addClass('mejs-fullscreen');
normalHeight=t.container.height();
normalWidth=t.container.width();
if(t.media.pluginType==='native'){
if(mejs.MediaFeatures.hasTrueNativeFullScreen){
mejs.MediaFeatures.requestFullScreen(t.container[0]);
if(t.isInIframe){
setTimeout(function checkFullscreen(){
if(t.isNativeFullScreen){
if($(window).width()!==screen.width){
t.exitFullScreen();
}else{
setTimeout(checkFullscreen,500);
}
}
},500);
}
}else if(mejs.MediaFeatures.hasSemiNativeFullScreen){
t.media.webkitEnterFullscreen();
return;
}
}
if(t.isInIframe){
var url=t.options.newWindowCallback(this);
if(url!==''){
if(!mejs.MediaFeatures.hasTrueNativeFullScreen){
t.pause();
window.open(url,t.id,'top=0,left=0,width='+screen.availWidth+',height='+screen.availHeight+',resizable=yes,scrollbars=no,status=no,toolbar=no');
return;
}else{
setTimeout(function(){
if(!t.isNativeFullScreen){
t.pause();
window.open(url,t.id,'top=0,left=0,width='+screen.availWidth+',height='+screen.availHeight+',resizable=yes,scrollbars=no,status=no,toolbar=no');
}
},250);
}
}
}
t.container
.addClass('mejs-container-fullscreen')
.width('100%')
.height('100%');
t.containerSizeTimeout=setTimeout(function(){
t.container.css({width:'100%',height:'100%'});
t.setControlsSize();
},500);
if(t.media.pluginType==='native'){
t.$media
.width('100%')
.height('100%');
}else{
t.container.find('.mejs-shim')
.width('100%')
.height('100%');
t.media.setVideoSize($(window).width(),$(window).height());
}
t.layers.children('div')
.width('100%')
.height('100%');
if(t.fullscreenBtn){
t.fullscreenBtn
.removeClass('mejs-fullscreen')
.addClass('mejs-unfullscreen');
}
t.setControlsSize();
t.isFullScreen=true;
},
exitFullScreen:function(){
var t=this;
clearTimeout(t.containerSizeTimeout);
if(t.media.pluginType!=='native'&&mejs.MediaFeatures.isFirefox){
t.media.setFullscreen(false);
return;
}
if(mejs.MediaFeatures.hasTrueNativeFullScreen&&(mejs.MediaFeatures.isFullScreen()||t.isFullScreen)){
mejs.MediaFeatures.cancelFullScreen();
}
$(document.documentElement).removeClass('mejs-fullscreen');
t.container
.removeClass('mejs-container-fullscreen')
.width(normalWidth)
.height(normalHeight);
if(t.media.pluginType==='native'){
t.$media
.width(normalWidth)
.height(normalHeight);
}else{
t.container.find('.mejs-shim')
.width(normalWidth)
.height(normalHeight);
t.media.setVideoSize(normalWidth,normalHeight);
}
t.layers.children('div')
.width(normalWidth)
.height(normalHeight);
t.fullscreenBtn
.removeClass('mejs-unfullscreen')
.addClass('mejs-fullscreen');
t.setControlsSize();
t.isFullScreen=false;
}
});
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
startLanguage:'',
tracksText:mejs.i18n.t('Captions/Subtitles'),
hideCaptionsButtonWhenEmpty:true,
toggleCaptionsButtonWhenOnlyOne:false,
slidesSelector:''
});
$.extend(MediaElementPlayer.prototype,{
hasChapters:false,
buildtracks:function(player,controls,layers,media){
if(player.tracks.length==0)
return;
var t=this,
i,
options='';
if(t.domNode.textTracks){for(var i=t.domNode.textTracks.length-1;i>=0;i--){
t.domNode.textTracks[i].mode="hidden";
}
}
player.chapters=
$('<div class="mejs-chapters mejs-layer"></div>')
.prependTo(layers).hide();
player.captions=
$('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position mejs-captions-position-hover"><span class="mejs-captions-text"></span></div></div>')
.prependTo(layers).hide();
player.captionsText=player.captions.find('.mejs-captions-text');
player.captionsButton=
$('<div class="mejs-button mejs-captions-button">'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.tracksText+'" aria-label="'+t.options.tracksText+'"></button>'+
'<div class="mejs-captions-selector">'+
'<ul>'+
'<li>'+
'<input type="radio" name="'+player.id+'_captions" id="'+player.id+'_captions_none" value="none" checked="checked" />'+
'<label for="'+player.id+'_captions_none">'+mejs.i18n.t('None')+'</label>'+
'</li>'+
'</ul>'+
'</div>'+
'</div>')
.appendTo(controls);
var subtitleCount=0;
for(i=0;i<player.tracks.length;i++){
if(player.tracks[i].kind=='subtitles'){
subtitleCount++;
}
}
if(t.options.toggleCaptionsButtonWhenOnlyOne&&subtitleCount==1){
player.captionsButton.on('click',function(){
if(player.selectedTrack==null){
var lang=player.tracks[0].srclang;
}else{
var lang='none';
}
player.setTrack(lang);
});
}else{
player.captionsButton.hover(function(){
$(this).find('.mejs-captions-selector').css('visibility','visible');
},function(){
$(this).find('.mejs-captions-selector').css('visibility','hidden');
})
.on('click','input[type=radio]',function(){
lang=this.value;
player.setTrack(lang);
});
}
if(!player.options.alwaysShowControls){
player.container
.bind('controlsshown',function(){
player.container.find('.mejs-captions-position').addClass('mejs-captions-position-hover');
})
.bind('controlshidden',function(){
if(!media.paused){
player.container.find('.mejs-captions-position').removeClass('mejs-captions-position-hover');
}
});
}else{
player.container.find('.mejs-captions-position').addClass('mejs-captions-position-hover');
}
player.trackToLoad=-1;
player.selectedTrack=null;
player.isLoadingTrack=false;
for(i=0;i<player.tracks.length;i++){
if(player.tracks[i].kind=='subtitles'){
player.addTrackButton(player.tracks[i].srclang,player.tracks[i].label);
}
}
player.loadNextTrack();
media.addEventListener('timeupdate',function(e){
player.displayCaptions();
},false);
if(player.options.slidesSelector!=''){
player.slidesContainer=$(player.options.slidesSelector);
media.addEventListener('timeupdate',function(e){
player.displaySlides();
},false);
}
media.addEventListener('loadedmetadata',function(e){
player.displayChapters();
},false);
player.container.hover(
function(){
if(player.hasChapters){
player.chapters.css('visibility','visible');
player.chapters.fadeIn(200).height(player.chapters.find('.mejs-chapter').outerHeight());
}
},
function(){
if(player.hasChapters&&!media.paused){
player.chapters.fadeOut(200,function(){
$(this).css('visibility','hidden');
$(this).css('display','block');
});
}
});
if(player.node.getAttribute('autoplay')!==null){
player.chapters.css('visibility','hidden');
}
},
setTrack:function(lang){
var t=this,
i;
if(lang=='none'){
t.selectedTrack=null;
t.captionsButton.removeClass('mejs-captions-enabled');
}else{
for(i=0;i<t.tracks.length;i++){
if(t.tracks[i].srclang==lang){
if(t.selectedTrack==null)
t.captionsButton.addClass('mejs-captions-enabled');
t.selectedTrack=t.tracks[i];
t.captions.attr('lang',t.selectedTrack.srclang);
t.displayCaptions();
break;
}
}
}
},
loadNextTrack:function(){
var t=this;
t.trackToLoad++;
if(t.trackToLoad<t.tracks.length){
t.isLoadingTrack=true;
t.loadTrack(t.trackToLoad);
}else{
t.isLoadingTrack=false;
t.checkForTracks();
}
},
loadTrack:function(index){
var
t=this,
track=t.tracks[index],
after=function(){
track.isLoaded=true;
t.enableTrackButton(track.srclang,track.label);
t.loadNextTrack();
};
$.ajax({
url:track.src,
dataType:"text",
success:function(d){
if(typeof d=="string"&&(/<tt\s+xml/ig).exec(d)){
track.entries=mejs.TrackFormatParser.dfxp.parse(d);
}else{
track.entries=mejs.TrackFormatParser.webvvt.parse(d);
}
after();
if(track.kind=='chapters'){
t.media.addEventListener('play',function(e){
if(t.media.duration>0){
t.displayChapters(track);
}
},false);
}
if(track.kind=='slides'){
t.setupSlides(track);
}
},
error:function(){
t.loadNextTrack();
}
});
},
enableTrackButton:function(lang,label){
var t=this;
if(label===''){
label=mejs.language.codes[lang]||lang;
}
t.captionsButton
.find('input[value='+lang+']')
.prop('disabled',false)
.siblings('label')
.html(label);
if(t.options.startLanguage==lang){
$('#'+t.id+'_captions_'+lang).click();
}
t.adjustLanguageBox();
},
addTrackButton:function(lang,label){
var t=this;
if(label===''){
label=mejs.language.codes[lang]||lang;
}
t.captionsButton.find('ul').append(
$('<li>'+
'<input type="radio" name="'+t.id+'_captions" id="'+t.id+'_captions_'+lang+'" value="'+lang+'" disabled="disabled" />'+
'<label for="'+t.id+'_captions_'+lang+'">'+label+' (loading)'+'</label>'+
'</li>')
);
t.adjustLanguageBox();
t.container.find('.mejs-captions-translations option[value='+lang+']').remove();
},
adjustLanguageBox:function(){
var t=this;
t.captionsButton.find('.mejs-captions-selector').height(
t.captionsButton.find('.mejs-captions-selector ul').outerHeight(true)+
t.captionsButton.find('.mejs-captions-translations').outerHeight(true)
);
},
checkForTracks:function(){
var
t=this,
hasSubtitles=false;
if(t.options.hideCaptionsButtonWhenEmpty){
for(i=0;i<t.tracks.length;i++){
if(t.tracks[i].kind=='subtitles'){
hasSubtitles=true;
break;
}
}
if(!hasSubtitles){
t.captionsButton.hide();
t.setControlsSize();
}
}
},
displayCaptions:function(){
if(typeof this.tracks=='undefined')
return;
var
t=this,
i,
track=t.selectedTrack;
if(track!=null&&track.isLoaded){
for(i=0;i<track.entries.times.length;i++){
if(t.media.currentTime>=track.entries.times[i].start&&t.media.currentTime<=track.entries.times[i].stop){
t.captionsText.html(track.entries.text[i]);
t.captions.show().height(0);
return}
}
t.captions.hide();
}else{
t.captions.hide();
}
},
setupSlides:function(track){
var t=this;
t.slides=track;
t.slides.entries.imgs=[t.slides.entries.text.length];
t.showSlide(0);
},
showSlide:function(index){
if(typeof this.tracks=='undefined'||typeof this.slidesContainer=='undefined'){
return;
}
var t=this,
url=t.slides.entries.text[index],
img=t.slides.entries.imgs[index];
if(typeof img=='undefined'||typeof img.fadeIn=='undefined'){
t.slides.entries.imgs[index]=img=$('<img src="'+url+'">')
.on('load',function(){
img.appendTo(t.slidesContainer)
.hide()
.fadeIn()
.siblings(':visible')
.fadeOut();
});
}else{
if(!img.is(':visible')&&!img.is(':animated')){
img.fadeIn()
.siblings(':visible')
.fadeOut();
}
}
},
displaySlides:function(){
if(typeof this.slides=='undefined')
return;
var
t=this,
slides=t.slides,
i;
for(i=0;i<slides.entries.times.length;i++){
if(t.media.currentTime>=slides.entries.times[i].start&&t.media.currentTime<=slides.entries.times[i].stop){
t.showSlide(i);
return}
}
},
displayChapters:function(){
var
t=this,
i;
for(i=0;i<t.tracks.length;i++){
if(t.tracks[i].kind=='chapters'&&t.tracks[i].isLoaded){
t.drawChapters(t.tracks[i]);
t.hasChapters=true;
break;
}
}
},
drawChapters:function(chapters){
var
t=this,
i,
dur,
percent=0,
usedPercent=0;
t.chapters.empty();
for(i=0;i<chapters.entries.times.length;i++){
dur=chapters.entries.times[i].stop-chapters.entries.times[i].start;
percent=Math.floor(dur/t.media.duration*100);
if(percent+usedPercent>100||i==chapters.entries.times.length-1&&percent+usedPercent<100){
percent=100-usedPercent;
}
t.chapters.append($(
'<div class="mejs-chapter" rel="'+chapters.entries.times[i].start+'" style="left: '+usedPercent.toString()+'%;width: '+percent.toString()+'%;">'+
'<div class="mejs-chapter-block'+((i==chapters.entries.times.length-1)?' mejs-chapter-block-last':'')+'">'+
'<span class="ch-title">'+chapters.entries.text[i]+'</span>'+
'<span class="ch-time">'+mejs.Utility.secondsToTimeCode(chapters.entries.times[i].start)+'&ndash;'+mejs.Utility.secondsToTimeCode(chapters.entries.times[i].stop)+'</span>'+
'</div>'+
'</div>'));
usedPercent+=percent;
}
t.chapters.find('div.mejs-chapter').click(function(){
t.media.setCurrentTime(parseFloat($(this).attr('rel')));
if(t.media.paused){
t.media.play();
}
});
t.chapters.show();
}
});
mejs.language={
codes:{
af:'Afrikaans',
sq:'Albanian',
ar:'Arabic',
be:'Belarusian',
bg:'Bulgarian',
ca:'Catalan',
zh:'Chinese',
'zh-cn':'Chinese Simplified',
'zh-tw':'Chinese Traditional',
hr:'Croatian',
cs:'Czech',
da:'Danish',
nl:'Dutch',
en:'English',
et:'Estonian',
tl:'Filipino',
fi:'Finnish',
fr:'French',
gl:'Galician',
de:'German',
el:'Greek',
ht:'Haitian Creole',
iw:'Hebrew',
hi:'Hindi',
hu:'Hungarian',
is:'Icelandic',
id:'Indonesian',
ga:'Irish',
it:'Italian',
ja:'Japanese',
ko:'Korean',
lv:'Latvian',
lt:'Lithuanian',
mk:'Macedonian',
ms:'Malay',
mt:'Maltese',
no:'Norwegian',
fa:'Persian',
pl:'Polish',
pt:'Portuguese',
ro:'Romanian',
ru:'Russian',
sr:'Serbian',
sk:'Slovak',
sl:'Slovenian',
es:'Spanish',
sw:'Swahili',
sv:'Swedish',
tl:'Tagalog',
th:'Thai',
tr:'Turkish',
uk:'Ukrainian',
vi:'Vietnamese',
cy:'Welsh',
yi:'Yiddish'
}
};

mejs.TrackFormatParser={
webvvt:{
pattern_identifier:/^([a-zA-z]+-)?[0-9]+$/,
pattern_timecode:/^([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,
parse:function(trackText){
var
i=0,
lines=mejs.TrackFormatParser.split2(trackText,/\r?\n/),
entries={text:[],times:[]},
timecode,
text;
for(;i<lines.length;i++){
if(this.pattern_identifier.exec(lines[i])){
i++;
timecode=this.pattern_timecode.exec(lines[i]);
if(timecode&&i<lines.length){
i++;
text=lines[i];
i++;
while(lines[i]!==''&&i<lines.length){
text=text+'\n'+lines[i];
i++;
}
text=$.trim(text).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a href='$1' target='_blank'>$1</a>");
entries.text.push(text);
entries.times.push(
{
start:(mejs.Utility.convertSMPTEtoSeconds(timecode[1])==0)?0.200:mejs.Utility.convertSMPTEtoSeconds(timecode[1]),
stop:mejs.Utility.convertSMPTEtoSeconds(timecode[3]),
settings:timecode[5]
});
}
}
}
return entries;
}
},
dfxp:{
parse:function(trackText){
trackText=$(trackText).filter("tt");
var
i=0,
container=trackText.children("div").eq(0),
lines=container.find("p"),
styleNode=trackText.find("#"+container.attr("style")),
styles,
begin,
end,
text,
entries={text:[],times:[]};
if(styleNode.length){
var attributes=styleNode.removeAttr("id").get(0).attributes;
if(attributes.length){
styles={};
for(i=0;i<attributes.length;i++){
styles[attributes[i].name.split(":")[1]]=attributes[i].value;
}
}
}
for(i=0;i<lines.length;i++){
var style;
var _temp_times={
start:null,
stop:null,
style:null
};
if(lines.eq(i).attr("begin"))_temp_times.start=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i).attr("begin"));
if(!_temp_times.start&&lines.eq(i-1).attr("end"))_temp_times.start=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i-1).attr("end"));
if(lines.eq(i).attr("end"))_temp_times.stop=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i).attr("end"));
if(!_temp_times.stop&&lines.eq(i+1).attr("begin"))_temp_times.stop=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i+1).attr("begin"));
if(styles){
style="";
for(var _style in styles){
style+=_style+":"+styles[_style]+";";
}
}
if(style)_temp_times.style=style;
if(_temp_times.start==0)_temp_times.start=0.200;
entries.times.push(_temp_times);
text=$.trim(lines.eq(i).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a href='$1' target='_blank'>$1</a>");
entries.text.push(text);
if(entries.times.start==0)entries.times.start=2;
}
return entries;
}
},
split2:function(text,regex){
return text.split(regex);
}
};
if('x\n\ny'.split(/\n/gi).length!=3){
mejs.TrackFormatParser.split2=function(text,regex){
var
parts=[],
chunk='',
i;
for(i=0;i<text.length;i++){
chunk+=text.substring(i,i+1);
if(regex.test(chunk)){
parts.push(chunk.replace(regex,''));
chunk='';
}
}
parts.push(chunk);
return parts;
}
}
})(mejs.$);

(function($){
$.extend(mejs.MepDefaults,
{'contextMenuItems':[
{
render:function(player){
if(typeof player.enterFullScreen=='undefined')
return null;
if(player.isFullScreen){
return mejs.i18n.t('Turn off Fullscreen');
}else{
return mejs.i18n.t('Go Fullscreen');
}
},
click:function(player){
if(player.isFullScreen){
player.exitFullScreen();
}else{
player.enterFullScreen();
}
}
}
,
{
render:function(player){
if(player.media.muted){
return mejs.i18n.t('Unmute');
}else{
return mejs.i18n.t('Mute');
}
},
click:function(player){
if(player.media.muted){
player.setMuted(false);
}else{
player.setMuted(true);
}
}
},
{
isSeparator:true
}
,
{
render:function(player){
return mejs.i18n.t('Download Video');
},
click:function(player){
window.location.href=player.media.currentSrc;
}
}
]}
);
$.extend(MediaElementPlayer.prototype,{
buildcontextmenu:function(player,controls,layers,media){
player.contextMenu=$('<div class="mejs-contextmenu"></div>')
.appendTo($('body'))
.hide();
player.container.bind('contextmenu',function(e){
if(player.isContextMenuEnabled){
e.preventDefault();
player.renderContextMenu(e.clientX-1,e.clientY-1);
return false;
}
});
player.container.bind('click',function(){
player.contextMenu.hide();
});
player.contextMenu.bind('mouseleave',function(){
player.startContextMenuTimer();
});
},
cleancontextmenu:function(player){
player.contextMenu.remove();
},
isContextMenuEnabled:true,
enableContextMenu:function(){
this.isContextMenuEnabled=true;
},
disableContextMenu:function(){
this.isContextMenuEnabled=false;
},
contextMenuTimeout:null,
startContextMenuTimer:function(){
var t=this;
t.killContextMenuTimer();
t.contextMenuTimer=setTimeout(function(){
t.hideContextMenu();
t.killContextMenuTimer();
},750);
},
killContextMenuTimer:function(){
var timer=this.contextMenuTimer;
if(timer!=null){
clearTimeout(timer);
delete timer;
timer=null;
}
},
hideContextMenu:function(){
this.contextMenu.hide();
},
renderContextMenu:function(x,y){
var t=this,
html='',
items=t.options.contextMenuItems;
for(var i=0,il=items.length;i<il;i++){
if(items[i].isSeparator){
html+='<div class="mejs-contextmenu-separator"></div>';
}else{
var rendered=items[i].render(t);
if(rendered!=null){
html+='<div class="mejs-contextmenu-item" data-itemindex="'+i+'" id="element-'+(Math.random()*1000000)+'">'+rendered+'</div>';
}
}
}
t.contextMenu
.empty()
.append($(html))
.css({top:y,left:x})
.show();
t.contextMenu.find('.mejs-contextmenu-item').each(function(){
var $dom=$(this),
itemIndex=parseInt($dom.data('itemindex'),10),
item=t.options.contextMenuItems[itemIndex];
if(typeof item.show!='undefined')
item.show($dom,t);
$dom.click(function(){
if(typeof item.click!='undefined')
item.click(t);
t.contextMenu.hide();
});
});
setTimeout(function(){
t.killControlsTimer('rev3');
},100);
}
});
})(mejs.$);

(function($){
$.extend(mejs.MepDefaults,{
postrollCloseText:mejs.i18n.t('Close')
});
$.extend(MediaElementPlayer.prototype,{
buildpostroll:function(player,controls,layers,media){
var
t=this,
postrollLink=t.container.find('link[rel="postroll"]').attr('href');
if(typeof postrollLink!=='undefined'){
player.postroll=
$('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">'+t.options.postrollCloseText+'</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(layers).hide();
t.media.addEventListener('ended',function(e){
$.ajax({
dataType:'html',
url:postrollLink,
success:function(data,textStatus){
layers.find('.mejs-postroll-layer-content').html(data);
}
});
player.postroll.show();
},false);
}
}
});
})(mejs.$);

;

;
if(typeof jQuery!='undefined'){
mejs.$=jQuery;
}else if(typeof ender!='undefined'){
mejs.$=ender;
}
(function($){
mejs.MepDefaults={
poster:'',
showPosterWhenEnded:false,
defaultVideoWidth:480,
defaultVideoHeight:270,
videoWidth:-1,
videoHeight:-1,
defaultAudioWidth:400,
defaultAudioHeight:30,
defaultSeekBackwardInterval:function(media){
return(media.duration*0.05);
},
defaultSeekForwardInterval:function(media){
return(media.duration*0.05);
},
audioWidth:-1,
audioHeight:-1,
startVolume:0.8,
loop:false,
autoRewind:true,
enableAutosize:true,
alwaysShowHours:false,
showTimecodeFrameCount:false,
framesPerSecond:25,
autosizeProgress:true,
alwaysShowControls:false,
hideVideoControlsOnLoad:false,
clickToPlayPause:true,
iPadUseNativeControls:false,
iPhoneUseNativeControls:false,
AndroidUseNativeControls:false,
features:['playpause','current','progress','duration','tracks','volume','fullscreen'],
isVideo:true,
enableKeyboard:true,
pauseOtherPlayers:true,
keyActions:[
{
keys:[
32,179],
action:function(player,media){
if(media.paused||media.ended){
player.play();
}else{
player.pause();
}
}
},
{
keys:[38],action:function(player,media){
var newVolume=Math.min(media.volume+0.1,1);
media.setVolume(newVolume);
}
},
{
keys:[40],action:function(player,media){
var newVolume=Math.max(media.volume-0.1,0);
media.setVolume(newVolume);
}
},
{
keys:[
37,227],
action:function(player,media){
if(!isNaN(media.duration)&&media.duration>0){
if(player.isVideo){
player.showControls();
player.startControlsTimer();
}
var newTime=Math.max(media.currentTime-player.options.defaultSeekBackwardInterval(media),0);
media.setCurrentTime(newTime);
}
}
},
{
keys:[
39,228],
action:function(player,media){
if(!isNaN(media.duration)&&media.duration>0){
if(player.isVideo){
player.showControls();
player.startControlsTimer();
}
var newTime=Math.min(media.currentTime+player.options.defaultSeekForwardInterval(media),media.duration);
media.setCurrentTime(newTime);
}
}
},
{
keys:[70],action:function(player,media){
if(typeof player.enterFullScreen!='undefined'){
if(player.isFullScreen){
player.exitFullScreen();
}else{
player.enterFullScreen();
}
}
}
}
]
};
mejs.mepIndex=0;
mejs.players={};
mejs.MediaElementPlayer=function(node,o){
if(!(this instanceof mejs.MediaElementPlayer)){
return new mejs.MediaElementPlayer(node,o);
}
var t=this;
t.$media=t.$node=$(node);
t.node=t.media=t.$media[0];
if(typeof t.node.player!='undefined'){
return t.node.player;
}else{
t.node.player=t;
}
if(typeof o=='undefined'){
o=t.$node.data('mejsoptions');
}
t.options=$.extend({},mejs.MepDefaults,o);
t.id='mep_'+mejs.mepIndex++;
mejs.players[t.id]=t;
t.init();
return t;
};
mejs.MediaElementPlayer.prototype={
hasFocus:false,
controlsAreVisible:true,
init:function(){
var
t=this,
mf=mejs.MediaFeatures,
meOptions=$.extend(true,{},t.options,{
success:function(media,domNode){t.meReady(media,domNode)},
error:function(e){t.handleError(e)}
}),
tagName=t.media.tagName.toLowerCase();
t.isDynamic=(tagName!=='audio'&&tagName!=='video');
if(t.isDynamic){
t.isVideo=t.options.isVideo;
}else{
t.isVideo=(tagName!=='audio'&&t.options.isVideo);
}
if((mf.isiPad&&t.options.iPadUseNativeControls)||(mf.isiPhone&&t.options.iPhoneUseNativeControls)){
t.$media.attr('controls','controls');
if(mf.isiPad&&t.media.getAttribute('autoplay')!==null){
t.play();
}
}else if(mf.isAndroid&&t.options.AndroidUseNativeControls){
}else{
t.$media.removeAttr('controls');
t.container=
$('<div id="'+t.id+'" class="mejs-container '+(mejs.MediaFeatures.svg?'svg':'no-svg')+'">'+
'<div class="mejs-inner">'+
'<div class="mejs-mediaelement"></div>'+
'<div class="mejs-layers"></div>'+
'<div class="mejs-controls"></div>'+
'<div class="mejs-clear"></div>'+
'</div>'+
'</div>')
.addClass(t.$media[0].className)
.insertBefore(t.$media);
t.container.addClass(
(mf.isAndroid?'mejs-android ':'')+
(mf.isiOS?'mejs-ios ':'')+
(mf.isiPad?'mejs-ipad ':'')+
(mf.isiPhone?'mejs-iphone ':'')+
(t.isVideo?'mejs-video ':'mejs-audio ')
);
if(mf.isiOS){
var $newMedia=t.$media.clone();
t.container.find('.mejs-mediaelement').append($newMedia);
t.$media.remove();
t.$node=t.$media=$newMedia;
t.node=t.media=$newMedia[0]
}else{
t.container.find('.mejs-mediaelement').append(t.$media);
}
t.controls=t.container.find('.mejs-controls');
t.layers=t.container.find('.mejs-layers');

var tagType=(t.isVideo?'video':'audio'),
capsTagName=tagType.substring(0,1).toUpperCase()+tagType.substring(1);
if(t.options[tagType+'Width']>0||t.options[tagType+'Width'].toString().indexOf('%')>-1){
t.width=t.options[tagType+'Width'];
}else if(t.media.style.width!==''&&t.media.style.width!==null){
t.width=t.media.style.width;
}else if(t.media.getAttribute('width')!==null){
t.width=t.$media.attr('width');
}else{
t.width=t.options['default'+capsTagName+'Width'];
}
if(t.options[tagType+'Height']>0||t.options[tagType+'Height'].toString().indexOf('%')>-1){
t.height=t.options[tagType+'Height'];
}else if(t.media.style.height!==''&&t.media.style.height!==null){
t.height=t.media.style.height;
}else if(t.$media[0].getAttribute('height')!==null){
t.height=t.$media.attr('height');
}else{
t.height=t.options['default'+capsTagName+'Height'];
}
t.setPlayerSize(t.width,t.height);
meOptions.pluginWidth=t.width;
meOptions.pluginHeight=t.height;
}
mejs.MediaElement(t.$media[0],meOptions);
if(typeof(t.container)!='undefined'&&t.controlsAreVisible){
t.container.trigger('controlsshown');
}
},
showControls:function(doAnimation){
var t=this;
doAnimation=typeof doAnimation=='undefined'||doAnimation;
if(t.controlsAreVisible)
return;
if(doAnimation){
t.controls
.css('visibility','visible')
.stop(true,true).fadeIn(200,function(){
t.controlsAreVisible=true;
t.container.trigger('controlsshown');
});
t.container.find('.mejs-control')
.css('visibility','visible')
.stop(true,true).fadeIn(200,function(){t.controlsAreVisible=true});
}else{
t.controls
.css('visibility','visible')
.css('display','block');
t.container.find('.mejs-control')
.css('visibility','visible')
.css('display','block');
t.controlsAreVisible=true;
t.container.trigger('controlsshown');
}
t.setControlsSize();
},
hideControls:function(doAnimation){
var t=this;
doAnimation=typeof doAnimation=='undefined'||doAnimation;
if(!t.controlsAreVisible||t.options.alwaysShowControls)
return;
if(doAnimation){
t.controls.stop(true,true).fadeOut(200,function(){
$(this)
.css('visibility','hidden')
.css('display','block');
t.controlsAreVisible=false;
t.container.trigger('controlshidden');
});
t.container.find('.mejs-control').stop(true,true).fadeOut(200,function(){
$(this)
.css('visibility','hidden')
.css('display','block');
});
}else{
t.controls
.css('visibility','hidden')
.css('display','block');
t.container.find('.mejs-control')
.css('visibility','hidden')
.css('display','block');
t.controlsAreVisible=false;
t.container.trigger('controlshidden');
}
},
controlsTimer:null,
startControlsTimer:function(timeout){
var t=this;
timeout=typeof timeout!='undefined'?timeout:1500;
t.killControlsTimer('start');
t.controlsTimer=setTimeout(function(){
t.hideControls();
t.killControlsTimer('hide');
},timeout);
},
killControlsTimer:function(src){
var t=this;
if(t.controlsTimer!==null){
clearTimeout(t.controlsTimer);
delete t.controlsTimer;
t.controlsTimer=null;
}
},
controlsEnabled:true,
disableControls:function(){
var t=this;
t.killControlsTimer();
t.hideControls(false);
this.controlsEnabled=false;
},
enableControls:function(){
var t=this;
t.showControls(false);
t.controlsEnabled=true;
},
meReady:function(media,domNode){
var t=this,
mf=mejs.MediaFeatures,
autoplayAttr=domNode.getAttribute('autoplay'),
autoplay=!(typeof autoplayAttr=='undefined'||autoplayAttr===null||autoplayAttr==='false'),
featureIndex,
feature;
if(t.created){
return;
}else{
t.created=true;
}
t.media=media;
t.domNode=domNode;
if(!(mf.isAndroid&&t.options.AndroidUseNativeControls)&&!(mf.isiPad&&t.options.iPadUseNativeControls)&&!(mf.isiPhone&&t.options.iPhoneUseNativeControls)){
t.buildposter(t,t.controls,t.layers,t.media);
t.buildkeyboard(t,t.controls,t.layers,t.media);
t.buildoverlays(t,t.controls,t.layers,t.media);
t.findTracks();
for(featureIndex in t.options.features){
feature=t.options.features[featureIndex];
if(t['build'+feature]){
try{
t['build'+feature](t,t.controls,t.layers,t.media);
}catch(e){
}
}
}
t.container.trigger('controlsready');
t.setPlayerSize(t.width,t.height);
t.setControlsSize();
if(t.isVideo){
if(mejs.MediaFeatures.hasTouch){
t.$media.bind('touchstart',function(){
if(t.controlsAreVisible){
t.hideControls(false);
}else{
if(t.controlsEnabled){
t.showControls(false);
}
}
});
}else{
mejs.MediaElementPlayer.prototype.clickToPlayPauseCallback=function(){
if(t.options.clickToPlayPause){
if(t.media.paused){
t.play();
}else{
t.pause();
}
}
};
t.media.addEventListener('click',t.clickToPlayPauseCallback,false);
t.container
.bind('mouseenter mouseover',function(){
if(t.controlsEnabled){
if(!t.options.alwaysShowControls){
t.killControlsTimer('enter');
t.showControls();
t.startControlsTimer(2500);
}
}
})
.bind('mousemove',function(){
if(t.controlsEnabled){
if(!t.controlsAreVisible){
t.showControls();
}
if(!t.options.alwaysShowControls){
t.startControlsTimer(2500);
}
}
})
.bind('mouseleave',function(){
if(t.controlsEnabled){
if(!t.media.paused&&!t.options.alwaysShowControls){
t.startControlsTimer(1000);
}
}
});
}
if(t.options.hideVideoControlsOnLoad){
t.hideControls(false);
}
if(autoplay&&!t.options.alwaysShowControls){
t.hideControls();
}
if(t.options.enableAutosize){
t.media.addEventListener('loadedmetadata',function(e){
if(t.options.videoHeight<=0&&t.domNode.getAttribute('height')===null&&!isNaN(e.target.videoHeight)){
t.setPlayerSize(e.target.videoWidth,e.target.videoHeight);
t.setControlsSize();
t.media.setVideoSize(e.target.videoWidth,e.target.videoHeight);
}
},false);
}
}
media.addEventListener('play',function(){
var playerIndex;
for(playerIndex in mejs.players){
var p=mejs.players[playerIndex];
if(p.id!=t.id&&t.options.pauseOtherPlayers&&!p.paused&&!p.ended){
p.pause();
}
p.hasFocus=false;
}
t.hasFocus=true;
},false);
t.media.addEventListener('ended',function(e){
if(t.options.autoRewind){
try{
t.media.setCurrentTime(0);
}catch(exp){
}
}
t.media.pause();
if(t.setProgressRail){
t.setProgressRail();
}
if(t.setCurrentRail){
t.setCurrentRail();
}
if(t.options.loop){
t.play();
}else if(!t.options.alwaysShowControls&&t.controlsEnabled){
t.showControls();
}
},false);
t.media.addEventListener('loadedmetadata',function(e){
if(t.updateDuration){
t.updateDuration();
}
if(t.updateCurrent){
t.updateCurrent();
}
if(!t.isFullScreen){
t.setPlayerSize(t.width,t.height);
t.setControlsSize();
}
},false);
setTimeout(function(){
t.setPlayerSize(t.width,t.height);
t.setControlsSize();
},50);
t.globalBind('resize',function(){
if(!(t.isFullScreen||(mejs.MediaFeatures.hasTrueNativeFullScreen&&document.webkitIsFullScreen))){
t.setPlayerSize(t.width,t.height);
}
t.setControlsSize();
});
if(t.media.pluginType=='youtube'){
t.container.find('.mejs-overlay-play').hide();
}
}
if(autoplay&&media.pluginType=='native'){
t.play();
}
if(t.options.success){
if(typeof t.options.success=='string'){
window[t.options.success](t.media,t.domNode,t);
}else{
t.options.success(t.media,t.domNode,t);
}
}
},
handleError:function(e){
var t=this;
t.controls.hide();
if(t.options.error){
t.options.error(e);
}
},
setPlayerSize:function(width,height){
var t=this;
if(typeof width!='undefined'){
t.width=width;
}
if(typeof height!='undefined'){
t.height=height;
}
if(t.height.toString().indexOf('%')>0||t.$node.css('max-width')==='100%'||parseInt(t.$node.css('max-width').replace(/px/,''),10)/t.$node.offsetParent().width()===1||(t.$node[0].currentStyle&&t.$node[0].currentStyle.maxWidth==='100%')){
var
nativeWidth=t.isVideo?((t.media.videoWidth&&t.media.videoWidth>0)?t.media.videoWidth:t.options.defaultVideoWidth):t.options.defaultAudioWidth,
nativeHeight=t.isVideo?((t.media.videoHeight&&t.media.videoHeight>0)?t.media.videoHeight:t.options.defaultVideoHeight):t.options.defaultAudioHeight,
parentWidth=t.container.parent().closest(':visible').width(),
newHeight=t.isVideo||!t.options.autosizeProgress?parseInt(parentWidth*nativeHeight/nativeWidth,10):nativeHeight;
if(t.container.parent()[0].tagName.toLowerCase()==='body'){parentWidth=$(window).width();
newHeight=$(window).height();
}
if(newHeight!=0&&parentWidth!=0){
t.container
.width(parentWidth)
.height(newHeight);
t.$media.add(t.container.find('.mejs-shim'))
.width('100%')
.height('100%');
if(t.isVideo){
if(t.media.setVideoSize){
t.media.setVideoSize(parentWidth,newHeight);
}
}
t.layers.children('.mejs-layer')
.width('100%')
.height('100%');
}
}else{
t.container
.width(t.width)
.height(t.height);
t.layers.children('.mejs-layer')
.width(t.width)
.height(t.height);
}
var playLayer=t.layers.find('.mejs-overlay-play'),
playButton=playLayer.find('.mejs-overlay-button');
playLayer.height(t.container.height()-t.controls.height());
playButton.css('margin-top','-'+(playButton.height()/2-t.controls.height()/2).toString()+'px');
},
setControlsSize:function(){
var t=this,
usedWidth=0,
railWidth=0,
rail=t.controls.find('.mejs-time-rail'),
total=t.controls.find('.mejs-time-total'),
current=t.controls.find('.mejs-time-current'),
loaded=t.controls.find('.mejs-time-loaded'),
others=rail.siblings();
alert("!!ddf!")
if(t.options&&!t.options.autosizeProgress){
railWidth=parseInt(rail.css('width'));
alert("!!!")
}
if(railWidth===0||!railWidth){
others.each(function(){
var $this=$(this);
if($this.css('position')!='absolute'&&$this.is(':visible')){
usedWidth+=$(this).outerWidth(true);
}
});
railWidth=t.controls.width()-usedWidth-(rail.outerWidth(true)-rail.width());
}
rail.width(railWidth);
total.width(railWidth-(total.outerWidth(true)-total.width()));
if(t.setProgressRail)
t.setProgressRail();
if(t.setCurrentRail)
t.setCurrentRail();
},
buildposter:function(player,controls,layers,media){
var t=this,
poster=
$('<div class="mejs-poster mejs-layer">'+
'</div>')
.appendTo(layers),
posterUrl=player.$media.attr('poster');
if(player.options.poster!==''){
posterUrl=player.options.poster;
}
if(posterUrl!==''&&posterUrl!=null){
t.setPoster(posterUrl);
}else{
poster.hide();
}
media.addEventListener('play',function(){
poster.hide();
},false);
if(player.options.showPosterWhenEnded&&player.options.autoRewind){
media.addEventListener('ended',function(){
poster.show();
},false);
}
},
setPoster:function(url){
var t=this,
posterDiv=t.container.find('.mejs-poster'),
posterImg=posterDiv.find('img');
if(posterImg.length==0){
posterImg=$('<img width="100%" height="100%" />').appendTo(posterDiv);
}
posterImg.attr('src',url);
posterDiv.css({'background-image':'url('+url+')'});
},
buildoverlays:function(player,controls,layers,media){
var t=this;
if(!player.isVideo)
return;
var
loading=
$('<div class="mejs-overlay mejs-layer">'+
'<div class="mejs-overlay-loading"><span></span></div>'+
'</div>')
.hide().appendTo(layers),
error=
$('<div class="mejs-overlay mejs-layer">'+
'<div class="mejs-overlay-error"></div>'+
'</div>')
.hide().appendTo(layers),
bigPlay=
$('<div class="mejs-overlay mejs-layer mejs-overlay-play">'+
'<div class="mejs-overlay-button"></div>'+
'</div>')
.appendTo(layers)
.bind('click touchstart',function(){
if(t.options.clickToPlayPause){
if(media.paused){
t.play();
}
}
});

media.addEventListener('play',function(){
bigPlay.hide();
loading.hide();
controls.find('.mejs-time-buffering').hide();
error.hide();
},false);
media.addEventListener('playing',function(){
bigPlay.hide();
loading.hide();
controls.find('.mejs-time-buffering').hide();
error.hide();
},false);
media.addEventListener('seeking',function(){
loading.show();
controls.find('.mejs-time-buffering').show();
},false);
media.addEventListener('seeked',function(){
loading.hide();
controls.find('.mejs-time-buffering').hide();
},false);
media.addEventListener('pause',function(){
if(!mejs.MediaFeatures.isiPhone){
bigPlay.show();
}
},false);
media.addEventListener('waiting',function(){
loading.show();
controls.find('.mejs-time-buffering').show();
},false);
media.addEventListener('loadeddata',function(){
loading.show();
controls.find('.mejs-time-buffering').show();
},false);
media.addEventListener('canplay',function(){
loading.hide();
controls.find('.mejs-time-buffering').hide();
},false);
media.addEventListener('error',function(){
loading.hide();
controls.find('.mejs-time-buffering').hide();
error.show();
error.find('mejs-overlay-error').html("Error loading this resource");
},false);
},
buildkeyboard:function(player,controls,layers,media){
var t=this;
t.globalBind('keydown',function(e){
if(player.hasFocus&&player.options.enableKeyboard){
for(var i=0,il=player.options.keyActions.length;i<il;i++){
var keyAction=player.options.keyActions[i];
for(var j=0,jl=keyAction.keys.length;j<jl;j++){
if(e.keyCode==keyAction.keys[j]){
e.preventDefault();
keyAction.action(player,media,e.keyCode);
return false;
}
}
}
}
return true;
});
t.globalBind('click',function(event){
if($(event.target).closest('.mejs-container').length==0){
player.hasFocus=false;
}
});
},
findTracks:function(){
var t=this,
tracktags=t.$media.find('track');
t.tracks=[];
tracktags.each(function(index,track){
track=$(track);
t.tracks.push({
srclang:(track.attr('srclang'))?track.attr('srclang').toLowerCase():'',
src:track.attr('src'),
kind:track.attr('kind'),
label:track.attr('label')||'',
entries:[],
isLoaded:false
});
});
},
changeSkin:function(className){
this.container[0].className='mejs-container '+className;
this.setPlayerSize(this.width,this.height);
this.setControlsSize();
},
play:function(){
this.load();
this.media.play();
},
pause:function(){
try{
this.media.pause();
}catch(e){}
},
load:function(){
if(!this.isLoaded){
this.media.load();
}
this.isLoaded=true;
},
setMuted:function(muted){
this.media.setMuted(muted);
},
setCurrentTime:function(time){
this.media.setCurrentTime(time);
},
getCurrentTime:function(){
return this.media.currentTime;
},
setVolume:function(volume){
this.media.setVolume(volume);
},
getVolume:function(){
return this.media.volume;
},
setSrc:function(src){
this.media.setSrc(src);
},
remove:function(){
var t=this,featureIndex,feature;
for(featureIndex in t.options.features){
feature=t.options.features[featureIndex];
if(t['clean'+feature]){
try{
t['clean'+feature](t);
}catch(e){
}
}
}
if(!t.isDynamic){
t.$media.prop('controls',true);
t.$node.clone().show().insertBefore(t.container);
t.$node.remove();
}else{
t.$node.insertBefore(t.container);
}
if(t.media.pluginType!=='native'){
t.media.remove();
}
delete mejs.players[t.id];
t.container.remove();
t.globalUnbind();
delete t.node.player;
}
};
(function(){
var rwindow=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;
function splitEvents(events,id){
var ret={d:[],w:[]};
$.each((events||'').split(' '),function(k,v){
var eventname=v+'.'+id;
if(eventname.indexOf('.')===0){
ret.d.push(eventname);
ret.w.push(eventname);
}
else{
ret[rwindow.test(v)?'w':'d'].push(eventname);
}
});
ret.d=ret.d.join(' ');
ret.w=ret.w.join(' ');
return ret;
}
mejs.MediaElementPlayer.prototype.globalBind=function(events,data,callback){
var t=this;
events=splitEvents(events,t.id);
if(events.d)$(document).bind(events.d,data,callback);
if(events.w)$(window).bind(events.w,data,callback);
};
mejs.MediaElementPlayer.prototype.globalUnbind=function(events,callback){
var t=this;
events=splitEvents(events,t.id);
if(events.d)$(document).unbind(events.d,callback);
if(events.w)$(window).unbind(events.w,callback);
};
})();
if(typeof jQuery!='undefined'){
jQuery.fn.mediaelementplayer=function(options){
if(options===false){
this.each(function(){
var player=jQuery(this).data('mediaelementplayer');
if(player){
player.remove();
}
jQuery(this).removeData('mediaelementplayer');
});
}
else{
this.each(function(){
jQuery(this).data('mediaelementplayer',new mejs.MediaElementPlayer(this,options));
});
}
return this;
};
}
$(document).ready(function(){
$('.mejs-player').mediaelementplayer();
});
window.MediaElementPlayer=mejs.MediaElementPlayer;
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
playpauseText:mejs.i18n.t('Play/Pause')
});
$.extend(MediaElementPlayer.prototype,{
buildplaypause:function(player,controls,layers,media){
var
t=this,
play=
$('<div class="mejs-button mejs-playpause-button mejs-play" >'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.playpauseText+'" aria-label="'+t.options.playpauseText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
e.preventDefault();
if(media.paused){
media.play();
}else{
media.pause();
}
return false;
});
media.addEventListener('play',function(){
play.removeClass('mejs-play').addClass('mejs-pause');
},false);
media.addEventListener('playing',function(){
play.removeClass('mejs-play').addClass('mejs-pause');
},false);
media.addEventListener('pause',function(){
play.removeClass('mejs-pause').addClass('mejs-play');
},false);
media.addEventListener('paused',function(){
play.removeClass('mejs-pause').addClass('mejs-play');
},false);
}
});
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
stopText:'Stop'
});
$.extend(MediaElementPlayer.prototype,{
buildstop:function(player,controls,layers,media){
var t=this,
stop=
$('<div class="mejs-button mejs-stop-button mejs-stop">'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.stopText+'" aria-label="'+t.options.stopText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(){
if(!media.paused){
media.pause();
}
if(media.currentTime>0){
media.setCurrentTime(0);
media.pause();
controls.find('.mejs-time-current').width('0px');
controls.find('.mejs-time-handle').css('left','0px');
controls.find('.mejs-time-float-current').html(mejs.Utility.secondsToTimeCode(0));
controls.find('.mejs-currenttime').html(mejs.Utility.secondsToTimeCode(0));
layers.find('.mejs-poster').show();
}
});
}
});
})(mejs.$);
(function($){
$.extend(MediaElementPlayer.prototype,{
buildprogress:function(player,controls,layers,media){
$('<div class="mejs-time-rail">'+
'<span class="mejs-time-total">'+
'<span class="mejs-time-buffering"></span>'+
'<span class="mejs-time-loaded"></span>'+
'<span class="mejs-time-current"></span>'+
'<span class="mejs-time-handle"></span>'+
'<span class="mejs-time-float">'+
'<span class="mejs-time-float-current">00:00</span>'+
'<span class="mejs-time-float-corner"></span>'+
'</span>'+
'</span>'+
'</div>')
.appendTo(controls);
controls.find('.mejs-time-buffering').hide();
var
t=this,
total=controls.find('.mejs-time-total'),
loaded=controls.find('.mejs-time-loaded'),
current=controls.find('.mejs-time-current'),
handle=controls.find('.mejs-time-handle'),
timefloat=controls.find('.mejs-time-float'),
timefloatcurrent=controls.find('.mejs-time-float-current'),
handleMouseMove=function(e){
var x=e.pageX,
offset=total.offset(),
width=total.outerWidth(true),
percentage=0,
newTime=0,
pos=0;
if(media.duration){
if(x<offset.left){
x=offset.left;
}else if(x>width+offset.left){
x=width+offset.left;
}
pos=x-offset.left;
percentage=(pos/width);
newTime=(percentage<=0.02)?0:percentage*media.duration;
if(mouseIsDown&&newTime!==media.currentTime){
media.setCurrentTime(newTime);
}
if(!mejs.MediaFeatures.hasTouch){
timefloat.css('left',pos);
timefloatcurrent.html(mejs.Utility.secondsToTimeCode(newTime));
timefloat.show();
}
}
},
mouseIsDown=false,
mouseIsOver=false;
total
.bind('mousedown',function(e){
if(e.which===1){
mouseIsDown=true;
handleMouseMove(e);
t.globalBind('mousemove.dur',function(e){
handleMouseMove(e);
});
t.globalBind('mouseup.dur',function(e){
mouseIsDown=false;
timefloat.hide();
t.globalUnbind('.dur');
});
return false;
}
})
.bind('mouseenter',function(e){
mouseIsOver=true;
t.globalBind('mousemove.dur',function(e){
handleMouseMove(e);
});
if(!mejs.MediaFeatures.hasTouch){
timefloat.show();
}
})
.bind('mouseleave',function(e){
mouseIsOver=false;
if(!mouseIsDown){
t.globalUnbind('.dur');
timefloat.hide();
}
});
media.addEventListener('progress',function(e){
player.setProgressRail(e);
player.setCurrentRail(e);
},false);
media.addEventListener('timeupdate',function(e){
player.setProgressRail(e);
player.setCurrentRail(e);
},false);
t.loaded=loaded;
t.total=total;
t.current=current;
t.handle=handle;
},
setProgressRail:function(e){
var
t=this,
target=(e!=undefined)?e.target:t.media,
percent=null;
if(target&&target.buffered&&target.buffered.length>0&&target.buffered.end&&target.duration){
percent=target.buffered.end(0)/target.duration;
}
else if(target&&target.bytesTotal!=undefined&&target.bytesTotal>0&&target.bufferedBytes!=undefined){
percent=target.bufferedBytes/target.bytesTotal;
}
else if(e&&e.lengthComputable&&e.total!=0){
percent=e.loaded/e.total;
}
if(percent!==null){
percent=Math.min(1,Math.max(0,percent));
if(t.loaded&&t.total){
t.loaded.width(t.total.width()*percent);
}
}
},
setCurrentRail:function(){
var t=this;
if(t.media.currentTime!=undefined&&t.media.duration){
if(t.total&&t.handle){
var
newWidth=Math.round(t.total.width()*t.media.currentTime/t.media.duration),
handlePos=newWidth-Math.round(t.handle.outerWidth(true)/2);
t.current.width(newWidth);
t.handle.css('left',handlePos);
}
}
}
});
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
duration:-1,
timeAndDurationSeparator:'<span> | </span>'
});
$.extend(MediaElementPlayer.prototype,{
buildcurrent:function(player,controls,layers,media){
var t=this;
$('<div class="mejs-time">'+
'<span class="mejs-currenttime">'+(player.options.alwaysShowHours?'00:':'')
+(player.options.showTimecodeFrameCount?'00:00:00':'00:00')+'</span>'+
'</div>')
.appendTo(controls);
t.currenttime=t.controls.find('.mejs-currenttime');
media.addEventListener('timeupdate',function(){
player.updateCurrent();
},false);
},
buildduration:function(player,controls,layers,media){
var t=this;
if(controls.children().last().find('.mejs-currenttime').length>0){
$(t.options.timeAndDurationSeparator+
'<span class="mejs-duration">'+
(t.options.duration>0?
mejs.Utility.secondsToTimeCode(t.options.duration,t.options.alwaysShowHours||t.media.duration>3600,t.options.showTimecodeFrameCount,t.options.framesPerSecond||25):
((player.options.alwaysShowHours?'00:':'')+(player.options.showTimecodeFrameCount?'00:00:00':'00:00'))
)+
'</span>')
.appendTo(controls.find('.mejs-time'));
}else{
controls.find('.mejs-currenttime').parent().addClass('mejs-currenttime-container');
$('<div class="mejs-time mejs-duration-container">'+
'<span class="mejs-duration">'+
(t.options.duration>0?
mejs.Utility.secondsToTimeCode(t.options.duration,t.options.alwaysShowHours||t.media.duration>3600,t.options.showTimecodeFrameCount,t.options.framesPerSecond||25):
((player.options.alwaysShowHours?'00:':'')+(player.options.showTimecodeFrameCount?'00:00:00':'00:00'))
)+
'</span>'+
'</div>')
.appendTo(controls);
}
t.durationD=t.controls.find('.mejs-duration');
media.addEventListener('timeupdate',function(){
player.updateDuration();
},false);
},
updateCurrent:function(){
var t=this;
if(t.currenttime){
t.currenttime.html(mejs.Utility.secondsToTimeCode(t.media.currentTime,t.options.alwaysShowHours||t.media.duration>3600,t.options.showTimecodeFrameCount,t.options.framesPerSecond||25));
}
},
updateDuration:function(){
var t=this;
t.container.toggleClass("mejs-long-video",t.media.duration>3600);
if(t.durationD&&(t.options.duration>0||t.media.duration)){
t.durationD.html(mejs.Utility.secondsToTimeCode(t.options.duration>0?t.options.duration:t.media.duration,t.options.alwaysShowHours,t.options.showTimecodeFrameCount,t.options.framesPerSecond||25));
}
}
});
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
muteText:mejs.i18n.t('Mute Toggle'),
hideVolumeOnTouchDevices:true,
audioVolume:'horizontal',
videoVolume:'vertical'
});
$.extend(MediaElementPlayer.prototype,{
buildvolume:function(player,controls,layers,media){
if(mejs.MediaFeatures.hasTouch&&this.options.hideVolumeOnTouchDevices)
return;
var t=this,
mode=(t.isVideo)?t.options.videoVolume:t.options.audioVolume,
mute=(mode=='horizontal')?
$('<div class="mejs-button mejs-volume-button mejs-mute">'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.muteText+'" aria-label="'+t.options.muteText+'"></button>'+
'</div>'+
'<div class="mejs-horizontal-volume-slider">'+'<div class="mejs-horizontal-volume-total"></div>'+'<div class="mejs-horizontal-volume-current"></div>'+'<div class="mejs-horizontal-volume-handle"></div>'+'</div>'
)
.appendTo(controls):
$('<div class="mejs-button mejs-volume-button mejs-mute">'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.muteText+'" aria-label="'+t.options.muteText+'"></button>'+
'<div class="mejs-volume-slider">'+'<div class="mejs-volume-total"></div>'+'<div class="mejs-volume-current"></div>'+'<div class="mejs-volume-handle"></div>'+'</div>'+
'</div>')
.appendTo(controls),
volumeSlider=t.container.find('.mejs-volume-slider, .mejs-horizontal-volume-slider'),
volumeTotal=t.container.find('.mejs-volume-total, .mejs-horizontal-volume-total'),
volumeCurrent=t.container.find('.mejs-volume-current, .mejs-horizontal-volume-current'),
volumeHandle=t.container.find('.mejs-volume-handle, .mejs-horizontal-volume-handle'),
positionVolumeHandle=function(volume,secondTry){
if(!volumeSlider.is(':visible')&&typeof secondTry=='undefined'){
volumeSlider.show();
positionVolumeHandle(volume,true);
volumeSlider.hide()
return;
}
volume=Math.max(0,volume);
volume=Math.min(volume,1);
if(volume==0){
mute.removeClass('mejs-mute').addClass('mejs-unmute');
}else{
mute.removeClass('mejs-unmute').addClass('mejs-mute');
}
if(mode=='vertical'){
var
totalHeight=volumeTotal.height(),
totalPosition=volumeTotal.position(),
newTop=totalHeight-(totalHeight*volume);
volumeHandle.css('top',Math.round(totalPosition.top+newTop-(volumeHandle.height()/2)));
volumeCurrent.height(totalHeight-newTop);
volumeCurrent.css('top',totalPosition.top+newTop);
}else{
var
totalWidth=volumeTotal.width(),
totalPosition=volumeTotal.position(),
newLeft=totalWidth*volume;
volumeHandle.css('left',Math.round(totalPosition.left+newLeft-(volumeHandle.width()/2)));
volumeCurrent.width(Math.round(newLeft));
}
},
handleVolumeMove=function(e){
var volume=null,
totalOffset=volumeTotal.offset();
if(mode=='vertical'){
var
railHeight=volumeTotal.height(),
totalTop=parseInt(volumeTotal.css('top').replace(/px/,''),10),
newY=e.pageY-totalOffset.top;
volume=(railHeight-newY)/railHeight;
if(totalOffset.top==0||totalOffset.left==0)
return;
}else{
var
railWidth=volumeTotal.width(),
newX=e.pageX-totalOffset.left;
volume=newX/railWidth;
}
volume=Math.max(0,volume);
volume=Math.min(volume,1);
positionVolumeHandle(volume);
if(volume==0){
media.setMuted(true);
}else{
media.setMuted(false);
}
media.setVolume(volume);
},
mouseIsDown=false,
mouseIsOver=false;
mute
.hover(function(){
volumeSlider.show();
mouseIsOver=true;
},function(){
mouseIsOver=false;
if(!mouseIsDown&&mode=='vertical'){
volumeSlider.hide();
}
});
volumeSlider
.bind('mouseover',function(){
mouseIsOver=true;
})
.bind('mousedown',function(e){
handleVolumeMove(e);
t.globalBind('mousemove.vol',function(e){
handleVolumeMove(e);
});
t.globalBind('mouseup.vol',function(){
mouseIsDown=false;
t.globalUnbind('.vol');
if(!mouseIsOver&&mode=='vertical'){
volumeSlider.hide();
}
});
mouseIsDown=true;
return false;
});
mute.find('button').click(function(){
media.setMuted(!media.muted);
});
media.addEventListener('volumechange',function(e){
if(!mouseIsDown){
if(media.muted){
positionVolumeHandle(0);
mute.removeClass('mejs-mute').addClass('mejs-unmute');
}else{
positionVolumeHandle(media.volume);
mute.removeClass('mejs-unmute').addClass('mejs-mute');
}
}
},false);
if(t.container.is(':visible')){
positionVolumeHandle(player.options.startVolume);
if(player.options.startVolume===0){
media.setMuted(true);
}
if(media.pluginType==='native'){
media.setVolume(player.options.startVolume);
}
}
}
});
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
usePluginFullScreen:true,
newWindowCallback:function(){return''},
fullscreenText:mejs.i18n.t('Fullscreen')
});
$.extend(MediaElementPlayer.prototype,{
isFullScreen:false,
isNativeFullScreen:false,
isInIframe:false,
buildfullscreen:function(player,controls,layers,media){
if(!player.isVideo)
return;
player.isInIframe=(window.location!=window.parent.location);
if(mejs.MediaFeatures.hasTrueNativeFullScreen){
var func=function(e){
if(player.isFullScreen){
if(mejs.MediaFeatures.isFullScreen()){
player.isNativeFullScreen=true;
player.setControlsSize();
}else{
player.isNativeFullScreen=false;
player.exitFullScreen();
}
}
};
if(mejs.MediaFeatures.hasMozNativeFullScreen){
player.globalBind(mejs.MediaFeatures.fullScreenEventName,func);
}else{
player.container.bind(mejs.MediaFeatures.fullScreenEventName,func);
}
}
var t=this,
normalHeight=0,
normalWidth=0,
container=player.container,
fullscreenBtn=
$('<div class="mejs-button mejs-fullscreen-button">'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.fullscreenText+'" aria-label="'+t.options.fullscreenText+'"></button>'+
'</div>')
.appendTo(controls);
if(t.media.pluginType==='native'||(!t.options.usePluginFullScreen&&!mejs.MediaFeatures.isFirefox)){
fullscreenBtn.click(function(){
var isFullScreen=(mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen())||player.isFullScreen;
if(isFullScreen){
player.exitFullScreen();
}else{
player.enterFullScreen();
}
});
}else{
var hideTimeout=null,
supportsPointerEvents=(function(){
var element=document.createElement('x'),
documentElement=document.documentElement,
getComputedStyle=window.getComputedStyle,
supports;
if(!('pointerEvents'in element.style)){
return false;
}
element.style.pointerEvents='auto';
element.style.pointerEvents='x';
documentElement.appendChild(element);
supports=getComputedStyle&&
getComputedStyle(element,'').pointerEvents==='auto';
documentElement.removeChild(element);
return!!supports;
})();
if(supportsPointerEvents&&!mejs.MediaFeatures.isOpera){
var fullscreenIsDisabled=false,
restoreControls=function(){
if(fullscreenIsDisabled){
for(var i in hoverDivs){
hoverDivs[i].hide();
}
fullscreenBtn.css('pointer-events','');
t.controls.css('pointer-events','');
t.media.removeEventListener('click',t.clickToPlayPauseCallback);
fullscreenIsDisabled=false;
}
},
hoverDivs={},
hoverDivNames=['top','left','right','bottom'],
i,len,
positionHoverDivs=function(){
var fullScreenBtnOffsetLeft=fullscreenBtn.offset().left-t.container.offset().left,
fullScreenBtnOffsetTop=fullscreenBtn.offset().top-t.container.offset().top,
fullScreenBtnWidth=fullscreenBtn.outerWidth(true),
fullScreenBtnHeight=fullscreenBtn.outerHeight(true),
containerWidth=t.container.width(),
containerHeight=t.container.height();
for(i in hoverDivs){
hoverDivs[i].css({position:'absolute',top:0,left:0})}
hoverDivs['top']
.width(containerWidth)
.height(fullScreenBtnOffsetTop);
hoverDivs['left']
.width(fullScreenBtnOffsetLeft)
.height(fullScreenBtnHeight)
.css({top:fullScreenBtnOffsetTop});
hoverDivs['right']
.width(containerWidth-fullScreenBtnOffsetLeft-fullScreenBtnWidth)
.height(fullScreenBtnHeight)
.css({top:fullScreenBtnOffsetTop,
left:fullScreenBtnOffsetLeft+fullScreenBtnWidth});
hoverDivs['bottom']
.width(containerWidth)
.height(containerHeight-fullScreenBtnHeight-fullScreenBtnOffsetTop)
.css({top:fullScreenBtnOffsetTop+fullScreenBtnHeight});
};
t.globalBind('resize',function(){
positionHoverDivs();
});
for(i=0,len=hoverDivNames.length;i<len;i++){
hoverDivs[hoverDivNames[i]]=$('<div class="mejs-fullscreen-hover" />').appendTo(t.container).mouseover(restoreControls).hide();
}
fullscreenBtn.on('mouseover',function(){
if(!t.isFullScreen){
var buttonPos=fullscreenBtn.offset(),
containerPos=player.container.offset();
media.positionFullscreenButton(buttonPos.left-containerPos.left,buttonPos.top-containerPos.top,false);
fullscreenBtn.css('pointer-events','none');
t.controls.css('pointer-events','none');
t.media.addEventListener('click',t.clickToPlayPauseCallback);
for(i in hoverDivs){
hoverDivs[i].show();
}
positionHoverDivs();
fullscreenIsDisabled=true;
}
});
media.addEventListener('fullscreenchange',function(e){
t.isFullScreen=!t.isFullScreen;
if(t.isFullScreen){
t.media.removeEventListener('click',t.clickToPlayPauseCallback);
}else{
t.media.addEventListener('click',t.clickToPlayPauseCallback);
}
restoreControls();
});
t.globalBind('mousemove',function(e){
if(fullscreenIsDisabled){
var fullscreenBtnPos=fullscreenBtn.offset();
if(e.pageY<fullscreenBtnPos.top||e.pageY>fullscreenBtnPos.top+fullscreenBtn.outerHeight(true)||
e.pageX<fullscreenBtnPos.left||e.pageX>fullscreenBtnPos.left+fullscreenBtn.outerWidth(true)
){
fullscreenBtn.css('pointer-events','');
t.controls.css('pointer-events','');
fullscreenIsDisabled=false;
}
}
});
}else{
fullscreenBtn
.on('mouseover',function(){
if(hideTimeout!==null){
clearTimeout(hideTimeout);
delete hideTimeout;
}
var buttonPos=fullscreenBtn.offset(),
containerPos=player.container.offset();
media.positionFullscreenButton(buttonPos.left-containerPos.left,buttonPos.top-containerPos.top,true);
})
.on('mouseout',function(){
if(hideTimeout!==null){
clearTimeout(hideTimeout);
delete hideTimeout;
}
hideTimeout=setTimeout(function(){
media.hideFullscreenButton();
},1500);
});
}
}
player.fullscreenBtn=fullscreenBtn;
t.globalBind('keydown',function(e){
if(((mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen())||t.isFullScreen)&&e.keyCode==27){
player.exitFullScreen();
}
});
},
cleanfullscreen:function(player){
player.exitFullScreen();
},
containerSizeTimeout:null,
enterFullScreen:function(){
var t=this;
if(t.media.pluginType!=='native'&&(mejs.MediaFeatures.isFirefox||t.options.usePluginFullScreen)){
return;
}
$(document.documentElement).addClass('mejs-fullscreen');
normalHeight=t.container.height();
normalWidth=t.container.width();
if(t.media.pluginType==='native'){
if(mejs.MediaFeatures.hasTrueNativeFullScreen){
mejs.MediaFeatures.requestFullScreen(t.container[0]);
if(t.isInIframe){
setTimeout(function checkFullscreen(){
if(t.isNativeFullScreen){
if($(window).width()!==screen.width){
t.exitFullScreen();
}else{
setTimeout(checkFullscreen,500);
}
}
},500);
}
}else if(mejs.MediaFeatures.hasSemiNativeFullScreen){
t.media.webkitEnterFullscreen();
return;
}
}
if(t.isInIframe){
var url=t.options.newWindowCallback(this);
if(url!==''){
if(!mejs.MediaFeatures.hasTrueNativeFullScreen){
t.pause();
window.open(url,t.id,'top=0,left=0,width='+screen.availWidth+',height='+screen.availHeight+',resizable=yes,scrollbars=no,status=no,toolbar=no');
return;
}else{
setTimeout(function(){
if(!t.isNativeFullScreen){
t.pause();
window.open(url,t.id,'top=0,left=0,width='+screen.availWidth+',height='+screen.availHeight+',resizable=yes,scrollbars=no,status=no,toolbar=no');
}
},250);
}
}
}
t.container
.addClass('mejs-container-fullscreen')
.width('100%')
.height('100%');
t.containerSizeTimeout=setTimeout(function(){
t.container.css({width:'100%',height:'100%'});
t.setControlsSize();
},500);
if(t.media.pluginType==='native'){
t.$media
.width('100%')
.height('100%');
}else{
t.container.find('.mejs-shim')
.width('100%')
.height('100%');
t.media.setVideoSize($(window).width(),$(window).height());
}
t.layers.children('div')
.width('100%')
.height('100%');
if(t.fullscreenBtn){
t.fullscreenBtn
.removeClass('mejs-fullscreen')
.addClass('mejs-unfullscreen');
}
t.setControlsSize();
t.isFullScreen=true;
},
exitFullScreen:function(){
var t=this;
clearTimeout(t.containerSizeTimeout);
if(t.media.pluginType!=='native'&&mejs.MediaFeatures.isFirefox){
t.media.setFullscreen(false);
return;
}
if(mejs.MediaFeatures.hasTrueNativeFullScreen&&(mejs.MediaFeatures.isFullScreen()||t.isFullScreen)){
mejs.MediaFeatures.cancelFullScreen();
}
$(document.documentElement).removeClass('mejs-fullscreen');
t.container
.removeClass('mejs-container-fullscreen')
.width(normalWidth)
.height(normalHeight);
if(t.media.pluginType==='native'){
t.$media
.width(normalWidth)
.height(normalHeight);
}else{
t.container.find('.mejs-shim')
.width(normalWidth)
.height(normalHeight);
t.media.setVideoSize(normalWidth,normalHeight);
}
t.layers.children('div')
.width(normalWidth)
.height(normalHeight);
t.fullscreenBtn
.removeClass('mejs-unfullscreen')
.addClass('mejs-fullscreen');
t.setControlsSize();
t.isFullScreen=false;
}
});
})(mejs.$);
(function($){
$.extend(mejs.MepDefaults,{
startLanguage:'',
tracksText:mejs.i18n.t('Captions/Subtitles'),
hideCaptionsButtonWhenEmpty:true,
toggleCaptionsButtonWhenOnlyOne:false,
slidesSelector:''
});
$.extend(MediaElementPlayer.prototype,{
hasChapters:false,
buildtracks:function(player,controls,layers,media){
if(player.tracks.length==0)
return;
var t=this,
i,
options='';
if(t.domNode.textTracks){for(var i=t.domNode.textTracks.length-1;i>=0;i--){
t.domNode.textTracks[i].mode="hidden";
}
}
player.chapters=
$('<div class="mejs-chapters mejs-layer"></div>')
.prependTo(layers).hide();
player.captions=
$('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position mejs-captions-position-hover"><span class="mejs-captions-text"></span></div></div>')
.prependTo(layers).hide();
player.captionsText=player.captions.find('.mejs-captions-text');
player.captionsButton=
$('<div class="mejs-button mejs-captions-button">'+
'<button type="button" aria-controls="'+t.id+'" title="'+t.options.tracksText+'" aria-label="'+t.options.tracksText+'"></button>'+
'<div class="mejs-captions-selector">'+
'<ul>'+
'<li>'+
'<input type="radio" name="'+player.id+'_captions" id="'+player.id+'_captions_none" value="none" checked="checked" />'+
'<label for="'+player.id+'_captions_none">'+mejs.i18n.t('None')+'</label>'+
'</li>'+
'</ul>'+
'</div>'+
'</div>')
.appendTo(controls);
var subtitleCount=0;
for(i=0;i<player.tracks.length;i++){
if(player.tracks[i].kind=='subtitles'){
subtitleCount++;
}
}
if(t.options.toggleCaptionsButtonWhenOnlyOne&&subtitleCount==1){
player.captionsButton.on('click',function(){
if(player.selectedTrack==null){
var lang=player.tracks[0].srclang;
}else{
var lang='none';
}
player.setTrack(lang);
});
}else{
player.captionsButton.hover(function(){
$(this).find('.mejs-captions-selector').css('visibility','visible');
},function(){
$(this).find('.mejs-captions-selector').css('visibility','hidden');
})
.on('click','input[type=radio]',function(){
lang=this.value;
player.setTrack(lang);
});
}
if(!player.options.alwaysShowControls){
player.container
.bind('controlsshown',function(){
player.container.find('.mejs-captions-position').addClass('mejs-captions-position-hover');
})
.bind('controlshidden',function(){
if(!media.paused){
player.container.find('.mejs-captions-position').removeClass('mejs-captions-position-hover');
}
});
}else{
player.container.find('.mejs-captions-position').addClass('mejs-captions-position-hover');
}
player.trackToLoad=-1;
player.selectedTrack=null;
player.isLoadingTrack=false;
for(i=0;i<player.tracks.length;i++){
if(player.tracks[i].kind=='subtitles'){
player.addTrackButton(player.tracks[i].srclang,player.tracks[i].label);
}
}
player.loadNextTrack();
media.addEventListener('timeupdate',function(e){
player.displayCaptions();
},false);
if(player.options.slidesSelector!=''){
player.slidesContainer=$(player.options.slidesSelector);
media.addEventListener('timeupdate',function(e){
player.displaySlides();
},false);
}
media.addEventListener('loadedmetadata',function(e){
player.displayChapters();
},false);
player.container.hover(
function(){
if(player.hasChapters){
player.chapters.css('visibility','visible');
player.chapters.fadeIn(200).height(player.chapters.find('.mejs-chapter').outerHeight());
}
},
function(){
if(player.hasChapters&&!media.paused){
player.chapters.fadeOut(200,function(){
$(this).css('visibility','hidden');
$(this).css('display','block');
});
}
});
if(player.node.getAttribute('autoplay')!==null){
player.chapters.css('visibility','hidden');
}
},
setTrack:function(lang){
var t=this,
i;
if(lang=='none'){
t.selectedTrack=null;
t.captionsButton.removeClass('mejs-captions-enabled');
}else{
for(i=0;i<t.tracks.length;i++){
if(t.tracks[i].srclang==lang){
if(t.selectedTrack==null)
t.captionsButton.addClass('mejs-captions-enabled');
t.selectedTrack=t.tracks[i];
t.captions.attr('lang',t.selectedTrack.srclang);
t.displayCaptions();
break;
}
}
}
},
loadNextTrack:function(){
var t=this;
t.trackToLoad++;
if(t.trackToLoad<t.tracks.length){
t.isLoadingTrack=true;
t.loadTrack(t.trackToLoad);
}else{
t.isLoadingTrack=false;
t.checkForTracks();
}
},
loadTrack:function(index){
var
t=this,
track=t.tracks[index],
after=function(){
track.isLoaded=true;
t.enableTrackButton(track.srclang,track.label);
t.loadNextTrack();
};
$.ajax({
url:track.src,
dataType:"text",
success:function(d){
if(typeof d=="string"&&(/<tt\s+xml/ig).exec(d)){
track.entries=mejs.TrackFormatParser.dfxp.parse(d);
}else{
track.entries=mejs.TrackFormatParser.webvvt.parse(d);
}
after();
if(track.kind=='chapters'){
t.media.addEventListener('play',function(e){
if(t.media.duration>0){
t.displayChapters(track);
}
},false);
}
if(track.kind=='slides'){
t.setupSlides(track);
}
},
error:function(){
t.loadNextTrack();
}
});
},
enableTrackButton:function(lang,label){
var t=this;
if(label===''){
label=mejs.language.codes[lang]||lang;
}
t.captionsButton
.find('input[value='+lang+']')
.prop('disabled',false)
.siblings('label')
.html(label);
if(t.options.startLanguage==lang){
$('#'+t.id+'_captions_'+lang).click();
}
t.adjustLanguageBox();
},
addTrackButton:function(lang,label){
var t=this;
if(label===''){
label=mejs.language.codes[lang]||lang;
}
t.captionsButton.find('ul').append(
$('<li>'+
'<input type="radio" name="'+t.id+'_captions" id="'+t.id+'_captions_'+lang+'" value="'+lang+'" disabled="disabled" />'+
'<label for="'+t.id+'_captions_'+lang+'">'+label+' (loading)'+'</label>'+
'</li>')
);
t.adjustLanguageBox();
t.container.find('.mejs-captions-translations option[value='+lang+']').remove();
},
adjustLanguageBox:function(){
var t=this;
t.captionsButton.find('.mejs-captions-selector').height(
t.captionsButton.find('.mejs-captions-selector ul').outerHeight(true)+
t.captionsButton.find('.mejs-captions-translations').outerHeight(true)
);
},
checkForTracks:function(){
var
t=this,
hasSubtitles=false;
if(t.options.hideCaptionsButtonWhenEmpty){
for(i=0;i<t.tracks.length;i++){
if(t.tracks[i].kind=='subtitles'){
hasSubtitles=true;
break;
}
}
if(!hasSubtitles){
t.captionsButton.hide();
t.setControlsSize();
}
}
},
displayCaptions:function(){
if(typeof this.tracks=='undefined')
return;
var
t=this,
i,
track=t.selectedTrack;
if(track!=null&&track.isLoaded){
for(i=0;i<track.entries.times.length;i++){
if(t.media.currentTime>=track.entries.times[i].start&&t.media.currentTime<=track.entries.times[i].stop){
t.captionsText.html(track.entries.text[i]);
t.captions.show().height(0);
return}
}
t.captions.hide();
}else{
t.captions.hide();
}
},
setupSlides:function(track){
var t=this;
t.slides=track;
t.slides.entries.imgs=[t.slides.entries.text.length];
t.showSlide(0);
},
showSlide:function(index){
if(typeof this.tracks=='undefined'||typeof this.slidesContainer=='undefined'){
return;
}
var t=this,
url=t.slides.entries.text[index],
img=t.slides.entries.imgs[index];
if(typeof img=='undefined'||typeof img.fadeIn=='undefined'){
t.slides.entries.imgs[index]=img=$('<img src="'+url+'">')
.on('load',function(){
img.appendTo(t.slidesContainer)
.hide()
.fadeIn()
.siblings(':visible')
.fadeOut();
});
}else{
if(!img.is(':visible')&&!img.is(':animated')){
img.fadeIn()
.siblings(':visible')
.fadeOut();
}
}
},
displaySlides:function(){
if(typeof this.slides=='undefined')
return;
var
t=this,
slides=t.slides,
i;
for(i=0;i<slides.entries.times.length;i++){
if(t.media.currentTime>=slides.entries.times[i].start&&t.media.currentTime<=slides.entries.times[i].stop){
t.showSlide(i);
return}
}
},
displayChapters:function(){
var
t=this,
i;
for(i=0;i<t.tracks.length;i++){
if(t.tracks[i].kind=='chapters'&&t.tracks[i].isLoaded){
t.drawChapters(t.tracks[i]);
t.hasChapters=true;
break;
}
}
},
drawChapters:function(chapters){
var
t=this,
i,
dur,
percent=0,
usedPercent=0;
t.chapters.empty();
for(i=0;i<chapters.entries.times.length;i++){
dur=chapters.entries.times[i].stop-chapters.entries.times[i].start;
percent=Math.floor(dur/t.media.duration*100);
if(percent+usedPercent>100||i==chapters.entries.times.length-1&&percent+usedPercent<100){
percent=100-usedPercent;
}
t.chapters.append($(
'<div class="mejs-chapter" rel="'+chapters.entries.times[i].start+'" style="left: '+usedPercent.toString()+'%;width: '+percent.toString()+'%;">'+
'<div class="mejs-chapter-block'+((i==chapters.entries.times.length-1)?' mejs-chapter-block-last':'')+'">'+
'<span class="ch-title">'+chapters.entries.text[i]+'</span>'+
'<span class="ch-time">'+mejs.Utility.secondsToTimeCode(chapters.entries.times[i].start)+'&ndash;'+mejs.Utility.secondsToTimeCode(chapters.entries.times[i].stop)+'</span>'+
'</div>'+
'</div>'));
usedPercent+=percent;
}
t.chapters.find('div.mejs-chapter').click(function(){
t.media.setCurrentTime(parseFloat($(this).attr('rel')));
if(t.media.paused){
t.media.play();
}
});
t.chapters.show();
}
});
mejs.language={
codes:{
af:'Afrikaans',
sq:'Albanian',
ar:'Arabic',
be:'Belarusian',
bg:'Bulgarian',
ca:'Catalan',
zh:'Chinese',
'zh-cn':'Chinese Simplified',
'zh-tw':'Chinese Traditional',
hr:'Croatian',
cs:'Czech',
da:'Danish',
nl:'Dutch',
en:'English',
et:'Estonian',
tl:'Filipino',
fi:'Finnish',
fr:'French',
gl:'Galician',
de:'German',
el:'Greek',
ht:'Haitian Creole',
iw:'Hebrew',
hi:'Hindi',
hu:'Hungarian',
is:'Icelandic',
id:'Indonesian',
ga:'Irish',
it:'Italian',
ja:'Japanese',
ko:'Korean',
lv:'Latvian',
lt:'Lithuanian',
mk:'Macedonian',
ms:'Malay',
mt:'Maltese',
no:'Norwegian',
fa:'Persian',
pl:'Polish',
pt:'Portuguese',
ro:'Romanian',
ru:'Russian',
sr:'Serbian',
sk:'Slovak',
sl:'Slovenian',
es:'Spanish',
sw:'Swahili',
sv:'Swedish',
tl:'Tagalog',
th:'Thai',
tr:'Turkish',
uk:'Ukrainian',
vi:'Vietnamese',
cy:'Welsh',
yi:'Yiddish'
}
};

mejs.TrackFormatParser={
webvvt:{
pattern_identifier:/^([a-zA-z]+-)?[0-9]+$/,
pattern_timecode:/^([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,
parse:function(trackText){
var
i=0,
lines=mejs.TrackFormatParser.split2(trackText,/\r?\n/),
entries={text:[],times:[]},
timecode,
text;
for(;i<lines.length;i++){
if(this.pattern_identifier.exec(lines[i])){
i++;
timecode=this.pattern_timecode.exec(lines[i]);
if(timecode&&i<lines.length){
i++;
text=lines[i];
i++;
while(lines[i]!==''&&i<lines.length){
text=text+'\n'+lines[i];
i++;
}
text=$.trim(text).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a href='$1' target='_blank'>$1</a>");
entries.text.push(text);
entries.times.push(
{
start:(mejs.Utility.convertSMPTEtoSeconds(timecode[1])==0)?0.200:mejs.Utility.convertSMPTEtoSeconds(timecode[1]),
stop:mejs.Utility.convertSMPTEtoSeconds(timecode[3]),
settings:timecode[5]
});
}
}
}
return entries;
}
},
dfxp:{
parse:function(trackText){
trackText=$(trackText).filter("tt");
var
i=0,
container=trackText.children("div").eq(0),
lines=container.find("p"),
styleNode=trackText.find("#"+container.attr("style")),
styles,
begin,
end,
text,
entries={text:[],times:[]};
if(styleNode.length){
var attributes=styleNode.removeAttr("id").get(0).attributes;
if(attributes.length){
styles={};
for(i=0;i<attributes.length;i++){
styles[attributes[i].name.split(":")[1]]=attributes[i].value;
}
}
}
for(i=0;i<lines.length;i++){
var style;
var _temp_times={
start:null,
stop:null,
style:null
};
if(lines.eq(i).attr("begin"))_temp_times.start=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i).attr("begin"));
if(!_temp_times.start&&lines.eq(i-1).attr("end"))_temp_times.start=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i-1).attr("end"));
if(lines.eq(i).attr("end"))_temp_times.stop=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i).attr("end"));
if(!_temp_times.stop&&lines.eq(i+1).attr("begin"))_temp_times.stop=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i+1).attr("begin"));
if(styles){
style="";
for(var _style in styles){
style+=_style+":"+styles[_style]+";";
}
}
if(style)_temp_times.style=style;
if(_temp_times.start==0)_temp_times.start=0.200;
entries.times.push(_temp_times);
text=$.trim(lines.eq(i).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a href='$1' target='_blank'>$1</a>");
entries.text.push(text);
if(entries.times.start==0)entries.times.start=2;
}
return entries;
}
},
split2:function(text,regex){
return text.split(regex);
}
};
if('x\n\ny'.split(/\n/gi).length!=3){
mejs.TrackFormatParser.split2=function(text,regex){
var
parts=[],
chunk='',
i;
for(i=0;i<text.length;i++){
chunk+=text.substring(i,i+1);
if(regex.test(chunk)){
parts.push(chunk.replace(regex,''));
chunk='';
}
}
parts.push(chunk);
return parts;
}
}
})(mejs.$);

(function($){
$.extend(mejs.MepDefaults,
{'contextMenuItems':[
{
render:function(player){
if(typeof player.enterFullScreen=='undefined')
return null;
if(player.isFullScreen){
return mejs.i18n.t('Turn off Fullscreen');
}else{
return mejs.i18n.t('Go Fullscreen');
}
},
click:function(player){
if(player.isFullScreen){
player.exitFullScreen();
}else{
player.enterFullScreen();
}
}
}
,
{
render:function(player){
if(player.media.muted){
return mejs.i18n.t('Unmute');
}else{
return mejs.i18n.t('Mute');
}
},
click:function(player){
if(player.media.muted){
player.setMuted(false);
}else{
player.setMuted(true);
}
}
},
{
isSeparator:true
}
,
{
render:function(player){
return mejs.i18n.t('Download Video');
},
click:function(player){
window.location.href=player.media.currentSrc;
}
}
]}
);
$.extend(MediaElementPlayer.prototype,{
buildcontextmenu:function(player,controls,layers,media){
player.contextMenu=$('<div class="mejs-contextmenu"></div>')
.appendTo($('body'))
.hide();
player.container.bind('contextmenu',function(e){
if(player.isContextMenuEnabled){
e.preventDefault();
player.renderContextMenu(e.clientX-1,e.clientY-1);
return false;
}
});
player.container.bind('click',function(){
player.contextMenu.hide();
});
player.contextMenu.bind('mouseleave',function(){
player.startContextMenuTimer();
});
},
cleancontextmenu:function(player){
player.contextMenu.remove();
},
isContextMenuEnabled:true,
enableContextMenu:function(){
this.isContextMenuEnabled=true;
},
disableContextMenu:function(){
this.isContextMenuEnabled=false;
},
contextMenuTimeout:null,
startContextMenuTimer:function(){
var t=this;
t.killContextMenuTimer();
t.contextMenuTimer=setTimeout(function(){
t.hideContextMenu();
t.killContextMenuTimer();
},750);
},
killContextMenuTimer:function(){
var timer=this.contextMenuTimer;
if(timer!=null){
clearTimeout(timer);
delete timer;
timer=null;
}
},
hideContextMenu:function(){
this.contextMenu.hide();
},
renderContextMenu:function(x,y){
var t=this,
html='',
items=t.options.contextMenuItems;
for(var i=0,il=items.length;i<il;i++){
if(items[i].isSeparator){
html+='<div class="mejs-contextmenu-separator"></div>';
}else{
var rendered=items[i].render(t);
if(rendered!=null){
html+='<div class="mejs-contextmenu-item" data-itemindex="'+i+'" id="element-'+(Math.random()*1000000)+'">'+rendered+'</div>';
}
}
}
t.contextMenu
.empty()
.append($(html))
.css({top:y,left:x})
.show();
t.contextMenu.find('.mejs-contextmenu-item').each(function(){
var $dom=$(this),
itemIndex=parseInt($dom.data('itemindex'),10),
item=t.options.contextMenuItems[itemIndex];
if(typeof item.show!='undefined')
item.show($dom,t);
$dom.click(function(){
if(typeof item.click!='undefined')
item.click(t);
t.contextMenu.hide();
});
});
setTimeout(function(){
t.killControlsTimer('rev3');
},100);
}
});
})(mejs.$);

(function($){
$.extend(mejs.MepDefaults,{
postrollCloseText:mejs.i18n.t('Close')
});
$.extend(MediaElementPlayer.prototype,{
buildpostroll:function(player,controls,layers,media){
var
t=this,
postrollLink=t.container.find('link[rel="postroll"]').attr('href');
if(typeof postrollLink!=='undefined'){
player.postroll=
$('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">'+t.options.postrollCloseText+'</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(layers).hide();
t.media.addEventListener('ended',function(e){
$.ajax({
dataType:'html',
url:postrollLink,
success:function(data,textStatus){
layers.find('.mejs-postroll-layer-content').html(data);
}
});
player.postroll.show();
},false);
}
}
});
})(mejs.$);
;

;
(function($){
$.extend(mejs.MepDefaults,{
loopText:'Repeat On/Off',
shuffleText:'Shuffle On/Off',
nextText:'Next Track',
prevText:'Previous Track',
playlistText:'Show/Hide Playlist'
});
$.extend(MediaElementPlayer.prototype,{
buildloop:function(player,controls,layers,media){
var t=this;
var loop=$('<div class="mejs-button mejs-loop-button '+((player.options.loop)?'mejs-loop-on':'mejs-loop-off')+'">'+
'<button type="button" aria-controls="'+player.id+'" title="'+player.options.loopText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
player.options.loop=!player.options.loop;
$(media).trigger('mep-looptoggle',[player.options.loop]);
if(player.options.loop){
loop.removeClass('mejs-loop-off').addClass('mejs-loop-on');
}
else{
loop.removeClass('mejs-loop-on').addClass('mejs-loop-off');
}
});
t.loopToggle=t.controls.find('.mejs-loop-button');
},
loopToggleClick:function(){
var t=this;
t.loopToggle.trigger('click');
},
buildshuffle:function(player,controls,layers,media){
var t=this;
var shuffle=$('<div class="mejs-button mejs-shuffle-button '+((player.options.shuffle)?'mejs-shuffle-on':'mejs-shuffle-off')+'">'+
'<button type="button" aria-controls="'+player.id+'" title="'+player.options.shuffleText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
player.options.shuffle=!player.options.shuffle;
$(media).trigger('mep-shuffletoggle',[player.options.shuffle]);
if(player.options.shuffle){
shuffle.removeClass('mejs-shuffle-off').addClass('mejs-shuffle-on');
}
else{
shuffle.removeClass('mejs-shuffle-on').addClass('mejs-shuffle-off');
}
});
t.shuffleToggle=t.controls.find('.mejs-shuffle-button');
},
shuffleToggleClick:function(){
var t=this;
t.shuffleToggle.trigger('click');
},
buildprevtrack:function(player,controls,layers,media){
var t=this;
var prevTrack=$('<div class="mejs-button mejs-prevtrack-button mejs-prevtrack">'+
'<button type="button" aria-controls="'+player.id+'" title="'+player.options.prevText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
$(media).trigger('mep-playprevtrack');
player.playPrevTrack();
});
t.prevTrack=t.controls.find('.mejs-prevtrack-button');
},
prevTrackClick:function(){
var t=this;
t.prevTrack.trigger('click');
},
buildnexttrack:function(player,controls,layers,media){
var t=this;
var nextTrack=$('<div class="mejs-button mejs-nexttrack-button mejs-nexttrack">'+
'<button type="button" aria-controls="'+player.id+'" title="'+player.options.nextText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
$(media).trigger('mep-playnexttrack');
player.playNextTrack();
});
t.nextTrack=t.controls.find('.mejs-nexttrack-button');
},
nextTrackClick:function(){
var t=this;
t.nextTrack.trigger('click');
},
buildplaylist:function(player,controls,layers,media){
var t=this;
var playlistToggle=$('<div class="mejs-button mejs-playlist-button '+((player.options.playlist)?'mejs-hide-playlist':'mejs-show-playlist')+'">'+
'<button type="button" aria-controls="'+player.id+'" title="'+player.options.playlistText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
player.options.playlist=!player.options.playlist;
$(media).trigger('mep-playlisttoggle',[player.options.playlist]);
if(player.options.playlist){
layers.children('.mejs-playlist').show();
playlistToggle.removeClass('mejs-show-playlist').addClass('mejs-hide-playlist');
}
else{
layers.children('.mejs-playlist').hide();
playlistToggle.removeClass('mejs-hide-playlist').addClass('mejs-show-playlist');
}
});
t.playlistToggle=t.controls.find('.mejs-playlist-button');
},
playlistToggleClick:function(){
var t=this;
t.playlistToggle.trigger('click');
},
buildplaylistfeature:function(player,controls,layers,media){
var playlist=$('<div class="mejs-playlist mejs-layer">'+
'<ul class="mejs"></ul>'+
'</div>')
.appendTo(layers);
if(!player.options.playlist){
playlist.hide();
}
if(player.options.playlistposition=='bottom'){
playlist.css('top',player.options.audioHeight+'px');
}
else{
playlist.css('bottom',player.options.audioHeight+'px');
}
var getTrackName=function(trackUrl){
var trackUrlParts=trackUrl.split("/");
if(trackUrlParts.length>0){
return decodeURIComponent(trackUrlParts[trackUrlParts.length-1]);
}
else{
return'';
}
};
var tracks=[];
$('#'+player.id).find('.mejs-mediaelement source').each(function(index,element){
if($.trim(this.src)!=''){
var track={};
track.source=$.trim(this.src);
if($.trim(this.title)!=''){
track.name=$.trim(this.title);
}
else{
track.name=getTrackName(track.source);
}
tracks.push(track);
}
});
for(var track in tracks){
layers.find('.mejs-playlist > ul').append('<li data-url="'+tracks[track].source+'" title="'+tracks[track].name+'">'+tracks[track].name+'</li>');
}
layers.find('li:first').addClass('current played');
layers.find('.mejs-playlist > ul li').click(function(e){
if(!$(this).hasClass('current')){
$(this).addClass('played');
player.playTrack($(this));
}
else{
player.play();
}
});
media.addEventListener('ended',function(e){
player.playNextTrack();
},false);
},
playNextTrack:function(){
var t=this;
var tracks=t.layers.find('.mejs-playlist > ul > li');
var current=tracks.filter('.current');
var notplayed=tracks.not('.played');
if(notplayed.length<1){
current.removeClass('played').siblings().removeClass('played');
notplayed=tracks.not('.current');
}
if(t.options.shuffle){
var random=Math.floor(Math.random()*notplayed.length);
var nxt=notplayed.eq(random);
}
else{
var nxt=current.next();
if(nxt.length<1&&t.options.loop){
nxt=current.siblings().first();
}
}
if(nxt.length==1){
nxt.addClass('played');
t.playTrack(nxt);
}
},
playPrevTrack:function(){
var t=this;
var tracks=t.layers.find('.mejs-playlist > ul > li');
var current=tracks.filter('.current');
var played=tracks.filter('.played').not('.current');
if(played.length<1){
current.removeClass('played');
played=tracks.not('.current');
}
if(t.options.shuffle){
var random=Math.floor(Math.random()*played.length);
var prev=played.eq(random);
}
else{
var prev=current.prev();
if(prev.length<1&&t.options.loop){
prev=current.siblings().last();
}
}
if(prev.length==1){
current.removeClass('played');
t.playTrack(prev);
}
},
playTrack:function(track){
var t=this;
t.pause();
t.setSrc(track.attr('data-url'));
t.load();
t.play();
track.addClass('current').siblings().removeClass('current');
},
playTrackURL:function(url){
var t=this;
var tracks=t.layers.find('.mejs-playlist > ul > li');
var track=tracks.filter('[data-url="'+url+'"]');
t.playTrack(track);
}
});
})(mejs.$);
;

;
(function($){
$.extend(mejs.MepDefaults,{
loopText:'Repeat On/Off',
shuffleText:'Shuffle On/Off',
nextText:'Next Track',
prevText:'Previous Track',
playlistText:'Show/Hide Playlist'
});
$.extend(MediaElementPlayer.prototype,{
buildloop:function(player,controls,layers,media){
var t=this;
var loop=$('<div class="mejs-button mejs-loop-button '+((player.options.loop)?'mejs-loop-on':'mejs-loop-off')+'">'+
'<button type="button" aria-controls="'+player.id+'" title="'+player.options.loopText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
player.options.loop=!player.options.loop;
$(media).trigger('mep-looptoggle',[player.options.loop]);
if(player.options.loop){
loop.removeClass('mejs-loop-off').addClass('mejs-loop-on');
}
else{
loop.removeClass('mejs-loop-on').addClass('mejs-loop-off');
}
});
t.loopToggle=t.controls.find('.mejs-loop-button');
},
loopToggleClick:function(){
var t=this;
t.loopToggle.trigger('click');
},
buildshuffle:function(player,controls,layers,media){
var t=this;
var shuffle=$('<div class="mejs-button mejs-shuffle-button '+((player.options.shuffle)?'mejs-shuffle-on':'mejs-shuffle-off')+'">'+
'<button type="button" aria-controls="'+player.id+'" title="'+player.options.shuffleText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
player.options.shuffle=!player.options.shuffle;
$(media).trigger('mep-shuffletoggle',[player.options.shuffle]);
if(player.options.shuffle){
shuffle.removeClass('mejs-shuffle-off').addClass('mejs-shuffle-on');
}
else{
shuffle.removeClass('mejs-shuffle-on').addClass('mejs-shuffle-off');
}
});
t.shuffleToggle=t.controls.find('.mejs-shuffle-button');
},
shuffleToggleClick:function(){
var t=this;
t.shuffleToggle.trigger('click');
},
buildprevtrack:function(player,controls,layers,media){
var t=this;
var prevTrack=$('<div class="mejs-button mejs-prevtrack-button mejs-prevtrack">'+
'<button type="button" aria-controls="'+player.id+'" title="'+player.options.prevText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
$(media).trigger('mep-playprevtrack');
player.playPrevTrack();
});
t.prevTrack=t.controls.find('.mejs-prevtrack-button');
},
prevTrackClick:function(){
var t=this;
t.prevTrack.trigger('click');
},
buildnexttrack:function(player,controls,layers,media){
var t=this;
var nextTrack=$('<div class="mejs-button mejs-nexttrack-button mejs-nexttrack">'+
'<button type="button" aria-controls="'+player.id+'" title="'+player.options.nextText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
$(media).trigger('mep-playnexttrack');
player.playNextTrack();
});
t.nextTrack=t.controls.find('.mejs-nexttrack-button');
},
nextTrackClick:function(){
var t=this;
t.nextTrack.trigger('click');
},
buildplaylist:function(player,controls,layers,media){
var t=this;
var playlistToggle=$('<div class="mejs-button mejs-playlist-button '+((player.options.playlist)?'mejs-hide-playlist':'mejs-show-playlist')+'">'+
'<button type="button" aria-controls="'+player.id+'" title="'+player.options.playlistText+'"></button>'+
'</div>')
.appendTo(controls)
.click(function(e){
player.options.playlist=!player.options.playlist;
$(media).trigger('mep-playlisttoggle',[player.options.playlist]);
if(player.options.playlist){
layers.children('.mejs-playlist').show();
playlistToggle.removeClass('mejs-show-playlist').addClass('mejs-hide-playlist');
}
else{
layers.children('.mejs-playlist').hide();
playlistToggle.removeClass('mejs-hide-playlist').addClass('mejs-show-playlist');
}
});
t.playlistToggle=t.controls.find('.mejs-playlist-button');
},
playlistToggleClick:function(){
var t=this;
t.playlistToggle.trigger('click');
},
buildplaylistfeature:function(player,controls,layers,media){
var playlist=$('<div class="mejs-playlist mejs-layer">'+
'<ul class="mejs"></ul>'+
'</div>')
.appendTo(layers);
if(!player.options.playlist){
playlist.hide();
}
if(player.options.playlistposition=='bottom'){
playlist.css('top',player.options.audioHeight+'px');
}
else{
playlist.css('bottom',player.options.audioHeight+'px');
}
var getTrackName=function(trackUrl){
var trackUrlParts=trackUrl.split("/");
if(trackUrlParts.length>0){
return decodeURIComponent(trackUrlParts[trackUrlParts.length-1]);
}
else{
return'';
}
};
var tracks=[];
$('#'+player.id).find('.mejs-mediaelement source').each(function(index,element){
if($.trim(this.src)!=''){
var track={};
track.source=$.trim(this.src);
if($.trim(this.title)!=''){
track.name=$.trim(this.title);
}
else{
track.name=getTrackName(track.source);
}
tracks.push(track);
}
});
for(var track in tracks){
layers.find('.mejs-playlist > ul').append('<li data-url="'+tracks[track].source+'" title="'+tracks[track].name+'">'+tracks[track].name+'</li>');
}
layers.find('li:first').addClass('current played');
layers.find('.mejs-playlist > ul li').click(function(e){
if(!$(this).hasClass('current')){
$(this).addClass('played');
player.playTrack($(this));
}
else{
player.play();
}
});
media.addEventListener('ended',function(e){
player.playNextTrack();
},false);
},
playNextTrack:function(){
var t=this;
var tracks=t.layers.find('.mejs-playlist > ul > li');
var current=tracks.filter('.current');
var notplayed=tracks.not('.played');
if(notplayed.length<1){
current.removeClass('played').siblings().removeClass('played');
notplayed=tracks.not('.current');
}
if(t.options.shuffle){
var random=Math.floor(Math.random()*notplayed.length);
var nxt=notplayed.eq(random);
}
else{
var nxt=current.next();
if(nxt.length<1&&t.options.loop){
nxt=current.siblings().first();
}
}
if(nxt.length==1){
nxt.addClass('played');
t.playTrack(nxt);
}
},
playPrevTrack:function(){
var t=this;
var tracks=t.layers.find('.mejs-playlist > ul > li');
var current=tracks.filter('.current');
var played=tracks.filter('.played').not('.current');
if(played.length<1){
current.removeClass('played');
played=tracks.not('.current');
}
if(t.options.shuffle){
var random=Math.floor(Math.random()*played.length);
var prev=played.eq(random);
}
else{
var prev=current.prev();
if(prev.length<1&&t.options.loop){
prev=current.siblings().last();
}
}
if(prev.length==1){
current.removeClass('played');
t.playTrack(prev);
}
},
playTrack:function(track){
var t=this;
t.pause();
t.setSrc(track.attr('data-url'));
t.load();
t.play();
track.addClass('current').siblings().removeClass('current');
},
playTrackURL:function(url){
var t=this;
var tracks=t.layers.find('.mejs-playlist > ul > li');
var track=tracks.filter('[data-url="'+url+'"]');
t.playTrack(track);
}
});
})(mejs.$);
;

;
angular
.module('ng-context-menu',[])
.factory('ContextMenuService',function(){
return{
menuElement:null
};
})
.directive('contextMenu',['$window','$parse','ContextMenuService',function($window,$parse,ContextMenuService){
return{
restrict:'A',
link:function($scope,element,attrs){
var opened=false,
openTarget,
disabled=$scope.$eval(attrs.contextMenuDisabled),
win=angular.element($window),
fn=$parse(attrs.contextMenu);
element.bind('contextmenu',function(event){
if(!disabled){
if(ContextMenuService.menuElement!==null){
close(ContextMenuService.menuElement);
}
ContextMenuService.menuElement=angular.element(document.getElementById(attrs.target));
openTarget=event.target;
event.preventDefault();
event.stopPropagation();
$scope.$apply(function(){
fn($scope,{$event:event});
});
}
});
}
};
}]);
;

;var dbits;
var canary=0xdeadbeefcafe;
var j_lm=((canary&0xffffff)==0xefcafe);
function BigInteger(a,b,c){
if(a!=null)
if("number"==typeof a)this.fromNumber(a,b,c);
else if(b==null&&"string"!=typeof a)this.fromString(a,256);
else this.fromString(a,b);
}
function nbi(){return new BigInteger(null)}
function am1(i,x,w,j,c,n){
while(--n>=0){
var v=x*this[i++]+w[j]+c;
c=Math.floor(v/0x4000000);
w[j++]=v&0x3ffffff;
}
return c;
}
function am2(i,x,w,j,c,n){
var xl=x&0x7fff,xh=x>>15;
while(--n>=0){
var l=this[i]&0x7fff;
var h=this[i++]>>15;
var m=xh*l+h*xl;
l=xl*l+((m&0x7fff)<<15)+w[j]+(c&0x3fffffff);
c=(l>>>30)+(m>>>15)+xh*h+(c>>>30);
w[j++]=l&0x3fffffff;
}
return c;
}
function am3(i,x,w,j,c,n){
var xl=x&0x3fff,xh=x>>14;
while(--n>=0){
var l=this[i]&0x3fff;
var h=this[i++]>>14;
var m=xh*l+h*xl;
l=xl*l+((m&0x3fff)<<14)+w[j]+c;
c=(l>>28)+(m>>14)+xh*h;
w[j++]=l&0xfffffff;
}
return c;
}
if(j_lm&&(navigator.appName=="Microsoft Internet Explorer")){
BigInteger.prototype.am=am2;
dbits=30;
}
else if(j_lm&&(navigator.appName!="Netscape")){
BigInteger.prototype.am=am1;
dbits=26;
}
else{BigInteger.prototype.am=am3;
dbits=28;
}
BigInteger.prototype.DB=dbits;
BigInteger.prototype.DM=((1<<dbits)-1);
BigInteger.prototype.DV=(1<<dbits);
var BI_FP=52;
BigInteger.prototype.FV=Math.pow(2,BI_FP);
BigInteger.prototype.F1=BI_FP-dbits;
BigInteger.prototype.F2=2*dbits-BI_FP;
var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";
var BI_RC=new Array();
var rr,vv;
rr="0".charCodeAt(0);
for(vv=0;vv<=9;++vv)BI_RC[rr++]=vv;
rr="a".charCodeAt(0);
for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;
rr="A".charCodeAt(0);
for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;
function int2char(n){return BI_RM.charAt(n)}
function intAt(s,i){
var c=BI_RC[s.charCodeAt(i)];
return(c==null)?-1:c;
}
function bnpCopyTo(r){
for(var i=this.t-1;i>=0;--i)r[i]=this[i];
r.t=this.t;
r.s=this.s;
}
function bnpFromInt(x){
this.t=1;
this.s=(x<0)?-1:0;
if(x>0)this[0]=x;
else if(x<-1)this[0]=x+this.DV;
else this.t=0;
}
function nbv(i){var r=nbi();r.fromInt(i);return r}
function bnpFromString(s,b){
var k;
if(b==16)k=4;
else if(b==8)k=3;
else if(b==256)k=8;else if(b==2)k=1;
else if(b==32)k=5;
else if(b==4)k=2;
else{this.fromRadix(s,b);return}
this.t=0;
this.s=0;
var i=s.length,mi=false,sh=0;
while(--i>=0){
var x=(k==8)?s[i]&0xff:intAt(s,i);
if(x<0){
if(s.charAt(i)=="-")mi=true;
continue;
}
mi=false;
if(sh==0)
this[this.t++]=x;
else if(sh+k>this.DB){
this[this.t-1]|=(x&((1<<(this.DB-sh))-1))<<sh;
this[this.t++]=(x>>(this.DB-sh));
}
else
this[this.t-1]|=x<<sh;
sh+=k;
if(sh>=this.DB)sh-=this.DB;
}
if(k==8&&(s[0]&0x80)!=0){
this.s=-1;
if(sh>0)this[this.t-1]|=((1<<(this.DB-sh))-1)<<sh;
}
this.clamp();
if(mi)BigInteger.ZERO.subTo(this,this);
}
function bnpClamp(){
var c=this.s&this.DM;
while(this.t>0&&this[this.t-1]==c)--this.t;
}
function bnToString(b){
if(this.s<0)return"-"+this.negate().toString(b);
var k;
if(b==16)k=4;
else if(b==8)k=3;
else if(b==2)k=1;
else if(b==32)k=5;
else if(b==4)k=2;
else return this.toRadix(b);
var km=(1<<k)-1,d,m=false,r="",i=this.t;
var p=this.DB-(i*this.DB)%k;
if(i-->0){
if(p<this.DB&&(d=this[i]>>p)>0){m=true;r=int2char(d)}
while(i>=0){
if(p<k){
d=(this[i]&((1<<p)-1))<<(k-p);
d|=this[--i]>>(p+=this.DB-k);
}
else{
d=(this[i]>>(p-=k))&km;
if(p<=0){p+=this.DB;--i}
}
if(d>0)m=true;
if(m)r+=int2char(d);
}
}
return m?r:"0";
}
function bnNegate(){var r=nbi();BigInteger.ZERO.subTo(this,r);return r}
function bnAbs(){return(this.s<0)?this.negate():this}
function bnCompareTo(a){
var r=this.s-a.s;
if(r!=0)return r;
var i=this.t;
r=i-a.t;
if(r!=0)return(this.s<0)?-r:r;
while(--i>=0)if((r=this[i]-a[i])!=0)return r;
return 0;
}
function nbits(x){
var r=1,t;
if((t=x>>>16)!=0){x=t;r+=16}
if((t=x>>8)!=0){x=t;r+=8}
if((t=x>>4)!=0){x=t;r+=4}
if((t=x>>2)!=0){x=t;r+=2}
if((t=x>>1)!=0){x=t;r+=1}
return r;
}
function bnBitLength(){
if(this.t<=0)return 0;
return this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&this.DM));
}
function bnpDLShiftTo(n,r){
var i;
for(i=this.t-1;i>=0;--i)r[i+n]=this[i];
for(i=n-1;i>=0;--i)r[i]=0;
r.t=this.t+n;
r.s=this.s;
}
function bnpDRShiftTo(n,r){
for(var i=n;i<this.t;++i)r[i-n]=this[i];
r.t=Math.max(this.t-n,0);
r.s=this.s;
}
function bnpLShiftTo(n,r){
var bs=n%this.DB;
var cbs=this.DB-bs;
var bm=(1<<cbs)-1;
var ds=Math.floor(n/this.DB),c=(this.s<<bs)&this.DM,i;
for(i=this.t-1;i>=0;--i){
r[i+ds+1]=(this[i]>>cbs)|c;
c=(this[i]&bm)<<bs;
}
for(i=ds-1;i>=0;--i)r[i]=0;
r[ds]=c;
r.t=this.t+ds+1;
r.s=this.s;
r.clamp();
}
function bnpRShiftTo(n,r){
r.s=this.s;
var ds=Math.floor(n/this.DB);
if(ds>=this.t){r.t=0;return}
var bs=n%this.DB;
var cbs=this.DB-bs;
var bm=(1<<bs)-1;
r[0]=this[ds]>>bs;
for(var i=ds+1;i<this.t;++i){
r[i-ds-1]|=(this[i]&bm)<<cbs;
r[i-ds]=this[i]>>bs;
}
if(bs>0)r[this.t-ds-1]|=(this.s&bm)<<cbs;
r.t=this.t-ds;
r.clamp();
}
function bnpSubTo(a,r){
var i=0,c=0,m=Math.min(a.t,this.t);
while(i<m){
c+=this[i]-a[i];
r[i++]=c&this.DM;
c>>=this.DB;
}
if(a.t<this.t){
c-=a.s;
while(i<this.t){
c+=this[i];
r[i++]=c&this.DM;
c>>=this.DB;
}
c+=this.s;
}
else{
c+=this.s;
while(i<a.t){
c-=a[i];
r[i++]=c&this.DM;
c>>=this.DB;
}
c-=a.s;
}
r.s=(c<0)?-1:0;
if(c<-1)r[i++]=this.DV+c;
else if(c>0)r[i++]=c;
r.t=i;
r.clamp();
}
function bnpMultiplyTo(a,r){
var x=this.abs(),y=a.abs();
var i=x.t;
r.t=i+y.t;
while(--i>=0)r[i]=0;
for(i=0;i<y.t;++i)r[i+x.t]=x.am(0,y[i],r,i,0,x.t);
r.s=0;
r.clamp();
if(this.s!=a.s)BigInteger.ZERO.subTo(r,r);
}
function bnpSquareTo(r){
var x=this.abs();
var i=r.t=2*x.t;
while(--i>=0)r[i]=0;
for(i=0;i<x.t-1;++i){
var c=x.am(i,x[i],r,2*i,0,1);
if((r[i+x.t]+=x.am(i+1,2*x[i],r,2*i+1,c,x.t-i-1))>=x.DV){
r[i+x.t]-=x.DV;
r[i+x.t+1]=1;
}
}
if(r.t>0)r[r.t-1]+=x.am(i,x[i],r,2*i,0,1);
r.s=0;
r.clamp();
}
function bnpDivRemTo(m,q,r){
var pm=m.abs();
if(pm.t<=0)return;
var pt=this.abs();
if(pt.t<pm.t){
if(q!=null)q.fromInt(0);
if(r!=null)this.copyTo(r);
return;
}
if(r==null)r=nbi();
var y=nbi(),ts=this.s,ms=m.s;
var nsh=this.DB-nbits(pm[pm.t-1]);if(nsh>0){pm.lShiftTo(nsh,y);pt.lShiftTo(nsh,r)}
else{pm.copyTo(y);pt.copyTo(r)}
var ys=y.t;
var y0=y[ys-1];
if(y0==0)return;
var yt=y0*(1<<this.F1)+((ys>1)?y[ys-2]>>this.F2:0);
var d1=this.FV/yt,d2=(1<<this.F1)/yt,e=1<<this.F2;
var i=r.t,j=i-ys,t=(q==null)?nbi():q;
y.dlShiftTo(j,t);
if(r.compareTo(t)>=0){
r[r.t++]=1;
r.subTo(t,r);
}
BigInteger.ONE.dlShiftTo(ys,t);
t.subTo(y,y);while(y.t<ys)y[y.t++]=0;
while(--j>=0){
var qd=(r[--i]==y0)?this.DM:Math.floor(r[i]*d1+(r[i-1]+e)*d2);
if((r[i]+=y.am(0,qd,r,j,0,ys))<qd){y.dlShiftTo(j,t);
r.subTo(t,r);
while(r[i]<--qd)r.subTo(t,r);
}
}
if(q!=null){
r.drShiftTo(ys,q);
if(ts!=ms)BigInteger.ZERO.subTo(q,q);
}
r.t=ys;
r.clamp();
if(nsh>0)r.rShiftTo(nsh,r);if(ts<0)BigInteger.ZERO.subTo(r,r);
}
function bnMod(a){
var r=nbi();
this.abs().divRemTo(a,null,r);
if(this.s<0&&r.compareTo(BigInteger.ZERO)>0)a.subTo(r,r);
return r;
}
function Classic(m){this.m=m}
function cConvert(x){
if(x.s<0||x.compareTo(this.m)>=0)return x.mod(this.m);
else return x;
}
function cRevert(x){return x}
function cReduce(x){x.divRemTo(this.m,null,x)}
function cMulTo(x,y,r){x.multiplyTo(y,r);this.reduce(r)}
function cSqrTo(x,r){x.squareTo(r);this.reduce(r)}
Classic.prototype.convert=cConvert;
Classic.prototype.revert=cRevert;
Classic.prototype.reduce=cReduce;
Classic.prototype.mulTo=cMulTo;
Classic.prototype.sqrTo=cSqrTo;
function bnpInvDigit(){
if(this.t<1)return 0;
var x=this[0];
if((x&1)==0)return 0;
var y=x&3;y=(y*(2-(x&0xf)*y))&0xf;y=(y*(2-(x&0xff)*y))&0xff;y=(y*(2-(((x&0xffff)*y)&0xffff)))&0xffff;y=(y*(2-x*y%this.DV))%this.DV;return(y>0)?this.DV-y:-y;
}
function Montgomery(m){
this.m=m;
this.mp=m.invDigit();
this.mpl=this.mp&0x7fff;
this.mph=this.mp>>15;
this.um=(1<<(m.DB-15))-1;
this.mt2=2*m.t;
}
function montConvert(x){
var r=nbi();
x.abs().dlShiftTo(this.m.t,r);
r.divRemTo(this.m,null,r);
if(x.s<0&&r.compareTo(BigInteger.ZERO)>0)this.m.subTo(r,r);
return r;
}
function montRevert(x){
var r=nbi();
x.copyTo(r);
this.reduce(r);
return r;
}
function montReduce(x){
while(x.t<=this.mt2)x[x.t++]=0;
for(var i=0;i<this.m.t;++i){
var j=x[i]&0x7fff;
var u0=(j*this.mpl+(((j*this.mph+(x[i]>>15)*this.mpl)&this.um)<<15))&x.DM;
j=i+this.m.t;
x[j]+=this.m.am(0,u0,x,i,0,this.m.t);
while(x[j]>=x.DV){x[j]-=x.DV;x[++j]++}
}
x.clamp();
x.drShiftTo(this.m.t,x);
if(x.compareTo(this.m)>=0)x.subTo(this.m,x);
}
function montSqrTo(x,r){x.squareTo(r);this.reduce(r)}
function montMulTo(x,y,r){x.multiplyTo(y,r);this.reduce(r)}
Montgomery.prototype.convert=montConvert;
Montgomery.prototype.revert=montRevert;
Montgomery.prototype.reduce=montReduce;
Montgomery.prototype.mulTo=montMulTo;
Montgomery.prototype.sqrTo=montSqrTo;
function bnpIsEven(){return((this.t>0)?(this[0]&1):this.s)==0}
function bnpExp(e,z){
if(e>0xffffffff||e<1)return BigInteger.ONE;
var r=nbi(),r2=nbi(),g=z.convert(this),i=nbits(e)-1;
g.copyTo(r);
while(--i>=0){
z.sqrTo(r,r2);
if((e&(1<<i))>0)z.mulTo(r2,g,r);
else{var t=r;r=r2;r2=t}
}
return z.revert(r);
}
function bnModPowInt(e,m){
var z;
if(e<256||m.isEven())z=new Classic(m);else z=new Montgomery(m);
return this.exp(e,z);
}
BigInteger.prototype.copyTo=bnpCopyTo;
BigInteger.prototype.fromInt=bnpFromInt;
BigInteger.prototype.fromString=bnpFromString;
BigInteger.prototype.clamp=bnpClamp;
BigInteger.prototype.dlShiftTo=bnpDLShiftTo;
BigInteger.prototype.drShiftTo=bnpDRShiftTo;
BigInteger.prototype.lShiftTo=bnpLShiftTo;
BigInteger.prototype.rShiftTo=bnpRShiftTo;
BigInteger.prototype.subTo=bnpSubTo;
BigInteger.prototype.multiplyTo=bnpMultiplyTo;
BigInteger.prototype.squareTo=bnpSquareTo;
BigInteger.prototype.divRemTo=bnpDivRemTo;
BigInteger.prototype.invDigit=bnpInvDigit;
BigInteger.prototype.isEven=bnpIsEven;
BigInteger.prototype.exp=bnpExp;
BigInteger.prototype.toString=bnToString;
BigInteger.prototype.negate=bnNegate;
BigInteger.prototype.abs=bnAbs;
BigInteger.prototype.compareTo=bnCompareTo;
BigInteger.prototype.bitLength=bnBitLength;
BigInteger.prototype.mod=bnMod;
BigInteger.prototype.modPowInt=bnModPowInt;
BigInteger.ZERO=nbv(0);
BigInteger.ONE=nbv(1);
;

;function bnClone(){var r=nbi();this.copyTo(r);return r}
function bnIntValue(){
if(this.s<0){
if(this.t==1)return this[0]-this.DV;
else if(this.t==0)return-1;
}
else if(this.t==1)return this[0];
else if(this.t==0)return 0;
return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0];
}
function bnByteValue(){return(this.t==0)?this.s:(this[0]<<24)>>24}
function bnShortValue(){return(this.t==0)?this.s:(this[0]<<16)>>16}
function bnpChunkSize(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}
function bnSigNum(){
if(this.s<0)return-1;
else if(this.t<=0||(this.t==1&&this[0]<=0))return 0;
else return 1;
}
function bnpToRadix(b){
if(b==null)b=10;
if(this.signum()==0||b<2||b>36)return"0";
var cs=this.chunkSize(b);
var a=Math.pow(b,cs);
var d=nbv(a),y=nbi(),z=nbi(),r="";
this.divRemTo(d,y,z);
while(y.signum()>0){
r=(a+z.intValue()).toString(b).substr(1)+r;
y.divRemTo(d,y,z);
}
return z.intValue().toString(b)+r;
}
function bnpFromRadix(s,b){
this.fromInt(0);
if(b==null)b=10;
var cs=this.chunkSize(b);
var d=Math.pow(b,cs),mi=false,j=0,w=0;
for(var i=0;i<s.length;++i){
var x=intAt(s,i);
if(x<0){
if(s.charAt(i)=="-"&&this.signum()==0)mi=true;
continue;
}
w=b*w+x;
if(++j>=cs){
this.dMultiply(d);
this.dAddOffset(w,0);
j=0;
w=0;
}
}
if(j>0){
this.dMultiply(Math.pow(b,j));
this.dAddOffset(w,0);
}
if(mi)BigInteger.ZERO.subTo(this,this);
}
function bnpFromNumber(a,b,c){
if("number"==typeof b){
if(a<2)this.fromInt(1);
else{
this.fromNumber(a,c);
if(!this.testBit(a-1))this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this);
if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime(b)){
this.dAddOffset(2,0);
if(this.bitLength()>a)this.subTo(BigInteger.ONE.shiftLeft(a-1),this);
}
}
}
else{
var x=new Array(),t=a&7;
x.length=(a>>3)+1;
b.nextBytes(x);
if(t>0)x[0]&=((1<<t)-1);else x[0]=0;
this.fromString(x,256);
}
}
function bnToByteArray(){
var i=this.t,r=new Array();
r[0]=this.s;
var p=this.DB-(i*this.DB)%8,d,k=0;
if(i-->0){
if(p<this.DB&&(d=this[i]>>p)!=(this.s&this.DM)>>p)
r[k++]=d|(this.s<<(this.DB-p));
while(i>=0){
if(p<8){
d=(this[i]&((1<<p)-1))<<(8-p);
d|=this[--i]>>(p+=this.DB-8);
}
else{
d=(this[i]>>(p-=8))&0xff;
if(p<=0){p+=this.DB;--i}
}
if((d&0x80)!=0)d|=-256;
if(k==0&&(this.s&0x80)!=(d&0x80))++k;
if(k>0||d!=this.s)r[k++]=d;
}
}
return r;
}
function bnEquals(a){return(this.compareTo(a)==0)}
function bnMin(a){return(this.compareTo(a)<0)?this:a}
function bnMax(a){return(this.compareTo(a)>0)?this:a}
function bnpBitwiseTo(a,op,r){
var i,f,m=Math.min(a.t,this.t);
for(i=0;i<m;++i)r[i]=op(this[i],a[i]);
if(a.t<this.t){
f=a.s&this.DM;
for(i=m;i<this.t;++i)r[i]=op(this[i],f);
r.t=this.t;
}
else{
f=this.s&this.DM;
for(i=m;i<a.t;++i)r[i]=op(f,a[i]);
r.t=a.t;
}
r.s=op(this.s,a.s);
r.clamp();
}
function op_and(x,y){return x&y}
function bnAnd(a){var r=nbi();this.bitwiseTo(a,op_and,r);return r}
function op_or(x,y){return x|y}
function bnOr(a){var r=nbi();this.bitwiseTo(a,op_or,r);return r}
function op_xor(x,y){return x^y}
function bnXor(a){var r=nbi();this.bitwiseTo(a,op_xor,r);return r}
function op_andnot(x,y){return x&~y}
function bnAndNot(a){var r=nbi();this.bitwiseTo(a,op_andnot,r);return r}
function bnNot(){
var r=nbi();
for(var i=0;i<this.t;++i)r[i]=this.DM&~this[i];
r.t=this.t;
r.s=~this.s;
return r;
}
function bnShiftLeft(n){
var r=nbi();
if(n<0)this.rShiftTo(-n,r);else this.lShiftTo(n,r);
return r;
}
function bnShiftRight(n){
var r=nbi();
if(n<0)this.lShiftTo(-n,r);else this.rShiftTo(n,r);
return r;
}
function lbit(x){
if(x==0)return-1;
var r=0;
if((x&0xffff)==0){x>>=16;r+=16}
if((x&0xff)==0){x>>=8;r+=8}
if((x&0xf)==0){x>>=4;r+=4}
if((x&3)==0){x>>=2;r+=2}
if((x&1)==0)++r;
return r;
}
function bnGetLowestSetBit(){
for(var i=0;i<this.t;++i)
if(this[i]!=0)return i*this.DB+lbit(this[i]);
if(this.s<0)return this.t*this.DB;
return-1;
}
function cbit(x){
var r=0;
while(x!=0){x&=x-1;++r}
return r;
}
function bnBitCount(){
var r=0,x=this.s&this.DM;
for(var i=0;i<this.t;++i)r+=cbit(this[i]^x);
return r;
}
function bnTestBit(n){
var j=Math.floor(n/this.DB);
if(j>=this.t)return(this.s!=0);
return((this[j]&(1<<(n%this.DB)))!=0);
}
function bnpChangeBit(n,op){
var r=BigInteger.ONE.shiftLeft(n);
this.bitwiseTo(r,op,r);
return r;
}
function bnSetBit(n){return this.changeBit(n,op_or)}
function bnClearBit(n){return this.changeBit(n,op_andnot)}
function bnFlipBit(n){return this.changeBit(n,op_xor)}
function bnpAddTo(a,r){
var i=0,c=0,m=Math.min(a.t,this.t);
while(i<m){
c+=this[i]+a[i];
r[i++]=c&this.DM;
c>>=this.DB;
}
if(a.t<this.t){
c+=a.s;
while(i<this.t){
c+=this[i];
r[i++]=c&this.DM;
c>>=this.DB;
}
c+=this.s;
}
else{
c+=this.s;
while(i<a.t){
c+=a[i];
r[i++]=c&this.DM;
c>>=this.DB;
}
c+=a.s;
}
r.s=(c<0)?-1:0;
if(c>0)r[i++]=c;
else if(c<-1)r[i++]=this.DV+c;
r.t=i;
r.clamp();
}
function bnAdd(a){var r=nbi();this.addTo(a,r);return r}
function bnSubtract(a){var r=nbi();this.subTo(a,r);return r}
function bnMultiply(a){var r=nbi();this.multiplyTo(a,r);return r}
function bnSquare(){var r=nbi();this.squareTo(r);return r}
function bnDivide(a){var r=nbi();this.divRemTo(a,r,null);return r}
function bnRemainder(a){var r=nbi();this.divRemTo(a,null,r);return r}
function bnDivideAndRemainder(a){
var q=nbi(),r=nbi();
this.divRemTo(a,q,r);
return new Array(q,r);
}
function bnpDMultiply(n){
this[this.t]=this.am(0,n-1,this,0,0,this.t);
++this.t;
this.clamp();
}
function bnpDAddOffset(n,w){
if(n==0)return;
while(this.t<=w)this[this.t++]=0;
this[w]+=n;
while(this[w]>=this.DV){
this[w]-=this.DV;
if(++w>=this.t)this[this.t++]=0;
++this[w];
}
}
function NullExp(){}
function nNop(x){return x}
function nMulTo(x,y,r){x.multiplyTo(y,r)}
function nSqrTo(x,r){x.squareTo(r)}
NullExp.prototype.convert=nNop;
NullExp.prototype.revert=nNop;
NullExp.prototype.mulTo=nMulTo;
NullExp.prototype.sqrTo=nSqrTo;
function bnPow(e){return this.exp(e,new NullExp())}
function bnpMultiplyLowerTo(a,n,r){
var i=Math.min(this.t+a.t,n);
r.s=0;r.t=i;
while(i>0)r[--i]=0;
var j;
for(j=r.t-this.t;i<j;++i)r[i+this.t]=this.am(0,a[i],r,i,0,this.t);
for(j=Math.min(a.t,n);i<j;++i)this.am(0,a[i],r,i,0,n-i);
r.clamp();
}
function bnpMultiplyUpperTo(a,n,r){
--n;
var i=r.t=this.t+a.t-n;
r.s=0;while(--i>=0)r[i]=0;
for(i=Math.max(n-this.t,0);i<a.t;++i)
r[this.t+i-n]=this.am(n-i,a[i],r,0,0,this.t+i-n);
r.clamp();
r.drShiftTo(1,r);
}
function Barrett(m){
this.r2=nbi();
this.q3=nbi();
BigInteger.ONE.dlShiftTo(2*m.t,this.r2);
this.mu=this.r2.divide(m);
this.m=m;
}
function barrettConvert(x){
if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);
else if(x.compareTo(this.m)<0)return x;
else{var r=nbi();x.copyTo(r);this.reduce(r);return r}
}
function barrettRevert(x){return x}
function barrettReduce(x){
x.drShiftTo(this.m.t-1,this.r2);
if(x.t>this.m.t+1){x.t=this.m.t+1;x.clamp()}
this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);
this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);
while(x.compareTo(this.r2)<0)x.dAddOffset(1,this.m.t+1);
x.subTo(this.r2,x);
while(x.compareTo(this.m)>=0)x.subTo(this.m,x);
}
function barrettSqrTo(x,r){x.squareTo(r);this.reduce(r)}
function barrettMulTo(x,y,r){x.multiplyTo(y,r);this.reduce(r)}
Barrett.prototype.convert=barrettConvert;
Barrett.prototype.revert=barrettRevert;
Barrett.prototype.reduce=barrettReduce;
Barrett.prototype.mulTo=barrettMulTo;
Barrett.prototype.sqrTo=barrettSqrTo;
function bnModPow(e,m){
var i=e.bitLength(),k,r=nbv(1),z;
if(i<=0)return r;
else if(i<18)k=1;
else if(i<48)k=3;
else if(i<144)k=4;
else if(i<768)k=5;
else k=6;
if(i<8)
z=new Classic(m);
else if(m.isEven())
z=new Barrett(m);
else
z=new Montgomery(m);
var g=new Array(),n=3,k1=k-1,km=(1<<k)-1;
g[1]=z.convert(this);
if(k>1){
var g2=nbi();
z.sqrTo(g[1],g2);
while(n<=km){
g[n]=nbi();
z.mulTo(g2,g[n-2],g[n]);
n+=2;
}
}
var j=e.t-1,w,is1=true,r2=nbi(),t;
i=nbits(e[j])-1;
while(j>=0){
if(i>=k1)w=(e[j]>>(i-k1))&km;
else{
w=(e[j]&((1<<(i+1))-1))<<(k1-i);
if(j>0)w|=e[j-1]>>(this.DB+i-k1);
}
n=k;
while((w&1)==0){w>>=1;--n}
if((i-=n)<0){i+=this.DB;--j}
if(is1){g[w].copyTo(r);
is1=false;
}
else{
while(n>1){z.sqrTo(r,r2);z.sqrTo(r2,r);n-=2}
if(n>0)z.sqrTo(r,r2);else{t=r;r=r2;r2=t}
z.mulTo(r2,g[w],r);
}
while(j>=0&&(e[j]&(1<<i))==0){
z.sqrTo(r,r2);t=r;r=r2;r2=t;
if(--i<0){i=this.DB-1;--j}
}
}
return z.revert(r);
}
function bnGCD(a){
var x=(this.s<0)?this.negate():this.clone();
var y=(a.s<0)?a.negate():a.clone();
if(x.compareTo(y)<0){var t=x;x=y;y=t}
var i=x.getLowestSetBit(),g=y.getLowestSetBit();
if(g<0)return x;
if(i<g)g=i;
if(g>0){
x.rShiftTo(g,x);
y.rShiftTo(g,y);
}
while(x.signum()>0){
if((i=x.getLowestSetBit())>0)x.rShiftTo(i,x);
if((i=y.getLowestSetBit())>0)y.rShiftTo(i,y);
if(x.compareTo(y)>=0){
x.subTo(y,x);
x.rShiftTo(1,x);
}
else{
y.subTo(x,y);
y.rShiftTo(1,y);
}
}
if(g>0)y.lShiftTo(g,y);
return y;
}
function bnpModInt(n){
if(n<=0)return 0;
var d=this.DV%n,r=(this.s<0)?n-1:0;
if(this.t>0)
if(d==0)r=this[0]%n;
else for(var i=this.t-1;i>=0;--i)r=(d*r+this[i])%n;
return r;
}
function bnModInverse(m){
var ac=m.isEven();
if((this.isEven()&&ac)||m.signum()==0)return BigInteger.ZERO;
var u=m.clone(),v=this.clone();
var a=nbv(1),b=nbv(0),c=nbv(0),d=nbv(1);
while(u.signum()!=0){
while(u.isEven()){
u.rShiftTo(1,u);
if(ac){
if(!a.isEven()||!b.isEven()){a.addTo(this,a);b.subTo(m,b)}
a.rShiftTo(1,a);
}
else if(!b.isEven())b.subTo(m,b);
b.rShiftTo(1,b);
}
while(v.isEven()){
v.rShiftTo(1,v);
if(ac){
if(!c.isEven()||!d.isEven()){c.addTo(this,c);d.subTo(m,d)}
c.rShiftTo(1,c);
}
else if(!d.isEven())d.subTo(m,d);
d.rShiftTo(1,d);
}
if(u.compareTo(v)>=0){
u.subTo(v,u);
if(ac)a.subTo(c,a);
b.subTo(d,b);
}
else{
v.subTo(u,v);
if(ac)c.subTo(a,c);
d.subTo(b,d);
}
}
if(v.compareTo(BigInteger.ONE)!=0)return BigInteger.ZERO;
if(d.compareTo(m)>=0)return d.subtract(m);
if(d.signum()<0)d.addTo(m,d);else return d;
if(d.signum()<0)return d.add(m);else return d;
}
var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];
var lplim=(1<<26)/lowprimes[lowprimes.length-1];
function bnIsProbablePrime(t){
var i,x=this.abs();
if(x.t==1&&x[0]<=lowprimes[lowprimes.length-1]){
for(i=0;i<lowprimes.length;++i)
if(x[0]==lowprimes[i])return true;
return false;
}
if(x.isEven())return false;
i=1;
while(i<lowprimes.length){
var m=lowprimes[i],j=i+1;
while(j<lowprimes.length&&m<lplim)m*=lowprimes[j++];
m=x.modInt(m);
while(i<j)if(m%lowprimes[i++]==0)return false;
}
return x.millerRabin(t);
}
function bnpMillerRabin(t){
var n1=this.subtract(BigInteger.ONE);
var k=n1.getLowestSetBit();
if(k<=0)return false;
var r=n1.shiftRight(k);
t=(t+1)>>1;
if(t>lowprimes.length)t=lowprimes.length;
var a=nbi();
for(var i=0;i<t;++i){
a.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);
var y=a.modPow(r,this);
if(y.compareTo(BigInteger.ONE)!=0&&y.compareTo(n1)!=0){
var j=1;
while(j++<k&&y.compareTo(n1)!=0){
y=y.modPowInt(2,this);
if(y.compareTo(BigInteger.ONE)==0)return false;
}
if(y.compareTo(n1)!=0)return false;
}
}
return true;
}
BigInteger.prototype.chunkSize=bnpChunkSize;
BigInteger.prototype.toRadix=bnpToRadix;
BigInteger.prototype.fromRadix=bnpFromRadix;
BigInteger.prototype.fromNumber=bnpFromNumber;
BigInteger.prototype.bitwiseTo=bnpBitwiseTo;
BigInteger.prototype.changeBit=bnpChangeBit;
BigInteger.prototype.addTo=bnpAddTo;
BigInteger.prototype.dMultiply=bnpDMultiply;
BigInteger.prototype.dAddOffset=bnpDAddOffset;
BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;
BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;
BigInteger.prototype.modInt=bnpModInt;
BigInteger.prototype.millerRabin=bnpMillerRabin;
BigInteger.prototype.clone=bnClone;
BigInteger.prototype.intValue=bnIntValue;
BigInteger.prototype.byteValue=bnByteValue;
BigInteger.prototype.shortValue=bnShortValue;
BigInteger.prototype.signum=bnSigNum;
BigInteger.prototype.toByteArray=bnToByteArray;
BigInteger.prototype.equals=bnEquals;
BigInteger.prototype.min=bnMin;
BigInteger.prototype.max=bnMax;
BigInteger.prototype.and=bnAnd;
BigInteger.prototype.or=bnOr;
BigInteger.prototype.xor=bnXor;
BigInteger.prototype.andNot=bnAndNot;
BigInteger.prototype.not=bnNot;
BigInteger.prototype.shiftLeft=bnShiftLeft;
BigInteger.prototype.shiftRight=bnShiftRight;
BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;
BigInteger.prototype.bitCount=bnBitCount;
BigInteger.prototype.testBit=bnTestBit;
BigInteger.prototype.setBit=bnSetBit;
BigInteger.prototype.clearBit=bnClearBit;
BigInteger.prototype.flipBit=bnFlipBit;
BigInteger.prototype.add=bnAdd;
BigInteger.prototype.subtract=bnSubtract;
BigInteger.prototype.multiply=bnMultiply;
BigInteger.prototype.divide=bnDivide;
BigInteger.prototype.remainder=bnRemainder;
BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;
BigInteger.prototype.modPow=bnModPow;
BigInteger.prototype.modInverse=bnModInverse;
BigInteger.prototype.pow=bnPow;
BigInteger.prototype.gcd=bnGCD;
BigInteger.prototype.isProbablePrime=bnIsProbablePrime;
BigInteger.prototype.square=bnSquare;
;

;function Arcfour(){
this.i=0;
this.j=0;
this.S=new Array();
}
function ARC4init(key){
var i,j,t;
for(i=0;i<256;++i)
this.S[i]=i;
j=0;
for(i=0;i<256;++i){
j=(j+this.S[i]+key[i%key.length])&255;
t=this.S[i];
this.S[i]=this.S[j];
this.S[j]=t;
}
this.i=0;
this.j=0;
}
function ARC4next(){
var t;
this.i=(this.i+1)&255;
this.j=(this.j+this.S[this.i])&255;
t=this.S[this.i];
this.S[this.i]=this.S[this.j];
this.S[this.j]=t;
return this.S[(t+this.S[this.i])&255];
}
Arcfour.prototype.init=ARC4init;
Arcfour.prototype.next=ARC4next;
function prng_newstate(){
return new Arcfour();
}
var rng_psize=256;
;

;var rng_state;
var rng_pool;
var rng_pptr;
function rng_seed_int(x){
rng_pool[rng_pptr++]^=x&255;
rng_pool[rng_pptr++]^=(x>>8)&255;
rng_pool[rng_pptr++]^=(x>>16)&255;
rng_pool[rng_pptr++]^=(x>>24)&255;
if(rng_pptr>=rng_psize)rng_pptr-=rng_psize;
}
function rng_seed_time(){
rng_seed_int(new Date().getTime());
}
if(rng_pool==null){
rng_pool=new Array();
rng_pptr=0;
var t;
if(window.crypto&&window.crypto.getRandomValues){
var ua=new Uint8Array(32);
window.crypto.getRandomValues(ua);
for(t=0;t<32;++t)
rng_pool[rng_pptr++]=ua[t];
}
if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){
var z=window.crypto.random(32);
for(t=0;t<z.length;++t)
rng_pool[rng_pptr++]=z.charCodeAt(t)&255;
}
while(rng_pptr<rng_psize){t=Math.floor(65536*Math.random());
rng_pool[rng_pptr++]=t>>>8;
rng_pool[rng_pptr++]=t&255;
}
rng_pptr=0;
rng_seed_time();
}
function rng_get_byte(){
if(rng_state==null){
rng_seed_time();
rng_state=prng_newstate();
rng_state.init(rng_pool);
for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)
rng_pool[rng_pptr]=0;
rng_pptr=0;
}
return rng_state.next();
}
function rng_get_bytes(ba){
var i;
for(i=0;i<ba.length;++i)ba[i]=rng_get_byte();
}
function SecureRandom(){}
SecureRandom.prototype.nextBytes=rng_get_bytes;
;

;function parseBigInt(str,r){
return new BigInteger(str,r);
}
function linebrk(s,n){
var ret="";
var i=0;
while(i+n<s.length){
ret+=s.substring(i,i+n)+"\n";
i+=n;
}
return ret+s.substring(i,s.length);
}
function byte2Hex(b){
if(b<0x10)
return"0"+b.toString(16);
else
return b.toString(16);
}
function pkcs1pad2(s,n){
if(n<s.length+11){alert("Message too long for RSA");
return null;
}
var ba=new Array();
var i=s.length-1;
while(i>=0&&n>0){
var c=s.charCodeAt(i--);
if(c<128){ba[--n]=c;
}
else if((c>127)&&(c<2048)){
ba[--n]=(c&63)|128;
ba[--n]=(c>>6)|192;
}
else{
ba[--n]=(c&63)|128;
ba[--n]=((c>>6)&63)|128;
ba[--n]=(c>>12)|224;
}
}
ba[--n]=0;
var rng=new SecureRandom();
var x=new Array();
while(n>2){x[0]=0;
while(x[0]==0)rng.nextBytes(x);
ba[--n]=x[0];
}
ba[--n]=2;
ba[--n]=0;
return new BigInteger(ba);
}
function RSAKey(){
this.n=null;
this.e=0;
this.d=null;
this.p=null;
this.q=null;
this.dmp1=null;
this.dmq1=null;
this.coeff=null;
}
function RSASetPublic(N,E){
if(N!=null&&E!=null&&N.length>0&&E.length>0){
this.n=parseBigInt(N,16);
this.e=parseInt(E,16);
}
else
alert("Invalid RSA public key");
}
function RSADoPublic(x){
return x.modPowInt(this.e,this.n);
}
function RSAEncrypt(text){
var m=pkcs1pad2(text,(this.n.bitLength()+7)>>3);
if(m==null)return null;
var c=this.doPublic(m);
if(c==null)return null;
var h=c.toString(16);
if((h.length&1)==0)return h;else return"0"+h;
}
RSAKey.prototype.doPublic=RSADoPublic;
RSAKey.prototype.setPublic=RSASetPublic;
RSAKey.prototype.encrypt=RSAEncrypt;
;

;function pkcs1unpad2(d,n){
var b=d.toByteArray();
var i=0;
while(i<b.length&&b[i]==0)++i;
if(b.length-i!=n-1||b[i]!=2)
return null;
++i;
while(b[i]!=0)
if(++i>=b.length)return null;
var ret="";
while(++i<b.length){
var c=b[i]&255;
if(c<128){ret+=String.fromCharCode(c);
}
else if((c>191)&&(c<224)){
ret+=String.fromCharCode(((c&31)<<6)|(b[i+1]&63));
++i;
}
else{
ret+=String.fromCharCode(((c&15)<<12)|((b[i+1]&63)<<6)|(b[i+2]&63));
i+=2;
}
}
return ret;
}
function RSASetPrivate(N,E,D){
if(N!=null&&E!=null&&N.length>0&&E.length>0){
this.n=parseBigInt(N,16);
this.e=parseInt(E,16);
this.d=parseBigInt(D,16);
}
else
alert("Invalid RSA private key");
}
function RSASetPrivateEx(N,E,D,P,Q,DP,DQ,C){
if(N!=null&&E!=null&&N.length>0&&E.length>0){
this.n=parseBigInt(N,16);
this.e=parseInt(E,16);
this.d=parseBigInt(D,16);
this.p=parseBigInt(P,16);
this.q=parseBigInt(Q,16);
this.dmp1=parseBigInt(DP,16);
this.dmq1=parseBigInt(DQ,16);
this.coeff=parseBigInt(C,16);
}
else
alert("Invalid RSA private key");
}
function RSAGenerate(B,E){
var rng=new SecureRandom();
var qs=B>>1;
this.e=parseInt(E,16);
var ee=new BigInteger(E,16);
for(;;){
for(;;){
this.p=new BigInteger(B-qs,1,rng);
if(this.p.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10))break;
}
for(;;){
this.q=new BigInteger(qs,1,rng);
if(this.q.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10))break;
}
if(this.p.compareTo(this.q)<=0){
var t=this.p;
this.p=this.q;
this.q=t;
}
var p1=this.p.subtract(BigInteger.ONE);
var q1=this.q.subtract(BigInteger.ONE);
var phi=p1.multiply(q1);
if(phi.gcd(ee).compareTo(BigInteger.ONE)==0){
this.n=this.p.multiply(this.q);
this.d=ee.modInverse(phi);
this.dmp1=this.d.mod(p1);
this.dmq1=this.d.mod(q1);
this.coeff=this.q.modInverse(this.p);
break;
}
}
}
function RSADoPrivate(x){
if(this.p==null||this.q==null)
return x.modPow(this.d,this.n);
var xp=x.mod(this.p).modPow(this.dmp1,this.p);
var xq=x.mod(this.q).modPow(this.dmq1,this.q);
while(xp.compareTo(xq)<0)
xp=xp.add(this.p);
return xp.subtract(xq).multiply(this.coeff).mod(this.p).multiply(this.q).add(xq);
}
function RSADecrypt(ctext){
var c=parseBigInt(ctext,16);
var m=this.doPrivate(c);
if(m==null)return null;
return pkcs1unpad2(m,(this.n.bitLength()+7)>>3);
}
RSAKey.prototype.doPrivate=RSADoPrivate;
RSAKey.prototype.setPrivate=RSASetPrivate;
RSAKey.prototype.setPrivateEx=RSASetPrivateEx;
RSAKey.prototype.generate=RSAGenerate;
RSAKey.prototype.decrypt=RSADecrypt;
;

;
(function(window,document){
'use strict';
var keyboardAllowed=typeof Element!=='undefined'&&'ALLOW_KEYBOARD_INPUT'in Element,fn=(function(){
var val,valLength;
var fnMap=[
[
'requestFullscreen',
'exitFullscreen',
'fullscreenElement',
'fullscreenEnabled',
'fullscreenchange',
'fullscreenerror'
],
[
'webkitRequestFullscreen',
'webkitExitFullscreen',
'webkitFullscreenElement',
'webkitFullscreenEnabled',
'webkitfullscreenchange',
'webkitfullscreenerror'
],
[
'webkitRequestFullScreen',
'webkitCancelFullScreen',
'webkitCurrentFullScreenElement',
'webkitCancelFullScreen',
'webkitfullscreenchange',
'webkitfullscreenerror'
],
[
'mozRequestFullScreen',
'mozCancelFullScreen',
'mozFullScreenElement',
'mozFullScreenEnabled',
'mozfullscreenchange',
'mozfullscreenerror'
],
[
'msRequestFullscreen',
'msExitFullscreen',
'msFullscreenElement',
'msFullscreenEnabled',
'MSFullscreenChange',
'MSFullscreenError'
]
];
var i=0;
var l=fnMap.length;
var ret={};
for(;i<l;i++){
val=fnMap[i];
if(val&&val[1]in document){
for(i=0,valLength=val.length;i<valLength;i++){
ret[fnMap[0][i]]=val[i];
}
return ret;
}
}
return false;
})(),
screenfull={
request:function(elem){
var request=fn.requestFullscreen;
elem=elem||document.documentElement;
if(/5\.1[\.\d]* Safari/.test(navigator.userAgent)){
elem[request]();
}else{
elem[request](keyboardAllowed&&Element.ALLOW_KEYBOARD_INPUT);
}
},
exit:function(){
document[fn.exitFullscreen]();
},
toggle:function(elem){
if(this.isFullscreen){
this.exit();
}else{
this.request(elem);
}
},
onchange:function(){},
onerror:function(){},
raw:fn
};
if(!fn){
window.screenfull=false;
return;
}
Object.defineProperties(screenfull,{
isFullscreen:{
get:function(){
return!!document[fn.fullscreenElement];
}
},
element:{
enumerable:true,
get:function(){
return document[fn.fullscreenElement];
}
},
enabled:{
enumerable:true,
get:function(){
return!!document[fn.fullscreenEnabled];
}
}
});
document.addEventListener(fn.fullscreenchange,function(e){
screenfull.onchange.call(screenfull,e);
});
document.addEventListener(fn.fullscreenerror,function(e){
screenfull.onerror.call(screenfull,e);
});
window.screenfull=screenfull;
})(window,document);
;

;

function MainController($scope,$compile){
window.$scope=$scope;
window.$compile=$compile;
$scope.appTitle="Songbase.fm";
$scope.safeApply=function(){
var phase=this.$root.$$phase;
if(phase!='$apply'&&phase!='$digest'){
this.$apply();
}
};
$scope.debugObj=function(obj){

return obj;
}
$scope.alert=function(msg){
alert("NG : "+msg);
}
$scope.mediaController=mediaController;
$scope.uiController=uiController;
$scope.viewController=viewController;
$scope.searchController=searchController;
$scope.exploreController=exploreController;
$scope.myBaseController=myBaseController;
$scope.playlistController=playlistController;
$scope.playbackController=playbackController;
$scope.accountController=accountController;
$scope.optionsMenu=optionsMenu;

$scope.loaded=true;
}

;

;

var mainApp=angular.module('mainApp',['ng-context-menu']);

;

;
var mediaController=function(){
};
mediaController.unknownData="Unknown";
mediaController.playCounter=0;
mediaController.versionList=[];
mediaController.startVersionIndex=-1;
mediaController.versionListSong=null;
mediaController.currentStreamURL="";
mediaController.currentvideoURL="";
mediaController.noClick=false;
mediaController.seekTime=0;
mediaController.seekTimeDuration=0;
mediaController.retrySongCounter=0;
mediaController.shareLinkURL="";
mediaController.showChooseVersionHint=true;
mediaController.buySong=function(){
var song=playbackController.getPlayingSong();
if(song){
var keywords=mediaController.getSongArtist(song)+" - "+song.name;
var language=window.navigator.userLanguage||window.navigator.language;
if(language=="de"||language=="de-at"||language=="de-li"){
mywindow=window.open("http://www.amazon.de/s/?_encoding=UTF8&ajr=0&camp=1638&creative=19454&field-keywords="+keywords+"&linkCode=ur2&rh=n%3A77195031%2Ck%3A"+keywords+"&site-redirect=de&tag=iggels-21&url=search-alias%3Ddigital-music","Amazon","");
}
else{
mywindow=window.open("http://www.amazon.com/mn/search/?_encoding=UTF8&camp=1789&creative=390957&field-keywords="+keywords+"&linkCode=ur2&linkId=MYPSR6WWIWMTB2LT&tag=songbasefm-20&url=search-alias%3Daps&linkId=D6BN5D5GAFQZOEN3","Amazon","");
}
mywindow.focus();
mediaController.getPrice();
}
}
mediaController.downloadWindowsApp=function(){
mywindow=window.open("/download/SongBase.fm.exe","Download Songbase.fm - App","");
mywindow.focus();
$('#popupDownloadApp').popup('close');
}
mediaController.getPrice=function(){
var song=playbackController.getPlayingSong();
var keywords=mediaController.getSongArtist(song)+" - "+song.name;

}
mediaController.init=function(){
$("#popupShareLink").popup({
afteropen:function(event,ui){
$('#popupShareLink input').focus();
$('#popupShareLink input').select();
}
});
}
mediaController.visitSongWebPage=function(){
if(mediaController.currentvideoURL!=""){
console.dir(mediaController.currentvideoURL);
mywindow=window.open(mediaController.currentvideoURL,"","");
mywindow.focus();
}
}
mediaController.mediaEnded=function(){
mediaController.sendRating("2");
document.title=$scope.appTitle;
videoController.isPlaying=false;
videoController.disableStopControl(true);
videoController.setBufferedPercentage(0);
$(".mejs-playpause-button button").addClass("looped");
uiController.updateUI();
if(!playbackController.isLoading)
playbackController.playNextSong();
}
mediaController.loadPreviewSafeApplyTimer=null;
mediaController.loadPreview=function(song){
console.dir("loadpreview ajax!!!!");
var artistString=mediaController.getSongArtist(song);
var titleString=song.name
$.ajax({
url:"http://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key=019c7bcfc5d37775d1e7f651d4c08e6f&artist="+encodeURIComponent(artistString)+"&track="+encodeURIComponent(titleString)+"&format=json",
success:function(data){
if(data){
if(data.track){
if(data.track.album){
song.image=data.track.album.image;
if(mediaController.loadPreviewSafeApplyTimer){
clearTimeout(mediaController.loadPreviewSafeApplyTimer)
mediaController.loadPreviewSafeApplyTimer=null;
}
mediaController.loadPreviewSafeApplyTimer=setTimeout(function(){
mediaController.loadPreviewSafeApplyTimer=null;
$scope.safeApply();
},500)
}
}
}
}
})
}
mediaController.setNoClickTomeout=function(){
mediaController.noClick=true;
setTimeout(function(){mediaController.noClick=false},500)
}
mediaController.clickRateSong=function(e,songversion){
console.dir("mediaController.clickRateSong!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");
console.dir(e);
var offset=$(e.target).offset();
var mx=e.clientX-offset.left;
if(mx<25){
if(songversion.rated==1){
songversion.rated=0;
mediaController.sendURLRating(songversion.url,-5);
}
else{
songversion.rated=1;
mediaController.sendURLRating(songversion.url,5);
}
}
else{
if(songversion.rated==-1){
songversion.rated=0;
mediaController.sendURLRating(songversion.url,5);
}
else{
songversion.rated=-1;
mediaController.sendURLRating(songversion.url,-5);
}
}
}
mediaController.getRateImage=function(songversion){
if(!songversion.rated)
songversion.rated=0;
if(songversion.rated==0){
return"public/img/ratebutton.png";
}else if(songversion.rated==1){
return"public/img/likedbutton.png";
}else{
return"public/img/dislikedbutton.png";
}
}
mediaController.sendURLRating=function(url,rating){
var rate=function(song,VideoURL){
if(mediaController.currentvideoURL!=""&&song){
var artistString=encodeURIComponent(mediaController.getSongArtist(song));
var titleString=encodeURIComponent(song.name);
$.ajax({
url:preferences.serverURL+"?ratingURL="+VideoURL+"&rating="+rating+"&artist="+artistString+"&title="+titleString+"&auth="+authController.ip_token,
success:function(data){
authController.ensureAuthenticated(data,function(){
mediaController.sendRating(rating);
})
}
})
}
}
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var VideoURL=escape(url);
var song=playbackController.getPlayingSong();
setTimeout(function(){rate(song,VideoURL)},4000);
}
}
mediaController.sendRating=function(rating){
var rate=function(song,VideoURL){
if(mediaController.currentvideoURL!=""&&song){
var artistString=encodeURIComponent(mediaController.getSongArtist(song));
var titleString=encodeURIComponent(song.name);
$.ajax({
url:preferences.serverURL+"?ratingURL="+VideoURL+"&rating="+rating+"&artist="+artistString+"&title="+titleString+"&auth="+authController.ip_token,
success:function(data){
authController.ensureAuthenticated(data,function(){
mediaController.sendRating(rating);
})
}
})
}
}
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var VideoURL=escape(mediaController.currentvideoURL);
var song=playbackController.getPlayingSong();
setTimeout(function(){rate(song,VideoURL)},4000);
}
}
mediaController.showDuration=function(songversion){
var duration=parseInt(songversion.duration);
myDate=new Date();
myDate.setMinutes(0,duration,0);
var minutes=myDate.getMinutes().toString();
if(minutes.length<2){
minutes="0"+minutes;
}
var seconds=myDate.getSeconds().toString();
if(seconds.length<2){
seconds="0"+seconds;
}
return minutes+":"+seconds;
}
mediaController.getSiteLogo=function(){
if(mediaController.currentvideoURL.toLowerCase().search(".dailymotion.com")>-1||mediaController.currentvideoURL.toLowerCase().search("/dailymotion.com")>-1){
return"dailymotion.png"
}else if(mediaController.currentvideoURL.toLowerCase().search(".youtube.")>-1||mediaController.currentvideoURL.toLowerCase().search("/youtube.")>-1){
return"youtube.png"
}else if(mediaController.currentvideoURL.toLowerCase().search(".muzu.tv")>-1||mediaController.currentvideoURL.toLowerCase().search("/muzu.tv")>-1){
return"muzu.png"
}else if(mediaController.currentvideoURL.toLowerCase().search(".vimeo.")>-1||mediaController.currentvideoURL.toLowerCase().search("/vimeo.")>-1){
return"vimeo.png"
}else if(mediaController.currentvideoURL.toLowerCase().search(".photobucket.")>-1||mediaController.currentvideoURL.toLowerCase().search("/photobucket.")>-1){
return"photobucket.png"
}else if(mediaController.currentvideoURL.toLowerCase().search(".metacafe.")>-1||mediaController.currentvideoURL.toLowerCase().search("/metacafe.")>-1){
return"metacafe.png"
}else if(mediaController.currentvideoURL.toLowerCase().search(".veoh.")>-1||mediaController.currentvideoURL.toLowerCase().search("/veoh.")>-1){
return"veoh.png"
}else if(mediaController.currentvideoURL.toLowerCase().search(".blip.")>-1||mediaController.currentvideoURL.toLowerCase().search("/blip.")>-1){
return"blip.png"
}else if(mediaController.currentvideoURL.toLowerCase().search(".myvideo.")>-1||mediaController.currentvideoURL.toLowerCase().search("/myvideo.")>-1){
return"myvideo.png"
}else if(mediaController.currentvideoURL.toLowerCase().search(".clipfish.")>-1||mediaController.currentvideoURL.toLowerCase().search("/clipfish.")>-1){
return"clipfish.png"
}
alert(mediaController.currentvideoURL.toLowerCase())
return"empty.png"
}
mediaController.getSiteName=function(url,prefix){
if(url.toLowerCase().search(".dailymotion.com")>-1||url.toLowerCase().search("/dailymotion.com")>-1){
return prefix+"Dailymotion";
}else if(url.toLowerCase().search(".youtube.")>-1||url.toLowerCase().search("/youtube.")>-1){
return prefix+"Youtube";
}else if(url.toLowerCase().search(".muzu.tv")>-1||url.toLowerCase().search("/muzu.tv")>-1){
return prefix+"Muzu";
}else if(url.toLowerCase().search(".vimeo.")>-1||url.toLowerCase().search("/vimeo.")>-1){
return prefix+"Vimeo";
}else if(url.toLowerCase().search(".photobucket.")>-1||url.toLowerCase().search("/photobucket.")>-1){
return prefix+"Photobucket";
}else if(url.toLowerCase().search(".metacafe.")>-1||url.toLowerCase().search("/metacafe.")>-1){
return prefix+"Metacafe";
}else if(url.toLowerCase().search(".veoh.")>-1||url.toLowerCase().search("/veoh.")>-1){
return prefix+"Veoh";
}else if(url.toLowerCase().search(".blip.")>-1||url.toLowerCase().search("/blip.")>-1){
return prefix+"Blip";
}else if(url.toLowerCase().search(".myvideo.")>-1||url.toLowerCase().search("/myvideo.")>-1){
return prefix+"Myvideo";
}else if(url.toLowerCase().search(".clipfish.")>-1||url.toLowerCase().search("/clipfish.")>-1){
return prefix+"Clipfish";
}
return""
}
mediaController.playSong=function(streamURL,videoURL){
console.dir("PLAYSONG!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")
mediaController.currentStreamURL="";
mediaController.currentvideoURL="";
videoController.loadSongInSuitablePlayer(streamURL,videoURL);
mediaController.currentStreamURL=streamURL;
mediaController.currentvideoURL=videoURL;
videoController.playSong();
$scope.safeApply();
if(mediaController.showChooseVersionHint){
mediaController.showChooseVersionHint=false;
setTimeout(function(){
$('#popupChooseVersionHint').popup('open',{positionTo:'#chooseversionbutton'});
setTimeout(function(){
$('#popupChooseVersionHint').popup('close');
},5000
)
},3000)
}
}
mediaController.PlayingSongError=function(){
console.dir("PLAYINGSONG ERROR: "+mediaController.currentvideoURL)
if(mediaController.currentvideoURL!=""){
if(mediaController.retrySongCounter<5){
if(videoController.isEmbedVideo(mediaController.currentvideoURL)){
mediaController.sendRating("-1");
mediaController.playNextVersion();
}
else
{
if(mediaController.retrySongCounter>0){
mediaController.sendRating("-1");
mediaController.playNextVersion();
}
else{
mediaController.playStream(mediaController.getSongArtist(playbackController.playingSong),playbackController.playingSong.name,0,0);
}
}
mediaController.retrySongCounter+1;
}
}
}
mediaController.shareMediaEnabled=function(){
var enabled=false;
var song=playbackController.getPlayingSong();
if(song&&song.name!=""){
enabled=true;
}
if(!enabled){
for(var i=0;i<playlistController.playlists.length;i++){
if(!playlistController.playlists[i].isCurrentQueue&&!playlistController.playlists[i].isSimilarSongs){
enabled=true;
break;
}
else if(playlistController.playlists[i].isCurrentQueue){
if(playlistController.playlists[i].tracks.length>0){
enabled=true;
break;
}
}
}
}
if(enabled){
return true;
}
else
{
return false;
}
}
mediaController.shareMediaStyle=function(){
if(mediaController.shareMediaEnabled()){
return"opacity:1;";
}
else
{
return"opacity:0.5;";
}
}
mediaController.shareMedia=function(){
var enabled=false;
var song=playbackController.getPlayingSong();
if(song&&song.name!=""){
$('#shareCurrentSongButton').show();
enabled=true;
}
else
{
$('#shareCurrentSongButton').hide();
}
var playlistsfound=false;
var playqueuefound=false;
for(var i=0;i<playlistController.playlists.length;i++){
if(!playlistController.playlists[i].isCurrentQueue&&!playlistController.playlists[i].isSimilarSongs){
playlistsfound=true;
}
else if(playlistController.playlists[i].isCurrentQueue){
if(playlistController.playlists[i].tracks.length>0){
playqueuefound=true;
}
}
}
if(playlistsfound){
$('#sharePlaylistButton').show();
enabled=true;
}
else
{
$('#sharePlaylistButton').hide();
}
if(playqueuefound){
$('#SharePlayQueueButton').show();
enabled=true;
}
else
{
$('#SharePlayQueueButton').hide();
}
if(enabled){
$scope.safeApply();
$('#popupShareMenu').popup('open',{positionTo:'#sharebutton'});
}
}
mediaController.shareCurrentSong=function(){
var song=playbackController.getPlayingSong();
if(song&&song.name!=""){
var artistString=encodeURIComponent(mediaController.getSongArtist(song));
var titleString=encodeURIComponent(song.name);
mediaController.shareLinkURL="http://www.songbase.fm/?artist="+artistString+"&title="+titleString
$scope.safeApply();
setTimeout(function(){
$("#popupShareLink").popup('open',{transition:'pop'});
},200);
}
$('#popupShareMenu').popup('close');
}
mediaController.sharePlayQueue=function(){
var playlist=playlistController.currentQueue;
var playlistdata=JSON.stringify(playlist.tracks)
var savedata=escape(playlistdata);
$.mobile.loading("show");
$.ajax({
type:"POST",
data:{shareplaylist:escape(playlist.name),gid:playlist.gid,data:savedata,auth:authController.ip_token},
timeout:30000,
url:preferences.serverURL,success:function(data){
if(authController.ensureAuthenticated(data,function(){mediaController.shareSelectedPlaylist(playlist)})){
if(data.hash&&data.hash!=""){
mediaController.shareLinkURL="http://www.songbase.fm/?playlistid="+data.hash
$scope.safeApply();
setTimeout(function(){
$("#popupShareLink").popup('open',{transition:'pop'});
},200);
$('#popupShareMenu').popup('close');
}
}
},
complete:function(){
$.mobile.loading("hide");
}
})
}
mediaController.sharePlaylist=function(){
$scope.safeApply();
setTimeout(function(){
optionsMenu.openSharePlaylistOptions($('#sharebutton'));
},200);
$('#popupShareMenu').popup('close');
}
mediaController.shareSelectedPlaylist=function(playlist){
var playlistdata=JSON.stringify(playlist.tracks)
var savedata=escape(playlistdata);
$.mobile.loading("show");
$.ajax({
type:"POST",
data:{shareplaylist:escape(playlist.name),gid:playlist.gid,data:savedata,auth:authController.ip_token},
timeout:30000,
url:preferences.serverURL,success:function(data){
if(authController.ensureAuthenticated(data,function(){mediaController.shareSelectedPlaylist(playlist)})){
if(data.hash&&data.hash!=""){
mediaController.shareLinkURL="http://www.songbase.fm/?playlistid="+data.hash
$scope.safeApply();
setTimeout(function(){
$("#popupShareLink").popup('open',{transition:'pop'});
},200);
$('#popupShareMenu').popup('close');
}
}
},
complete:function(){
$.mobile.loading("hide");
}
})
}
mediaController.getVersions=function(artist,title){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var currentsong=playbackController.getPlayingSong();
if(mediaController.currentStreamURL!=""){
if(mediaController.versionListSong!=currentsong){
mediaController.versionList=[];
$scope.safeApply();
$('#reloadVersionButton').hide();
$("#searchviewVersions").listview('refresh');
$('#popupVideoSettings').popup('open',{positionTo:'#chooseversionbutton'});
$('#loadversionimg').css("opacity","1");
var getsongversions=function(counter){
if($(".mejs-button-choose-version button").css("opacity")<1&&counter>2)
return;
var song=playbackController.getPlayingSong();
var artistString=encodeURIComponent(mediaController.getSongArtist(song));
var titleString=encodeURIComponent(song.name);
if(artistString==artist&&titleString==title){
$.ajax({
url:preferences.serverURL+"?getversions=8&artist="+artistString+"&title="+titleString+"&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
getsongversions(counter);
})){
var dataok=false;
if(data.track){
if(data.track.length>0){
if(playbackController.getPlayingSong()==song){
for(var i=0;i<data.track.length;i++){
try{
data.track[i].title=decodeURIComponent(data.track[i].title);
}
catch(e){
data.track[i].title=unescape(data.track[i].title);
}
try{
data.track[i].url=decodeURIComponent(data.track[i].url);
}
catch(e){
data.track[i].url=unescape(data.track[i].url);
}
data.track[i].rated=0;
}
mediaController.versionListSong=song;
mediaController.versionList=data.track;
mediaController.startVersionIndex=-1;
$('#reloadVersionButton').show();
$scope.safeApply();
$('#loadversionimg').css("opacity","0");
$("#searchviewVersions").listview('refresh');
$("#popupVideoSettings-popup").css("margin-left","");
$('#popupVideoSettings').popup("reposition",{positionTo:'#chooseversionbutton'});
$("#popupVideoSettings-popup").css("margin-left","1px");
}
dataok=true;
}
}
if(dataok==false){
if(counter<120){
if(playbackController.getPlayingSong()==song){
setTimeout(function(){
getsongversions(counter+1)
},2000);
}
}
}
}
},
error:function(xhr,ajaxOptions,thrownError){
if(counter<120){
if(playbackController.getPlayingSong()==song){
setTimeout(function(){
getsongversions(counter+2)
},2000);
}
}
}
})
}
}
getsongversions(0);
}
else{
$("#searchviewVersions").listview('refresh');
$('#popupVideoSettings').popup('open',{positionTo:'#chooseversionbutton'});
$scope.safeApply();
$('#popupVideoSettings').popup("reposition",{positionTo:'#chooseversionbutton'});
}
}
}
}
mediaController.getReloadedVersions=function(artist,title){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var currentsong=playbackController.getPlayingSong();
if(mediaController.currentStreamURL!=""){
$scope.safeApply();
$("#searchviewVersions").listview('refresh');
$('#loadversionimg').css("opacity","1");
var getsongversions=function(counter){
if($(".mejs-button-choose-version button").css("opacity")<1&&counter>2)
return;
var song=currentsong;
var artistString=encodeURIComponent(mediaController.getSongArtist(song));
var titleString=encodeURIComponent(song.name);
if(artistString==artist&&titleString==title){
$.ajax({
url:preferences.serverURL+"?getversions=8&artist="+artistString+"&title="+titleString+"&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
getsongversions(counter);
})){
var dataok=false;
if(data.track){
if(data.track.length>0){
if(playbackController.getPlayingSong()==song){
for(var i=0;i<data.track.length;i++){
try{
data.track[i].title=decodeURIComponent(data.track[i].title);
}
catch(e){
data.track[i].title=unescape(data.track[i].title);
}
try{
data.track[i].url=decodeURIComponent(data.track[i].url);
}
catch(e){
data.track[i].url=unescape(data.track[i].url);
}
data.track[i].rated=0;
}
var newlist=true;
for(var i in data.track){
newlist=true;
for(var j in mediaController.versionList){
if(data.track[i].url==mediaController.versionList[j].url){
newlist=false;
break;
}
}
if(newlist==true)
{
break;
}
}
mediaController.versionListSong=song;
if(newlist==true){
mediaController.versionList=data.track;
mediaController.startVersionIndex=-1;
$scope.safeApply();
$('#loadversionimg').css("opacity","0");
$("#searchviewVersions").listview('refresh');
$("#popupVideoSettings-popup").css("margin-left","");
$('#popupVideoSettings').popup("reposition",{positionTo:'#chooseversionbutton'});
$("#popupVideoSettings-popup").css("margin-left","1px");
dataok=true;
}
}
}
}
if(dataok==false){
if(counter<120){
if(playbackController.getPlayingSong()==song){
setTimeout(function(){
getsongversions(counter+1)
},3000);
}
}
}
}
},
error:function(xhr,ajaxOptions,thrownError){
console.dir("error "+counter);
console.fir(xhr.responseText);
if(counter<120){
if(playbackController.getPlayingSong()==song){
setTimeout(function(){
getsongversions(counter+2)
},3000);
}
}
}
})
}
}
getsongversions(0);
}
}
}
mediaController.reloadVersions=function(){
$('#loadversionimg').css("opacity","1");
$('#reloadVersionButton').hide();
var song=playbackController.getPlayingSong();
var reload=function(artistString,titleString,duration){
$.ajax({
timeout:30000,
url:preferences.serverURL+"?reloadversions="+artistString+"&title="+titleString+"&duration="+duration+"&auth="+authController.ip_token,
complete:function(data){
setTimeout(function(){mediaController.getReloadedVersions(artistString,titleString)},2000);
}
})
}
var getinfo=function(artistString,titleString){
$.ajax({
url:"http://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key=019c7bcfc5d37775d1e7f651d4c08e6f&artist="+artistString+"&track="+titleString+"&format=json",
success:function(data){
var duration=200000;
if(data.track){
if(data.track.duration){
duration=data.track.duration;
}
}
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var loadError=false;
reload(artistString,titleString,duration);
}
}
})
}
var artistString=encodeURIComponent(mediaController.getSongArtist(song));
var titleString=encodeURIComponent(song.name);
getinfo(artistString,titleString);
}
mediaController.playVersion=function(songversion,rating,resetVersion){
if(!mediaController.noClick){
console.dir("PLAY VERSION!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");
var loadError=false;
$('#loadversionimg').css("opacity","1");
mediaController.playCounter++;
var streamID=mediaController.playCounter;
var videoURL=songversion.url
var play=function(streamID,videoURL){
var song=playbackController.getPlayingSong();
if(videoURL!=mediaController.currentvideoURL){
if(videoController.isEmbedVideo(videoURL)){
if(rating==1){
mediaController.sendRating("-1");
}
mediaController.playStreamURLSeek(videoURL,videoURL,true,rating);
$('#loadversionimg').css("opacity","0");
setTimeout(function(){
videoController.showBuffering(false);
},500);
}
else{
if(authController.ip_token!="auth"&&authController.ip_token!=""){
$.ajax({
timeout:30000,
url:preferences.serverURL+"?playurl="+encodeURIComponent(videoURL)+"&artist="+encodeURIComponent(mediaController.getSongArtist(song))+"&title="+encodeURIComponent(song.name)+"&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
play(streamID,videoURL);
})){
if(streamID==mediaController.playCounter){
if(data.streamURL){
var streamURL=data.streamURL;
if(data.videoURL){
videoURL=data.videoURL;
}
videoURL=unescape(videoURL);
streamURL=unescape(streamURL);
if(streamURL){
if(rating==1){
mediaController.sendRating("-1");
}
if(resetVersion==1){
mediaController.startVersionIndex=-1;
}
mediaController.seekTime=videoController.progressTime;
mediaController.seekTimeDuration=videoController.maxTime;
mediaController.versionListSong=song;
mediaController.playStreamURLSeek(streamURL,videoURL,true,rating);
}else
loadError=true;
}else
loadError=true;
}else
loadError=true;
}
},
error:function(){
loadError=true;
},
complete:function(){
$('#loadversionimg').css("opacity","0");
setTimeout(function(){
videoController.showBuffering(false);
},500);
}
})
}
}
}
else{
$('#loadversionimg').css("opacity","0");
setTimeout(function(){
videoController.showBuffering(false);
},500);
}
}
play(streamID,videoURL);
}
}
mediaController.loadStreamURL=function(streamID,searchString,artistString,titleString,streamURL,duration,playedAutomatic,fromCache){
var loadError=false;
$.ajax({
timeout:60000,
url:preferences.serverURL+"?play="+encodeURIComponent(searchString)+"&force1="+encodeURIComponent(artistString)+"&force2="+encodeURIComponent(titleString)+"&duration="+duration+"&fromCache="+fromCache+"&auth="+authController.ip_token,
success:function(data){
console.dir(" mediaController.loadStreamURL success")
if(streamID==mediaController.playCounter){
if(authController.ensureAuthenticated(data,function(){
console.dir("authController.ensureAuthenticated")
mediaController.loadStreamURL(streamID,searchString,artistString,titleString,streamURL,duration,playedAutomatic,fromCache);
})){
mediaController.playCounter++;
var videoURL="";
if(data.videoURL){
videoURL=data.videoURL;
}
videoURL=unescape(videoURL);
console.dir("videoURL: "+videoURL)
if(videoController.isEmbedVideo(videoURL)){
streamURL=videoURL;
mediaController.playStreamURL(streamURL,videoURL,true);
if(playbackController.playedSongs.length>100){
playbackController.playedSongs.splice(playbackController.playedSongs.length-100,100)
}
}
else if(data.streamURL){
streamURL=data.streamURL;
streamURL=unescape(streamURL);
console.dir("streamURL: "+streamURL)
console.dir(data);
if(streamURL){
mediaController.playStreamURL(streamURL,videoURL,true);
if(playbackController.playedSongs.length>100){
playbackController.playedSongs.splice(playbackController.playedSongs.length-100,100)
}
}
}else
loadError=true;
}
}
},
error:function(xhr,ajaxOptions,thrownError){
console.dir(" mediaController.loadStreamURL error: "+xhr.responseText)
loadError=true;

},
complete:function(){
console.dir(" mediaController.loadStreamURL complete")
if(loadError){
mediaController.onLoadingError(streamID,playedAutomatic);
}
}
})
}
mediaController.onLoadingError=function(streamID,playedAutomatic){
if(streamID==mediaController.playCounter){
setTimeout(function(){
videoController.showBuffering(false);
},500);
uiController.toast("Sorry, this song is not available at the moment.",1500);
if(!playedAutomatic)
playbackController.resetPlayingSong();
else
playbackController.playNextSong();
mediaController.songError();
}
}
mediaController.playStream=function(artist,title,playedAutomatic,fromCache){
console.dir("playStream "+artist+" "+title)
if(fromCache=="1"||fromCache==1){
console.dir(" mediaController.retrySongCounter = 0;")
mediaController.retrySongCounter=0;
}
videoController.setLoopButton(false);
mediaController.playCounter++;
var streamID=mediaController.playCounter;
var artistString=artist;
var titleString=title;
artistString=artistString.replace("?","");
titleString=titleString.replace("?","");
var searchString=""
if(artist!="")
searchString=artist+" - "+title;
else
searchString=title;
var streamURL="";
var play=function(streamID,searchString,artistString,titleString,streamURL,fromCache){
$.ajax({
url:"http://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key=019c7bcfc5d37775d1e7f651d4c08e6f&artist="+encodeURIComponent(artistString)+"&track="+encodeURIComponent(titleString)+"&format=json",
success:function(data){
console.dir("mediaController.playStream sucess!")
if(streamID==mediaController.playCounter){
var duration=200000;
if(data.track){
if(data.track.duration){
duration=data.track.duration;
}
}
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var loadError=false;
console.dir("mediaController.loadStreamURL: "+artistString+" "+titleString)
mediaController.loadStreamURL(streamID,searchString,artistString,titleString,streamURL,duration,playedAutomatic,fromCache);
}
}
},
error:function(){
console.dir("mediaController.playStream error!")
var duration=200000;
mediaController.loadStreamURL(streamID,searchString,artistString,titleString,streamURL,duration,playedAutomatic,fromCache);
}
})
}
play(streamID,searchString,artistString,titleString,streamURL,fromCache);
}
mediaController.playStreamURLSeek=function(streamURL,videoURL,differentVersions,rating){
console.dir("playStreamURLSeek!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");
setTimeout(function(){
playbackController.playingOldSong=playbackController.playingSong;
playbackController.setNewTitle(playbackController.playingSong.name,mediaController.getSongCover(playbackController.playingSong),true);
mediaController.playSong(streamURL,videoURL)
if(rating==1){
mediaController.sendRating("1");
}
if(differentVersions){
videoController.disableVersionControl(false);

}else
videoController.disableVersionControl(true);
},200)
}
mediaController.songError=function(){
setTimeout(function(){
videoController.showBuffering(false);
},500);
uiController.toast("Sorry, this song is not available at the moment.",1500);
playbackController.resetPlayingSong();
}
mediaController.playNextVersion=function(){
console.dir("playNextVersion!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");
if(!videoController.versionsEnabled)
return;
var currentsong=playbackController.getPlayingSong();
if(currentsong.name!=""){
if(mediaController.versionListSong!=currentsong){
var getsongversions=function(counter){
if(counter<120){
if(authController.ip_token!="auth"&&authController.ip_token!=""){
var song=currentsong;
$.ajax({
url:preferences.serverURL+"?getversions=8&artist="+encodeURIComponent(mediaController.getSongArtist(song))+"&title="+encodeURIComponent(song.name)+"&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
getsongversions(counter);
})){
if(data.track){
if(playbackController.getPlayingSong()==song){
mediaController.startVersionIndex=-1;
var nextIndex=-1
for(var i=0;i<data.track.length;i++){
try{
data.track[i].title=decodeURIComponent(data.track[i].title);
}
catch(e){
data.track[i].title=unescape(data.track[i].title);
}
try{
data.track[i].url=decodeURIComponent(data.track[i].url);
}
catch(e){
data.track[i].url=unescape(data.track[i].url);
}
if(data.track[i].url==mediaController.currentvideoURL){
nextIndex=i;
}
data.track[i].rated=0;
}
nextIndex=nextIndex+1;
if(nextIndex>=data.track.length){
nextIndex=0;
}
mediaController.playVersion(data.track[nextIndex],1,0);
}
}
else{
if(playbackController.getPlayingSong()==song){
setTimeout(function(){
getsongversions(counter+1)
},1500);
}
}
}
},
error:function(xhr,ajaxOptions,thrownError){
if(playbackController.getPlayingSong()==song){
setTimeout(function(){
getsongversions(counter+2)
},5000);
}
}
})
}
}
}
getsongversions(0);
}
else{
var nextIndex=-1
for(var i=0;i<mediaController.versionList.length;i++){
if(mediaController.versionList[i].url==mediaController.currentvideoURL){
nextIndex=i;
}
}
nextIndex=nextIndex+1;
if(nextIndex>=mediaController.versionList.length){
nextIndex=0;
}
console.log("nextIndex: "+nextIndex);
console.log("startVersionIndex: "+mediaController.startVersionIndex);
if(mediaController.startVersionIndex!=nextIndex){
if(mediaController.startVersionIndex==-1){
mediaController.startVersionIndex=nextIndex;
}
mediaController.playVersion(mediaController.versionList[nextIndex],1,0)
}
else{
mediaController.songError();
}
}
}
}
mediaController.playStreamURL=function(streamURL,videoURL,differentVersions){
console.dir("playStreamURL!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");
$(".songlist li.oldloadedsong").removeClass("oldloadedsong loadedsong playing pausing");
uiController.swipeTimer=Date.now();setTimeout(function(){
var listElement=playbackController.getListElementFromElement(playbackController.playingSong);
if(listElement.length==0||(listElement.length>0&&listElement.hasClass("loadedsong"))){
uiController.dontRemark=true;
var loadTime=Date.now()-playbackController.startedLoadingTime;

listElement.addClass("firstplay");
var cover=listElement.find("img.ui-li-icon");
var playing=listElement.find(".loadingSongImg");
cover.addClass("fadeout");
playing.addClass("fadeout");
uiController.swipeTimer=Date.now();setTimeout(function(){
if(listElement.hasClass("stillloading")){
listElement.addClass("playing");
listElement.removeClass("stillloading")
}
listElement.find("img.ui-li-icon").css("opacity","0.001")
listElement.find(".loadingSongImg").css("opacity","0")
listElement.find(".loadingSongImg").removeClass("fadeout")
listElement.find("img.ui-li-icon").removeClass("fadeout");
setTimeout(function(){
listElement.find("img.ui-li-icon").addClass("fadeincomplete")
listElement.removeClass("firstplay");
setTimeout(function(){
listElement.find(".loadingSongImg").css("opacity","")
listElement.find("img.ui-li-icon").css("opacity","1")
listElement.find("img.ui-li-icon").removeClass("fadeincomplete");
uiController.dontRemark=false;
},1000)
},500)
},50)
playbackController.playingOldSong=playbackController.playingSong;
playbackController.setNewTitle(playbackController.playingSong.name,mediaController.getSongCover(playbackController.playingSong),true);
mediaController.playSong(streamURL,videoURL);
console.dir(streamURL);
if(differentVersions){
videoController.disableVersionControl(false);

}else
videoController.disableVersionControl(true);
}
},100)
}
mediaController.toggleLyrics=function(){
var iframe=$('#lyricsiframe');

mediaController.showLyrics=!mediaController.showLyrics;
if(mediaController.showLyrics){
if(playbackController.playingSong){
var src="http://lyrics.wikia.com/"+mediaController.getSongArtist(playbackController.playingSong)+":"+playbackController.playingSong.name+"?useskin=wikiamobile";
if($("#lyricsifrm").attr("src")!=src)
$("#lyricsifrm").attr("src",src);
iframe.show();
setTimeout(function(){
iframe.css("left","").css("opacity","").css("pointer-events","auto");
},0)
}
}else{
iframe.css("left","-50px").css("opacity","0").css("pointer-events","none");
setTimeout(function(){
iframe.hide();
},1500)
}
}

mediaController.getSongCoverForLoadedPlaylist=function(){
if(playlistController.loadedPlaylists[0]&&playbackController.playingSong){
return mediaController.getSongCover(playbackController.playingSong);
}else
return"public/img/playlist.png";
}

mediaController.getImage=function(element,defaultImage){
if(!defaultImage)
var url="public/img/playlist.png";
else
url=defaultImage
if(element.image){
if(element.image[1])
url=element.image[1]['#text'];
else
url=element.image[0]['#text']
}else
url="public/img/playlist.png";
if(!url||$.trim(url)=="")
url="public/img/playlist.png";
return url;
}

mediaController.getPlaylistCoverSong=function(index,maxIndex,playlist,playingSong){
if(playlist.isPlaylist){
if(playingSong&&playbackController.playingSong)
return"background-image:url("+mediaController.getSongCover(playbackController.playingSong,(index!=0))+")";
var actIndex=playlist.tracks.length-1-index;
if(playlist.tracks&&playlist.tracks[actIndex]){
if(playlist.tracks[actIndex].isGoogleDrive){
return"background-image:url(public/img/playlistgdrive.png)";
}else{
return"background-image:url("+mediaController.getSongCover(playlist.tracks[actIndex],(index!=0))+")";
}
}
else{
return"background-image:url(public/img/playlist.png);opacity:0.9;";
}
}else
return"display:none";
}
mediaController.getSongCover=function(song,lowQuality){
var url="";
if(!song)
url="public/img/playlist.png";
else if(song.isPlaylist){
url="public/img/empty.png";
}else{
if(song.image){
if(song.image[1]&&!lowQuality)
url=song.image[1]['#text'];
else
url=song.image[0]['#text']
}else
url="public/img/playlist.png";
}
if(!url||$.trim(url)=="")
url="public/img/playlist.png";
return url;
}
mediaController.getSongDisplayName=function(song){
if(!song)
return mediaController.unknownData;
var artist=mediaController.getSongArtist(song);
if(artist==""){
if(song.name)
return song.name
else
return mediaController.unknownData;
}else{
if(song.name)
return artist+" - "+song.name;
else
return artist+" - "+mediaController.unknownData;
}
}

mediaController.getElementTitle=function(element){
var name=element.name;
if(element.artist&&element.artist.name)
var artist=element.artist.name;
else
artist=mediaController.unknownData;
if(element.isPlaylist){
return"Playlist: "+name+" - "+artist;
}else{
return"Song: "+name+" - "+artist;
}
}
mediaController.getSongArtist=function(song){
if(!song)
return mediaController.unknownData;
var artist=mediaController.unknownData;
if(song.artist){
if(song.artist.name)
artist=song.artist.name;
else if(song.artist)
artist=song.artist;
}
return artist;
}
mediaController.openExternalSite=function(){
window.open(mediaController.currentvideoURL,'_blank');
if(videoController.isPlaying){
videoController.pauseSong();
}
}
mediaController.showNewMedia=function(){
}
cryptauth=function(string){
return SHA1(string+mediaController.randomseed+mediaController.ipaddress+mediaController.clientid);
}

;

;
var mediaelementPlayer=function(selector){

this.container=null;this.containerVideo=null;this.videoSelector=selector;
this.videoElement=$(selector);

this.init=function(){
var that=this;
MediaElementPlayer.prototype.extoptions={scale:1.5,displayBox:false};

this.mediaElementPlayer=new MediaElementPlayer(selector,{
features:['prevtrack','playpause','stop','nexttrack','shuffle','current','progress','duration','volume','fullscreen'],
pauseOtherPlayers:true,
enableKeyboard:false,
alwaysShowControls:true,
autosizeProgress:false,
success:function(mediaElement,domObject){
that.container=$(selector).parents(".mejs-container");
that.containerVideo=$(selector).parents(".mejs-mediaelement");
setTimeout(function(){
var oldSetProgressRail=that.mediaElementPlayer.setProgressRail;
that.mediaElementPlayer.setProgressRail=function(){
var percent=oldSetProgressRail();
var target=that.mediaElementPlayer.media;
if(target&&target.buffered&&target.buffered.length>0&&target.buffered.end&&target.duration){
var minDiff=target.duration;
var minDiffPos=0;
for(var i=0;i<target.buffered.length;i++){
var diff=target.buffered.end(i)-target.currentTime;
if(diff>=0&&diff<minDiff){
minDiff=diff;
minDiffPos=target.buffered.end(i);
}
}
percent=minDiffPos/target.duration;
}
else if(target&&target.bytesTotal!=undefined&&target.bytesTotal>0&&target.bufferedBytes!=undefined){
percent=target.bufferedBytes/target.bytesTotal;
}
if(percent!==null){
percent=Math.min(1,Math.max(0,percent));
videoController.setBufferedPercentage(percent)
}
}
},0);
var resizeLayer=$(".mejs-overlay-play").clone();
resizeLayer.removeClass("mejs-overlay-play").addClass("mejs-overlay-resize");
resizeLayer.insertAfter(".mejs-overlay-play");
that.container.find(".mejs-overlay-play").remove();
that.container.find(".mejs-overlay-resize").click(function(){
setTimeout(function(){
if(Date.now()-uiController.noVideoClickTimer>600){
videoController.playPauseSong();
}
},500)
})
that.container.find(".mejs-overlay-resize").dblclick(function(){
uiController.noVideoClickTimer=Date.now();
if(!uiController.isMaxVideoSizeFaktor(uiController.sizeVideo))
uiController.sizeVideo=uiController.sizeVideo*1.5;
else
uiController.sizeVideo=1/1.5;
uiController.styleVideo();
})
mediaElement.addEventListener("canplay",function(e){
that.mediaElementPlayer.media.setVolume(videoController.volume);
that.canplay=true;
if(that.startplay){
that.play();
}
else if(that.startplause)
that.pause();
that.startplause=false;
that.startplay=false;
that.startplay=false;
})
mediaElement.addEventListener("playing",function(e){
videoController.playingSong();
that.updateTime.call(that);
});
mediaElement.addEventListener("ended",function(e){
videoController.endedSong();
that.stopUpdateTime();
});
mediaElement.addEventListener("error",function(e){if(mediaController.currentvideoURL!=""){
if(!videoController.isEmbedVideo(mediaController.currentvideoURL)){
console.log("MEDIAELEMENT ERROR!")
mediaController.PlayingSongError();
}
}

});
mediaElement.addEventListener('loadeddata',function(e){
videoController.setMaxTime(mediaElement.duration)
});
},
error:function(){
console.log("Error creating mediaelementjs!");
}
});
};

this.load=function(url){
videoController.setProgressPercentage(0);
this.mediaElementPlayer.setSrc(url);
this.mediaElementPlayer.load();
this.containerVideo.addClass("backgroundVideo").appendTo("#backgroundVideo");
this.canplay=false;
this.startplay=false;
this.startplause=false;
console.log("LOAD"+Date.now())
}

this.unload=function(url){
this.stop();
this.stopUpdateTime();
this.containerVideo.addClass("backgroundVideo").insertAfter($(this.container).find(".mejs-inner"));
this.containerVideo.find("video").first().attr('src','')
}
this.updateTime=function(){
var that=this;
if(that.updateTimeTimeout){
clearTimeout(that.updateTimeTimeout)
that.updateTimeTimeout=null;
}
if(that.mediaElementPlayer){
videoController.setProgressTime(that.mediaElementPlayer.media.currentTime);
}
this.updateTimeTimeout=setTimeout(function(){
that.updateTime.call(that)
},100);
}
this.stopUpdateTime=function(){
if(this.updateTimeTimeout){
clearTimeout(this.updateTimeTimeout)
this.updateTimeTimeout=null;
}
}
this.play=function(){
if(this.canplay){
this.mediaElementPlayer.play();
}
else{
this.startplay=true;
this.startplause=false;
}
};
this.pause=function(){
if(this.canplay){
this.mediaElementPlayer.pause();
this.stopUpdateTime();
}else{
this.startplay=false;
this.startplause=true;
}
};
this.stop=function(){
this.container.find(".mejs-stop-button").click()};

this.setProgressPercentage=function(percentage){
if(!this.mediaElementPlayer.media)
return;
var newTime=percentage*this.mediaElementPlayer.media.duration;
if(newTime&&newTime!==this.mediaElementPlayer.media.currentTime){
this.mediaElementPlayer.media.setCurrentTime(newTime);
}
videoController.setProgressPercentage(percentage,false)
}
this.setVolume=function(volume){
if(this.mediaElementPlayer&&this.mediaElementPlayer.media)
this.mediaElementPlayer.media.setVolume(volume);
};
}

;

;
var myBaseController=function(){
};
myBaseController.usesSearchList=false;
myBaseController.index=2;
myBaseController.inputText="Filter MyBase";

myBaseController.onInput=function(){
}

myBaseController.onClear=function(){
}

myBaseController.showView=function(){
myBaseController.visible=true;
$("#explorearea").show();
}

myBaseController.hideView=function(){
myBaseController.visible=false;
$("#explorearea").hide();
}
;

;
var optionsMenu=function(){
};
optionsMenu.options=[
{text:"",callback:null}
]
optionsMenu.openPlaylistOptions=function(event,positionTo){
if(event)
event.stopPropagation();
optionsMenu.options=[
{text:"Play",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
var playlist=playlistController.getLoadedPlaylist();
if(playlist&&playlist.tracks.length>0)
playlistController.playSongList(playlist.tracks);
},150)
}},
{text:"Play next",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
var playlist=playlistController.getLoadedPlaylist();
if(playlist&&playlist.tracks.length>0)
playlistController.playSongListNext(playlist.tracks);
},150)
}},
{text:"Add to Playlist",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
var playlist=playlistController.getLoadedPlaylist();
if(playlist&&playlist.tracks.length>0)
playlistController.addSongListElementsToPlaylist(positionTo,playlist.tracks,"r");
},150)
}},
{text:"Duplicate Playlist",callback:function(){
optionsMenu.closePopup();
var playlist=playlistController.loadedPlaylistSongs||[];
setTimeout(function(){
if(playlist&&playlist.length>0)
playlistController.loadNewPlaylistWithSongs(playlist)
},150)
}}
]
if(!playlistController.getLoadedPlaylist().isSimilarSongs){
optionsMenu.options.push({text:"Rename",callback:function(){
optionsMenu.closePopup();
$("#popupOptions").popup({
afterclose:function(){
$("#popupOptions").popup({afterclose:null});
setTimeout(function(){
$("#popupTextInput").popup('open',{positionTo:"window",transition:'pop'});
},100)
}
});
playlistController.editedPlaylistTitle="Rename Playlist";
playlistController.editedPlaylist=jQuery.extend(true,{},playlistController.getLoadedPlaylist());
$scope.safeApply();
}});
}
$scope.safeApply();
$("#popupOptionsList").listview("refresh");
$("#popupOptions").popup("option","arrow","r");
$("#popupOptions").popup('open',{positionTo:positionTo,transition:'pop'});
$("#popupOptions-popup").css("margin-top","3px").css("margin-left","-10px");
}
optionsMenu.openQueueOptions=function(event,positionTo){
if(event)
event.stopPropagation();
optionsMenu.options=[
{text:"Create new Playlist",callback:function(){
optionsMenu.closePopup();
var playlist=playlistController.loadedPlaylistSongs||[];
setTimeout(function(){
if(playlist&&playlist.length>0)
playlistController.loadNewPlaylistWithSongs(playlist)
},150)
}},
{text:"Clear Queue",callback:function(){
optionsMenu.closePopup();
playlistController.clearQueue();
}}
]
$scope.safeApply();
$("#popupOptionsList").listview("refresh");
$("#popupOptions").popup("option","arrow","r");
$("#popupOptions").popup('open',{positionTo:positionTo,transition:'pop'});
$("#popupOptions-popup").css("margin-top","3px").css("margin-left","-10px");
}

optionsMenu.openSearchListSelectionOptions=function(event,positionTo){
if(event)
event.stopPropagation();
optionsMenu.options=[
{text:"Play next",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
playlistController.playSelectionNext();
},150)
}},
{text:"Create new Playlist",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
playlistController.loadNewPlaylistWithSelectedSongs();
},150)
}},
{text:"Add to Playlist",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
playlistController.addSelectedElementsToPlaylist(positionTo);
},150)
}}
]
$scope.safeApply();
$("#popupOptionsList").listview("refresh");
$("#popupOptions").popup("option","arrow","l");
$("#popupOptions").popup('open',{positionTo:positionTo,transition:'pop'});
$("#popupOptions-popup").css("margin-top","7px").css("margin-left","15px");
}
optionsMenu.openPlayListSelectionPlaylistOptions=function(event,positionTo){
if(event)
event.stopPropagation();
optionsMenu.options=[
{text:"Play next",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
playlistController.playSelectionNext();
},150)
}},
{text:"Create new Playlist",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
playlistController.loadNewPlaylistWithSelectedSongs();
},150)
}},
{text:"Add to Playlist",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
playlistController.addSelectedElementsToPlaylist(positionTo);
},150)
}}
]
if(playlistController.selectedSongs.length==1){
optionsMenu.options.push(
{text:"Rename",callback:function(){
$("#popupOptions").popup({
afterclose:function(){
$("#popupOptions").popup({afterclose:null});
setTimeout(function(){
$("#popupTextInput").popup('open',{positionTo:"window",transition:'pop'});
},100)
}
});
optionsMenu.closePopup();
playlistController.editedPlaylistTitle="Rename Playlist";
playlistController.editedPlaylist=jQuery.extend(true,{},playlistController.selectedSongs[0].song);
$scope.safeApply();
}}
)
}
$scope.safeApply();
$("#popupOptionsList").listview("refresh");
$("#popupOptions").popup("option","arrow","l");
$("#popupOptions").popup('open',{positionTo:positionTo,transition:'pop'});
$("#popupOptions-popup").css("margin-top","7px").css("margin-left","15px");
}
optionsMenu.openPlayListSelectionSongOptions=function(event,positionTo){
if(event)
event.stopPropagation();
optionsMenu.options=[
{text:"Play next",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
playlistController.playSelectionNext();
},150)
}},
{text:"Create new Playlist",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
playlistController.loadNewPlaylistWithSelectedSongs();
},150)
}},
{text:"Add to Playlist",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
playlistController.addSelectedElementsToPlaylist(positionTo);
},150)
}}

]
$scope.safeApply();
$("#popupOptionsList").listview("refresh");
$("#popupOptions").popup("option","arrow","l");
$("#popupOptions").popup('open',{positionTo:positionTo,transition:'pop'});
$("#popupOptions-popup").css("margin-top","7px").css("margin-left","15px");
}

optionsMenu.openSharePlaylistOptions=function(positionTo){
if(event)
event.stopPropagation();
var share=function(index){
return function(){
jqmAllowPopUpClosing=true;
$("#popupSharePlaylistOptions").popup('close');
setTimeout(function(){
mediaController.shareSelectedPlaylist(playlistController.playlists[index]);
},150);
}
};
optionsMenu.options=[];
for(var i=0;i<playlistController.playlists.length;i++){
if(!playlistController.playlists[i].isCurrentQueue&&!playlistController.playlists[i].isSimilarSongs){
var callback=share(i);
optionsMenu.options.push({text:playlistController.playlists[i].name,callback:callback})
}
}
$scope.safeApply();
$("#popupSharePlaylistOptionsList").listview("refresh");
$('#popupSharePlaylistOptions').popup('open',{positionTo:positionTo});
}

optionsMenu.openChoosePlaylist=function(positionTo,listToAdd,arrowDirection){
if(event)
event.stopPropagation();
var add=function(index){
return function(){
optionsMenu.closePopup();
setTimeout(function(){
playlistController.addSongsToPlaylist(playlistController.playlists[index],listToAdd)
playlistController.deselectSongs();
},150);
}
};
optionsMenu.options=[];
for(var i=0;i<playlistController.playlists.length;i++){
if(!playlistController.playlists[i].isCurrentQueue&&!playlistController.playlists[i].isSimilarSongs){
var callback=add(i);
optionsMenu.options.push({text:playlistController.playlists[i].name,callback:callback})
}
}
callback=add(playlistController.getPlaylistIndexFromId(playlistController.currentQueue.gid));
optionsMenu.options.push({text:playlistController.currentQueue.name,callback:callback,currentQueue:true})
$scope.safeApply();
$("#popupOptionsList").listview("refresh");
$("#popupOptions").popup("option","arrow",arrowDirection);
$("#popupOptions").popup('open',{positionTo:positionTo,transition:'pop'});
if(arrowDirection=="r")
$("#popupOptions-popup").css("margin-top","3px").css("margin-left","-10px");
else
$("#popupOptions-popup").css("margin-top","").css("margin-left","18px");
}
optionsMenu.openArtistResultsOptions=function(event,positionTo){
if(event)
event.stopPropagation();
optionsMenu.options=[
{text:"Play",callback:null},
{text:"Add Songs to Playlist",callback:null},
{text:"Create new Playlist",callback:null}
]
$scope.safeApply();
$("#popupOptionsList").listview("refresh");
$("#popupOptions").popup("option","arrow",true);
$("#popupOptions").popup('open',{positionTo:positionTo,transition:'pop'});
$("#popupOptions-popup").css("margin-top","").css("margin-left","1px");
}

optionsMenu.openPlaylistResultsOptions=function(event,positionTo){
if(event)
event.stopPropagation();
optionsMenu.options=[
{text:"Play",callback:function(){
optionsMenu.closePopup();
if(searchController.playlists.searchResults&&searchController.playlists.searchResults.length>0){
setTimeout(function(){
uiController.disableUI(true);
var playlists=searchController.playlists.searchResults.concat();
var addPlaylist=function(playlists,index,playlistLength){
if(index>0&&playlists[index-1]&&playlists[index-1].tracks&&playlists[index-1].tracks.length){
playlistLength=playlistLength+playlists[index-1].tracks.length;
if(playlistLength>0){
if(index==1)
playlistController.playSongList(playlists[index-1].tracks.concat());
else
playlistController.addSongsToPlaylist(playlistController.currentQueue,playlists[index-1].tracks.concat());
}
}
if(index<playlists.length&&playlistLength<searchController.maxResults){
searchController.loadPlaylistTracks(playlists[index],function(){
addPlaylist(playlists,index+1,playlistLength);
},false)
}else{
uiController.disableUI(false);
}
}
addPlaylist(playlists,0,0)
},150)
}
}},
{text:"Play next",callback:function(){
optionsMenu.closePopup();
if(searchController.playlists.searchResults&&searchController.playlists.searchResults.length>0){
setTimeout(function(){
uiController.disableUI(true);
var playlists=searchController.playlists.searchResults.concat();
var addPlaylist=function(playlists,index,playlistLength){
if(index>0&&playlists[index-1]&&playlists[index-1].tracks&&playlists[index-1].tracks.length){
playlistLength=playlistLength+playlists[index-1].tracks.length;
if(playlistLength>0){
playlistController.addSongsToPlaylist(playlistController.currentQueue,playlists[index-1].tracks.concat());
}
}
if(index<playlists.length&&playlistLength<searchController.maxResults){
searchController.loadPlaylistTracks(playlists[index],function(){
addPlaylist(playlists,index+1,playlistLength);
},false)
}else{
uiController.disableUI(false);
}
}
addPlaylist(playlists,0,0)
},150)
}
}}
,
{text:"Create new Playlist",callback:function(){
optionsMenu.closePopup();
if(searchController.playlists.searchResults&&searchController.playlists.searchResults.length>0){
setTimeout(function(){
uiController.disableUI(true);
var playlists=searchController.playlists.searchResults.concat();
var addPlaylist=function(playlists,index,playlistLength){
if(index>0&&playlists[index-1]&&playlists[index-1].tracks&&playlists[index-1].tracks.length){
playlistLength=playlistLength+playlists[index-1].tracks.length;
}
if(index<playlists.length&&playlistLength<searchController.maxResults){
searchController.loadPlaylistTracks(playlists[index],function(){
addPlaylist(playlists,index+1,playlistLength);
},false)
}else{
if(playlistLength>0){
var playlist=[];
for(var i=0;i<playlists.length;i++){
playlist=playlist.concat(playlists[i].tracks);
}
if(playlist&&playlist.length>0)
playlistController.loadNewPlaylistWithSongs(playlist)
}
uiController.disableUI(false);
}
}
addPlaylist(playlists,0,0)
},150)
}
}},
{text:"Add to Playlist",callback:function(){
optionsMenu.closePopup();
if(searchController.playlists.searchResults&&searchController.playlists.searchResults.length>0){
setTimeout(function(){
var playlists=searchController.playlists.searchResults.concat();
playlistController.addSongListElementsToPlaylist(positionTo,playlists,"l");
},150)
}
}}
]
if(!searchController.isOnlyTypeDisplayed(2)){
optionsMenu.options.unshift({text:"Show all results",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
searchController.setShowMode(2)
},150)
}})
}
$scope.safeApply();
$("#popupOptionsList").listview("refresh");
$("#popupOptions").popup("option","arrow",true);
$("#popupOptions").popup('open',{positionTo:positionTo,transition:'pop'});
$("#popupOptions-popup").css("margin-top","").css("margin-left","1px");
}

optionsMenu.openPlaylistSingleResultsOptions=function(event,positionTo){
if(searchController.showedPlaylist&&searchController.showedPlaylist.tracks){
var playlist=searchController.showedPlaylist.tracks;
var playlistName=searchController.showedPlaylist.name;
}
else{
playlist=[];
playlistName=null;
}
optionsMenu.openSongListOptions(event,playlist,positionTo,true,playlistName)
}

optionsMenu.openSongListOptions=function(event,songList,positionTo,isNotSearchList,playlistName){
if(event)
event.stopPropagation();
optionsMenu.options=[
{text:"Play",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
var playlist=songList;
if(playlist&&playlist.length>0)
playlistController.playSongList(playlist.slice(0,searchController.maxResults));
},150)
}},
{text:"Play next",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
var playlist=songList;
if(playlist&&playlist.length>0)
playlistController.playSongListNext(playlist.slice(0,searchController.maxResults));
},150)
}},
{text:"Add to Playlist",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
var playlist=songList;
if(playlist&&playlist.length>0)
playlistController.addSongListElementsToPlaylist(positionTo,playlist.slice(0,searchController.maxResults),"l");
},150)
}},
{text:"Create new Playlist",callback:function(){
optionsMenu.closePopup();
var playlist=songList||[];
setTimeout(function(){
if(playlist&&playlist.length>0)
playlistController.loadNewPlaylistWithSongs(playlist.slice(0,searchController.maxResults),playlistName)
},150)
}}
]
if(!isNotSearchList){
if(!searchController.isOnlyTypeDisplayed(1)){
optionsMenu.options.unshift({text:"Show all results",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
searchController.setShowMode(1)
},150)
}})
}
}
$scope.safeApply();
$("#popupOptionsList").listview("refresh");
$("#popupOptions").popup("option","arrow",true);
$("#popupOptions").popup('open',{positionTo:positionTo,transition:'pop'});
$("#popupOptions-popup").css("margin-top","").css("margin-left","1px");
}

optionsMenu.openSongExploreOptions=function(event,positionTo){
optionsMenu.openSongListOptions(event,exploreController.songs.searchResults,positionTo,true)
}

optionsMenu.openSongResultsOptions=function(event,positionTo){
optionsMenu.openSongListOptions(event,searchController.songs.searchResults,positionTo)
}
optionsMenu.openUserResultsOptions=function(event,positionTo){
if(event)
event.stopPropagation();
optionsMenu.options=[
{text:"Show All Results",callback:function(){
optionsMenu.closePopup();
setTimeout(function(){
searchController.setShowMode(4);
},150)
}
}
]
$scope.safeApply();
$("#popupOptionsList").listview("refresh");
$("#popupOptions").popup("option","arrow",true);
$("#popupOptions").popup('open',{positionTo:positionTo,transition:'pop'});
$("#popupOptions-popup").css("margin-top","").css("margin-left","1px");
}
optionsMenu.closePopup=function(){
jqmAllowPopUpClosing=true;
$("#popupOptions").popup('close');
}
;

;
var playbackController=function(){
};

playbackController.doubleClickedElement=function(event){
event.stopPropagation();
}
playbackController.touchedElement=function(event,onlyStyle){
if($(event.target).is("li"))
var listElement=$(event.target);
else
listElement=$(event.target).parents("li");
var element=listElement.data("song");
playbackController.clickedElement(event,element,onlyStyle);
}

playbackController.clickedElement=function(event,element,onlyStyle){
if(uiController.swipeTimer&&Date.now()-uiController.swipeTimer<100)
return;
var songlist=$(event.target).parents("li")
if(songlist.length>0&&(event.clientX-songlist.offset().left)<65){
playlistController.selectSong(element)
return;
}
if(element.isPlaylist){
if(element.gid){
playlistController.showPlaylist(element);
}else{
searchController.showPlaylist(element);
}
}else{
playbackController.playSong(element,onlyStyle,false,true);
}
event.stopPropagation();
}

playbackController.playSong=function(song,resetingSong,playedAutomatic,addSongToQueue){
if(playbackController.playSongTimer&&Date.now()-playbackController.playSongTimer<100){
playbackController.playSongTimer=Date.now();
return;
}else
playbackController.playSongTimer=Date.now();
mediaController.versionListSong=null;
var listElement=playbackController.getListElementFromElement(song);
if(!resetingSong){
var isSameSongAsLoadedSong=listElement.hasClass("oldloadedsong")||(listElement.hasClass("loadedsong")&&playbackController.playingSong&&(((!song.gid)||(playbackController.playingSong.gid==song.gid))&&playbackController.playingSong.name==song.name)&&(mediaController.getSongArtist(playbackController.playingSong)==mediaController.getSongArtist(song)));
if(isSameSongAsLoadedSong){
if(playbackController.isLoading){
playbackController.resetPlayingSong();
return;
}
else if(playbackController.playingSong){
if(!listElement.hasClass("stillloading")){
setTimeout(function(){
videoController.playPauseSong();
},50);
}
return;
}
}
}
if(!playbackController.isLoading&&playbackController.playingSong){
playbackController.playingOldSong=playbackController.playingSong;
}
playbackController.updatePlayingSongIndex();
playbackController.playingSong=jQuery.extend(true,{},song);
if(playlistController.getLoadedPlaylist().isSimilarSongs)
playlistController.getSimilarSongs(playbackController.playingSong);
$(".songlist li.loadedsong.stillloading").removeClass("loadedsong stillloading");
$(".songlist li.loadedsong").addClass("oldloadedsong").removeClass("loadedsong");listElement.removeClass("playing pausing oldloadedsong");
listElement.addClass("loadedsong");
var addedToQueue=false;
if(!resetingSong){
if(!isSameSongAsLoadedSong){
playbackController.setNewTitle(playbackController.playingSong.name,mediaController.getSongCover(playbackController.playingSong));
if(addSongToQueue){
if(playbackController.playingSong.playlistgid!=playlistController.currentQueue.gid){
var actSong=jQuery.extend(true,{},song);
actSong.playlistgid=playlistController.currentQueue.gid;
var actSongList=[actSong];
playlistController.prepareGIDsToInsertSongsIntoPlaylist(playlistController.currentQueue,actSongList)
playbackController.playingSong.gid=actSong.gid;playbackController.playingSong=actSongList[0];
setTimeout(function(){
playlistController.insertSongsIntoQueue(actSongList);
playbackController.updatePlayingSongIndex();
},0);
if(playlistController.loadedPlaylists["0"])
addedToQueue=true;
}else
playbackController.updatePlayingSongIndex();
if(!playedAutomatic&&playlistController.playlistMode){
setTimeout(function(){
playlistController.animateAddedToList($(".currentqueue"));
},300)
}
}else
playbackController.updatePlayingSongIndex();
playbackController.isLoading=true;
playbackController.playingSongTimer=null;
playbackController.startedLoadingTime=Date.now();
if(playbackController.playingSong.streamURL)
mediaController.playStreamURL(playbackController.playingSong.streamURL);
else
mediaController.playStream(mediaController.getSongArtist(playbackController.playingSong),playbackController.playingSong.name,playedAutomatic,1);
playbackController.playedSongs.push(playbackController.playingSong);
}
}
$scope.safeApply();
if(!addedToQueue){
playbackController.remarkSong();
}
setTimeout(function(){
$("#playingSongInfoLink").css("opacity","1");
$("#buySongLink").css("opacity","1");
},500)
setTimeout(function(){
if(mediaController.showLyrics)
$("#lyricsifrm").attr("src","http://lyrics.wikia.com/"+mediaController.getSongArtist(playbackController.playingSong)+":"+playbackController.playingSong.name);
videoController.disableLyricsControl(false);
videoController.disableShareSocialControl(false);
if(!playbackController.playingOldSong)
videoController.disableStopControl(false);
videoController.disableControls(false);
},0)
}

playbackController.resetPlayingSong=function(){
console.log("RESETTTTT")
playbackController.isLoading=false;
mediaController.playCounter=mediaController.playCounter+1;
$(".videoControlElements-controls").find('.videoControlElements-time-loaded').show();
videoController.showBuffering(false);
playbackController.playingSong=playbackController.playingOldSong;
$(".songlist li").removeClass("loadedsong playing stillloading pausing");
if(playbackController.playingSong){
playbackController.playSongTimer=0;
playbackController.playSong(playbackController.playingSong,true);playbackController.setNewTitle(playbackController.playingSong.name,mediaController.getSongCover(playbackController.playingSong),true);
}
else{
$(".songlist li.loadedsong.stillloading .loadingSongImg").hide();
videoController.disableControls(true);
videoController.disableStopControl(true);
$(".iScrollPlayIndicator").hide();
playbackController.setNewTitle("","",true);
$(".videoControlElements-button-lyrics button").css("opacity","0.5");
}
}

playbackController.updatePlayingSongIndex=function(){
playbackController.playingSongIndex=0;
if(playbackController.playingSong){
for(var i=playlistController.currentQueue.tracks.length-1;i>=0;i--){
if(playlistController.currentQueue.tracks[i].gid==playbackController.playingSong.gid){
playbackController.playingSongIndex=i;
console.log("........ "+i)
break;
}
}
}else if(playlistController.currentQueue.tracks&&playlistController.currentQueue.tracks.length>0){
playbackController.playingSongIndex=playlistController.currentQueue.tracks.length-1;
}
};

playbackController.setNewTitle=function(title,coverUrl,isLoaded){
if(!isLoaded){
facebookHandler.updateSongFBButtons();
$("#playingSongCover").removeClass("fadeincomplete")
$("#playingSongTitle").removeClass("fadeincomplete");
$("#playingSongTitle").hide();
$("#playingSongTitleLoading").hide();
$("#playingSongCover").hide();
}
setTimeout(function(){
$("#playingSongTitleLoading").removeClass("fadeincomplete").removeClass("fadeoutcomplete");
if(title&&title!="")
document.title=$scope.appTitle+" : "+title;
else
document.title=$scope.appTitle;
var searchinput="";
if($("#searchinput").val()){
searchinput=$("#searchinput").val()
}

if(!isLoaded){
coverUrl="public/img/loadertitle.gif";
$("#playingSongInfoStyle").remove();
var style=$('<style id="playingSongInfoStyle">'+
'.playingSongInfo.ui-icon-custom:after  {'+
' background-image: url('+coverUrl+')'+
'}'+
'#popupArtist-popup::before{'+
'  background-color:rgba(255,255,255,.5)!important'+
'}'+
'</style>');
$('html > head').append(style);
}
else{
$("#playingSongInfoStyle").remove();
style=$('<style id="playingSongInfoStyle">'+
'.playingSongInfo.ui-icon-custom:after  {'+
' background-image: url('+coverUrl+')'+
'}'+
'#popupArtist-popup::before{'+
'  background: url('+coverUrl+');'+
'  background-size:cover;!important'+
'}'+
'</style>');
$('html > head').append(style);
}
$scope.safeApply();
setTimeout(function(){
if(isLoaded){
$("#playingSongTitleLoading").addClass("fadeoutcomplete")
$("#playingSongTitleLoading").show();
}
else{
$("#playingSongCover").addClass("fadeincomplete")
$("#playingSongCover").show();
$("#playingSongTitleLoading").addClass("fadeincomplete")
$("#playingSongTitleLoading").show();
$("#playingSongTitle").addClass("fadeincomplete")
$("#playingSongTitle").show();
}
},50)
},150)
}

playbackController.playPrevSong=function(){
if(playlistController.currentQueue.tracks.length==1){
videoController.setProgressPercentage(0);
videoController.setProgressTime(0);
videoController.videoPlayer.setProgressPercentage(0);
setTimeout(function(){
videoController.playSong();
},0)
}else{
var emptyList=false;
var index=playbackController.getIndexOfSong(playbackController.playingSong,playlistController.currentQueue.tracks);
if(index==-1){
if(playbackController.playedSongs.length==0){
index=1;
}
emptyList=true;
}
if(playbackController.playedSongs.length>0){
var song=playbackController.playedSongs[playbackController.playedSongs.length-1];
playbackController.playedSongs.splice(playbackController.playedSongs.length-1,1);
var alreadyInList=((!song.gid||(song.gid==playbackController.playingSong.gid))&&song.name==playbackController.playingSong.name&&mediaController.getSongArtist(song)==mediaController.getSongArtist(playbackController.playingSong));
if(alreadyInList){
if(playbackController.playedSongs.length>=1){
song=playbackController.playedSongs[playbackController.playedSongs.length-1];
playbackController.playedSongs.splice(playbackController.playedSongs.length-1,1);
}
else
song=null;
}
}
if(!song){
if(emptyList){
if(playlistController.currentQueue.tracks.length==0){
videoController.disablePositionControls(true);
return;
}
else
index=0;
}
else
index=index-1;
if(index<=-1)
index=playlistController.currentQueue.tracks.length-1;
playbackController.playSong(playlistController.currentQueue.tracks[index])

}else{
playbackController.playSong(song)
}
}
}

playbackController.playNextSong=function(){
if(playlistController.currentQueue.tracks.length==1){
videoController.setProgressPercentage(0);
videoController.setProgressTime(0);
videoController.videoPlayer.setProgressPercentage(0);
setTimeout(function(){
videoController.playSong();
},0)
}else{
var index=playbackController.getIndexOfSong(playbackController.playingSong,playlistController.currentQueue.tracks);
if(index>=0){
if(!videoController.shuffleMode){
index=index+1;
if(index==playlistController.currentQueue.tracks.length)
index=0;
}else if(playlistController.currentQueue.tracks.length>1){
var oIndex=index;
do{
index=Math.round(Math.random()*(playlistController.currentQueue.tracks.length-1))
}
while(index==oIndex)
}
playbackController.playSong(playlistController.currentQueue.tracks[index],false,true)
}else if(playlistController.currentQueue.tracks.length>0){
playbackController.playSong(playlistController.currentQueue.tracks[0],false,true)
}else
videoController.disablePositionControls(true);
}
}

playbackController.positionPlayIndicator=function(){
var listElement=playbackController.getListElementFromElement(playbackController.playingSong);
if(!listElement||listElement.length==0){
$("#searchlist .iScrollPlayIndicator").hide();
$("#playlistInner .iScrollPlayIndicator").hide();
}else{
if(listElement.parents("#playlistInner").length>0){
var scrollHeight=$("#playlistInner .iScrollVerticalScrollbar").height();
var listElementPlaylist=listElement.filter(':noparents(#playlistInner)');
var otherTopHeight=$("#playlistInner .othertopheight.songlisttitlebutton:visible").length*10;
var otherTopElements=$("#playlistInner .othertopheight:visible");
for(var i=0;i<otherTopElements.length;i++){
otherTopHeight=otherTopHeight+$(otherTopElements.get(i)).height();
}
otherTopHeight=otherTopHeight/($("#playlistInner ul").outerHeight()-65)*scrollHeight;
var otherBottomHeight=$("#playlistInner .otherbottomheight.songlisttitlebutton:visible").length*10;
var otherBottomElements=$("#playlistInner .otherbottomheight:visible");
for(i=0;i<otherBottomElements.length;i++){
otherBottomHeight=otherBottomHeight+$(otherBottomElements.get(i)).height();
}
otherBottomHeight=otherBottomHeight/($("#playlistInner ul").outerHeight()-65)*scrollHeight;
var position=listElementPlaylist.get(0).dataset.index;
var y=5+parseInt(position)/(Math.min(playlistController.getDisplayLimit(),playlistController.loadedPlaylistSongs.length)-1)*(scrollHeight-otherTopHeight-otherBottomHeight)+otherTopHeight;
if(y>scrollHeight)
y=scrollHeight;
$("#playlistInner .iScrollPlayIndicator").css('-webkit-transform','translate(0px,'+y+'px)').css('-moz-transform','translate(0px, '+y+'px)').css('-ms-transform','translate(0px, '+y+'px)').css('transform','translate(0px, '+y+'px)')
$("#playlistInner .iScrollPlayIndicator").show();
}else
$("#playlistInner .iScrollPlayIndicator").hide();
if(listElement.parents("#searchlist").length>0){
scrollHeight=$("#searchlist .iScrollVerticalScrollbar").height();
var listElementSearchlist=listElement.filter(':noparents(#searchlist)');
otherTopHeight=$("#searchlist .othertopheight.songlisttitlebutton:visible").length*10;
otherTopElements=$("#searchlist .othertopheight:visible");
for(var i=0;i<otherTopElements.length;i++){
otherTopHeight=otherTopHeight+$(otherTopElements.get(i)).height();
}
otherTopHeight=otherTopHeight/($("#searchlist ul").outerHeight()-65)*scrollHeight;
otherBottomHeight=$("#searchlist .otherbottomheight.songlisttitlebutton:visible").length*10;
otherBottomElements=$("#searchlist .otherbottomheight:visible");
for(i=0;i<otherBottomElements.length;i++){
otherBottomHeight=otherBottomHeight+$(otherBottomElements.get(i)).height();
}
otherBottomHeight=otherBottomHeight/($("#searchlist ul").outerHeight()-65)*scrollHeight;
position=listElementSearchlist.get(0).dataset.index;
y=5+parseInt(position)/(Math.min(searchController.getShowModeLimit(1),searchController.songs.searchResults.length)-1)*(scrollHeight-otherTopHeight-otherBottomHeight)+otherTopHeight;
if(y>scrollHeight)
y=scrollHeight;
$("#searchlist .iScrollPlayIndicator").css('-webkit-transform','translate(0px,'+y+'px)').css('-moz-transform','translate(0px, '+y+'px)').css('-ms-transform','translate(0px, '+y+'px)').css('transform','translate(0px, '+y+'px)')
if($("#searchlist .iScrollPlayIndicator:visible").length==0){
$("#searchlist .iScrollPlayIndicator").show();
}
}else
$("#searchlist .iScrollPlayIndicator").hide();
}
}

playbackController.positionPlayIndicatorAtTop=function(searchlist){
var y=0;
if(playbackController.playingSong){
if(playbackController.playingSong.gid&&!searchlist){
$("#playlistInner .iScrollPlayIndicator").css('-webkit-transform','translate(0px,'+y+'px)').css('-moz-transform','translate(0px, '+y+'px)').css('-ms-transform','translate(0px, '+y+'px)').css('transform','translate(0px, '+y+'px)')
}
else{
$("#searchlist .iScrollPlayIndicator").css('-webkit-transform','translate(0px,'+y+'px)').css('-moz-transform','translate(0px, '+y+'px)').css('-ms-transform','translate(0px, '+y+'px)').css('transform','translate(0px, '+y+'px)')
}
}
}

playbackController.getListElementFromElement=function(element,onlyList){
if(!element)
return $([]);
var playlistElements=[],searchListElements=[];
if(!onlyList||onlyList==1)
searchListElements=$("#searchlist li[data-elementtitle='"+mediaController.getElementTitle(element)+"'] ");
if(!onlyList||onlyList==2)
playlistElements=$("#playlistInner li[data-songgid='playlistsong"+element.gid+"']");
return $(searchListElements).add(playlistElements);
}

playbackController.isPlayingSong=function(song){
if(playbackController.playingSong&&song)
return song.gid==playbackController.playingSong.gid||(mediaController.getSongDisplayName(song)==mediaController.getSongDisplayName(playbackController.playingSong))
else
return false;
}

playbackController.isLoadingSong=function(song){
return playbackController.isPlayingSong(song)&&playbackController.isLoading;
}

playbackController.remarkSong=function(){
if(uiController.dontRemark){
setTimeout(function(){
playbackController.remarkSong();
},150)
}
else{
var listElement;
listElement=playbackController.getListElementFromElement(playbackController.playingSong);
$(".songlist .loadedsong").not(listElement).removeClass("loadedsong");
var safe=$(".songlist .oldloadedsong.playing")
$(".songlist .playing").not(listElement).removeClass("playing");
safe.addClass("playing")
safe=$(".songlist .oldloadedsong.pausing")
$(".songlist .pausing").removeClass("pausing");
safe.addClass("pausing")
$(".songlist .stillloading").not(listElement).removeClass("stillloading");
if(playbackController.playingSong){
if(listElement.length>0){
playbackController.positionPlayIndicator();
listElement.addClass("loadedsong");
if(playbackController.isLoading){
listElement.addClass("stillloading");
}else if(videoController.isPlaying){
listElement.addClass("playing");
listElement.removeClass("pausing");
}
else{
listElement.addClass("pausing");
listElement.removeClass("playing");
}
}
}
}
}

playbackController.getPlayingTitle=function(){
if(playbackController.playingSong){
return mediaController.getSongDisplayName(playbackController.playingSong);
}
else
return"";
}

playbackController.getPlayingSong=function(){
if(playbackController.playingSong)
return playbackController.playingSong;
else
return{name:""};
}

playbackController.getIndexOfSong=function(song,list){
for(var index=0;index<list.length;index++){
if((!song.gid||(song.gid==list[index].gid))&&song.name==list[index].name&&mediaController.getSongArtist(song)==mediaController.getSongArtist(list[index])){
return index;
}
}
return-1;
}

;

;
var playlistController=function(){
};
playlistController.sortPlaylist=false;
playlistController.selectedSongs=[];
playbackController.playingSongIndex=0;
playlistController.similarSongsMaxResults=100;
playlistController.globalId="";playlistController.editedPlaylist={name:""};
playbackController.playedSongs=[];
playlistController.globalIdPlaylist="";playlistController.playlistMode=true;
playlistController.displayLimit=0;
playlistController.currentShowID=0;
playlistController.selectPlaylistsPlaceholder="Search your Playlists";
playlistController.loadedPlaylistSongs=[];
playlistController.currentQueue={gid:0,id:0,name:"Current Play Queue",isPlaylist:true,isCurrentQueue:true,tracks:[]};
playlistController.similarSongs={gid:1,id:1,name:"Similar Songs",isPlaylist:true,isSimilarSongs:true,tracks:[],song:{}};
playlistController.playlists=[playlistController.currentQueue,playlistController.similarSongs];playlistController.playlistHelp={playlist:"Drag and Drop your favorite Songs<br>to add them to this Playlist.",queue:"Drag and Drop your favorite Songs<br>to add them to the Play Queue."};
playlistController.loadedPlaylists={};
playlistController.counterGlobalId=0;
playlistController.init=function(){
setTimeout(function(){
$("#playlist").addClass("fadeincomplete").css("opacity","");
},0);
playlistController.makePlayListScrollable();
$(".iScrollIndicator").hide();
playlistController.chosenElement=$("#playlistselectverticalform").chosen({disable_search_threshold:2})
playlistController.chosenObject=$("#playlistselectverticalform").data("chosen")
$(".chosen-choices").addClass("ui-input ui-body-a ui-corner-all ui-shadow-inset");
$(".chosen-choices").css("min-height","2.2em");
$(".chosen-choices input").css("margin-top","5px")
$(".chosen-container").css("margin-top","-3px")
playlistController.chosenElement.change(function(evt,params){
playlistController.onLoadedPlaylistsChanged();
});
$("#clearChoosenPlaylists").hide();
$scope.safeApply();
$("#searchlistview").listview('refresh');
uiController.updateUI();
setTimeout(function(){
playlistController.makePlayListSortable();
setTimeout(function(){
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.playListScroll.refresh();
},1000)
},150)
},0)
playlistController.chosenElement.on("chosen:hiding_dropdown",function(){
setTimeout(function(){
$("#playlistselectvertical .chosen-drop").removeClass("visible")},0)
})
$("#playlistselectvertical .chosen-container").click(function(event){
if($('#playlistselectvertical #clearChoosenPlaylists:hover, #playlistselectvertical .search-choice:hover').length==0){
$("#playlistselectvertical .chosen-with-drop .chosen-drop").addClass("visible")
}
else
setTimeout(function(){
$("#playlistselectvertical .chosen-container").removeClass("chosen-with-drop");
},0)
});
$('#playlistselectvertical #clearChoosenPlaylists').click(function(event){
uiController.showPlaylists();
});
$('.chosen-container input').blur(function(){
setTimeout(uiController.updateUI,100);
});
playlistController.makePlayListSortable();
$(".sortable").sortable("disable");
$("#playlistselectvertical .ui-input-clear").appendTo("#playlistselectvertical .ui-input");
$("#playlistselectvertical .search-field input").attr("placeholder",playlistController.selectPlaylistsPlaceholder)
$("#playlistselectvertical .search-field input").on("focus",function(){
if($('#playlistselectvertical #clearChoosenPlaylists:hover, #playlistselectvertical .search-choice:hover').length==0)
setTimeout(function(){
$("#playlistselectvertical .chosen-with-drop .chosen-drop").addClass("visible")
$("#playlistselectvertical .chosen-container").addClass("chosen-with-drop");
},0)
})
$("#popupTextInput").popup({
beforeposition:function(event,ui){
$.mobile.loading("hide");
},
afteropen:function(event,ui){
$('#popupTextInput input').focus();
$('#popupTextInput input').select();
},
afterclose:function(){
$("#popupTextInput input").css("background-color","#fff").css("color","#000");
}
});
$('#popupTextInput input').keyup(function(e){
if(e.keyCode==13){
playlistController.renamePlaylist(playlistController.editedPlaylist,$("#popupTextInput input").val());
}else
playlistController.validateRenamePlaylist(playlistController.editedPlaylist,$("#popupTextInput input").val());
});
setTimeout(function(){
playlistController.createScrollIndicators();
},150)
}
playlistController.createScrollIndicators=function(){
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.playListScroll.refresh();
},1000)
playlistController.scrollUpIndicator=$('<div class="iScrollScrollUpIndicator fadeincomplete" style="display:none;"></div>');
$("#playlistInner .iScrollVerticalScrollbar").prepend(playlistController.scrollUpIndicator);
playlistController.scrollUpIndicator.click(function(){
uiController.playListScroll.scrollTo(0,0,200);
});
uiController.playListScroll.on('scrollEnd',function(){
if(uiController.playListScroll.y==0){
$("#playlistInner .iScrollScrollUpIndicator").hide();
}else{
$("#playlistInner .iScrollScrollUpIndicator").show();
}
});
playlistController.playIndicator=$('<div class="iScrollPlayIndicator fadeincomplete5s" style="display:none;"></div>');
playlistController.playIndicator.appendTo("#playlistInner .iScrollVerticalScrollbar");
playlistController.playIndicator.click(function(){
uiController.playListScroll.scrollToElement(".loadedsong",700);
});
$(".iScrollIndicator").addClass("fadeincomplete");
}
playlistController.getNewID=function(){
var timeNow=new Date();
playlistController.counterGlobalId++;
var id=MD5(timeNow.getTime()+"."+Math.random()+"."+playlistController.counterGlobalId);
return"id_"+id;
}
playlistController.getDisplayLimit=function(){
var limit;
if(playlistController.loadedPlaylistSongs.length<playlistController.displayLimit)
limit=playlistController.loadedPlaylistSongs.length;
else
limit=playlistController.displayLimit;
return limit;
}
playlistController.applySongList=function(){
playlistController.displayLimit=0;
var apply=function(currentShowID){
console.log("-------------------------------------")
$(".specialplaylistbutton").removeClass("fadeincompletefaster");
$("#playlistInner .iScrollIndicator").hide();
var stepSize=10;
var stepDelay=50;
var size=playlistController.loadedPlaylistSongs.length;
var delays=(Math.ceil(size/stepSize));
if(delays==0)
delays=1;
console.log("SONGLIST APPLY")
console.log(delays)
console.log(size+"  "+stepSize)
var songInList=playlistController.isSongInList(playbackController.playingSong);
$("#playlistview").addClass("disablecoveranim");
for(var i=1;i<=delays;i++){
var show=function(index){
setTimeout(function(){
if(playlistController.currentShowID==currentShowID){

playlistController.displayLimit=size*index/delays;
console.log("safeapply")
$scope.safeApply();
console.dirx(JSON.parse(JSON.stringify(playlistController.loadedPlaylistSongs)));
$("#playlistview").listview('refresh');
if((songInList&&$("#playlistInner .loadedsong").length==0)||index==1)
playbackController.remarkSong();
if(index==1){
uiController.updateUI();
if(songInList)
playbackController.positionPlayIndicator();
playlistController.updateDeselectedSong();
$(".specialplaylistbutton").addClass("fadeincompletefaster");
$("#playlistview").css("opacity","1")
$("#playlistview").show();
$("#playlisthelp").show();
setTimeout(function(){
$("#playlistview").removeClass("disablecoveranim");
$("#playlistInner .iScrollIndicator").show();
},500)
$("#playlistInner .songlist").removeClass("hidden").removeClass("avoidhiding");
}
if(index==delays){
if(songInList)
playbackController.positionPlayIndicator();
setTimeout(function(){
uiController.playListScroll.refresh();
},500)
setTimeout(function(){
uiController.playListScroll.refresh();
},2000)
playlistController.makePlayListSortable();
}else if(index%3==0){
uiController.playListScroll.refresh();
if(songInList)
playbackController.positionPlayIndicator();
}
}
},stepDelay*(index-1))
}
show(i)
}
}
playlistController.currentShowID=playlistController.currentShowID+1;
apply(playlistController.currentShowID);
}

playlistController.isSongInList=function(song){
if(song){
var displayName=mediaController.getSongDisplayName(song)
for(var i=0;i<playlistController.loadedPlaylistSongs.length;i++){
if(displayName==mediaController.getSongDisplayName(playlistController.loadedPlaylistSongs[i])){
return true;
}
}
}
return false;
}

playlistController.showPlaylist=function(playlist){
if(playlistController.playlistMode){
$("#playlistInner .iScrollIndicator").hide();
$("#playlistInner .iScrollScrollUpIndicator").hide();
$("#playlistview").css("opacity","0")
}
if(Object.keys(playlistController.loadedPlaylists).length!=0){
if(playlistController.loadedPlaylists[0])
playlistController.playlistsQueueScrollY=uiController.playListScroll.y;
playlistController.loadedPlaylists={};
playlistController.loadedPlaylistSongs=[];
$('#playlistselectverticalform option').prop('selected',false);
}
$('#playlistselectverticalform option[value="'+playlist.gid+'"]').prop('selected',true);
$('#playlistselectverticalform').trigger('chosen:updated');
setTimeout(function(){
$('#playlistselectverticalform').trigger('chosen:close');
if($('#playlistselectverticalform option:selected').size()>1)
$("#clearChoosenPlaylists").show();
else
$("#clearChoosenPlaylists").hide();
playlistController.chosenElement.trigger('change');
uiController.updateUI();
$("#playlistselectvertical .chosen-container").removeClass("chosen-with-drop");
},0)
}
playlistController.updateDeselectedSong=function(){
for(var i=0;i<playlistController.selectedSongs.length;i++){
if(playlistController.selectedSongs[i].ele.closest("html").length==0||!playlistController.selectedSongs[i].ele.hasClass("selected")){
playlistController.selectedSongs.splice(i,1);
i--;
}
}
}

playlistController.selectSong=function(song){
if(!uiController.swipeTimer||Date.now()-uiController.swipeTimer>500){

var listElement=null;
if(song.gid){
listElement=playbackController.getListElementFromElement(song,2)
}
else{
listElement=playbackController.getListElementFromElement(song,1)
}
if(listElement)
listElement.toggleClass("selected");
var showedOptions=false;
if(listElement.hasClass("selected")){
playlistController.selectedSongs.push({ele:listElement,song:song})
showedOptions=true;
playlistController.hideSongOptions();
playlistController.showSongOptions(listElement,song);
}else if(playlistController.selectedSongs.length>0&&playlistController.selectedSongs[playlistController.selectedSongs.length-1].song==song){
while(playlistController.selectedSongs.length>0){
playlistController.selectedSongs.splice(playlistController.selectedSongs.length-1,1);
if(playlistController.selectedSongs.length>0&&playlistController.selectedSongs[playlistController.selectedSongs.length-1].ele.hasClass("selected")){
showedOptions=true;
playlistController.hideSongOptions();
playlistController.showSongOptions(playlistController.selectedSongs[playlistController.selectedSongs.length-1].ele,playlistController.selectedSongs[playlistController.selectedSongs.length-1].song);
break;
}
}
}
if(playlistController.selectedSongs.length==0||(!showedOptions&&playlistController.selectedSongs.length>0&&playlistController.selectedSongs[playlistController.selectedSongs.length-1].song==song)){
playlistController.hideSongOptions();
}
}
}

playlistController.positionSongOptions=function(){
if(playlistController.selectedSongs.length>0&&$(".songOptions").length>0){
var song=playlistController.selectedSongs[playlistController.selectedSongs.length-1].song
var width=$("<h3 id='textMeasuring' style='opacity:0;z-index:10000000;top:80px;left:0;font-size: 1em;font-weight: bold;position:absolute'>"+song.name+"</h3>").appendTo("body").width()
var widthTitle=$("<div id='textMeasuring2' style='opacity:0;z-index:10000000;top:110px;left:0;font-size: .75em;position:absolute'>"+mediaController.getSongArtist(song)+"</div>").appendTo("body").width()
$("#textMeasuring").remove();
$("#textMeasuring2").remove();
if(width<widthTitle)
width=widthTitle;
width=width+35;
if(63+width+150>playlistController.selectedSongs[playlistController.selectedSongs.length-1].ele.outerWidth()-50)
width=playlistController.selectedSongs[playlistController.selectedSongs.length-1].ele.outerWidth()-150-63-50;
$(".songOptions").css("left",(63+width)+"px");
}
}

playlistController.showSongOptions=function(listElement,song){
setTimeout(function(){
if(playlistController.selectedSongs.length>0&&playlistController.selectedSongs[playlistController.selectedSongs.length-1].song==song&&listElement.hasClass("selected")){
var width=$("<h3 id='textMeasuring' style='opacity:0;z-index:10000000;top:80px;left:0;font-size: 1em;font-weight: bold;position:absolute'>"+song.name+"</h3>").appendTo("body").width()
var widthTitle=$("<div id='textMeasuring2' style='opacity:0;z-index:10000000;top:110px;left:0;font-size: .75em;position:absolute'>"+mediaController.getSongArtist(song)+'<span ng-if ="song.playcount !== undefined && song.playcount"><span  style="font-style: normal;font-size: .83em;margin-left:2px;"> ?</span><span class="songPlayCount" style="font-style: italic;font-size: .93em;margin-left:2px;">'+song.playcount+'</span></span> </div>').appendTo("body").width()
$("#textMeasuring").remove();
$("#textMeasuring2").remove();
if(width<widthTitle)
width=widthTitle;
width=width+35;
if(63+width+150>listElement.outerWidth()-50)
width=listElement.outerWidth()-150-63-50;
var songOptionsId=Date.now();
$("#songOptionsOriginal").clone(true,true).attr("id","").addClass("songOptions songOptions"+songOptionsId).appendTo(listElement)
var songOptions=$(".songOptions"+songOptionsId)
songOptions.css("opacity","0");
songOptions.css("left",(63+width+20)+"px");
songOptions.addClass("noanim").hide();
songOptions.removeClass("noanim").show();
setTimeout(function(){
songOptions.css("left",(63+width)+"px");
songOptions.css("opacity","0.83");
},0)
}
},0)
}

playlistController.hideSongOptions=function(){
var songOptions=$(".songOptions")
if(songOptions.length>0){
songOptions.css("opacity","0");
songOptions.css("width","0px");
songOptions.css("left",(parseInt($(".songOptions").css("left").replace("px",""))-5)+"px");
setTimeout(function(){
songOptions.remove();
},200)
}
}

playlistController.getSongListFromSelection=function(){
var list=[];
for(var i=0;i<playlistController.selectedSongs.length;i++){
var element=playlistController.selectedSongs[i].song;
if(element.isPlaylist){
if(element.tracks&&element.tracks.length>0){
for(var j=0;j<element.tracks.length;j++){
list.push(element.tracks[j])
}
}
}else
list.push(element)
}
return list;
}

playlistController.playSongList=function(songlist){
songlist=jQuery.extend(true,[],songlist);
if(songlist.length>0){
playlistController.prepareGIDsToInsertSongsIntoPlaylist(playlistController.currentQueue,songlist);
console.log("!!!!!!!!!!")
console.dir(songlist)
playlistController.insertSongsIntoQueue(songlist);
playbackController.playSong(songlist[0],false,false,false);
playbackController.playingSong=songlist[0];
if(playlistController.playlistMode){
setTimeout(function(){
playlistController.animateAddedToList($(".currentqueue"));
},300
)
}
}
}

playlistController.playSelection=function(event){
event.stopPropagation();
playlistController.playSongList(playlistController.getSongListFromSelection());
playlistController.deselectSongs();
}

playlistController.prepareGIDsToInsertSongsIntoPlaylist=function(playlist,songs){
for(var i=0;i<songs.length;i++){
var actSong=jQuery.extend(true,{},songs[i]);
actSong.playlistgid=playlist.gid;
if(!actSong.gid){
actSong.gid=playlistController.getNewID();
}else{
for(var j=0;j<playlist.tracks.length;j++){
var actSong2=playlist.tracks[j];
if(actSong.gid==actSong2.gid){
var newID=playlistController.getNewID();
if(playbackController.playingSong&&playbackController.playingSong.gid==actSong2.gid){
playbackController.playingSong.gid=newID;
}
actSong2.gid=newID;
}
}
}
songs[i]=actSong;
}
}

playlistController.playSongListNext=function(songlist){
songlist=jQuery.extend(true,[],songlist);
if(songlist.length>0){
playlistController.prepareGIDsToInsertSongsIntoPlaylist(playlistController.currentQueue,songlist);
playlistController.insertSongsIntoQueue(songlist);
if(!playbackController.playingSong)
playbackController.playSong(songlist[0],false,false,false);
if(playlistController.playlistMode){
setTimeout(function(){
playlistController.animateAddedToList($(".currentqueue"));
},300
)
}
}
}

playlistController.playSelectionNext=function(){
playlistController.playSongListNext(playlistController.getSongListFromSelection());
playlistController.deselectSongs();
}

playlistController.loadNewPlaylistWithSelectedSongs=function(){
var list=playlistController.getSongListFromSelection();
if(list.length>0){
playlistController.loadNewPlaylistWithSongs(list)
}
playlistController.deselectSongs();
}

playlistController.animateAddedToList=function(listElement){
listElement.addClass("addedsongs").removeClass("hoverable")
setTimeout(function(){
listElement.removeClass("addedsongs")
setTimeout(function(){
listElement.addClass("hoverable")
},200)
},2000)
}

playlistController.playlistChanged=function(playlist,position){
if(!position)
position=playlistController.getPlaylistPosition(playlist.gid);
if(position>-1){
accountController.savePlaylist(playlist.gid,playlist.name,playlist.tracks,position);
}
}

playlistController.showMoreSelectionOptions=function(event,that){
event.stopPropagation();
if($(that).parents("#searchlist").length>0)
optionsMenu.openSearchListSelectionOptions(event,$(event.target))
else{
if(playlistController.playlistMode)
optionsMenu.openPlayListSelectionPlaylistOptions(event,$(event.target))
else
optionsMenu.openPlayListSelectionSongOptions(event,$(event.target))
}
}

playlistController.clearQueue=function(){
if(playbackController.playingSong)
playlistController.loadedPlaylistSongs=[jQuery.extend(true,{},playbackController.playingSong)];
else
playlistController.loadedPlaylistSongs=[];
playlistController.currentQueue.tracks=playlistController.loadedPlaylistSongs;
playbackController.updatePlayingSongIndex();
accountController.savePlaylist(playlistController.currentQueue.gid,null,playlistController.currentQueue.tracks);
$("#playlistInner .iScrollPlayIndicator").hide();
$("#playlistInner .songlist").addClass("hidden");
playlistController.applySongList();
}

playlistController.insertSongsIntoQueue=function(songs){
var tmp=playlistController.currentQueue.tracks.slice(0,playbackController.playingSongIndex+1).concat(songs);
playlistController.currentQueue.tracks=tmp.concat(playlistController.currentQueue.tracks.slice(playbackController.playingSongIndex+1));
for(var j=playbackController.playingSongIndex;j<playbackController.playingSongIndex+songs.length&&j<playlistController.currentQueue.tracks.length;j++){
if(!playlistController.currentQueue.tracks[j].image){
setTimeout(mediaController.loadPreview(playlistController.currentQueue.tracks[j]),j*300);
}
}
if(playlistController.loadedPlaylists["0"]){
if(Object.keys(playlistController.loadedPlaylists).length==1){
playlistController.loadedPlaylistSongs=playlistController.currentQueue.tracks;
}
playlistController.displayLimit=playlistController.loadedPlaylistSongs.length;
$scope.safeApply();
$("#playlistview").listview('refresh');
setTimeout(function(){
$("#playlistview").listview('refresh');
uiController.updateUI();
playbackController.remarkSong();
setTimeout(function(){
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.playListScroll.refresh();
},1000)
},150)
},0)
}
}

playlistController.addSongListElementsToPlaylist=function(positionTo,listToAdd,arrowDirection){
listToAdd=jQuery.extend(true,[],listToAdd);
setTimeout(function(){
optionsMenu.openChoosePlaylist(positionTo,listToAdd,arrowDirection);
},300)
}

playlistController.loadSharedPlaylist=function(hash){
$.mobile.loading("show");
$.ajax({
timeout:30000,
url:preferences.serverURL+"?loadplaylist="+hash+"&auth="+authController.ip_token,
success:function(data){
if(authController.ensureAuthenticated(data,function(){
playlistController.loadSharedPlaylist(hash);
})){
if(data.data){
var songlist=data.data;
playlistController.prepareGIDsToInsertSongsIntoPlaylist(playlistController.currentQueue,songlist);
playlistController.insertSongsIntoQueue(songlist);
if(playlistController.currentQueue.tracks&&playlistController.currentQueue.tracks[0]){
playbackController.playSong(playlistController.currentQueue.tracks[0]);
}
setTimeout(function(){
playlistController.loadCurrentQueue();
},4500);
}
}
},
error:function(xhr,ajaxOptions,thrownError){
console.dir(xhr.responseText);
},
complete:function(){
$.mobile.loading("hide");
}
})
}

playlistController.addSelectedElementsToPlaylist=function(positionTo){
playlistController.addSongListElementsToPlaylist(positionTo,playlistController.getSongListFromSelection(),"l");
}

playlistController.addSongsToPlaylist=function(playlist,listToAdd){
var addSongsToPlaylist=function(playlist,songs){
playlistController.prepareGIDsToInsertSongsIntoPlaylist(playlist,songs);
var oldLength=playlist.tracks.length;
playlist.tracks=playlist.tracks.concat(songs);
for(var j=oldLength;j<playlist.tracks.length;j++){
if(!playlist.tracks[j].image){
setTimeout(mediaController.loadPreview(playlist.tracks[j]),j*300);
}
}
setTimeout(function(){
accountController.savePlaylist(playlist.gid,playlist.name,playlist.tracks);
},0);
$scope.safeApply();
if(playlistController.playlistMode){
if(playlist.gid==playlistController.currentQueue.gid)
playlistController.animateAddedToList($(".currentqueue"));
else
playlistController.animateAddedToList(playbackController.getListElementFromElement(playlist));
}else if(playlistController.getLoadedPlaylist().gid==playlist.gid){
if(Object.keys(playlistController.loadedPlaylists).length==1){
playlistController.loadedPlaylistSongs=playlist.tracks;
}
playlistController.displayLimit=playlistController.loadedPlaylistSongs.length;
$scope.safeApply();
playbackController.remarkSong();
$("#playlistview").listview('refresh');
setTimeout(function(){
$("#playlistview").listview('refresh');
uiController.updateUI();
setTimeout(function(){
playbackController.remarkSong();
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.playListScroll.refresh();
},1000)
},150)
},0)
}
}
var addToList=function(playlist,listToAdd){
var addSongsToList=function(listToAdd){
if(listToAdd.length>0){
addSongsToPlaylist(playlist,listToAdd);
}
}
uiController.disableUI(true);
var addPlaylist=function(elements,index,songList){
if(index>0&&elements[index-1]){
if(elements[index-1].isPlaylist){
if(elements[index-1].tracks&&elements[index-1].tracks.length){
songList=songList.concat(elements[index-1].tracks);
}
}else{songList=songList.concat([elements[index-1]]);
}
}
if(index<elements.length&&songList.length<searchController.maxResults){
if(elements[index].isPlaylist&&!elements[index].tracks){
searchController.loadPlaylistTracks(elements[index],function(){
addPlaylist(elements,index+1,songList);
},false)
}else addPlaylist(elements,index+1,songList);
}else{
addSongsToList(songList.concat());
uiController.disableUI(false);
}
}
addPlaylist(listToAdd,0,[])
}
addToList(playlist,listToAdd)
}

playlistController.addSelectedElementsToQueue=function(event){
event.stopPropagation();
var list=playlistController.getSongListFromSelection();
playlistController.addSongsToPlaylist(playlistController.currentQueue,list);
playlistController.deselectSongs();
}

playlistController.removeSelectedElementsFromPlaylist=function(event,noConfirmPopup){
event.stopPropagation();
var doReallyDelete=function(){
var deletedPlaylist=false;
for(var i=0;i<playlistController.selectedSongs.length;i++){
var element=playlistController.selectedSongs[i].song;
if(element.gid){
if(element.isPlaylist){
for(var j=0;j<playlistController.playlists.length;j++){
if(playlistController.playlists[j].gid==playlistController.selectedSongs[i].song.gid){
accountController.deletePlaylist(playlistController.playlists[j].gid);
playlistController.playlists.splice(j,1);
deletedPlaylist=true;
j--;
}
}
}else{
var playlist=playlistController.getLoadedPlaylist();
for(var j=0;j<playlist.tracks.length;j++){
if(playlist.tracks[j].gid==playlistController.selectedSongs[i].song.gid){
playlist.tracks.splice(j,1);
j--;
accountController.savePlaylist(playlist.gid,playlist.name,playlist.tracks);
}
}
for(var j=0;j<playlistController.loadedPlaylistSongs.length;j++){
if(playlistController.loadedPlaylistSongs[j].gid==playlistController.selectedSongs[i].song.gid){
playlistController.loadedPlaylistSongs.splice(j,1);
j--;
}
}
}
}
}
console.log(":::::::::::::::::::::::::::: "+deletedPlaylist)
if(deletedPlaylist){
accountController.savePlaylistsPosition();
}
$scope.safeApply();
playbackController.remarkSong();
$("#playlistview").listview('refresh');
setTimeout(function(){
$("#playlistview").listview('refresh');
uiController.updateUI();
setTimeout(function(){
playbackController.remarkSong();
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.playListScroll.refresh();
},1000)
},150)
},0)
playlistController.deselectSongs();
}
var playlistsDelete=false;
if(!noConfirmPopup){
for(var i=0;i<playlistController.selectedSongs.length;i++){
var element=playlistController.selectedSongs[i].song;
if(element.gid&&element.isPlaylist){
playlistsDelete=true;
break;
}
}
}
if(playlistsDelete){
$("#popupConfirm").popup('open',{transition:'pop'});
}
else
doReallyDelete();
}

playlistController.shareSelectedElements=function(event){
event.stopPropagation();
}

playlistController.getPlaylistGIDFromChosenElement=function(element){
var item=playlistController.chosenObject.results_data[element.find("a").attr("data-option-array-index")];
var option=playlistController.chosenObject.form_field.options[item.options_index]
if(option)
return option.value;
else
return undefined;
}

playlistController.onLoadedPlaylistsChanged=function(){
var closefunc=function(){
setTimeout(function(){
$("#playlistselectvertical .chosen-container").removeClass("chosen-with-drop");
uiController.updateUI();
},0)
if(Object.keys(playlistController.loadedPlaylists).length!=0){
playlistController.chosenClose();
$(".search-field input").css("opacity","0")
if(playlistController.loadedPlaylists[0])
playlistController.playlistsQueueScrollY=uiController.playListScroll.y;
playlistController.loadedPlaylists={};
playlistController.loadedPlaylistSongs=[];
$('#playlistselectverticalform option').prop('selected',false);
$('#playlistselectverticalform').trigger('chosen:updated');
playlistController.loadedPlaylistSongs=playlistController.playlists;
playlistController.loadedPlaylists={};
playlistController.playlistMode=true;
$("#playlistInner .iScrollIndicator").hide();
$("#playlistInner .iScrollPlayIndicator").hide();
$("#playlistInner .iScrollScrollUpIndicator").hide();
$("#clearChoosenPlaylists").hide();
$("#playlistview").hide();
$scope.safeApply();
$('#playlistselectverticalform').trigger('chosen:updated');
playlistController.updateDeselectedSong();
uiController.updateUI();
setTimeout(function(){
$("#playlistview").listview('refresh');
uiController.playListScroll.scrollTo(0,playlistController.playlistsScrollY,0);
$("#playlistview").show();
playlistController.makePlayListSortable();
setTimeout(function(){
uiController.playListScroll.refresh();
if(playlistController.playlistsScrollY)
uiController.playListScroll.scrollTo(0,playlistController.playlistsScrollY,0);
},150)
setTimeout(function(){
uiController.playListScroll.refresh();
},1000)
},0)
}

}
var playlistsOldLoaded=[];
var searchChoices=$('#playlistselectvertical .search-choice')
if(searchChoices.length>0){
for(var i=0;i<searchChoices.length;i++){
var searchChoice=$(searchChoices.get(i));
var actName=searchChoice.find("span").text();
playlistsOldLoaded.push(actName);
var gid=playlistController.getPlaylistGIDFromChosenElement(searchChoice);
if(!playlistController.loadedPlaylists[gid])
var name=searchChoice.find("span").text();
else{
searchChoice.remove();
}
}
if(name){
searchChoice.find(".search-choice-close").attr("title","Close")
var playlist=null;
for(var i=0;i<playlistController.playlists.length;i++){
if(playlistController.playlists[i].name==name)
playlist=playlistController.playlists[i];
}
console.log("LOAD----???"+name+"   "+playlistController.loadedPlaylists[playlist.gid]+"   "+playlist.gid)
if(playlist!=null&&!playlistController.loadedPlaylists[playlist.gid]){
console.log("LOAD------------------------------------------------------------------------------ "+name)
if(playlist.gid==playlistController.currentQueue.gid){
$(searchChoice).on("click",function(){
optionsMenu.openQueueOptions(event,$(this))
})
}else{
$(searchChoice).on("click",function(){
optionsMenu.openPlaylistOptions(event,$(this))
})
}
playlistController.hideHelp=true;
$("#playlistview").css("opacity","0")
if(Object.keys(playlistController.loadedPlaylists).length!=0){
if(playlistController.loadedPlaylists[0])
playlistController.playlistsQueueScrollY=uiController.playListScroll.y;
playlistController.loadedPlaylists={};
playlistController.loadedPlaylistSongs=[];
$('#playlistselectverticalform option').prop('selected',false);
$('#playlistselectverticalform option[value="'+playlist.gid+'"]').prop('selected',true);
$('#playlistselectverticalform').trigger('chosen:updated');
}
if(playlist.isSimilarSongs&&playbackController.playingSong){
if(playlistController.similarSongs.song.name!=playbackController.playingSong.name||playlistController.similarSongs.song.artist.name!=playbackController.playingSong.artist.name){
$.mobile.loading("show");
playlistController.getSimilarSongs(playbackController.playingSong);
}
}
playlistController.loadPlaylist(playlist);
}
}else if(Object.keys(playlistController.loadedPlaylists).length!=0)closefunc();
}else if(Object.keys(playlistController.loadedPlaylists).length!=0)closefunc();

$('#playlistselectvertical .search-choice').data('loaded','true')
if($('#playlistselectverticalform option:selected').size()>1)
$("#clearChoosenPlaylists").show();
else
$("#clearChoosenPlaylists").hide();
uiController.updateUI();
$('.search-choice-close').unbind('click',closefunc);
$(".search-choice-close").click(closefunc)
}
playlistController.deselectSongs=function(event){
if(event)
event.stopPropagation();
$(".songlist li.selected").removeClass("selected");
playlistController.selectedSongs=[];
playlistController.hideSongOptions();
}

playlistController.chosenClose=function(){
$("#playlistselectvertical .chosen-container").removeClass("chosen-with-drop");
$("#playlistselectvertical .chosen-drop").removeClass("visible");
$("#playlistselectvertical chosen-container-active").removeClass("chosen-container-active");
playlistController.chosenObject.container.removeClass("chosen-container-active");
playlistController.chosenObject.clear_backstroke();
playlistController.chosenObject.show_search_field_default();
playlistController.chosenObject.search_field_scale();
playlistController.chosenObject.result_clear_highlight();
playlistController.chosenObject.active_field=false;
playlistController.chosenObject.results_showing=false
}

playlistController.openLoadedPlaylistMenu=function(event,that){
if(playlistController.getLoadedPlaylist().gid==playlistController.currentQueue.gid){
optionsMenu.openQueueOptions(event,$(that).find(".optionsPlaylist"))
}else{
optionsMenu.openPlaylistOptions(event,$(that).find(".optionsPlaylist"))
}
}
playlistController.validateRenamePlaylist=function(playlist,name){
var samePlaylistName=false;
if(!name||$.trim(name)=="")
var samePlaylistName=true
else{
for(var i=0;i<playlistController.playlists.length;i++){
if(playlistController.editedPlaylist.gid!=playlistController.playlists[i].gid&&$.trim(name)==$.trim(playlistController.playlists[i].name)){
samePlaylistName=true;
}
}
}
if(samePlaylistName){
$("#popupTextInput input").css("background-color","rgb(111, 0, 0)").css("color","#fff");
}else{
$("#popupTextInput input").css("background-color","#fff").css("color","#000");
}
return!samePlaylistName
}

playlistController.renamePlaylist=function(playlist,name){
if(playlistController.validateRenamePlaylist(playlist,name)){
$("#popupTextInput").popup("close");
setTimeout(function(){
playlist=playlistController.getPlaylistFromId(playlist.gid)
if(playlist){
playlist.name=name;
delete playlist.isUnnamedPlaylist;
$scope.safeApply();
accountController.savePlaylist(playlist.gid,playlist.name);
}
},150)
}
}
playlistController.importPlaylistPopup=function(){
$("#popupImportInput").popup("open",{transition:'pop'});
}
playlistController.loadPlaylist=function(playlist){
$("#playlistInner .iScrollIndicator").hide();
$("#playlistInner .iScrollScrollUpIndicator").hide();
playlistController.loadedPlaylists[playlist.gid]=playlist;
if(playlistController.playlistMode){
playlistController.loadedPlaylistSongs=[];
playlistController.playlistMode=false;
playlistController.playlistsScrollY=uiController.playListScroll.y;
}
if(playlist.gid==playlistController.currentQueue.gid&&playlistController.playlistsQueueScrollY)
uiController.playListScroll.scrollTo(0,playlistController.playlistsQueueScrollY,0);
else
uiController.playListScroll.scrollTo(0,0,0);
playlistController.loadedPlaylistSongs=playlist.tracks;

if(Object.keys(playlistController.loadedPlaylists).length>1||!playlistController.loadedPlaylists["0"]){
$("#playlisthelp").html(playlistController.playlistHelp.playlist)
}else{
$("#playlisthelp").html(playlistController.playlistHelp.queue)
}

playlistController.hideHelp=false;
playlistController.applySongList();
if(playlistController.renameLoadedPlaylist){
playlistController.renameLoadedPlaylist=false;
var showRename=function(){
if($(".ui-popup-container.ui-popup-active , .ui-popup-container.reverse.out").length==0){
playlistController.editedPlaylist=jQuery.extend(true,{},playlist);
playlistController.editedPlaylistTitle="New Playlist";
$scope.safeApply();
$("#popupTextInput").popup('open',{positionTo:"window",transition:'pop'});
}else
setTimeout(showRename,150)
}
setTimeout(showRename,0)
}
}
uiController.stopPlaylistScrollingOnClick=function(event){
var myEvent=jQuery.extend({},event);
myEvent.type="mouseup";
myEvent.preventDefault=function(){
};
setTimeout(function(){
uiController.playListScroll.handleEvent(myEvent);
},10)
setTimeout(function(){
uiController.playListScroll.handleEvent(myEvent);
},100)
}


playlistController.getSongPlaylistName=function(song){
if(song.playlistgid===0){
return""}
else if(song.playlistgid&&playlistController.loadedPlaylists[song.playlistgid]){
return playlistController.loadedPlaylists[song.playlistgid].name;
}
return"";
}

playlistController.hasTrendStyle=function(trend,song){
return(song.trend===trend);
}

playlistController.getTrendTitleClass=function(song){
if(song.trend==0||song.trend==1||song.trend==2||song.trend==3){
return"songTitleMargin";
}
return"";
}


playlistController.scrollByWheel=function(event){
uiController.playListScroll.handleEvent(event);
}

playlistController.scrollByDragCallback=function(event){
if(uiController.draggingSortableSong||uiController.draggingSong){
var dragEle=$(".draggedsortablelistelement, .draggedsearchlistelement");
if($("#playlistview").height()>$("#playlistInner").height()){
var doScroll=false;
if($("#playlistInner").offset().top-dragEle.offset().top>10&&Math.abs($("#playlistInner").offset().left-dragEle.offset().left)<50){
if(!uiController.playListScrollTimer||Date.now()-uiController.playListScrollTimer>500){
console.log(uiController.playListScroll.scrollY)
uiController.playListScrollTimer=Date.now()
uiController.playListScroll.enable();
uiController.playListScroll.refresh();
doScroll=true;
var scrollY=uiController.playListScroll.y+$("#playlistInner").height()/2
}
}else if($("#playlistInner").offset().top+$("#playlistInner").height()-dragEle.offset().top-dragEle.height()<-10&&Math.abs($("#playlistInner").offset().left-dragEle.offset().left)<50){
if(!uiController.playListScrollTimer||Date.now()-uiController.playListScrollTimer>500){
console.log(uiController.playListScroll.scrollY)
uiController.playListScrollTimer=Date.now()
uiController.playListScroll.enable();
uiController.playListScroll.refresh();
doScroll=true;
scrollY=uiController.playListScroll.y-$("#playlistInner").height()/2
}
}
if(scrollY>0)
scrollY=0;
else if(scrollY<uiController.playListScroll.maxScrollY)
scrollY=uiController.playListScroll.maxScrollY;
uiController.playListScroll.refresh();
if(doScroll)
uiController.playListScroll.scrollTo(0,scrollY,1000)
}
}
}

playlistController.getLoadedPlaylist=function(){
for(var playlist in playlistController.loadedPlaylists){
if(playlistController.loadedPlaylists.hasOwnProperty(playlist)){
return playlistController.loadedPlaylists[playlist]
}
}
return{};
}

playlistController.getPlaylistFromId=function(gid){
for(var i=0;i<playlistController.playlists.length;i++){
if(playlistController.playlists[i].gid==gid){
return playlistController.playlists[i];
}
}
return null;
}

playlistController.getPlaylistIndexFromId=function(gid){
for(var i=0;i<playlistController.playlists.length;i++){
if(playlistController.playlists[i].gid==gid){
return i;
}
}
return null;
}

playlistController.getPlaylistPosition=function(gid){
for(var i=0;i<playlistController.playlists.length;i++){
if(playlistController.playlists[i].gid==gid){
return i;
}
}
return-1;
}

playlistController.createEmptyPlaylist=function(addAtBottom,name){
if(!name)
name="Playlist";
var id=playlistController.getNewID();
var countUnnamed=0;
for(var i=0;i<playlistController.playlists.length;i++){
if(playlistController.playlists[i].name.substring(0,name.length)==name){
var number=playlistController.playlists[i].name.substring(name.length+2)
if(parseInt(number)&&countUnnamed<=parseInt(number)){
countUnnamed=parseInt(number);
}else if(!parseInt(number)&&(playlistController.playlists[i].name!=name||countUnnamed==0))
countUnnamed=countUnnamed+1;
}
}
if(countUnnamed>0){
name=name+" #"+(countUnnamed+1);
}
var playlist={gid:id,id:id,name:name,isUnnamedPlaylist:true,isPlaylist:true,tracks:[]};
if(addAtBottom)
playlistController.playlists.push(playlist);
else
playlistController.playlists.unshift(playlist);
return playlist;
}

playlistController.getSimilarSongs=function(song){
playlistController.similarSongs.song=jQuery.extend(true,{},song);
var artist=song.artist.name;
var title=song.name;
var onlineSearchURL="http://ws.audioscrobbler.com/2.0/?method=track.getsimilar&%searchTerm&api_key="+searchController.lastfmapikey+"&format=json"
$.when(
exploreController.basicOnlineSearchDeferred(onlineSearchURL,"artist="+artist+"&track="+title,searchController.searchTypeSongs,false,artist)
).then(function(onlineList){
var songList=exploreController.songs.completeSearch([],onlineList);
if(songList&&songList.length>0){
for(var i=0;i<songList.length;i++){
songList[i].gid=playlistController.getNewID();
}
playlistController.similarSongs.tracks=songList.splice(0,playlistController.similarSongsMaxResults);
playlistController.loadedPlaylistSongs=playlistController.similarSongs.tracks;
uiController.playListScroll.scrollTo(0,0,1000)
$("#playlistInner .iScrollPlayIndicator").hide();
$("#playlistInner .iScrollIndicator").hide();
playlistController.applySongList();
}
$.mobile.loading("hide");
});
}

playlistController.loadSimilarSongs=function(){
if(uiController.swipeTimer&&Date.now()-uiController.swipeTimer<100)
return;
var playlist=playlistController.similarSongs;
$scope.safeApply();
setTimeout(function(){
playlistController.showPlaylist(playlist);
setTimeout(function(){
$scope.safeApply();
},50)
},0)
event.stopPropagation();
}

playlistController.loadCurrentQueue=function(){
if(uiController.swipeTimer&&Date.now()-uiController.swipeTimer<100)
return;
var playlist=playlistController.currentQueue;
$scope.safeApply();
setTimeout(function(){
playlistController.showPlaylist(playlist);
setTimeout(function(){
$scope.safeApply();
},50)
},0)
if(event)
event.stopPropagation();
}

playlistController.loadNewPlaylistWithSongs=function(songs,playlistName){
songs=jQuery.extend(true,[],songs);
$.mobile.loading("show");
var playlist=playlistController.createEmptyPlaylist(false,playlistName);
for(var i=0;i<songs.length;i++){
var song=jQuery.extend(true,{},songs[i]);
if(song.playlistgid!=playlistController.currentQueue.gid||!song.gid)
song.gid=playlistController.getNewID()
song.playlistgid=playlist.gid;
song.id="plsid"+helperFunctions.padZeros(song,(""+playlistController.loadedPlaylistSongs.length).length);
songs[i]=song;
}
playlist.tracks=songs;
for(var j=0;j<playlist.tracks.length;j++){
if(!playlist.tracks[j].image){
setTimeout(mediaController.loadPreview(playlist.tracks[j]),j*300);
}
}
setTimeout(function(){
accountController.savePlaylist(playlist.gid,playlist.name,playlist.tracks);
accountController.savePlaylistsPosition();
},0)
$("#playlistview").hide();
$("#playlisthelp").hide();
playlistController.renameLoadedPlaylist=true;
$scope.safeApply();
setTimeout(function(){
playlistController.showPlaylist(playlist);
},0)
}

playlistController.loadNewEmptyPlaylist=function(){
if(uiController.swipeTimer&&Date.now()-uiController.swipeTimer<100)
return;
var playlist=playlistController.createEmptyPlaylist();
setTimeout(function(){
accountController.savePlaylist(playlist.gid,playlist.name,[]);
accountController.savePlaylistsPosition();
},0)
playlistController.renameLoadedPlaylist=true;
$scope.safeApply();
setTimeout(function(){
playlistController.showPlaylist(playlist);
},0)
event.stopPropagation();
}


playlistController.toggleSortablePlaylist=function(manuell){
console.log("!!!")
if(manuell&&playlistController.sortPlaylistTimer&&Date.now()-playlistController.sortPlaylistTimer<500){
return;
}
console.log("!!!2")
if(manuell){
uiController.startedSortPlaylist=false;
}
playlistController.sortPlaylist=!playlistController.sortPlaylist;
if(playlistController.sortPlaylist){
$(".sortable").sortable("enable");
$("#sortplaylistbtn").addClass("greenbackground");
$("#playlistInner").css("background-color","rgba(255,255,255,0.1)");
$('#playlistInner').css({backgroundColor:'rgba(255,255,255,0)'})
$('#playlistInner').animate({
backgroundColor:'rgba(255,255,255,0.1)'
},100);
$("#playlistsortstyle").remove();
var style=$('<style id="playlistsortstyle">'+
'#playlistInner ul li a{'+
'opacity:0.9!important;'+
'margin-bottom:-1px;'+
'border-bottom: 1px solid rgba(255,255,255,0.45);'+
'}'+
'</style>');
$('html > head').append(style);
console.log("!!!3")
}else{
playlistController.deselectSongs();
playlistController.sortPlaylistTimer=Date.now();
if(manuell){
var delay=0;
}
else
delay=1500;
setTimeout(function(){
if(!playlistController.sortPlaylist){
$('#playlistInner').animate({
backgroundColor:'rgba(255,255,255,0)'
},200);
}
},delay)
$("#sortplaylistbtn").removeClass("greenbackground");
setTimeout(function(){
$(".sortable").sortable("disable");
},100)
uiController.playListScroll.enable();
$("#playlistsortstyle").remove();

}
setTimeout(uiController.updateUI,0);
}
playlistController.getHelpStyleClass=function(){
if(!playlistController.getLoadedPlaylist().isSimilarSongs&&!playlistController.playlistMode&&playlistController.loadedPlaylistSongs.length==0&&!playlistController.hideHelp){
return"";
}else{
return"invisible";
}
}

playlistController.makePlayListScrollable=function(){
uiController.playListScroll=new IScroll('#playlistInner',{
interactiveScrollbars:true,
zoom:true,
scrollX:false,
scrollY:true,
mouseWheel:true,
zoomMin:0.2,
zoomMax:1,
startZoom:1,
scrollbars:true,
noHorizontalZoom:true
});
$(".iScrollIndicator").addClass("fadeincomplete").hide();
}

playlistController.makePlayListSortable=function(){
var startDragFunction=function(event){
playlistController.dragDraggableSongY=event.clientY;
playlistController.dragDraggableSongX=event.clientX;
if(playlistController.sortPlaylist){
if($(this).parents("#playlistInner").length==0)
return;
if(!playlistController.dragDraggableLastSongTimer||Date.now()-playlistController.dragDraggableLastSongTimer>500){
playlistController.dragDraggableSongTimer=Date.now();
playlistController.dragDraggableSongStartEvent=event;
playlistController.dragDraggableSongStartElement=this;
uiController.swiping=false;
}else
playlistController.dragDraggableSongTimer=0;
}
$("body").on("mouseup ",function(event){
$("body").off("mouseup");
$("body").off("mousemove");
playlistController.dragDraggableSongY=-10;
if(uiController.swiping||(playlistController.dragDraggableSongY>0&&Math.abs(event.clientY-playlistController.dragDraggableSongY)>30)){
uiController.swipeTimer=Date.now();
}
playlistController.dragDraggableSongTimer=0;
uiController.swiping=false;
})
$("body").on("mousemove ",function(event){
if(uiController.swiping||(playlistController.dragDraggableSongY>0&&Math.abs(event.clientY-playlistController.dragDraggableSongY)>30)){
uiController.swipeTimer=Date.now();
uiController.swiping=true;
}
if(playlistController.sortPlaylist){
if(playlistController.dragDraggableSongTimer&&Date.now()-playlistController.dragDraggableSongTimer<500&&Date.now()-playlistController.dragDraggableSongTimer>50){
uiController.stopPlaylistScrollingOnClick(event);
uiController.updateUI();
$("body").off("mousemove").off("mouseup");
playlistController.dragDraggableLastSongTimer=Date.now();
playlistController.dragDraggableSongTimer=0;
$(".sortable").sortable("enable");
var coords={
clientX:playlistController.dragDraggableSongStartEvent.clientX,
clientY:playlistController.dragDraggableSongStartEvent.clientY
};
$(playlistController.dragDraggableSongStartElement).simulate("mouseup",coords);
var coords={
clientX:event.clientX,
clientY:event.clientY
};
$(playlistController.dragDraggableSongStartElement).simulate("mouseup",coords);
uiController.mouseUp=false;
$(playlistController.dragDraggableSongStartElement).simulate("mousedown",coords);
}
}
})
}
$("#playlistInner li").off("mousedown",startDragFunction);
$("#playlistInner li").on("mousedown",startDragFunction)
$("#playlistview").sortable({
tolerance:"pointer",
dropOnEmpty:true,
revert:true,
opacity:0.9,
items:".playlistsong",
helper:function(event,$item){
$(".songOptions").appendTo("body").hide();
$("#searchlist li.selected").removeClass("selected")
if(!$($item).hasClass("selected")){
$("#playlistInner li.selected").removeClass("selected")
$($item).addClass("selected");
}

var $helper=$('<ul></ul>').addClass('songlist draggedlistelement draggedsortablelistelement');
var elements=$("#playlistInner li.selected").removeClass("selected").removeClass("loadedsong playing pausing stillLoading");
elements.find(".loadingSongImg").remove();
if(elements.length==0){
var oneItem=true;
elements=$($item).removeClass("selected").removeClass("loadedsong playing pausing stillLoading");
elements.removeClass("fadeslideincompletefast");
}else{
elements.removeClass("fadeslideincompletefast");
$(elements.get(0));
oneItem=false;
}

$("#playlistplaceholder").remove();
$("<style type='text/css' id='playlistplaceholder'> #playlistInner ul .ui-sortable-placeholder{ height:"+(65*elements.length)+"px !important} </style>").appendTo("head");
var ele=$helper.append(elements.clone());
if(!oneItem){
for(var i=0;i<elements.length;i++){
if($item[0]!=elements.get(i)){
$(elements.get(i)).hide();
}
}
playlistController.draggedElements=elements;
}else
playlistController.draggedElements=null;
return ele;
},
receive:function(event,ui){
console.log(".......................")
console.dir(ui)
},
start:function(event,ui){
if(!uiController.draggingSong){
console.log("STARTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT")
playlistController.hideSongOptions();
$("#playlistInner").offset().top
uiController.lastDraggingSongFromSearchlist=false;
uiController.draggingSortableSong=true;
$("#playlistInner").removeClass("animate");
$("#playlistInner li").removeClass("fadeslideincompletefast");
setTimeout(function(){
},3000)
$(".draggedsortablelistelement").off();
$(".draggedsortablelistelement").on('mousemove',playlistController.scrollByDragCallback);
$(".draggedsortablelistelement").on('wheel',playlistController.scrollByWheel);
$(".draggedsortablelistelement").on('mousewheel',playlistController.scrollByWheel);
$(".draggedsortablelistelement").on('DOMMouseScroll',playlistController.scrollByWheel);
uiController.playListScroll.enable();
}
},beforeStop:function(){
},
stop:function(event,ui){
playlistController.dragDraggableSongY=0;
uiController.swiping=false;
var newLoadedPlaylistSongs=[];
if(playlistController.draggedElements){
playlistController.draggedElements.css("opacity","");
playlistController.draggedElements.show();
}
var actPlsid=0;
$("#playlistview").find("li").each(function(index){
$(this).removeClass("margintop fadeslideincompletefast");
if($(this).hasClass("specialplaylistbutton"))
return;
if($(this).hasClass("playlistsong")){id=this.dataset.index;
var isDraggedElement=false;
var isDraggedElementButNotFirst=false;
if(playlistController.draggedElements&&!uiController.lastDraggingSongFromSearchlist){
if(this.dataset.songgid&&ui.item[0].dataset.index==this.dataset.index)
isDraggedElement=true;
else{
playlistController.draggedElements.each(function(index){
var dragid=playlistController.draggedElements[index].dataset.index;
if(dragid==id)
isDraggedElementButNotFirst=true;
})
}
}
console.dir("Playlist "+$(this).find("h3").text()+"   "+isDraggedElement+"   "+isDraggedElementButNotFirst)
if(isDraggedElement){playlistController.draggedElements.each(function(index){
id=playlistController.draggedElements[index].dataset.index;
if(playlistController.playlistMode)
actSong=playlistController.playlists[parseInt(id)];
else{
actSong=playlistController.loadedPlaylistSongs[parseInt(id)];
actSong.id="plsid"+helperFunctions.padZeros(actPlsid,(""+playlistController.loadedPlaylistSongs.length).length);
}
actSong=jQuery.extend(true,{},actSong);
newLoadedPlaylistSongs.push(actSong);
actPlsid=actPlsid+1
});
}
else if(!isDraggedElementButNotFirst){
if(playlistController.playlistMode)
actSong=playlistController.playlists[parseInt(id)];
else{
actSong=playlistController.loadedPlaylistSongs[parseInt(id)];
actSong.id="plsid"+helperFunctions.padZeros(actPlsid,(""+playlistController.loadedPlaylistSongs.length).length);
}
actSong=jQuery.extend(true,{},actSong);
newLoadedPlaylistSongs.push(actSong);
actPlsid=actPlsid+1
}
}else{console.dir("Searchlist "+$(this).find("h3").text())
var id=this.dataset.index;
isDraggedElement=false;
if(playlistController.draggedElements&&uiController.lastDraggingSongFromSearchlist){
if(!this.dataset.songgid&&ui.item[0].dataset.index==this.dataset.index)
isDraggedElement=true;
}
if(isDraggedElement){playlistController.draggedElements.each(function(index){
var id=playlistController.draggedElements[index].dataset.index;
var actSong=searchController.getSongFromIndex(parseInt(id));
actSong=jQuery.extend(true,{},actSong);
if(actSong.tmpHide)
delete actSong.tmpHide;
actSong.gid=playlistController.getNewID();actSong.id="plsid"+helperFunctions.padZeros(actPlsid,(""+playlistController.loadedPlaylistSongs.length).length);
var playlistCount=Object.keys(playlistController.loadedPlaylists).length;
for(var playlist in playlistController.loadedPlaylists){
if(playlistController.loadedPlaylists.hasOwnProperty(playlist)){
if(playlistController.loadedPlaylists[playlist].isUnnamedPlaylist||playlistCount==1){
actSong.playlistgid=playlistController.loadedPlaylists[playlist].gid;
}
}
}
newLoadedPlaylistSongs.push(actSong);
actPlsid=actPlsid+1;
})
}
else{
var actSong=searchController.getSongFromIndex(parseInt(id));
actSong=jQuery.extend(true,{},actSong);
if(actSong.tmpHide)
delete actSong.tmpHide;
actSong.gid=playlistController.getNewID();actSong.id="plsid"+helperFunctions.padZeros(actPlsid,(""+playlistController.loadedPlaylistSongs.length).length);
newLoadedPlaylistSongs.push(actSong);
actPlsid=actPlsid+1
}
$(this).remove();
}
})
var playlistCount=Object.keys(playlistController.loadedPlaylists).length;playlistController.loadedPlaylistSongs=newLoadedPlaylistSongs;
playlistController.displayLimit=playlistController.loadedPlaylistSongs.length;
if(playlistController.playlistMode){
playlistController.playlists=playlistController.loadedPlaylistSongs;
setTimeout(function(){
accountController.savePlaylistsPosition();
},0)
}
else{
if($('#playlistselectverticalform option:selected').size()>1)
$("#clearChoosenPlaylists").show();
else
$("#clearChoosenPlaylists").hide();
for(var playlist in playlistController.loadedPlaylists){
if(playlistController.loadedPlaylists.hasOwnProperty(playlist)){
if(playlistController.loadedPlaylists[playlist].isUnnamedPlaylist||playlistCount==1){
playlistController.loadedPlaylists[playlist].tracks=playlistController.loadedPlaylistSongs;
}
}
}
}
setTimeout(function(){
for(var playlist in playlistController.loadedPlaylists){
if(playlistController.loadedPlaylists.hasOwnProperty(playlist)){
if(playlistController.loadedPlaylists[playlist].isUnnamedPlaylist||playlistCount==1){
if(playlistController.loadedPlaylists[playlist].tracks.length>0){
var position=playlistController.getPlaylistPosition(playlistController.loadedPlaylists[playlist].gid);
if(position>-1){
var savePlaylist=playlistController.loadedPlaylists[playlist];
accountController.savePlaylist(savePlaylist.gid,savePlaylist.name,savePlaylist.tracks);
}
}
}
}
}
},1000)

var scrollY=uiController.playListScroll.y;
$("#playlistInner").hide();
$("#playlistInner").html(
window.$compile(
preloadhtml.playlisthtml
)($scope));
$scope.safeApply();
playbackController.remarkSong();
$("#playlistview").addClass("disablecoveranim");
setTimeout(function(){
$("#playlistview").removeClass("disablecoveranim");
},300)
$("#playlistview li").removeClass("fadeslideincompletefast").removeClass("fadeincomplete");
$("#playlistview").listview();
playlistController.makePlayListScrollable();
$("#playlistview").listview('refresh');
uiController.playListScroll.scrollTo(0,scrollY);
$("#playlistInner").show();
uiController.updateUI();
setTimeout(function(){
playlistController.createScrollIndicators();
playbackController.positionPlayIndicator();
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.playListScroll.refresh();
},1000)
},150)
if(uiController.startedSortPlaylist){
playlistController.toggleSortablePlaylist();
uiController.startedSortPlaylist=false;
}
setTimeout(function(){
playlistController.makePlayListSortable();
},0)
uiController.swipeTimer=Date.now();
uiController.draggingSortableSong=false;
},
appendTo:'body',
zIndex:"1000000"}).disableSelection();
$(".sortable").sortable("disable");
}
;

;
var preloadhtml=function(){
};
preloadhtml.sharefbartist=$("#fbartistbox").html();
$("#fbartistbox").html("");
preloadhtml.sharefbsong=$("#fbtitlebox").html();
$("#fbtitlebox").html("");
preloadhtml.recommendfb=$(".fb-recommendations-bar-container").html();
$(".fb-recommendations-bar-container").html("");
preloadhtml.playlisthtml=$("#playlistInner").html();
;

;
var searchController=function(){
};
searchController.lastfmapikey="019c7bcfc5d37775d1e7f651d4c08e6f";
searchController.songs=function(){
};
searchController.playlists=function(){
};
searchController.artists=function(){
};
searchController.users=function(){
};
searchController.songs.searchResults=[];
searchController.playlists.searchResults=[];
searchController.artists.searchResults=[];
searchController.users.searchResults=[];
searchController.usesSearchList=true;
searchController.index=0;
searchController.inputText="Search Songs and Playlists";
searchController.currentSearchID=0;
searchController.maxResults=100;
searchController.displayLimit=searchController.maxResults;
searchController.searchSongsString="";
searchController.showMode=-1;searchController.maxPopularSongPages=2;
searchController.maxArtistSongPages=2;

searchController.searchTypeSongs=0;
searchController.searchTypePlaylists=1;
searchController.searchTypeArtists=2;
searchController.searchTypeUsers=3;
if(generatedData&&generatedData.charts){
searchController.preloadedPopularSongs={"track":generatedData.charts};
setTimeout(function(){
searchController.songs.cleanList(searchController.preloadedPopularSongs.track);
},0)
}
else
searchController.preloadedPopularSongs={"track":[]}
searchController.init=function(){
uiController.searchListScroll=new IScroll('#searchlist',{
interactiveScrollbars:true,
zoom:true,
scrollX:false,
scrollY:true,
mouseWheel:true,
zoomMin:0.2,
zoomMax:1,
startZoom:1,
useTransition:true,
scrollbars:true,
noHorizontalZoom:true,
HWCompositing:false
});
$(".iScrollIndicator").addClass("fadeincomplete").hide();
uiController.searchListScroll.on('scrollEnd',function(){
if(uiController.searchListScroll.y==0){
$("#searchlist .iScrollScrollUpIndicator").hide();
}else{
$("#searchlist .iScrollScrollUpIndicator").show();
}
});
setTimeout(function(){
uiController.searchListScroll.refresh();
},150)
searchController.scrollUpIndicator=$('<div class="iScrollScrollUpIndicator fadeincomplete" style="display:none;"></div>');
$("#searchlist .iScrollVerticalScrollbar").prepend(searchController.scrollUpIndicator);
searchController.scrollUpIndicator.click(function(){
uiController.searchListScroll.scrollTo(0,0,200);
});
searchController.playIndicator=$('<div class="iScrollPlayIndicator fadeincomplete5s" style="display:none;"></div>');
searchController.playIndicator.appendTo("#searchlist .iScrollVerticalScrollbar");
searchController.playIndicator.click(function(){
uiController.searchListScroll.scrollToElement(".loadedsong",700);
});
}

searchController.onInput=function(){
if(searchController.showMode==5)
searchController.backShowMode();
$("#searchlist .iScrollPlayIndicator").hide();
$("#searchlist .iScrollScrollUpIndicator").hide();
searchController.startSearch();
}

searchController.onClear=function(){
searchController.startSearch()}

searchController.showView=function(){
uiController.searchListScroll.scrollTo(0,0,0);
searchController.visible=true;
$("#searchinput").val(searchController.searchSongsString);
setTimeout(function(){
if(searchController.visible){
searchController.displayLimit=0;
searchController.applySongList(searchController.currentSearchID);
}
},350)
}

searchController.hideView=function(){
searchController.visible=false;
searchController.currentSearchID++;
searchController.displayLimit=0;
searchController.searchSongsString=$("#searchinput").val();
$scope.safeApply();
$("#searchlistview").listview('refresh');
}
searchController.basicLocalSearchDeferred=function(searchTerm,searchTypeNative){
var deferred=$.Deferred();
setTimeout(function(){
var data=[];
deferred.resolve(data);
},0)
return deferred.promise();
}
searchController.basicOnlineSearchDeferred=function(searchURL,searchTerm,searchTypeNative,dontSearchNative,nativeSearchTerm){
var deferred=$.Deferred();
searchURL=searchURL.replace("%searchTerm",searchTerm);
var searchserver=function(){
if(!nativeSearchTerm)
var url=preferences.serverURL+"?searchjson="+searchTerm+"&type="+searchTypeNative+"&auth="+authController.ip_token;
else
url=preferences.serverURL+"?searchjson="+nativeSearchTerm+"&type="+searchTypeNative+"&auth="+authController.ip_token;
$.ajax({
url:url,
success:function(data){
if(data.auth&&data.auth=="true"){
authController.extractToken(data.token);
searchserver();
}
else{
var list=[];
if(data.track){
for(var i=0;i<data.track.length;i++){
try{
data.track[i].artist=decodeURIComponent(data.track[i].artist);
}
catch(e){
data.track[i].artist=unescape(data.track[i].artist);
}
try{
data.track[i].name=decodeURIComponent(data.track[i].name);
}
catch(e){
data.track[i].name=unescape(data.track[i].name);
}
}
list=data.track;
}
for(var j=0;j<data.track.length;j++){
setTimeout(mediaController.loadPreview(data.track[j]),j*300);
}
deferred.resolve({list:list,native:true});
}
},
error:function(xhr,ajaxOptions,thrownError){
console.dir("JUKE SERVER ERROR!");
console.dir(xhr);
deferred.resolve({list:[],native:true});
}
})
}
$.ajax({
url:searchURL,
success:function(data){
if(!data)
data={};
if(data.results&&!(data.results.trackmatches=="\n"||data.results.albummatches=="\n"||data.results.artistmatches=="\n")){
deferred.resolve({list:data,native:false});
}else if(data.similartracks&&!(data.similartracks=="\n")){
deferred.resolve({list:data.similartracks,native:false});
}else{
if(!dontSearchNative){
searchserver();
}else
deferred.resolve({list:[],native:true});
}
},
error:function(){
if(!dontSearchNative){
searchserver();
}else
deferred.resolve({list:[],native:true});
}
})
return deferred.promise();
}

searchController.startSearch=function(searchTerm){
if(!searchTerm)
searchTerm=$("#searchinput").val();
viewController.showLoading(true);
if(searchTerm&&$.trim(searchTerm)!=""){
searchController.showedPopulars=false;
searchController.currentSearchID=searchController.currentSearchID+1;
var search=function(searchID){
$.when(
searchController.songs.startSearchDeferred(searchTerm),
searchController.playlists.startSearchDeferred(searchTerm),
searchController.artists.startSearchDeferred(searchTerm)
).then(function(songList,playlistList,artistsList,userList){
if(searchID==searchController.currentSearchID){
searchController.completedSearch(songList,playlistList,artistsList,userList);
}
});
};
search(searchController.currentSearchID);
}else{
searchController.showPopulars();
}
};

searchController.completedSearch=function(songList,playlistList,artistsList,userList){
if(songList||playlistList||artistsList||userList){
searchController.displayLimit=0;
if(searchController.showMode==-1)
searchController.showMode=0;
uiController.searchListScroll.scrollTo(0,0,1000)
if(songList!=null)searchController.songs.searchResults=songList;
if(playlistList!=null)searchController.playlists.searchResults=playlistList;
if(artistsList!=null)searchController.artists.searchResults=artistsList;
if(userList!=null)searchController.users.searchResults=userList;
console.dir("songList!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")
console.dir(songList);
searchController.applySongList(searchController.currentSearchID);
setTimeout(viewController.showLoading,100)}
};
searchController.showPopulars=function(){
if(searchController.preloadedPopularSongs){
searchController.playlists.searchResults=[];
searchController.artists.searchResults=[];
searchController.users.searchResults=[];
searchController.showedPopulars=true;
searchController.currentSearchID=searchController.currentSearchID+1;
searchController.completedSearch(searchController.preloadedPopularSongs.track);
}
}
searchController.emptySearchList=function(dontInitFully){
searchController.currentSearchID++;
viewController.showLoading(false);
searchController.songs.searchResults=[];
searchController.playlists.searchResults=[];
searchController.artists.searchResults=[];
searchController.users.searchResults=[];
searchController.displayLimit=0;
$scope.safeApply();
console.log("EMPTYÄÄÄÄÄAYYYYIIIIIII")
$("#searchlistview").listview('refresh');
$("#searchlist .iScrollIndicator").hide();
$("#searchlist .iScrollPlayIndicator").hide();
$("#searchlist .iScrollScrollUpIndicator").hide();
playbackController.positionPlayIndicatorAtTop(true);
setTimeout(function(){
uiController.searchListScroll.refresh();
playlistController.updateDeselectedSong();
uiController.updateUI();
playbackController.remarkSong();
},0)
if(!dontInitFully){
searchController.makeSearchListDraggable();
setTimeout(function(){
$("#searchlistview li").removeClass("fadeincompletefast");
},100)
}
}


searchController.songs.startSearchDeferred=function(searchTerm){
var deferred=$.Deferred();
var onlineSearchURL="http://ws.audioscrobbler.com/2.0/?method=track.search&track=%searchTerm&limit=100&api_key="+searchController.lastfmapikey+"&format=json";
$.when(
searchController.basicLocalSearchDeferred(searchTerm,searchController.searchTypeSongs),
searchController.basicOnlineSearchDeferred(onlineSearchURL,searchTerm,searchController.searchTypeSongs)
).then(function(localList,onlineList){
var songList=searchController.songs.completeSearch(localList,onlineList)
deferred.resolve(songList);
});
return deferred.promise();
}
searchController.formatNumber=function(x){
if(x.indexOf(".")==-1)
return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");
else
return x
}
searchController.songs.cleanList=function(songList){
for(var i=0;i<songList.length;i++){
var song=songList[i];
if(!song.name||song.name==""){
songList.splice(i,1);
i--;
}else{
if(song.playcount)
song.playcount=searchController.formatNumber(song.playcount);
if(song.artist){
if(!song.artist.name){
if(song.artist)
song.artist={name:song.artist};
}
}else
song.artist={name:mediaController.unknownData};
song.artist.name=$.trim(song.artist.name);
song.name=$.trim(song.name);
if(song.mbid){
delete song.mbid
}
if(song.streamable){
delete song.streamable
}
if(song.url){
delete song.url
}
}
}
}
searchController.songs.completeSearch=function(localList,onlineList){
if(onlineList.native){
onlineList=onlineList.list;
}else{
if(onlineList.list.results&&onlineList.list.results.trackmatches)
onlineList=onlineList.list.results.trackmatches.track;
else if(onlineList.list)
onlineList=onlineList.list.track;
}
if(!onlineList)
onlineList=[];
var songList=localList.concat(onlineList)
searchController.songs.cleanList(songList)
var changedResults=false;
if(songList.length&&searchController.songs.searchResults.length==songList.length){
for(var i=0;i<searchController.songs.searchResults.length;i++){
if($.trim(searchController.songs.searchResults[i].artist.name)!=$.trim(songList[i].artist.name)){
changedResults=true;
break;
}
if($.trim(searchController.songs.searchResults[i].name)!=$.trim(songList[i].name)){
changedResults=true;
break;
}
}
}else
changedResults=true;
if(!changedResults){
songList=null;
}
return songList;
}


searchController.playlists.startSearchDeferred=function(searchTerm){
var deferred=$.Deferred();
var onlineSearchURL="http://ws.audioscrobbler.com/2.0/?method=album.search&album=%searchTerm&limit=100&api_key="+searchController.lastfmapikey+"&format=json";
$.when(
searchController.basicLocalSearchDeferred(searchTerm,searchController.searchTypePlaylists),
searchController.basicOnlineSearchDeferred(onlineSearchURL,searchTerm,searchController.searchTypePlaylists,true)
).then(function(localList,onlineList){
var playlistList=searchController.playlists.completeSearch(localList,onlineList)
deferred.resolve(playlistList);
});
return deferred.promise();
}
searchController.playlists.completeSearch=function(localList,onlineList){
if(onlineList.native){
onlineList=onlineList.list;
}else
onlineList=onlineList.list.results.albummatches.album;
var playlistList=localList.concat(onlineList)
for(var i=0;i<playlistList.length;i++){
var playlist=playlistList[i];
if(!playlist.name||playlist.name==""){
playlistList.splice(i,1);
i--;
}else{
playlistList[i].isPlaylist=true;
if(playlist.artist){
if(!playlist.artist.name){
if(playlist.artist)
playlist.artist={name:playlist.artist};
}
}else
playlist.artist={name:mediaController.unknownData};
playlist.artist.name=$.trim(playlist.artist.name);
playlist.name=$.trim(playlist.name);
}
}
var changedResults=false;
if(searchController.playlists.searchResults.length==playlistList.length){
for(var i=0;i<searchController.playlists.searchResults.length;i++){
if($.trim(searchController.playlists.searchResults[i].name)!=$.trim(playlistList[i].name)){
changedResults=true;
break;
}
}
}else
changedResults=true;
if(!changedResults){
playlistList=null;
}
return playlistList;
}


searchController.artists.startSearchDeferred=function(searchTerm){
var deferred=$.Deferred();
var onlineSearchURL="http://ws.audioscrobbler.com/2.0/?method=artist.search&artist=%searchTerm&limit=100&api_key="+searchController.lastfmapikey+"&format=json";
$.when(
searchController.basicLocalSearchDeferred(searchTerm,searchController.searchTypeArtists)
).then(function(localList,onlineList){
var artistList=searchController.artists.completeSearch(localList,onlineList)
deferred.resolve(artistList);
});
return deferred.promise();
}
searchController.artists.completeSearch=function(localList,onlineList){
if(!onlineList)
onlineList=[];
if(onlineList.native){
onlineList=onlineList.list;
}else if(onlineList.list)
onlineList=onlineList.list.results.artistmatches.artist;
else
onlineList=[];
var artistList=localList.concat(onlineList)
for(var i=0;i<artistList.length;i++){
var artist=artistList[i];
if(!artist.name||artist.name==""){
artistList.splice(i,1);
i--;
}else{
artistList[i].isArtist=true;
artist.name=$.trim(artist.name);
}
}
var changedResults=false;
if(searchController.artists.searchResults.length==artistList.length){
for(var i=0;i<searchController.artists.searchResults.length;i++){
if($.trim(searchController.artists.searchResults[i].name)!=$.trim(artistList[i].name)){
changedResults=true;
break;
}
}
}else
changedResults=true;
if(!changedResults){
artistList=null;
}
return artistList;
}


searchController.getSongFromIndex=function(index){
if(searchController.showMode==5)
return searchController.showedPlaylist.tracks[index];
else
return searchController.songs.searchResults[index];
}

searchController.applySongList=function(currentSearchID){
console.log("-------------------------------------")
$(".specialplaylistbutton").removeClass("fadeincompletefaster");
$("#searchlist .iScrollIndicator").hide();
var stepSize=10;
var stepDelay=50;
if(searchController.showMode==0){
var size=searchController.maxResults;
}
else{
if(searchController.showed)
size=Math.min(searchController.showed.searchResults.length,searchController.maxResults)
else
size=searchController.maxResults;
}
var delays=(Math.ceil(size/stepSize));
console.log(delays)
console.log(size+"  "+stepSize)
viewController.applySongList(currentSearchID,size,delays,stepSize,stepDelay);
}
searchController.searchArtistSongs=function(artist){
return

}


searchController.showPlaylist=function(playlist){
console.dir(playlist)
playlist.tracks=[];
searchController.showedPlaylist=playlist;
searchController.oldShowMode=searchController.showMode;
searchController.showMode=5;
$("#searchlistview").hide();
$("#searchlist .iScrollIndicator").hide();
$("#searchlist .iScrollScrollUpIndicator").hide();
var callbackComplete=function(){
$scope.safeApply();
setTimeout(function(){
$("#searchlistview").listview('refresh');
searchController.makeSearchListDraggable();
$("#searchlistview").show();
},150);
setTimeout(function(){
uiController.searchListScroll.refresh();
},150)
setTimeout(function(){
uiController.searchListScroll.refresh();
},1000)
}
setTimeout(function(){
searchController.loadPlaylistTracks(playlist,callbackComplete,true);
},0);
}

searchController.loadPlaylistTracks=function(playlist,completeCallback,loadPreviews){
var url="http://ws.audioscrobbler.com/2.0/?method=album.getinfo&api_key="+searchController.lastfmapikey+"&artist="+playlist.artist.name+"&album="+playlist.name+"&format=json";
$.ajax({
url:url,
success:function(data){
if(data.album&&data.album.tracks&&data.album.tracks.track){
searchController.songs.cleanList(data.album.tracks.track);
playlist.tracks=data.album.tracks.track;
if(playlist.tracks.length&&loadPreviews){
for(var j=0;j<playlist.tracks.length;j++){
if(!playlist.tracks[j].image){
setTimeout(mediaController.loadPreview(playlist.tracks[j]),j*300);
}
}
}
console.dir(playlist);
}
},
error:function(){
},
complete:function(){
if(completeCallback)
completeCallback();
}
})
}

searchController.backShowMode=function(){
if(searchController.oldShowMode!==undefined)
searchController.setShowMode(searchController.oldShowMode);
}
searchController.getArtistInfo=function(){
$.ajax({
url:"&search=",
success:function(data){
if(data){
}
}
})
}

searchController.getSongFromId=function(id){
for(var i=0;i<searchController.songs.searchResults.length;i++){
if(searchController.songs.searchResults[i].id==id){
return searchController.songs.searchResults[i];
}
}
return null;
}

searchController.isSongInList=function(song){
if(song){
var displayName=mediaController.getSongDisplayName(song)
for(var i=0;i<searchController.songs.searchResults.length;i++){
if(displayName==mediaController.getSongDisplayName(searchController.songs.searchResults[i])){
return true;
}
}
}
return false;
}
searchController.isVisisbleInShowMode=function(showMode){
return searchController.showMode!=-1&&(showMode==searchController.showMode||searchController.showMode==0);
}

searchController.setShowMode=function(showMode){
if(showMode==searchController.showMode)
return;
if(searchController.isOnlyTypeDisplayed(showMode))
return;
$("#searchlistview").hide();
$("#searchlist .iScrollIndicator").hide();
$("#searchlist .iScrollScrollUpIndicator").hide();
if(searchController.showMode==0)
playlistController.searchListScrollY=uiController.searchListScroll.y;
searchController.showMode=showMode;
switch(showMode){
case 0:searchController.showed=null;
searchController.displayLimit=0;
$scope.safeApply();
$("#searchlistview").listview('refresh');
setTimeout(function(){
playbackController.remarkSong();
},0)
break;
case 1:searchController.showed=searchController.songs;
break;
case 2:searchController.showed=searchController.playlists;
break;
case 3:searchController.showed=searchController.artists;
break;
case 4:searchController.showed=searchController.user;
break;
}
setTimeout(function(){
if(searchController.showMode==0&&playlistController.searchListScrollY)
uiController.searchListScroll.scrollTo(0,playlistController.searchListScrollY,0);
else
uiController.searchListScroll.scrollTo(0,0,0);
},0);
searchController.applySongList(searchController.currentSearchID);
setTimeout(function(){
$("#searchlistview").show();
},150);
}

searchController.isOnlyTypeDisplayed=function(type){
return searchController.showMode==type||searchController.isOnlyResultType(type);
}

searchController.isOnlyResultType=function(type){
switch(type){
case 1:if(searchController.playlists.searchResults.length==0&&searchController.artists.searchResults.length==0&&searchController.users.searchResults.length==0)
return true;
break;
case 2:if(searchController.songs.searchResults.length==0&&searchController.artists.searchResults.length==0&&searchController.users.searchResults.length==0)
return true;
break;
case 3:if(searchController.playlists.searchResults.length==0&&searchController.songs.searchResults.length==0&&searchController.users.searchResults.length==0)
return true;
break;
case 4:if(searchController.playlists.searchResults.length==0&&searchController.songs.searchResults.length==0&&searchController.artists.searchResults.length==0)
return true;
break;
}
return false;
}
searchController.getShowModeLimit=function(type){
if(searchController.isOnlyTypeDisplayed(type)){
var limit=searchController.displayLimit;
}else{
switch(type){
case 1:if(uiController.gridLayout)
limit=Math.ceil(10/uiController.gridLayoutCols)*uiController.gridLayoutCols;
else
limit=30;
break;
break;
case 2:if(uiController.gridLayout)
limit=uiController.gridLayoutCols;
else
limit=3;break;
case 3:if(uiController.gridLayout)
limit=uiController.gridLayoutCols;
else
limit=1;
break;
case 4:if(uiController.gridLayout)
limit=uiController.gridLayoutCols;
else
limit=3;
break;
}
}
return limit
}

searchController.dragDraggableSongTimer=0;
searchController.makeSearchListDraggable=function(){
var startDragFunction=function(event){
if($(this).parents("#searchlist").length==0)
return;
if(!searchController.dragDraggableLastSongTimer||Date.now()-searchController.dragDraggableLastSongTimer>500){
searchController.dragDraggableSongX=event.clientX;
searchController.dragDraggableSongY=event.clientY;
searchController.dragDraggableSongTimer=Date.now();
TIMER=Date.now()
searchController.dragDraggableSongStartEvent=event;
searchController.dragDraggableSongStartElement=this;
uiController.swiping=false;
$("body").on("mouseup ",function(event){
$("body").off("mousemove").off("mouseup");
if(uiController.swiping||(searchController.dragDraggableSongY>0&&Math.abs(event.clientY-searchController.dragDraggableSongY)>30)){
uiController.swipeTimer=Date.now();
}
setTimeout(function(){
$("#playlistview").removeClass("dragging");
$(".songlist").removeClass("nohover");
uiController.swiping=false;
searchController.dragDraggableSongY=0;
searchController.dragDraggableSongTimer=0;
},50)
})
$("body").on("mousemove ",function(event){
console.log('MOUSEMOVE SEARCH  '+Math.abs(event.clientY-searchController.dragDraggableSongY)+"    "+(Date.now()-searchController.dragDraggableSongTimer))
if(uiController.swiping||(searchController.dragDraggableSongY>0&&Math.abs(event.clientY-searchController.dragDraggableSongY)>30)){
searchController.dragDraggableSongY=-10;
uiController.swiping=true;
uiController.swipeTimer=Date.now();
console.log('SWIPING SEARCH '+Math.abs(event.clientY-searchController.dragDraggableSongY)+"    "+(Date.now()-searchController.dragDraggableSongTimer))
}else if(searchController.dragDraggableSongTimer&&Date.now()-searchController.dragDraggableSongTimer<500){
if(!uiController.draggingSong&&event.clientX-searchController.dragDraggableSongX>0&&Math.abs(event.clientY-searchController.dragDraggableSongY)<Math.abs(event.clientX-searchController.dragDraggableSongX)*0.8){
console.log('DRAGGING')
$("body").off("mousemove").off("mouseup");
searchController.dragDraggableSongY=-10;
searchController.dragDraggableLastSongTimer=Date.now();
searchController.dragDraggableSongTimer=0;
searchController.mainDraggedElement=$(searchController.dragDraggableSongStartEvent.target)
if(!searchController.mainDraggedElement.hasClass("draggableSong"))
searchController.mainDraggedElement=$(searchController.dragDraggableSongStartEvent.target).parents("li")
if(searchController.mainDraggedElement.length==0)
return;
var delay=0;
if(playlistController.playlistMode){
$("#searchlistview .draggableSong").draggable("option","connectToSortable","");
if(playlistController.sortPlaylist)
playlistController.toggleSortablePlaylist();
}else{
$("#searchlistview .draggableSong").draggable("option","connectToSortable","#playlistview");
}
searchController.mainDraggedElement.draggable("enable");
if(!uiController.sidePanelOpen&&$(window).width()<uiController.responsiveWidthSmallest){
uiController.startedSortPlaylistOpenedPanel=true;
uiController.toggleSidePanel();
delay=delay+250;
}else{
uiController.startedSortPlaylistOpenedPanel=false;
}
var coords={
clientX:searchController.dragDraggableSongStartEvent.clientX,
clientY:searchController.dragDraggableSongStartEvent.clientY
};
$(searchController.dragDraggableSongStartElement).simulate("mouseup",coords);
uiController.mouseUp=false;
$("body").on("mouseup ",function(event){
$("body").off("mouseup");
uiController.mouseUp=true;
if(searchController.mainDraggedElement){
searchController.mainDraggedElement.draggable("disable").removeClass("ui-disabled ui-state-disabled");
searchController.mainDraggedElement=null;
}
})
setTimeout(function(){
console.log("MOUSEUP??"+uiController.mouseUp)
if(!uiController.mouseUp){
if(!playlistController.sortPlaylist&&!playlistController.playlistMode){
playlistController.toggleSortablePlaylist();
console.log("STARTTTTTSORTABLE")
uiController.startedSortPlaylist=true;
}else
uiController.startedSortPlaylist=false;
console.log("! "+uiController.startedSortPlaylist+"   "+playlistController.playlistMode)
$(searchController.dragDraggableSongStartElement).simulate("mousedown",coords);
uiController.updateUI();
}
},delay)
}
}
})
}else
searchController.dragDraggableSongTimer=0;
}
$("#searchlist li").off("mousedown",startDragFunction);
$("#searchlist li").on("mousedown",startDragFunction)
$('#searchlistview .draggableSong').draggable({
tolerance:"pointer",
dropOnEmpty:true,
revert:false,
connectToSortable:'#playlistview',
helper:function(event,ui){
$("#songOptions").appendTo("body").hide();
$("#playlistInner li.selected").removeClass("selected")
if(!$(this).hasClass("selected")){
$("#searchlist li.selected").removeClass("selected")
$(this).addClass("selected");
}
var $helper=$('<ul></ul>').addClass('songlist draggedlistelement draggedsearchlistelement');
var elements=$("#searchlist li.selected").removeClass("selected").clone().removeClass("loadedsong playing pausing stillLoading");
elements.find(".songPlayCount, .songTrend, .loadingSongImg").remove();
elements.find("h3").removeClass("songTitleMargin");
if(elements.length==0){
elements=$(this).removeClass("selected").clone().removeClass("loadedsong playing pausing stillLoading");
elements.removeClass("fadeslideincompletefast");
elements.addClass("margintop");
}else{
elements.removeClass("fadeslideincompletefast");
$(elements.get(0)).addClass("margintop");
}
$("#playlistplaceholder").remove();
var eleHeight=(65*elements.length);
if(eleHeight>65*4){
eleHeight=65*4;
}
if(eleHeight<65)
eleHeight=65;
$("<style type='text/css' id='playlistplaceholder'> #playlistInner ul .ui-sortable-placeholder{ height:"+eleHeight+"px !important} </style>").appendTo("head");
var ele=$helper.append(elements)
playlistController.draggedElements=elements;
playlistController.draggedElement=ele.find("li[data-index='"+$(this).data("index")+"'] ");
$(".songlist").addClass("nohover");
ele.css("opacity","1");
return ele;
},
start:function(event){
$(".importplaylist").hide();
var eleParent=$(playlistController.draggedElements.get(0)).parent();
eleParent.attr('style',eleParent.attr('style')+'; '+"margin-top:"+(-(playlistController.draggedElement.offset().top-playlistController.draggedElements.offset().top))+"px"+' !important');
eleParent.css("opacity","1");
playlistController.hideSongOptions();
uiController.draggingSortableSong=false;
uiController.draggingSong=true;
uiController.lastDraggingSongFromSearchlist=true;
uiController.dragSongX=event.clientX;
uiController.dragSongY=event.clientY;
uiController.dragSongCheckHorizontal=true;
uiController.dragSongCheckHorizontalTimer=Date.now();
$(".draggedsearchlistelement").off();
$(".draggedsearchlistelement").on('mousemove',playlistController.scrollByDragCallback);
$(".draggedsearchlistelement").on('wheel',playlistController.scrollByWheel);
$(".draggedsearchlistelement").on('mousewheel',playlistController.scrollByWheel);
$(".draggedsearchlistelement").on('DOMMouseScroll',playlistController.scrollByWheel);
if(playlistController.playlistMode){
$("#playlistview").addClass("dragging")
}
},
stop:function(event,ui){
if(playlistController.playlistMode&&playlistController.playlists.length>0){
$(".draggedlistelement").remove();
var x=event.clientX,y=event.clientY,
elementMouseIsOver=document.elementFromPoint(x,y);
var listElement=$(elementMouseIsOver).parents("li");
if(listElement.length==0)
listElement=$(elementMouseIsOver).parents("ul");
if(listElement.length==0)
listElement=$(elementMouseIsOver)
setTimeout(function(){
if(listElement&&(listElement.parents("#playlistInner").length>0)||listElement.attr("id")=="playlistInner"){
var newPlaylistAtTop=false;
if(listElement.hasClass("playlistsong")){
var playlist=playlistController.getPlaylistFromId(listElement.data("songgid").substring(12))
var newPlaylist=false;
}else if(listElement.hasClass("currentqueue")){
playlist=playlistController.currentQueue;
newPlaylist=false;
}else{if(listElement.hasClass("createplaylist"))
newPlaylistAtTop=true;
playlist=playlistController.createEmptyPlaylist(!newPlaylistAtTop);
playlistController.editedPlaylist=jQuery.extend(true,{},playlist);
playlistController.editedPlaylistTitle="New Playlist";
setTimeout(function(){
$("#popupTextInput").popup('open',{positionTo:"window",transition:'pop'});
},500)
delete playlist.isUnnamedPlaylist;
newPlaylist=true;
}
if(playlist){
if(!playlist.tracks)
playlist.tracks=[];
playlistController.draggedElements.each(function(index,listElement){
if($(listElement).data("song")){
var actSong=$(listElement).data("song");
if(actSong){
actSong=jQuery.extend(true,{},actSong);
actSong.gid=playlistController.getNewID();
actSong.playlistgid=playlist.gid;
playlist.tracks.push(actSong)
}
}
})
setTimeout(function(){
accountController.savePlaylist(playlist.gid,playlist.name,playlist.tracks);
accountController.savePlaylistsPosition();
},0);
if(newPlaylist){
if(playlistController.loadedPlaylistSongs.indexOf(playlist)==-1){
if(newPlaylistAtTop)
playlistController.loadedPlaylistSongs.unshift(playlist);
else
playlistController.loadedPlaylistSongs.push(playlist);
}
playlistController.displayLimit=playlistController.loadedPlaylistSongs.length;
$scope.safeApply();
$("#playlistview").listview('refresh');
playlistController.chosenElement.trigger('chosen:updated');
uiController.playListScroll.scrollTo(0,scrollY);
uiController.updateUI();
setTimeout(function(){
uiController.playListScroll.refresh();
},150)
setTimeout(function(){
uiController.playListScroll.refresh();
},1000)
}else
$scope.safeApply();
}
}
},0)
if(listElement.hasClass("playlistsong")||listElement.hasClass("currentqueue")){
playlistController.animateAddedToList(listElement);
}
}else{
setTimeout(function(){
if(!playlistController.playlistMode&&playlistController.loadedPlaylistSongs.length==0)
$(".importplaylist").show();
},1000)
}
$("#playlistview").removeClass("dragging")
$(".songlist").removeClass("nohover");
var ele=$(playlistController.draggedElements.get(0)).parent();
ele.attr('style',ele.attr('style')+'; '+"margin-top:0px"+' !important');
ele.addClass("animatemargin");
if(searchController.mainDraggedElement){
searchController.mainDraggedElement.draggable("disable").removeClass("ui-disabled ui-state-disabled");
searchController.mainDraggedElement=null;
}
$(this).css("opacity","1")
setTimeout(function(){
$("#searchlist li").simulate("mouseup");
},0)
if(uiController.startedSortPlaylistOpenedPanel)
setTimeout(function(){
uiController.toggleSidePanel();
},1000)
if(uiController.startedSortPlaylist){
playlistController.sortPlaylist=true;
playlistController.toggleSortablePlaylist();
uiController.startedSortPlaylist=false;
}
uiController.draggingSong=false;
playlistController.updateDeselectedSong();
uiController.swipeTimer=Date.now();
},
appendTo:'body',
zIndex:"1000000"});
$("#searchlistview .draggableSong").draggable("disable").removeClass("ui-disabled ui-state-disabled");
}

;

;
var uiController=function(){
};
uiController.responsiveWidthSmallest=780;
uiController.responsiveWidthSmall=850;
uiController.responsiveWidthSmaller=1165;
uiController.adsWidth=160;
uiController.totalTimeWidth=0;
uiController.gridLayout=false;




uiController.init=function(){
uiController.disableAutoFocus();
$(".ui-icon-loading").click(function(){
$(".ui-icon-loading").hide();
})
if(navigator.userAgent.toLowerCase().indexOf('firefox')>-1){
$("#titleHeader").show().css("opacity","1");
$("#iconHeader").css("opacity","1");
}else{
setTimeout(function(){
$("#titleHeader").addClass("fadeincomplete");
$("#titleHeader").show();
$("#iconHeader").addClass("bounce");
},0);
}
$("#titleHeader").append('<div style="margin-left:3px;display:inline-block;color: #a00; font-weight: 100; font-size: 16px;"><sup> BETA</sup></div>');
setTimeout(function(){
$("#iconHeader").attr("src","public/img/logo.gif");
},1000);
uiController.countCustomButtons=$(".videoControlElements-custom-button:visible").length;
$("body").dblclick(function(event){
playlistController.deselectSongs(event);
if(playlistController.sortPlaylist)
playlistController.toggleSortablePlaylist(true);
})

$(".ui-input-clear").addClass("ui-btn ui-btn-b ui-shadow ui-corner-all ui-mini");
uiController.updateDisplay();
setTimeout(function(){
$("iframe").get(0).contentDocument.close();
},2000);
var style=$('<style id="inputclearhide">'+
'.ui-input-clear {'+
' display:none!important;'+
'}'+
'</style>');
$('html > head').append(style);
$('video').bind('contextmenu',function(e){
});
$(window).resize(function(){
if($('.ui-panel-open').length!=0){
$('#rightpanel').panel('close');
}
if(playlistController.sortPlaylist)
playlistController.toggleSortablePlaylist();
$("#playlistview").css("min-height","");
uiController.updateUI();
setTimeout(function(){
uiController.searchListScroll.refresh();
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.searchListScroll.refresh();
uiController.playListScroll.refresh();
playbackController.positionPlayIndicator();
setTimeout(function(){
uiController.searchListScroll.refresh();
uiController.playListScroll.refresh();
playbackController.positionPlayIndicator();
setTimeout(function(){
playbackController.positionPlayIndicator();
setTimeout(function(){
playbackController.positionPlayIndicator();
setTimeout(function(){
uiController.searchListScroll.refresh();
uiController.playListScroll.refresh();
playbackController.positionPlayIndicator();
},2000);
},100);
},100);
},100);
},100);
},1000);
});
$("#rightpanel").on("panelbeforeclose",function(event,ui){
if(playlistController.sortPlaylist)
playlistController.toggleSortablePlaylist();
uiController.sidePanelOpen=false;
uiController.updateUI();
uiController.searchListScroll.enable();
uiController.searchListScroll.refresh();
var transform="translate3d(0px,0px,0px)";
$("#openSidePanelBarIcon").css({"transition":"0.15s linear","-transform":transform,"-ms-transform":transform,"-webkit-transform":transform});
setTimeout(function(){
uiController.updateUI();
},500);
});
$("#rightpanel").on("panelbeforeopen",function(event,ui){
uiController.sidePanelOpen=true;
uiController.searchListScroll.disable();
var transform="translate3d(10px,0px,0px)";
$("#openSidePanelBarIcon").css({"transition":"0.15s linear","-transform":transform,"-ms-transform":transform,"-webkit-transform":transform});
setTimeout(function(){
uiController.updateUI();
},500);
});
setTimeout(function(){
$("#inputclearhide").remove();
},1000);
document.title=$scope.appTitle;
var checkAdblock=function(){
if($(".sideinfo .adsbygoogle").children().length==0){
$(".sideinfo .blocked").show();
}else
$(".sideinfo .blocked").hide();
setTimeout(checkAdblock,3000);
}
setTimeout(checkAdblock,10000);
if(window.WebGLRenderingContext){
try{
var canvas=document.getElementById("webglcanvas");
if(canvas)
try{
var webglcontext=canvas.getContext("webgl")||canvas.getContext("experimental-webgl");
}
catch(e){
}
}catch(e){
}
}
};
uiController.isMaxVideoSizeFaktor=function(sizeVideo){
if($("#videoplayer").height()*0.5*sizeVideo*uiController.sizeVideoRelative+82+30>$(window).height()){
return true
}
return false;
}


uiController.toast=function(msg,time,touchFunc){
$("#toastId").remove();
var toastclass='ui-loader ui-overlay-shadow ui-bar-e ui-corner-all';
$("<div id='toastTest' 'class= '"+toastclass+"'>"+msg+"</div>")
.css({display:"inline-block",visibility:"visisble"})
.appendTo($.mobile.pageContainer)
$("<div class='"+toastclass+"' id = 'toastId'>"+msg+"</div>")
.css({display:"block",
opacity:0,
position:"fixed",
padding:"7px",
"text-align":"center",
width:$("#toastTest").width()+10,
left:(uiController.windowWidth-$("#toastTest").width()-10)/2,
top:$(window).height()/2-$("#toastTest").height()/2})
.click(function(){
$("#toastId").hide();
touchFunc();
})
.appendTo($.mobile.pageContainer)
.fadeTo(400,0.8)
.delay(time)
.fadeOut(400,function(){
$(this).remove();
});
$("#toastTest").remove();
}
uiController.toggleSearchButton=function(button){
$('#searchbutton'+button).buttonMarkup({theme:'a'});
$('#searchbutton'+button).parent().buttonMarkup({theme:'a'});
for(var i=0;i<5;i++){
if(i+1!=button){
$('#searchbutton'+(i+1)).buttonMarkup({theme:'b'});
$('#searchbutton'+(i+1)).parent().buttonMarkup({theme:'b'});
}
}
}

uiController.stopScrollingOnClick=function(event){
var myEvent=jQuery.extend({},event);
myEvent.type="mouseup";
myEvent.preventDefault=function(){
};
setTimeout(function(){
uiController.searchListScroll.handleEvent(myEvent);
},10)
setTimeout(function(){
uiController.searchListScroll.handleEvent(myEvent);
},100)
}
uiController.updateDisplay=function(){
if(videoController.fullscreenMode==0&&$(window).width()>=uiController.responsiveWidthSmallest)
uiController.windowWidth=$(window).width()-uiController.adsWidth;
else
uiController.windowWidth=$(window).width();
$("#page").width(uiController.windowWidth);
if($(window).height()>710)
$("#header").width($(window).width());
else
$("#header").width($(window).width()-160);
$("#videocontrols").width(uiController.windowWidth);
}

uiController.updateUI=function(){
uiController.updateDisplay();
uiController.countCustomButtons=$(".videoControlElements-custom-button:visible").length;
$(".sideinfo").css("line-height",($(window).height()-5-44-10)+"px");
$("#lyricsifrm").css("height",$(window).height()-8-44-44-44)
var myIframe=document.getElementById('lyricsifrm');
setTimeout(function(){
myIframe.contentWindow.scrollTo(0,100);
},2000)
setTimeout(function(){
$("#playlistview").css("min-height",$("#playlistInner").height()-20);
},500)

$(".ui-panel").css("height",$(window).height()-44-3);
$("#page").css("height",$(window).height()-44-3);
if(65*2-30+$(window).height()/2-60>65)
$("#playlisthelp").css("top",75-30+$(window).height()/2-60)
else
$("#playlisthelp").css("top",75-30+65)
if($(window).width()<uiController.responsiveWidthSmallest){
$("#rightpanel").css("height",$(window).height()-88);
$("#searchlist a").css("text-overflow","clip");
if($("#playlist").parents("#rightpanel").length==0)
$("#playlist").appendTo("#rightpanel");
$("#playlist").css("max-height",$(window).height()-44-44-3);
setTimeout(function(){
if($("#playlistselectvertical .chosen-container").height()>0)
$("#playlistInner").css("max-height",$(window).height()-3-45-(100+$("#playlistselectvertical .chosen-container").height()-30));
else
$("#playlistInner").css("max-height",$(window).height()-3-45-5);
},100)
if(uiController.sidePanelOpen){
if(uiController.windowWidth-$("#rightpanel").width()-10<100){
$("#searchlist li").css("max-height","65px");
}
}
$("#searchcontent").css("width",uiController.windowWidth-20);
$("#playlist").css("width",$("#rightpanel").width()-20-10);
$("#playlistInner li").css("width",$("#rightpanel").width()-20);
$("#playlistselectvertical .chosen-container").css("width","");
$("#playlistselectvertical .chosen-container").css("max-width","");
$("#saveplaylistinput").css("width","");
$("#saveplaylistinput").css("max-width","");
$("#playlistselectvertical input").css("width",110);
}
else{$("#searchlist a").css("text-overflow","ellipsis");
if($("#playlist").parents("#rightpanel").length!=0){
$("#playlist").hide().appendTo("#content");
setTimeout(function(){
$("#playlist").fadeIn()
},150)
}
setTimeout(function(){
var topDifference;
if($("#playlistselectvertical .chosen-container").height()>0)
topDifference=$("#playlistselectvertical .chosen-container").height()-30;
else
topDifference=5;
if($(window).width()<uiController.responsiveWidthSmaller&&$(window).width()>uiController.responsiveWidthSmall){
$("#playlist").css("max-height",$(window).height()-110-44);
$("#playlistInner").css("max-height",$(window).height()-110-100-topDifference);
}else{
$("#playlist").css("max-height",$(window).height()-50-44);
$("#playlistInner").css("max-height",$(window).height()-50-100-topDifference);
}
},100)
$("#searchcontent").css("max-height",$(window).height()-44-120+6+5);
var setSelectSize=function(){
$("#playlistselectvertical .chosen-container").css("width",$("#playlist").width()-45);
$("#playlistselectvertical .chosen-container").css("max-width",$("#playlist").width()-45);
$("#saveplaylistinput").css("width",$("#playlist").width()-45);
$("#saveplaylistinput").css("max-width",$("#playlist").width()-45);
$("#playlistselectvertical input").css("width",110);
}
setSelectSize();
$("#playlist").css("width",uiController.windowWidth/3);
$("#playlistInner li").css("width",uiController.windowWidth/3);
if($(window).width()<uiController.responsiveWidthSmall)
$("#searchcontent").css("width",uiController.windowWidth-uiController.windowWidth/3-30-33);
else
$("#searchcontent").css("width",uiController.windowWidth-uiController.windowWidth/3-30);
setSelectSize();
}
uiController.totalTimeWidth=uiController.windowWidth/1.5-160-105-5;
videoController.resizeVideo();
if($(window).width()<uiController.responsiveWidthSmall){
uiController.totalTimeWidth=(uiController.windowWidth/1.5-160);
if((uiController.windowWidth)/1.5-160-105+10<323-105-uiController.countCustomButtons*26){
if(((uiController.windowWidth)/1.5-160-105-uiController.countCustomButtons*26)+10<0){
$("#videocontrols .videoControlElements-time-total").css("width","0px");
$("#videocontrols .videoControlElements-time-rail").css("width","0px");
}
else{
$("#videocontrols .videoControlElements-time-total").css("width",((uiController.windowWidth)/1.5-160-105-uiController.countCustomButtons*26));
$("#videocontrols .videoControlElements-time-rail").css("width",((uiController.windowWidth)/1.5-160-105-uiController.countCustomButtons*26)+10);
}
}
else{
$("#videocontrols .videoControlElements-time-total").css("width",323-105-uiController.countCustomButtons*26-10);
$("#videocontrols .videoControlElements-time-rail").css("width",323-105-uiController.countCustomButtons*26);
}
$("#searchcontent").css("max-height",$(window).height()-44-130-40+12+5);
$("#content").css({"width":uiController.windowWidth-16,"height":$(window).height()-44-4-8});
}
else{

uiController.totalTimeWidth=(uiController.windowWidth/1.5-160)/1.3-105-uiController.countCustomButtons*26;
$("#videocontrols .videoControlElements-time-total").css("width",(uiController.windowWidth/1.5-160)/1.3-105-uiController.countCustomButtons*26);
$("#videocontrols .videoControlElements-time-rail").css("width",(uiController.windowWidth/1.5-160)/1.3+10-105-uiController.countCustomButtons*26);
$("#content").css({"width":uiController.windowWidth-32,"height":$(window).height()-44-4-32});
}
if(uiController.windowWidth<365){
$("#controlbar .ui-input-search").css("max-width",uiController.windowWidth-65);
$("#controlbar .ui-select").css("max-width",uiController.windowWidth-25);
}else{
$("#controlbar .ui-input-search").css("max-width",320);
$("#controlbar .ui-select").css("max-width",340);
}
setTimeout(function(){
if($("#playlistselectvertical .chosen-container").height()>0)
$("#playlistInner").css("top",90+$("#playlistselectvertical .chosen-container").height()-30-30);
else
$("#playlistInner").css("top",90+8-30);
},100)
setTimeout(function(){
var oldDraggelementId="draggelement"+Date.now()+""+Math.random();
$("#draggelement").attr("id",oldDraggelementId);
var style=$('<style id="draggelement">'+
'.draggedlistelement li { '+
'        width: '+($("#playlistInner ul").width()-18)+'px !important;'+
'        max-width: '+($("#playlistInner ul").width()-18)+'px !important;'+
'        min-width: '+($("#playlistInner ul").width()-18)+'px !important;'+
'}'+
'.draggedlistelement li a { '+
'        width: '+($("#playlistInner ul li").width()-90-18)+'px !important;'+
'        max-width: '+($("#playlistInner ul li").width()-90-18)+'px !important;'+
'        min-width: '+($("#playlistInner ul li").width()-90-18)+'px !important;'+
'}'+
'</style>');
$('html > head').append(style);
setTimeout(function(){
$("#"+oldDraggelementId).remove();
},0)
$("#videocontrolsInner").css("opacity",0);
var positionControls=function(){
if(Math.abs($("#videocontrolsInner .videoControlElements-controls").css("padding-left").replace("px","")-((uiController.windowWidth-$(".videoControlElements-controls").width()*1.5)/2/1.5))>1)
$("#videocontrolsInner .videoControlElements-controls").css("padding-left",(uiController.windowWidth-$(".videoControlElements-controls").width()*1.5)/2/1.5).css("padding-right",(uiController.windowWidth-$(".videoControlElements-controls").width()*1.5)/2/1.5);
}
positionControls();
setTimeout(positionControls,50)
},0)
};

uiController.toggleSidePanel=function(){
if(!this.toggleSidePanelTimer||Date.now()-this.toggleSidePanelTimer>200){
if($('.ui-panel-open').length==0){
$('#rightpanel').panel('open')
}else{
$('#rightpanel').panel('close')
}
}
this.toggleSidePanelTimer=Date.now();
}

uiController.showPlaylists=function(){
$('#playlistselectverticalform option').prop('selected',false);
$('#playlistselectverticalform').trigger('chosen:updated');
setTimeout(function(){
$('#playlistselectverticalform').trigger('chosen:close');
},0)
for(var playlist in playlistController.loadedPlaylists){
if(playlistController.loadedPlaylists.hasOwnProperty(playlist)){
if(!playlistController.loadedPlaylists[playlist].tracks||(playlistController.loadedPlaylists[playlist].tracks.length==0&&playlistController.loadedPlaylists[playlist].isUnnamedPlaylist)){
for(var j=playlistController.playlists.length-1;j>=0;j--){
if(playlistController.playlists[j].gid==playlistController.loadedPlaylists[playlist].gid){
playlistController.playlists.splice(j,1);
}
}
}
}
}
playlistController.loadedPlaylists={};
playlistController.loadedPlaylistSongs=[];
playlistController.playlistMode=true;
$("#clearChoosenPlaylists").hide();
uiController.updateUI();
playlistController.loadedPlaylistSongs=playlistController.playlists;
$("#playlistInner .iScrollPlayIndicator").hide();
$("#playlistInner .songlist").addClass("hidden");
playlistController.applySongList();

}

uiController.toggleGridLayout=function(){
uiController.gridLayout=!uiController.gridLayout;
if(uiController.gridLayout)
$("#searchlayoutbutton img").attr("src","public/img/list.png");
else
$("#searchlayoutbutton img").attr("src","public/img/grid.png");
setTimeout(function(){
$("#searchlist  .iScrollIndicator").hide();
var scrollY=uiController.searchListScroll.y;
$("#searchlist").hide();
setTimeout(function(){
$("#searchlist ul").toggleClass("gridlayout")
$("#searchlist").css("opacity","0");
$("#searchlist").show();
$("#searchlistview").listview('refresh');
},0);
setTimeout(function(){
if(uiController.gridLayout){
uiController.gridLayoutCols=Math.floor(($("#searchlist ul").width()-15)/250);
if(($("#searchlist ul").width()/uiController.gridLayoutCols-35)>250){
$("#gridlayoutwidth").remove();
var style=$('<style id="gridlayoutwidth">'+
'#searchlist ul.gridlayout li { width:'+(($("#searchlist ul").width()/uiController.gridLayoutCols-35))+'px!important;} '+
'</style>');
$('html > head').append(style);
}
scrollY=scrollY/uiController.gridLayoutCols;
if(uiController.searchListScroll.toggelLayoutOldY!=uiController.searchListScroll.y)
scrollY=scrollY+64;
}
else{
scrollY=(scrollY)*uiController.gridLayoutCols;
setTimeout(function(){
playlistController.positionSongOptions();
},0)
}
$scope.safeApply();
$("#searchlistview").listview('refresh');
uiController.searchListScroll.refresh();
if($("#searchlist ul").height()>$("#searchlist").height())
$("#searchlist .iScrollIndicator").show();
if(!$("#searchlist ul").height()>$("#searchlist").height())
scrollY=0;
else if(scrollY>0)
scrollY=0;
else if(scrollY<uiController.searchListScroll.maxScrollY)
scrollY=uiController.searchListScroll.maxScrollY;
uiController.searchListScroll.scrollTo(0,scrollY);
$("#searchlist").hide();
$("#searchlist").css("opacity","1");
$("#searchlist").addClass("fadeincomplete");
$("#searchlist").show();
setTimeout(function(){
$("#searchlist").removeClass("fadeincomplete");
},500)
uiController.searchListScroll.toggelLayoutOldY=scrollY;
},800)
},0);
}
uiController.disableUI=function(disable){
if(disable){
$(".fullscreendisable").show()
$.mobile.loading("show");
}else{
$(".fullscreendisable").hide()
$.mobile.loading("hide");
}
}
uiController.showBackgroundImage=function(show){
if(!show){
uiController.showBackgroundImageWasVisible=($("#backgroundImage:visible").length>0);
$("#backgroundImage").removeClass("fadeoutcomplete").addClass("fadeincompleteslow")
$("<style type='text/css' id='hidevideobackground'> #backgroundVideo{ opacity:0!important} #backgroundImage{ display:block!important;}  </style>").appendTo("head");
}else{
$("#hidevideobackground").remove();
if(!uiController.showBackgroundImageWasVisible){
$("#backgroundImage").removeClass("fadeincompleteslow").addClass("fadeoutcomplete")
}
}
}
uiController.disableAutoFocus=function(){
function is_touch_device(){
return!!window.ontouchstart||!!window.onmsgesturechange};
if(is_touch_device()){
var maxTime=3000;
var timeoutInterval=5;
var usedTime=0;
var isManualFocus=false;
function check(){
if(!isManualFocus&&document.activeElement.tagName.toLowerCase()=="input"){
console.log("BLURRED");
document.activeElement.blur();
}
usedTime+=timeoutInterval;
if(usedTime<maxTime){
window.setTimeout(check,timeoutInterval);
}
}
check();
document.body.addEventListener("click",function(evt){
if(evt.target.tagName=="INPUT"){
console.log("MANUAL CLICK");
isManualFocus=true;
}
});
document.body.addEventListener("keydown",function(evt){
isManualFocus=true;
});
}
}
;

;
var videoController=function(){
};
videoController.videoPlayerList=[
[]
];
videoController.videoPlayerList[0]=[];
videoController.videoPlayerList[1]=[];
videoController.videoPlayerList[2]=[];
videoController.videoPlayerList[0][0]=new mediaelementPlayer("#mediaemelemtjsPlayer1");
videoController.videoPlayerList[1][0]=dailymotionPlayer;
videoController.videoPlayerList[2][0]=vimeoPlayer;
videoController.videoPlayer=videoController.videoPlayerList[0][0];videoController.videoOpactiy=0.5;
videoController.isEmbedded=false;
videoController.isPlaying=false;
videoController.scaleFactor=1.5;
videoController.fullscreenMode=0;
videoController.progressTime=0;
videoController.maxTime=0;
videoController.changingVolume=false;
videoController.isMuted=false;
videoController.beforeMutedVolume=null;
videoController.volume=0.5;
videoController.shuffleMode=false;
videoController.prevEnabled=true;
videoController.playpauseEnabled=true;
videoController.stopEnabled=true;
videoController.nextEnabled=true;
videoController.shuffleEnabled=true;
videoController.timerailEnabled=true;
videoController.volumeEnabled=true;
videoController.fullscreenEnabled=false;
videoController.versionsEnabled=true;
videoController.lyricsEnabled=false;
videoController.sharesocialEnabled=false;
videoController.externalSiteEnabled=false;

videoController.init=function(){
var changeHandler=function(){
setTimeout(function(){
if(!videoController.isBrowserFullscreen()){
if(videoController.fullscreenMode!=0){
videoController.fullscreenMode=0;
videoController.updateFullscreenMode();
}
}
},500)
}
document.addEventListener("fullscreenchange",changeHandler,false);
document.addEventListener("webkitfullscreenchange",changeHandler,false);
document.addEventListener("mozfullscreenchange",changeHandler,false);
$(document).keyup(function(evt){
if($('input:focus, textarea:focus').length==0){
if(evt.keyCode==32){
videoController.playPauseSong();
}else if(evt.keyCode==38||evt.keyCode==37){
videoController.playPrevSong();
}else if(evt.keyCode==40||evt.keyCode==39){
playbackController.playNextSong();
}
}
})
for(var i=0;i<=1;i++){
for(var j=0;i<=1;i++){
if(videoController.videoPlayerList[i][j])
videoController.videoPlayerList[i][j].init();
}
}
videoController.controls=$(".videoControlElements-controls");
videoController.controls.find(".videoControlElements-prevtrack-button").click(function(){
videoController.playPrevSong();
});
videoController.controls.find(".videoControlElements-playpause-button").click(function(){
if(videoController.playpauseEnabled&&videoController.videoPlayer){
videoController.playPauseSong();
}
});
videoController.controls.find(".videoControlElements-stop-button").click(function(){
if(videoController.stopEnabled&&videoController.videoPlayer)
videoController.stopSong();
});
videoController.controls.find(".videoControlElements-nexttrack-button").click(function(){
videoController.playNextSong();
});
videoController.controls.find(".videoControlElements-shuffle-button").click(function(){
if(videoController.shuffleEnabled)
videoController.toggleShuffleSongs();
});
videoController.controls.find(".videoControlElements-time-rail").click(function(event){
if(videoController.timerailEnabled&&playbackController.playingSong){
var total=videoController.controls.find('.videoControlElements-time-total'),
x=event.pageX,
offset=total.offset(),
width=total.outerWidth(true)*videoController.scaleFactor/1.023,
pos,
percentage;
if(x<offset.left){
x=offset.left;
}else if(x>width+offset.left){
x=width+offset.left;
}
pos=x-offset.left;
percentage=(pos/width);
videoController.videoPlayer.setProgressPercentage(percentage);
}
});
videoController.controls.find(".videoControlElements-volume-button button").click(function(){
if(videoController.volumeEnabled&&videoController.videoPlayer){
videoController.isMuted=!videoController.isMuted;
if(videoController.isMuted){
videoController.beforeMutedVolume=videoController.volume;
videoController.volume=0;
}else{
videoController.volume=videoController.beforeMutedVolume;
}
videoController.setVolume(videoController.volume);
}
});
videoController.controls.find(".videoControlElements-volume-button").mouseover(function(){
if(videoController.volumeEnabled)
videoController.controls.find(".videoControlElements-volume-slider").show();
});
videoController.controls.find(".videoControlElements-volume-button").mouseout(function(){
if(!videoController.changingVolume)
videoController.controls.find(".videoControlElements-volume-slider").hide();
});
videoController.controls.find(".videoControlElements-volume-slider").click(function(event){
if(!videoController.changingVolume){
var total=videoController.controls.find('.videoControlElements-volume-slider'),
y=event.pageY-20,
offset=total.offset(),
height=total.outerHeight(true)*videoController.scaleFactor/1.023-20,
pos,
percentage;
if(y<offset.top){
y=offset.top;
}else if(y>height+offset.top){
y=height+offset.top;
}
pos=y-offset.top;
percentage=(pos/height);
videoController.volume=(1-percentage);
videoController.setVolume(videoController.volume);
}
});
videoController.controls.find(".videoControlElements-volume-handle").bind('mousedown',function(e){
var volumeSlider=videoController.controls.find('.videoControlElements-volume-slider'),
volumeTotal=videoController.controls.find('.videoControlElements-volume-total'),
volumeCurrent=videoController.controls.find('.videoControlElements-volume-current'),
volumeHandle=videoController.controls.find('.videoControlElements-volume-handle'),
mute=$(".videoControlElements-volume-button");
var changeVolumeHandler=function(e){
videoController.changingVolume=true;
var volume,
totalOffset=volumeTotal.offset();
var
railHeight=volumeTotal.height()*videoController.scaleFactor/1.023,totalTop=parseInt(volumeTotal.css('top').replace(/px/,''),10),
newY=e.pageY-totalOffset.top;
volume=(railHeight-newY)/railHeight;
if(totalOffset.top==0||totalOffset.left==0)
return;
volume=Math.max(0,volume);
volume=Math.min(volume,1);
videoController.volume=volume;
videoController.setVolume(videoController.volume);
videoController.videoPlayer.setVolume(videoController.volume);
}
$(document).bind('mousemove.videoVolume',changeVolumeHandler)
$(document).bind('mouseup.videoVolume',function(e){
if(videoController.controls.find(".videoControlElements-volume-slider:hover").length==0)
videoController.controls.find(".videoControlElements-volume-slider").hide();
setTimeout(function(){
videoController.changingVolume=false;
},50)
$(document).unbind(".videoVolume");
})
});
videoController.controls.find(".videoControlElements-fullscreen-button button").click(function(){
if(videoController.fullscreenEnabled&&videoController.videoPlayer){
videoController.toggleFullscreenMode();
}
});
videoController.controls.find(".videoControlElements-fullscreen-button").mouseover(function(){
if(videoController.fullscreenMode==0)
videoController.controls.find(".videoControlElements-fullscreen-slider").show();
});
videoController.controls.find(".videoControlElements-fullscreen-button").mouseout(function(){
videoController.controls.find(".videoControlElements-fullscreen-slider").hide();
});
videoController.controls.find(".videoControlElements-fullscreen-slider").mouseover(function(){
$(".videoControlElements-fullscreen-button button").css("background-image","url(public/img/brightness.png)")
});
videoController.controls.find(".videoControlElements-fullscreen-slider").mouseout(function(){
$(".videoControlElements-fullscreen-button button").css("background","")
});
videoController.controls.find(".videoControlElements-fullscreen-slider").click(function(event){
if(!videoController.changingVideoOpactiy){
var total=videoController.controls.find('.videoControlElements-fullscreen-slider'),
y=event.pageY-20,
offset=total.offset(),
height=total.outerHeight(true)*videoController.scaleFactor/1.023-20,
pos,
percentage;
if(y<offset.top){
y=offset.top;
}else if(y>height+offset.top){
y=height+offset.top;
}
pos=y-offset.top;
percentage=(pos/height);
videoController.videoOpactiy=(1-percentage);
videoController.setVideoOpacity(videoController.videoOpactiy);
}
});
videoController.controls.find(".videoControlElements-fullscreen-handle").bind('mousedown',function(e){
var videoOpactiySlider=videoController.controls.find('.videoControlElements-fullscreen-slider'),
videoOpactiyTotal=videoController.controls.find('.videoControlElements-fullscreen-total'),
videoOpactiyCurrent=videoController.controls.find('.videoControlElements-fullscreen-current'),
videoOpactiyHandle=videoController.controls.find('.videoControlElements-fullscreen-handle'),
mute=$(".videoControlElements-fullscreen-button");
var changevideoOpactiyHandler=function(e){
videoController.changingVideoOpactiy=true;
var videoOpactiy,
totalOffset=videoOpactiyTotal.offset();
var
railHeight=videoOpactiyTotal.height()*videoController.scaleFactor/1.023,totalTop=parseInt(videoOpactiyTotal.css('top').replace(/px/,''),10),
newY=e.pageY-totalOffset.top;
videoOpactiy=(railHeight-newY)/railHeight;
if(totalOffset.top==0||totalOffset.left==0)
return;
videoOpactiy=Math.max(0,videoOpactiy);
videoOpactiy=Math.min(videoOpactiy,1);
videoController.videoOpactiy=videoOpactiy;
videoController.setVideoOpacity(videoController.videoOpactiy);
}
$(document).bind('mousemove.videoOpacity',changevideoOpactiyHandler)
$(document).bind('mouseup.videoOpacity',function(e){
if(videoController.controls.find(".videoControlElements-fullscreen-slider:hover").length==0)
videoController.controls.find(".videoControlElements-fullscreen-slider").hide();
setTimeout(function(){
videoController.changingVideoOpactiy=false;
},50)
$(document).unbind(".videoOpacity");
})
});
videoController.controls.find(".videoControlElements-button-choose-version").click(function(){
if(videoController.versionsEnabled)
var song=playbackController.getPlayingSong();
var artistString=encodeURIComponent(mediaController.getSongArtist(song));
var titleString=encodeURIComponent(song.name);
mediaController.getVersions(artistString,titleString);
});
videoController.controls.find(".videoControlElements-button-share").click(function(){
mediaController.shareMedia();
});
videoController.controls.find(".videoControlElements-button-lyrics").click(function(){
if(videoController.lyricsEnabled)
mediaController.toggleLyrics();
});
videoController.controls.find(".videoControlElements-button-facebook").click(function(){
if(videoController.sharesocialEnabled){
$("#popupSocial").popup('open',{positionTo:"window",transition:'slideup'});
}
});
videoController.controls.find(".videoControlElements-button-external").click(function(){
if(videoController.externalSiteEnabled){
var mywindow=window.open(mediaController.currentvideoURL,"","");
mywindow.focus();
}
});
setTimeout(function(){
$("#videocontrolsInner").hide();
$("#videocontrolsInner").css("opacity","1");
$("#videocontrolsInner").addClass("fadeincomplete");
$("#videocontrolsInner").show();
},1000);
$("#videocontrols").css("background","none");
videoController.setVolume(videoController.volume);
videoController.disablePlayStopControls(true);
videoController.disableControls(true);
uiController.noVideoClickTimer=0;
videoController.setVideoOpacity(videoController.videoOpactiy);

}

videoController.playPauseSong=function(){
if(videoController.isPlaying)
videoController.pauseSong();
else
videoController.playSong();
}

videoController.resizeVideo=function(){
if(videoController.videoPlayer.resize)
videoController.videoPlayer.resize();
}

videoController.playNextSong=function(){
if(videoController.prevEnabled)
playbackController.playNextSong();
}

videoController.playPrevSong=function(){
if(videoController.prevEnabled)
playbackController.playPrevSong();
}

videoController.isEmbedVideo=function(videoURL){
if(videoURL.search("dailymotion.com")>-1){
return videoController.videoPlayerList[1][0];
}
return null;
}

videoController.loadSongInSuitablePlayer=function(streamURL,videoURL){
videoController.isPlaying=false;
videoController.isLoading=false;
playbackController.isLoading=false;
$("#backgroundVideo").css("opacity","0");
$("#backgroundVideo").removeClass("animated")
$("#backgroundVideo").hide();
$("#siteLogo").hide();
videoController.setMaxTime(0);
videoController.setProgressPercentage(0);
videoController.setProgressTime(0);
videoController.setBufferedPercentage(0);
if(videoController.videoPlayer&&videoController.videoPlayer.unload){
videoController.videoPlayer.unload();
}
var player=videoController.isEmbedVideo(videoURL);
if(player!=null){
videoController.isEmbedded=true;
videoController.videoPlayer=player;
videoController.videoPlayer.load(videoURL);
}
else{
videoController.isEmbedded=false;
videoController.videoPlayer=videoController.videoPlayerList[0][0];
console.dir("PLAY STREAM!!!: "+streamURL);
videoController.videoPlayer.load(streamURL);
}
$("#backgroundVideo").show();
videoController.updateFullscreenMode();
if(!playbackController.firstPlayedSongAlready){
playbackController.firstPlayedSongAlready=true;
$("#backgroundImage").addClass("fadeoutcomplete");
setTimeout(function(){
$("#backgroundImage").hide();
},1000)
}
}

videoController.playSong=function(){
if(!videoController.isPlaying&&playbackController.playingSong){
videoController.controls.find(".videoControlElements-play").removeClass("videoControlElements-play").addClass("videoControlElements-pause");
videoController.videoPlayer.play();
videoController.isPlaying=true;
videoController.disablePlayStopControls(false);
if(!playbackController.isLoading&&!$(".songlist li.loadedsong").hasClass("firstplay")){
$(".songlist li.loadedsong.stillloading .loadingSongImg").hide();
$(".songlist li.loadedsong").addClass("playing");
$(".songlist li.loadedsong").removeClass("pausing");
}
}
}

videoController.pauseSong=function(){
if(videoController.isPlaying){
videoController.controls.find(".videoControlElements-pause").removeClass("videoControlElements-pause").addClass("videoControlElements-play");
videoController.videoPlayer.pause();
videoController.isPlaying=false;
if(!playbackController.isLoading){
$(".songlist li.loadedsong.stillloading .loadingSongImg").hide();
$(".songlist li.loadedsong").addClass("pausing");
$(".songlist li.loadedsong").removeClass("playing");
}
}
}

videoController.stopSong=function(){
if(playbackController.playingSong){
if(videoController.isPlaying){
videoController.pauseSong();
videoController.isPlaying=false;
}
videoController.videoPlayer.stop();
videoController.setProgressPercentage(0);
$(".songlist li.loadedsong").removeClass("pausing");
$(".songlist li.loadedsong").addClass("playing");
if(videoController.stopEnabled==true){
videoController.disableStopControl(true);
$(".videoControlElements-playpause-button button").removeClass("looped");
$(".videoControlElements-time-loaded").hide();
if(!playbackController.playingOldSong){
playbackController.resetPlayingSong();
}
}
}
}

videoController.isBrowserFullscreen=function(){
return(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||window.fullScreen)||
(window.innerWidth==screen.width&&window.innerHeight==screen.height);
}

videoController.toggleFullscreenMode=function(){
videoController.fullscreenMode=videoController.fullscreenMode+1;
if(videoController.fullscreenMode>1)
videoController.fullscreenMode=0;
videoController.updateFullscreenMode();
}
videoController.toggleBrowserFullScreen=function(){
var element=document.getElementById("page");
console.dir("FULLSCREEEN!!!!");
console.dir(document.webkitIsFullScreen);
console.dir(element.webkitRequestFullScreen);
console.dir();
if(element.requestFullScreen){
if(!document.fullScreen){
element.requestFullscreen();
}else{
document.exitFullScreen();
}
}
if(element.mozRequestFullScreen){
if(!document.mozFullScreen){
element.mozRequestFullScreen();
}else{
document.mozCancelFullScreen();
}
}else if(element.webkitRequestFullScreen){
if(!document.webkitIsFullScreen){
element.webkitRequestFullScreen();
}else{
document.webkitCancelFullScreen();
}
}
}

videoController.updateFullscreenMode=function(){
var hideControlsTimer=null;
var hideControlsPointerX=null;
var hideControlsPointerY=null;
var hideControls=function(event){
if(!hideControlsPointerX||!event||(Math.abs(hideControlsPointerX-event.clientX)>20&&Math.abs(hideControlsPointerY-event.clientY)>20)){
if(event){
hideControlsPointerX=event.clientX;
hideControlsPointerY=event.clientY;
}
if(hideControlsTimer){
clearTimeout(hideControlsTimer)
$("#videocontrols").css("opacity","");
$("#siteLogo img").css("bottom","");
}
hideControlsTimer=setTimeout(function(){
if(videoController.fullscreenMode==1){
$("#videocontrols").css("opacity","0");
$("#siteLogo img").css("bottom","15px");
}
},3500)
}
}
if(videoController.fullscreenMode==0){$("#songbaseLogoImage").hide();
if(hideControlsTimer){
clearTimeout(hideControlsTimer);
$("#videocontrols").removeClass("fadeoutcomplete");
}
$("body").off("mousemove mouseup",hideControls);
$("#header").css("opacity","1").css("pointer-events","auto");
$("#controlbar").css("opacity","1").css("pointer-events","auto");
$("#searchlist").css("opacity","1").css("pointer-events","auto");
$("#playlist").css("opacity","1").addClass("fadeincomplete").css("pointer-events","auto");
$("#controlbarplaylist").css("opacity","1").css("pointer-events","auto");
$(".videoControlElements-custom-button").show();
$(".backgroundVideo,  #backgroundVideo").addClass("background");
$(".fb-recommendations-bar-container").show();
$(".sideinfo").show();
$("#page, #content, .backgroundVideo, #backgroundVideo").removeClass("fullscreen");
uiController.updateUI();
if(videoController.isBrowserFullscreen())
videoController.toggleBrowserFullScreen();
setTimeout(function(){
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.updateUI();
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.updateUI();
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.updateUI();
uiController.playListScroll.refresh();
setTimeout(function(){
uiController.updateUI();
uiController.playListScroll.refresh();
},1000)
},1000)
},1000)
},1000)
},150)
}
else if(videoController.fullscreenMode==1){setTimeout(function(){
hideControls();
$("body").on("mousemove mouseup",hideControls);
},2000);
$("#songbaseLogoImage").show();
$(".videoControlElements-custom-button").hide();
$("#header").css("opacity","0").css("pointer-events","none");
$("#controlbar").css("opacity","0").css("pointer-events","none");
$("#searchlist").css("opacity","0").css("pointer-events","none");
$("#playlist").css("opacity","0").removeClass("fadeincomplete").css("pointer-events","none");
$("#controlbarplaylist").css("opacity","0").css("pointer-events","none");
$(".backgroundVideo,  #backgroundVideo").removeClass("background");
$("#page, #content, .backgroundVideo,  #backgroundVideo").addClass("fullscreen");
$(".fb-recommendations-bar-container").hide();
$(".sideinfo").hide();
uiController.updateUI();
if(!videoController.isBrowserFullscreen()){
$("#videocontrols").css("opacity","0");
setTimeout(function(){
$("#videocontrols").hide();
$("#videocontrols").css("opacity","1");
$("#videocontrols").addClass("fadeincomplete")
uiController.updateUI();
$("#videocontrols").show();
setTimeout(function(){
$("#videocontrols").removeClass("fadeincomplete");
},2000)
},1000)
videoController.toggleBrowserFullScreen();
}
}
}

videoController.disableStopControl=function(disable){
videoController.stopEnabled=!disable;
if(disable){
$(".videoControlElements-stop-button button").css("opacity","0.5");
}else{
$(".videoControlElements-stop-button button").css("opacity","1");
}
}

videoController.disablePlayStopControls=function(disable){
videoController.stopEnabled=!disable;
videoController.playpauseEnabled=!disable;
if(disable){
$(".videoControlElements-playpause-button button").css("opacity","0.5");
$(".videoControlElements-stop-button button").css("opacity","0.5");
}else{
$(".videoControlElements-playpause-button button").css("opacity","1");
$(".videoControlElements-stop-button button").css("opacity","1");
}
}

videoController.disableControls=function(disable){
videoController.prevEnabled=!disable;
videoController.nextEnabled=!disable;
if(disable){
$(".videoControlElements-nexttrack-button button").css("opacity","0.5");
$(".videoControlElements-prevtrack-button button").css("opacity","0.5");
}else{
$(".videoControlElements-nexttrack-button button").css("opacity","1");
$(".videoControlElements-prevtrack-button button").css("opacity","1");
}
}

videoController.disablePositionControls=function(disable){
videoController.prevEnabled=!disable;
videoController.nextEnabled=!disable;
if(disable){
$(".videoControlElements-nexttrack-button button").css("opacity","0.5");
$(".videoControlElements-prevtrack-button button").css("opacity","0.5");
}else{
$(".videoControlElements-nexttrack-button button").css("opacity","1");
$(".videoControlElements-prevtrack-button button").css("opacity","1");
}
}

videoController.disableVersionControl=function(disable){
videoController.versionsEnabled=!disable;
if(disable){
$(".videoControlElements-button-choose-version button").css("opacity","0.5");
}else{
$(".videoControlElements-button-choose-version button").css("opacity","1");
}
}

videoController.disableLyricsControl=function(disable){
videoController.lyricsEnabled=!disable;
if(disable){
$(".videoControlElements-button-lyrics button").css("opacity","0.5");
}else{
$(".videoControlElements-button-lyrics button").css("opacity","1");
}
}

videoController.disableFullscreenControl=function(disable){
videoController.fullscreenEnabled=!disable;
if(disable){
$(".videoControlElements-fullscreen-button button").css("opacity","0.5");
}else{
$(".videoControlElements-fullscreen-button button").css("opacity","1");
}
}

videoController.disableExternalSiteControl=function(disable){
videoController.externalSiteEnabled=!disable;
if(disable){
$(".videoControlElements-button-external button").css("opacity","0.5");
}else{
$(".videoControlElements-button-external button").css("opacity","1");
}
}

videoController.disableShareSocialControl=function(disable){
videoController.sharesocialEnabled=!disable;
if(disable){
$(".videoControlElements-button-facebook button").css("opacity","0.5");
}else{
$(".videoControlElements-button-facebook button").css("opacity","1");
}
}

videoController.toggleShuffleSongs=function(){
videoController.shuffleMode=!videoController.shuffleMode;
if(videoController.shuffleMode)
$(".videoControlElements-shuffle-button button").css("opacity","1");
else{
$(".videoControlElements-shuffle-button button").css("opacity","0.5");
}
}

videoController.setLoopButton=function(loop){
if(loop){
$(".videoControlElements-playpause-button button").addClass("looped");
}else{
$(".videoControlElements-playpause-button button").removeClass("looped");
}
}

videoController.setProgressPercentage=function(percentage,updateVideo){
if(percentage<0)
percentage=0;
else if(percentage>1)
percentage=1;
videoController.controls.find(".videoControlElements-time-current").css("width",percentage*100+"%")
if(videoController.maxTime&&videoController.maxTime>0){
videoController.progressTime=videoController.maxTime*percentage;
videoController.controls.find(".videoControlElements-currenttime").text(videoController.secondsToTimeCode(videoController.progressTime,false,false,false));
}
if(updateVideo&&videoController.videoPlayer&&playbackController.playingSong&&!playbackController.isLoading)
videoController.videoPlayer.setProgressPercentage(percentage);
}

videoController.setProgressTime=function(time,updateVideo){
videoController.progressTime=time;
videoController.controls.find(".videoControlElements-currenttime").text(videoController.secondsToTimeCode(time,false,false,false));
if(videoController.maxTime&&videoController.maxTime>0)
videoController.setProgressPercentage(videoController.progressTime/videoController.maxTime,updateVideo)
}

videoController.setBufferedPercentage=function(percentage){
videoController.buffered=percentage;
if(percentage<0)
percentage=0;
else if(percentage>1)
percentage=1;
videoController.controls.find(".videoControlElements-time-loaded").css("width",percentage*100+"%")
}

videoController.showBuffered=function(show){
if(show)
videoController.controls.find(".videoControlElements-time-loaded").fadeIn()
else
videoController.controls.find(".videoControlElements-time-loaded").fadeOut()
}

videoController.setMaxTime=function(time){
videoController.maxTime=time;
videoController.controls.find(".videoControlElements-duration").text(videoController.secondsToTimeCode(time,false,false,false));
}

videoController.showBuffering=function(show){
if(show)
videoController.controls.find(".videoControlElements-time-buffering").fadeIn();
else
videoController.controls.find(".videoControlElements-time-buffering").hide();
}

videoController.setVolume=function(volume,secondTry){
var volumeSlider=videoController.controls.find('.videoControlElements-volume-slider'),
volumeTotal=videoController.controls.find('.videoControlElements-volume-total'),
volumeCurrent=videoController.controls.find('.videoControlElements-volume-current'),
volumeHandle=videoController.controls.find('.videoControlElements-volume-handle'),
mute=$(".videoControlElements-volume-button");
if(!volumeSlider.is(':visible')&&typeof secondTry=='undefined'){
volumeSlider.show();
videoController.setVolume(volume,true);
volumeSlider.hide()
return;
}
volume=Math.max(0,volume);
volume=Math.min(volume,1);
if(volume==0){
mute.removeClass('videoControlElements-mute').addClass('videoControlElements-unmute');
}else{
mute.removeClass('videoControlElements-unmute').addClass('videoControlElements-mute');
}
var totalHeight=volumeTotal.height(),
totalPosition=volumeTotal.position(),
newTop=totalHeight-(totalHeight*volume);
volumeHandle.css('top',Math.round(totalPosition.top+newTop-(volumeHandle.height()/2)));
volumeCurrent.height(totalHeight-newTop);
volumeCurrent.css('top',totalPosition.top+newTop);
videoController.volume=volume;
videoController.videoPlayer.setVolume(videoController.volume);
}

videoController.setVideoOpacity=function(videoOpactiy,secondTry){
var videoOpactiySlider=videoController.controls.find('.videoControlElements-fullscreen-slider'),
videoOpactiyTotal=videoController.controls.find('.videoControlElements-fullscreen-total'),
videoOpactiyCurrent=videoController.controls.find('.videoControlElements-fullscreen-current'),
videoOpactiyHandle=videoController.controls.find('.videoControlElements-fullscreen-handle'),
mute=$(".videoControlElements-fullscreen-button");
if(!videoOpactiySlider.is(':visible')&&typeof secondTry=='undefined'){
videoOpactiySlider.show();
videoController.setVideoOpacity(videoOpactiy,true);
videoOpactiySlider.hide()
return;
}
videoOpactiy=Math.max(0,videoOpactiy);
videoOpactiy=Math.min(videoOpactiy,1);
var totalHeight=videoOpactiyTotal.height(),
totalPosition=videoOpactiyTotal.position(),
newTop=totalHeight-(totalHeight*videoOpactiy);
videoOpactiyHandle.css('top',Math.round(totalPosition.top+newTop-(videoOpactiyHandle.height()/2)));
videoOpactiyCurrent.height(totalHeight-newTop);
videoOpactiyCurrent.css('top',totalPosition.top+newTop);
videoController.videoOpactiy=videoOpactiy;
$("#backgroundVideo").css("opacity",videoController.videoOpactiy);
if(videoController.videoOpactiy==0){
$("#backgroundVideo").hide();
}else
$("#backgroundVideo").show();
}

videoController.endedSong=function(){
videoController.stopSong();

mediaController.mediaEnded();
}

videoController.playingSong=function(){
if(playbackController.playingSong){
playbackController.playingSongTimer=Date.now();
$("#backgroundVideo").addClass("animated")
$("#backgroundVideo").css("opacity",videoController.videoOpactiy);
$("#siteLogoImage").attr("src","public/img/sites/"+mediaController.getSiteLogo());
$("#siteLogo").show();
videoController.disableExternalSiteControl(false);
videoController.disableFullscreenControl(false);
$(".videoControlElements-time-loaded").show();
$(".videoControlElements-playpause-button button").removeClass("looped");
if(!playbackController.playingSong.isAudioFile){

uiController.updateUI(true);
}
}
}


videoController.secondsToTimeCode=function(time,forceHours,showFrameCount,fps){
if(typeof showFrameCount=='undefined'){
showFrameCount=false;
}else if(typeof fps=='undefined'){
fps=25;
}
var hours=Math.floor(time/3600)%24,
minutes=Math.floor(time/60)%60,
seconds=Math.floor(time%60),
frames=Math.floor(((time%1)*fps).toFixed(3)),
result=
((forceHours||hours>0)?(hours<10?'0'+hours:hours)+':':'')
+(minutes<10?'0'+minutes:minutes)+':'
+(seconds<10?'0'+seconds:seconds)
+((showFrameCount)?':'+(frames<10?'0'+frames:frames):'');
return result;
}

;

;
var viewController=function(){
};
viewController.views=[searchController,exploreController,myBaseController];
viewController.activeView=null;

viewController.init=function(){
for(var i=0;i<viewController.views.length;i++){
if(viewController.views[i].init)
viewController.views[i].init();
}
setTimeout(function(){
$("#searchinput").focus(function(){
var that=$(this);
window.setTimeout(function(){
if($(".ui-popup-active, .ui-popup-container.pop.in").length==0)
that.select();
},100);
});
},10000);
$("#searchinput").on("input",function(){
viewController.activeView.onInput();
})
$("#controlbar .ui-input-clear").click(function(){
viewController.activeView.onClear();
})
viewController.activateView(searchController,true);
if(!urlParams.search||urlParams.search==""){
setTimeout(function(){
viewController.activeView.onInput();
},500)
}
}

viewController.showLoading=function(show){
if(show)
$(".ui-alt-icon.ui-icon-search, .ui-alt-icon .ui-icon-search, .ui-input-search").addClass("loading");
else
$(".ui-alt-icon.ui-icon-search, .ui-alt-icon .ui-icon-search, .ui-input-search").removeClass("loading");
}

viewController.isActiveView=function(view){
return viewController.activeView==view;
}

viewController.activateView=function(view,noAnimation,showFunction){
if(!viewController.isActiveView(view)){
viewController.showLoading(false);
$("#controlbar .ui-input-clear").addClass("ui-input-clear-hidden");
if(viewController.activeView){
viewController.activeView.hideView();
if(viewController.activeView.usesSearchList){
$("#searchlist .iScrollPlayIndicator").hide();
$("#searchlist .iScrollScrollUpIndicator").hide();
$("#searchlist .iScrollIndicator").hide();
}
}
viewController.activeView=view;
var index=viewController.activeView.index;
var input=$("#searchinput").parent();
var oIndex=input.data("button");
if(oIndex){
var oButton=$("#searchbutton"+oIndex).parent();
oButton.show();
var width=oButton.width();
oButton.removeClass("animated");
oButton.css("width",input.width());
setTimeout(function(){
oButton.addClass("animated");
oButton.css("width",width)
},50)
}
input.data("button",index+1);
var button=$("#searchbutton"+(index+1)).parent();
input.removeClass("animated");
if(!noAnimation)
input.css("width",button.width());
setTimeout(function(){
if(!noAnimation)
input.addClass("animated");
input.css("width","");
setTimeout(function(){
input.find("input").focus();
},500)
uiController.toggleSearchButton(index+1);
},60)
$("#searchinput").val("");
if(viewController.activeView.inputText)
$(input).insertAfter(button).find("input").attr("placeholder",viewController.activeView.inputText);
button.hide();
if(viewController.activeView.usesSearchList){
$("#searchlayoutbutton").show();
$("#searchlist").show();
}
else{
$("#searchlayoutbutton").hide();
$("#searchlist").hide();
}
viewController.activeView.showView(showFunction);
}
}

viewController.applySongList=function(currentSearchID,size,delays,stepSize,stepDelay){
$(".specialplaylistbutton").removeClass("fadeincompletefaster");
$("#searchlist .iScrollIndicator").hide();
var songInList=viewController.activeView.isSongInList(playbackController.playingSong);
$("#searchlist .loadedsong").removeClass("loadedsong playing pausing stillloading");
$("#searchlist .oldloadedsong").removeClass("loadedsong");
for(var i=1;i<=delays;i++){
var show=function(index){
setTimeout(function(){
if(viewController.activeView.currentSearchID==currentSearchID){

viewController.activeView.displayLimit=size*index/delays;
$scope.safeApply();
if((songInList&&$("#searchlist .loadedsong").length==0)||index==1)
playbackController.remarkSong();
if(index==1){
if(songInList)
playbackController.positionPlayIndicator();
playlistController.updateDeselectedSong();
$(".specialplaylistbutton").addClass("fadeincompletefaster");
}
if(index==delays){
if(songInList)
playbackController.positionPlayIndicator();
searchController.makeSearchListDraggable();
setTimeout(function(){
uiController.searchListScroll.refresh();
$("#searchlistview li").removeClass("fadeincompletefast fadeincompletefaster");
},500)
setTimeout(function(){
uiController.searchListScroll.refresh();
},2000)
}else if(index%3==0){
uiController.searchListScroll.refresh();
if(songInList)
playbackController.positionPlayIndicator();
}
$("#searchlistview").listview('refresh');
}
},stepDelay*(index-1))
}
show(i)
}
}

;

;
var vimeoPlayer=function(){
};
vimeoPlayer.player=null;
vimeoPlayer.active=0;
vimeoPlayer.vimeo=0;
vimeoPlayer.vimeoVideoID="";
vimeoPlayer.bufferedTime=0;
vimeoPlayer.duration=0;
vimeoPlayer.currentTime=0;
vimeoPlayer.apiready=false;
vimeoPlayer.player=null;
vimeoPlayer.status=null;
vimeoPlayer.iframe=null;
window.dmAsyncInit=function()
{
}


vimeoPlayer.init=function(){
};

vimeoPlayer.setProgressPercentage=function(percentage){
videoController.setProgressPercentage(percentage)
}
vimeoPlayer.eventListener=function(){};
vimeoPlayer.eventListener.apiready=function(e)
{
if(vimeoPlayer.player){
if(e.target.src.search(vimeoPlayer.vimeoVideoID)>-1){
$(".mejs-time-buffering").hide();
$("#vimeoplayer").show();
$("#vimeoembedplayer").show();
vimeoPlayer.apiready=true;
vimeoPlayer.firstplay=true;
if(vimeoPlayer.startplay){
vimeoPlayer.play()
}
else if(vimeoPlayer.startpause){
videoController.playingSong();
vimeoPlayer.firstplay=false;
}
vimeoPlayer.startpause=false;
vimeoPlayer.startplay=false;
}
}
}
vimeoPlayer.eventListener.error=function(e)
{
if(vimeoPlayer.player){
vimeoPlayer.error();
}
}
vimeoPlayer.eventListener.play=function(e)
{
if(vimeoPlayer.player&&vimeoPlayer.firstplay){
videoController.playingSong();
vimeoPlayer.firstplay=false;
}
}
vimeoPlayer.eventListener.canplaythrough=function(e)
{

}
vimeoPlayer.eventListener.durationchange=function(e)
{
if(vimeoPlayer.player){
vimeoPlayer.duration=e.target.duration;
videoController.setMaxTime(vimeoPlayer.duration);
}
}
vimeoPlayer.eventListener.timeupdate=function(e)
{
if(vimeoPlayer.player){
vimeoPlayer.currentTime=e.target.currentTime;
videoController.setProgressTime(vimeoPlayer.currentTime);
}
}
vimeoPlayer.eventListener.progress=function(e)
{
if(vimeoPlayer.player){
if(e.target.src.search(vimeoPlayer.vimeoVideoID)>-1){
vimeoPlayer.bufferedTime=e.target.bufferedTime;
if(vimeoPlayer.duration>0){
videoController.setBufferedPercentage(vimeoPlayer.bufferedTime/vimeoPlayer.duration);
}
}
}
}
vimeoPlayer.eventListener.ended=function(e)
{
if(vimeoPlayer.player){
if(e.target.src.search(vimeoPlayer.vimeoVideoID)>-1){
vimeoPlayer.mediaEnded();
videoController.endedSong();
}
}
}

vimeoPlayer.loadInit=function(){
vimeoPlayer.iframe=$('#vimeoplayerframe')[0];
vimeoPlayer.player=$f(vimeoPlayer.iframe);
vimeoPlayer.status=$('.status');
vimeoPlayer.player.addEvent('ready',function(){
});
vimeoPlayer.player.api("play");
vimeoPlayer.apiready=true;
}
vimeoPlayer.load=function(url){
console.dir("VIMEO LOAD: "+url);
vimeoPlayer.active=1;
vimeoPlayer.bufferedTime=0;
vimeoPlayer.duration=0;
vimeoPlayer.currentTime=0;
vimeoPlayer.apiready=false;
$.ajax({
url:"http://vimeo.com/api/oembed.json?url="+escape(url),
success:function(data){
console.dir("VIMEO JSON")
console.dir(data)
var videoid=data.video_id;
if(videoid){
console.dir("VIMEO VideoID: "+videoid);
$("#vimeoplayer").remove();
$("#vimeoembedplayer").append('<div id="vimeoplayer" ><iframe id="vimeoplayerframe" src="//player.vimeo.com/video/'+videoid+'?portrait=0&autoplay=1&badge=0&hd=1&title=0&byline=0" width="110%" height="110%" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>');
$('#vimeoplayerframe').load(vimeoPlayer.loadInit);
$("#vimeoPlayer").hide();
$("#vimeoembedplayer").show();
$("#vimeoplayer").addClass("iframeVideo").appendTo("#backgroundVideo");
}
},
error:function(xhr,ajaxOptions,thrownError){
}
})
};

vimeoPlayer.unload=function(){
vimeoPlayer.player.api("unload");
console.dir("UNLOAD! ");
vimeoPlayer.vimeoVideoID="null";
vimeoPlayer.stop();
vimeoPlayer.active=0;
$("#vimeoplayer").hide();
vimeoPlayer.apiready=false;
delete vimeoPlayer.player;
vimeoPlayer.player=null;
$("#vimeoplayer").remove();
$("#vimeoembedplayer").append('<div id="vimeoplayer" ></div>');
};
vimeoPlayer.setVolume=function(volume){
if(vimeoPlayer.player&&vimeoPlayer.apiready){
vimeoPlayer.player.api("setVolume",volume)
}
}
vimeoPlayer.play=function(){
if(vimeoPlayer.player){
if(vimeoPlayer.apiready){
vimeoPlayer.player.api("play");
}
else{
vimeoPlayer.startplay=true;
vimeoPlayer.startpause=false;
}
console.dir("PLAY: "+vimeoPlayer.vimeoVideoID);
}
}
vimeoPlayer.pause=function(){
if(vimeoPlayer.player){
if(vimeoPlayer.apiready)
vimeoPlayer.player.api("pause");
else{
vimeoPlayer.startplay=false;
vimeoPlayer.startpause=true;
}
console.dir("PAUSE: "+vimeoPlayer.vimeoVideoID);
}
}
vimeoPlayer.stop=function(){
if(vimeoPlayer.player&&vimeoPlayer.apiready){
vimeoPlayer.player.api("pause");
vimeoPlayer.player.api("setCurrentTime",0);
}
}
vimeoPlayer.setProgressPercentage=function(percentage){
if(vimeoPlayer.player&&vimeoPlayer.apiready){
vimeoPlayer.player.api("setCurrentTime",percentage*vimeoPlayer.duration);
}
}
vimeoPlayer.mediaEnded=function(){
videoController.endedSong();
mediaController.mediaEnded();
}
vimeoPlayer.error=function(){
if(vimeoPlayer.active==1){
}
}

;

;function pkcs1unpad2(d,n){
var b=d.toByteArray();
var i=0;
while(i<b.length&&b[i]==0)++i;
if(b.length-i!=n-1||b[i]!=2)
return null;
++i;
while(b[i]!=0)
if(++i>=b.length)return null;
var ret="";
while(++i<b.length){
var c=b[i]&255;
if(c<128){ret+=String.fromCharCode(c);
}
else if((c>191)&&(c<224)){
ret+=String.fromCharCode(((c&31)<<6)|(b[i+1]&63));
++i;
}
else{
ret+=String.fromCharCode(((c&15)<<12)|((b[i+1]&63)<<6)|(b[i+2]&63));
i+=2;
}
}
return ret;
}
function RSASetPrivate(N,E,D){
if(N!=null&&E!=null&&N.length>0&&E.length>0){
this.n=parseBigInt(N,16);
this.e=parseInt(E,16);
this.d=parseBigInt(D,16);
}
else
alert("Invalid RSA private key");
}
function RSASetPrivateEx(N,E,D,P,Q,DP,DQ,C){
if(N!=null&&E!=null&&N.length>0&&E.length>0){
this.n=parseBigInt(N,16);
this.e=parseInt(E,16);
this.d=parseBigInt(D,16);
this.p=parseBigInt(P,16);
this.q=parseBigInt(Q,16);
this.dmp1=parseBigInt(DP,16);
this.dmq1=parseBigInt(DQ,16);
this.coeff=parseBigInt(C,16);
}
else
alert("Invalid RSA private key");
}
function RSAGenerate(B,E){
var rng=new SecureRandom();
var qs=B>>1;
this.e=parseInt(E,16);
var ee=new BigInteger(E,16);
for(;;){
for(;;){
this.p=new BigInteger(B-qs,1,rng);
if(this.p.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10))break;
}
for(;;){
this.q=new BigInteger(qs,1,rng);
if(this.q.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10))break;
}
if(this.p.compareTo(this.q)<=0){
var t=this.p;
this.p=this.q;
this.q=t;
}
var p1=this.p.subtract(BigInteger.ONE);
var q1=this.q.subtract(BigInteger.ONE);
var phi=p1.multiply(q1);
if(phi.gcd(ee).compareTo(BigInteger.ONE)==0){
this.n=this.p.multiply(this.q);
this.d=ee.modInverse(phi);
this.dmp1=this.d.mod(p1);
this.dmq1=this.d.mod(q1);
this.coeff=this.q.modInverse(this.p);
break;
}
}
}
function RSADoPrivate(x){
if(this.p==null||this.q==null)
return x.modPow(this.d,this.n);
var xp=x.mod(this.p).modPow(this.dmp1,this.p);
var xq=x.mod(this.q).modPow(this.dmq1,this.q);
while(xp.compareTo(xq)<0)
xp=xp.add(this.p);
return xp.subtract(xq).multiply(this.coeff).mod(this.p).multiply(this.q).add(xq);
}
function RSADecrypt(ctext){
var c=parseBigInt(ctext,16);
var m=this.doPrivate(c);
if(m==null)return null;
return pkcs1unpad2(m,(this.n.bitLength()+7)>>3);
}
RSAKey.prototype.doPrivate=RSADoPrivate;
RSAKey.prototype.setPrivate=RSASetPrivate;
RSAKey.prototype.setPrivateEx=RSASetPrivateEx;
RSAKey.prototype.generate=RSAGenerate;
RSAKey.prototype.decrypt=RSADecrypt;
;

